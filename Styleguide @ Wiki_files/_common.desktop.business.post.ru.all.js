var BEMHTML;!function(t){var e=function(){var t,e={};(function(e){if("function"==typeof e.I18N&&e.I18N._proto)return e.I18N;void 0===i&&(i={}),t=e;var n="_",s="__",o={},r=[],a=!1,c="undefined"!=typeof console&&"function"==typeof console.log;function l(t,e){if(a&&c){var i="keyset: "+e._keyset+" key: "+e._key+" (lang: "+e._lang+")";console.log(t,i)}}function d(){this._lang="",this._prj="lego",this._keyset="",this._key=""}d.prototype={lang:function(t){return this._lang=t,this},project:function(t){return this._prj=t,this},keyset:function(t,e){var i;return e&&function(t){t&&r.push(t)}(this._keyset),this._keyset="string"==typeof(i=t)?i:i.block+(i.elem?s+i.elem:"")+(i.modName?n+i.modName+n+i.modVal:""),this},key:function(t){return this._key=t,this},decl:function(t){var e=function(t){var e={};return t.split(s).forEach(function(t,i){var s=[i?"elem":"block","mod","val"];t.split(n).forEach(function(t,i){e[s[i]]=t})}),e}(this._keyset),r="i-tanker"===e.block?"tanker":this._prj,a=e.elem||this._keyset,c=this._key;(a=(r=i[r]||(i[r]={}))[a]||(r[a]={}))[c]="function"==typeof t?t:function(){return t};var l=o[this._lang]||(o[this._lang]={});(l[this._keyset]||(l[this._keyset]={}))[c]=t},val:function(t,e){var i=o[this._lang]&&o[this._lang][this._keyset];if(!i)return l("[I18N_NO_KEYSET] %s",this),"";var n=typeof(i=i[this._key]);return"undefined"===n?(l("[I18N_NO_VALUE] %s",this),""):"string"===n?i:i.call(e||this,t)},_cache:function(){return o}};var h=function(t,e,i){return h.keyset(t).key(e,i)};h._proto=new d,h.project=function(t){return this._proto.project(t),this},h.keyset=function(t){return this._proto.keyset(t,!0),this},h.key=function(t,e){var i,n,s=this._proto;return s.lang(this._lang).key(t),i=s.val(e,h),(n=r.length&&r.pop())&&s.keyset(n,!1),i},h.decl=function(t,e,i){var n,s=this._proto;for(n in i&&i.lang&&s.lang(i.lang),s.keyset(t),e)e.hasOwnProperty(n)&&s.key(n).decl(e[n]);return this},h.lang=function(t){return void 0!==t&&(this._lang=t),this._lang},h.debug=function(t){a=!!t},h.lang("ru"),e.I18N=h})(void 0===(t=e)?{}:t);var i=e.I18N;return i.decl("attach",{"button-text":"Выбрать файл","no-file":"файл не выбран",page_import_invalid_format:'Неверный формат. Выберите, пожалуйста, файл с форматом ".docx" или ".txt".'},{lang:"ru"}),i.decl("b-cluster-tree",{cant_load_cluster_tree:"Не удалось загрузить структуру раздела",subpages:"Подстраницы"},{lang:"ru"}),i.decl("b-cluster-tree-filter",{closed_pages:"Страницы с закрытым доступом",non_existent:"Несуществующие страницы",redirects:"Страницы с перенаправлением",tables:"Таблицы"},{lang:"ru"}),i.decl("b-cluster-tree-sort",{sort_by_address:"По адресу",sort_by_createDate:"По дате создания",sort_by_name:"По заголовку",sort_by_updates:"По дате изменения"},{lang:"ru"}),i.decl("b-copyright",{yandex:"Яндекс"},{lang:"ru"}),i.decl("b-editor-close-button",{want_to_close:"Вы действительно хотите закрыть редактор?"},{lang:"ru"}),i.decl("b-editor-save-button",{page_title_prefix:"Страница",save_error:"Не удалось сохранить страницу"},{lang:"ru"}),i.decl("b-event",{cant_load_revision:"Не удалось загрузить эту версию."},{lang:"ru"}),i.decl("b-events-log",{access:"Изменены права доступа",add_author:"Добавлен автор",add_comment:"Добавлен комментарий",add_file:"Добавлен файл",author:"Автор",cant_load_revision:"Не удалось загрузить историю страницы.",change_access:"Изменения в настройках доступа",change_authors:"Смена авторов",change_owner:function(t){return"Cмена владельца с "+t.content+" на "},change_to_redirect:"Установлено перенаправление",closed_page_access:"Доступ закрыт",create:"Страница создана",delete:"Страница удалена",delete_comment:"Удалён комментарий",delete_file:"Удалён файл",diff_not_found:"Версии не найдены",edit:"Страница изменена",edit_structure:"Изменена структура таблицы",edit_version:"Редактировать эту версию",keywords:"Изменены ключевые слова",limit_exceeded:"Достигнуто максимальное количество доступных событий",mark_actual:"Помечена как актуальная",mark_obsolete:"Поставлена метка «Данные устарели»",more_events:"Ещё события",move_cluster:"Страница перенесена",no_events:"Cобытий нет",old_page_version:"Это старая версия страницы, от ",old_table_version:"Это старая версия таблицы, от ",page_edit:"Правка",remove_comment:"Удалён комментарий",rename:"Страница переименована",request_access:"Запрос доступа",request_ownership:"Запрос «Стать владельцем»",request_page_author:"Запрос «Стать автором»",resolve_access:"Доступ предоставлен",return_this_version:"Вернуться к этой версии",revert_from_redirect:"Удалено перенаправление",subscribe_other_user:function(t){return"Подписан пользователь "+t.content},unwatch:"Отписка от страницы",watch:"Подписка на страницу"},{lang:"ru"}),i.decl("b-events-select",{all_events:"Все события",only_attaches:"Файлы",only_comments:"Комментарии",only_edits:"Правки",only_subscribes:"Подписки"},{lang:"ru"}),i.decl("b-favs",{editerd_by_me:"Отредактированные мной",favorite:"Избранное",i_am_author:"Мои страницы",i_am_observer:"Подписки"},{lang:"ru"}),i.decl("b-favs-folder",{cant_delete_folder:"Не удалось удалить папку.",cant_rename_folder:"Не удалось переименовать папку."},{lang:"ru"}),i.decl("b-favs-folders",{new_folder:"Новая папка"},{lang:"ru"}),i.decl("b-favs-links",{name_search:"Поиск по заголовку",search_in_folder:"Поиск в папке"},{lang:"ru"}),i.decl("b-favs-new-folder",{cant_create_folder:"Не удалось создать папку.",new_folder:"Новая папка"},{lang:"ru"}),i.decl("b-favs-options-button",{complete:"Завершить",settings:"Настройки"},{lang:"ru"}),i.decl("b-favs-widget",{settings:"Настройки"},{lang:"ru"}),i.decl("b-foot",{about_service:"О сервисе",confidential:"Конфиденциально",feedback:"Обратная связь",syntax:"Синтаксис Вики"},{lang:"ru"}),i.decl("b-foot-nda",{text:"Коммерческая тайна ООО «Яндекс», 119021, Россия, г. Москва, ул. Льва Толстого, д. 16"},{lang:"ru"}),i.decl("b-footer",{about_service:"О сервисе",confidential:"Конфиденциально",feedback:"Обратная связь",mobile:"Мобильная версия",syntax:"Синтаксис Вики"},{lang:"ru"}),i.decl("b-form-input",{search:"Поиск","search-label":"поиск",vid:"Видео"},{lang:"ru"}),i.decl("b-grid-table",{add_line:"Добавить строку",cant_load_table:"Не удалось загрузить таблицу.",edit:"Редактировать",finish:"Завершить",incorrect_format:"Неверный формат данных",options_list_empty:"Введите хотя бы одно значение списка.",page:"Страница",this_required:"Необходимо заполнить",try_more:"Попробовать ещё раз",undefined_column:"Ошибка: неизвестный тип колонки."},{lang:"ru"}),i.decl("b-grid-table-cell",{choose_date:"выберите дату",get_user_data_error:"Не удалось получить данные о пользователе.",select:"Выберите",to_choose:"Выбрать"},{lang:"ru"}),i.decl("b-grid-table-code-form",{can_sort:"Возможность сортировки\n",read_only:"Только для чтения",show_line_nums:"Показывать номера строк",width:"Ширина"},{lang:"ru"}),i.decl("b-grid-table-editors",{cant_load_editors:"Не удалось загрузить список редакторов."},{lang:"ru"}),i.decl("b-grid-table-head",{add:"Добавить",author:"Автор",change:"Изменить",checkbox:"Чекбокс",components:"Компоненты",date:"Дата",date_created:"Дата создания",employee:"Сотрудник",executor:"Исполнитель",fix_versions:"Исправить в версиях",list:"Список",mandatory:"Обязательный",mark_made:"Помечать сделанным",multiple_list:"Множественный список",number:"Число",original_estimation:"Первоначальная оценка",priority:"Приоритет",remove_column:"Удалить столбец",several_employees:"Несколько сотрудников",status:"Статус",story_points:"Story Points",text:"Текст",ticket_in_tracker:"Задача в Трекере",tickets:"Задачи",title:"Заголовок",type:"Тип",updated:"Дата обновления",width:"Ширина"},{lang:"ru"}),i.decl("b-grid-table-list-options",{duplicate:"Такое значение уже используется."},{lang:"ru"}),i.decl("b-grid-table-options",{copy:"Копировать",delete:"Удалить",export:"Скачать таблицу",import:"Импортировать данные",mark_as_actual:"Снять метку «Данные устарели»",mark_as_obsolete:"Поставить метку «Данные устарели»",move:"Перенести",parent_table:"Родительская таблица",referrers:"Ссылающиеся страницы",settings:"Настройки",tree:"Структура раздела"},{lang:"ru"}),i.decl("b-grid-table-settings",{save:"Сохранить",table_name:"Заголовок таблицы"},{lang:"ru"}),i.decl("b-grid-table-sorting-controll",{add_sort:"Добавить сортировку",remove_sort:"Удалить сортировку",sort:"Сортировать",then:"Затем"},{lang:"ru"}),i.decl("b-grid-table-sorting-list",{a_z:"А → Я",z_a:"Я → А"},{lang:"ru"}),i.decl("b-grid-table-width-controll",{auto:"Авто"},{lang:"ru"}),i.decl("b-head",{create:"Создать",favorite:"Закладки",guide:"Помощь",intranet_search:"поиск по интранету",me:"Моя страница",my_page:"Моя страница",notes:"Заметки",options:"Настройки",school:"Школа",search:"Поиск",wiki:"Вики","wiki-eva":"Вики.Ева",wiki_syntax:"Синтаксис Вики"},{lang:"ru"}),i.decl("b-page",{access_mistake:"Хотите запросить доступ?",access_request_sended:"Запрос отправлен авторам страницы.",access_request_sended_to_support:"Запрос отправлен администратору.",ask_access:"Заявка на предоставление доступа",ask_again:"Отправить запрос ещё раз",ask_mail:"Заявка будет отправлена авторам страницы, и они примут решение о выдаче доступа.",authors:"Авторы страницы:",cant_delete_page:"Не удалось сохранить страницу.",error:"Ошибка",error_body:"Тело ошибки",error_occurred:"Произошла ошибка ",get_owner_fail:"не удалось получить данные о владельце страницы","icon-favorite":"Избранное",if_error_appears_again:", если она повторяется.",if_you_mail:"Пожалуйста, напишите об ошибке администратору организации, если она повторяется.",new_page:"новую страницу",no_access:"Это закрытая страница.",owner:"Владелец страницы",page:"Страница",save:"Сохранить",send:"Отправить",settings:"Настройки",something_broken:"У нас что-то сломалось",title:"Заголовок страницы",unauthorized:"К сожалению, у вас нет доступа к сервису. Чтобы получить доступ, обратитесь к вашему руководителю или создайте запрос в форме обратной связи для вашего подразделения.",we_know_about_exception:"Скорее всего, мы уже нашли ошибку и исправляем её.",write_to:"Пожалуйста, напишите об ошибке на ",you_can_create:"По этому адресу в Вики совсем ничего нет. А значит, вы можете создать здесь "},{lang:"ru"}),i.decl("b-page-more-panel",{change_owner:"Сменить владельца",create_page:"Создать подстраницу",delete:"Удалить",export:"Экспортировать",mark_as_actual:"Снять метку «Данные устарели»",mark_as_obsolete:"Поставить метку «Данные устарели»",move:"Перенести",page_access:"Настроить доступ",referrers:"Ссылающиеся страницы",settings:"Настройки",subscriptions_control:"Подписать пользователей",tree:"Структура раздела"},{lang:"ru"}),i.decl("b-readonly",{cant_change:"Сохранение изменений временно недоступно.",in_readonly:"Вики находится в режиме «Только для чтения»."},{lang:"ru"}),i.decl("b-request-access",{access_denied:"В доступе отказано.",access_employee:"Дать доступ сотруднику",access_granted:"Доступ выдан.",access_group:"Дать доступ отделу или команде",access_was_processed:"Запрос доступа обработан.",access_will_take:"Доступ получит только ",another_group:"Другой отдел или команда",ask_access:" запрашивает доступ к этой странице.",cancel:"Отменить",close:"Закрыть",division:"Отделы",error:"Ошибка",give_access:"Как правило, лучше дать доступ группе: информация на этой странице может быть важна и для коллег @",groups_include:"Отделы или команды, в которые входит",no_group_selected:"Нужно выбрать хотя бы один отдел или команду.",no_id_for_request:"Невозможно выполнить операцию: нет ID запроса.",reason_is_required_field:"Пожалуйста, заполните поле «Причина отказа».",reject:"Отказать",request_irrelevant:"У пользователя уже есть доступ к этой странице.",request_processed:"Запрос уже обработан. ",save:"Сохранить",services:"Команды",use_this:function(t){return"Как правило, лучше дать доступ отделу или команде: информация на этой странице может быть важна и для коллег @"+t.login},why_you_dont_give_access:"Пожалуйста, напишите причину отказа.",wrong_status:"Невозможно выполнить операцию: статус запроса не распознан. ",you_want_reject_access:"Вы собираетесь отказать в доступе к странице."},{lang:"ru"}),i.decl("b-revision-diff",{cant_load_diff:"Не удалось загрузить сравнение версий."},{lang:"ru"}),i.decl("b-widget",{access_caption:"У кого есть доступ к этой странице",access_free:"У всех сотрудников",access_lock:"Только у авторов страницы",access_to_parent:"Как у родительской страницы",add:"Добавить",add_department_or_person:"Добавить отдел или пользователя",add_link:"Добавить еще одну ссылку",add_links_text:"Если вы знаете страницы с актуальной информацией по этой теме, пожалуйста, добавьте ссылки на эти страницы. ",add_person:"Добавить пользователя",add_users:"Добавить пользователей",and_on_cols_that_imports:"а также в столбцах, которые импортируются в ",approve_rejected_text1:"К сожалению, доступ к странице для подразделений/групп/сотрудников:",approve_rejected_text2:"невозможно выдать автоматически.",approve_rejected_text3:"Подробнее про это –",approve_rejected_text4:"Пожалуйста, подтвердите необходимость этого доступа.",attention:"Внимание!",author:"Автор",authors:"Авторы страницы",back:"Назад",cancel:"Отменить",cancel_new:"Отмена",cant_copy_cluster:"Не удалось скопировать раздел.",cant_create_grid:"Не удалось создать грид",cant_create_page:"Не удалось создать страницу",cant_delete_page:"Не получилось удалить страницу.",cant_move_cluster:"Не удалось переместить раздел",cant_set_ownership_request:"Не удалось отправить запрос.","change-to":"сменить на",change_authors:"Изменить авторов",close:"Закрыть",cluster:"Личный раздел",cluster_description_cluster:function(t){return"Страница будет создана в кластере  "+t.cluster},cluster_description_personal:function(t){return"Страница будет создана в кластере "+t.cluster},cluster_description_root:"Страница будет создана в корневом разделе ",cluster_description_sub:function(t){return"Страница будет создана в кластере  "+t.cluster},cluster_new_address:"Новый адрес страницы",cluster_subpages:function(t){return this.keyset("i-tanker__dynamic").key("plural_adv",{count:t.count,one:"подстраница",some:"подстраницы",many:"подстраниц",none:"подстраниц"})},col:"Столбец",cols_that_imports:"столбцах, которые импортируются в ",comment:"Комментарий",common:"Все сотрудники",confirm:"Подтвердить","confirmation-text":"Нажмите «Подтвердить», чтобы обновить данные.","copy-data":"Копировать данные",copy_table:"Таблица будет скопирована на указанный вами адрес.",copy_the_cluster:"Копировать",copy_the_table:"Копировать",create:"Создать",create_page:"Создание страницы",create_page_from_doc:"Создание страницы из документа",current_address_of_cluster:"Текущий адрес страницы",current_address_table:"Текущий адрес","delete-message":"Вы уверены, что хотите удалить эту страницу?",download:"Скачать",download_in_format:"Скачать в формате",export_and:"и",export_page:"Страницу",export_subpages:function(t){return this.keyset("i-tanker__dynamic").key("plural_adv",{count:t.count,one:"подстраницу",some:"подстраницы",many:"подстраниц",none:"подстраниц"})},fields_seperator:"Разделитель полей",file_upload_fail:"Не удалось загрузить файл.",get_authorship:"Стать автором",get_authorship_message_placeholder:"Укажите, почему вы должны стать автором страницы",get_ownership:"Стать владельцем",get_ownership_message_placeholder:"Укажите, почему вы должны стать владельцем этих страниц",get_ownership_message_placeholder_only_this:"Укажите, почему вы должны стать владельцем этой страницы",grid:"Таблица",grid_already_exist:"Такая таблица уже есть.",import:"Загрузить файл","import-data":"Загрузка данных",import_error:"Не удалось загрузить данные.",import_first_line:"Пропустить первую строку",import_holder:"Страница будет создана из загруженного документа.",incompatible_data_types:"Несовместимые типы данных в ",input_new_cluster_address:"Введите новое имя страницы",input_new_table_address:"Новое название",input_page_name:"Введите заголовок страницы",input_page_url:"Введите адрес страницы.",link_wiki_page:"Ссылка на страницу Вики","linked-pages":"Страницы, которые ссылаются на эту страницу",load:"Загрузить",load_another_file:"Загрузить другой файл",lock:"Закрытый",mark:"Сохранить",mark_page_as_actual:"Снять метку «Данные устарели»",mark_page_as_obsolete:"Поставить метку «Данные устарели»",move_page:"Страница будет перенесена на указанный адрес, по старому адресу будет создано перенаправление на новый.",move_table:"Таблица будет перенесена на указанный адрес, по старому адресу будет создано перенаправление на новый.",move_the_cluster:"Перенести",move_the_table:"Перенести",name:"Заголовок","no-subscribers":"На страницу ещё никто не подписан.",no_authors_error:"Укажите хотя бы одного автора.",note:"Заметка","note-placeholder":"Напишите заметку",note_text:"Текст заметки",only_supported_formats:"Поддерживается формат .docx или .txt",operation_for_redirect:"Эта операция недоступна для страниц-перенаправлений.",page:"Страница","page-remove":"Удаление страницы","page-settings":"Настройки страницы","page-watchers":"Пользователи, которые получат уведомление",page_address:"Адрес страницы",page_already_exist:"Такая страница уже существует.",page_in_current_cluster:"Страница будет создана в текущем разделе",page_in_home_cluster:"страница будет создана в вашем личном разделе",page_on_current_address:"страница будет создана по текущему адресу",page_title:"Название",readonly_page:"Только автор может редактировать страницу",redirected_from:"На эту страницу установлено перенаправление с",reject:"Отменить",reject_approve:"Да. Подтверждаю.",reject_cancel:"Нет. Отклоняю.",remove:"Удалить",remove_redirect:"Удалить перенаправление",rename_page:"Переименовать страницу",rename_table:"Переименовать таблицу",request_page_author_propose:"Вы уверены, что хотите добавить нового автора для этой страницы?",restricted:"У некоторых сотрудников",root:"Новый раздел",rows_separator:"Ограничитель строки",save:"Сохранить",save_authors_fail:"Ошибка: не удалось сохранить список авторов.","school-common":"Все",select_file:"Выберите файл формата CSV или TXT.",send:"Отправить",set_page_name_to_copy_cluster:"В какой раздел скопировать страницу?",set_page_name_to_copy_table:"На какой странице создать копию таблицы?",set_page_name_to_move_cluster:"В какой раздел перенести страницу?",set_page_name_to_move_table:"В какой раздел перенести таблицу?",show:"Показать",sign_on_page:"Подписать",sub:"Текущий раздел",subpages:"Структура раздела",subpages_hint:"Документы будут скачаны в архиве .zip",subpages_list:"Список подстраниц",subpages_title:"Будут переданы следующие подстраницы:",subscribe:"Подписать",subscribers:"Подписчики",success_subscribe:"Пользователи успешно подписаны. Они получат сообщение с вашим комментарием.",symbols:"символов",table_new_address:"Новый адрес таблицы",title_length_error:"Длина заголовка превышена на",unsubscribe:"Отписаться",unsubscribe_propose:"Вы уверены, что хотите отписаться от этой страницы и её подстраниц?",unsupported_format:"Этот формат файла не поддерживается.",update_preview_error:"Не удалось обновить превью.",validation_error:"Ошибка валидации"},{lang:"ru"}),i.decl("b-wiki-form",{cant_save_form:"Не удалось сохранить форму",choose_date:"выберите дату",data_successfully_send:"Данные успешно отправлены.",error_in_target:"Ошибка в поле target:",form_send_error:"При отправке формы произошла непредвиденная ошибка:",missing_field_in_target:"Поле target содержит ненайденное поле",send:"Отправить",unknown_error:"Неизвестная ошибка",unknown_page:"Вы пытаетесь отправить форму на страницу, которая не существует",validation_error_message:"Не все обязательные поля формы заполнены",yaml_error:"Ошибка в синтаксисе YAML:"},{lang:"ru"}),i.decl("b-wiki-serviceteam",{contacts:"Контакты сервиса",roles:"Команда сервиса",serviceteam:"Команда сервиса"},{lang:"ru"}),i.decl("b-wiki-tree",{cant_get_tree:"Не удалось получить структуру раздела.",cluster_tree:"Структура раздела",expand_all:"Показать все подстраницы",full_loaded:"Загружены все подстраницы",not_full_loaded:"Не все подстраницы загружены"},{lang:"ru"}),i.decl("b-wiki-tree-page",{cant_get_branch:"Не удалось загрузить структуру раздела.",created:"создано",modified:"отредактировано"},{lang:"ru"}),i.decl("copyright",{link:function(t){return"ООО «"+t.content+"»"},yandex:"ЯНДЕКС"},{lang:"ru"}),i.decl("editor-help",{"actions-list-link":"Список динамических действий","full-syntax-link":"Полный синтаксис Вики","highlighting-link":"Подсветка кода","hotkey-bold-title":"Жирный шрифт","hotkey-italic-title":"Курсив","hotkey-list-title":"Маркированный список","hotkey-save-title":"Сохранить правки","hotkey-stroke-title":"Перечёркнутый текст","hotkey-undo-title":"Отменить последнее действие","hotkeys-title":"Горячие клавиши",lang:"динамическое действие","manual-title":"Помощь","syntax-action-title":"действие","syntax-cat-title-bottom":"Текст под катом","syntax-cat-title-upper":"Кат","syntax-h2-title":"Заголовок 2","syntax-h3-title":"Заголовок 3","syntax-highlight-title":"код","syntax-login-description-title":"ссылка на профиль сотрудника","syntax-login-title":"логин или логин","syntax-queue-title":"ссылка на задачу","syntax-title":"Базовый синтаксис","syntax-url-title":"URL текст ссылки","tables-syntax-link":"Работа с таблицами"},{lang:"ru"}),i.decl("footer",{about:"О компании","about-url":"//company.yandex.ru",advert:"Реклама","advert-url":"//advertising.yandex.ru/kupislova.xml?advertising",apps:"Мобильные приложения","apps-url":"//mobile.yandex.ru",stat:"Статистика",termsofuse:"Лицензия на поиск","termsofuse-url":"//legal.yandex.ru/termsofuse/"},{lang:"ru"}),i.decl("i-services",{404:"404",adresa:"Адреса",advertising:"Реклама",afisha:"Афиша",all:"Все сервисы",api:"API",appmetrica:"AppMetrica",appsearch:"Приложения",audience:"Аудитории",auto:"Авто",autoru:"Авто.ру",avia:"Авиабилеты",aziada:"Азиада",ba:"Баян",backapv:"Партнер Я.Карт",balance:"Баланс",bar:"Бар","bar-ie":"Бар для ИЕ","bar-ie9":"Бар для ИЕ9",bayan:"Баннеры Яндекса",blogs:"Блоги",books:"Книги",browser:"Браузер",calendar:"Календарь",captcha:"ой...",catalogwdgt:"Каталог виджетов",chrome:"Хром с поиском Яндекса",city:"Города",cityday:"День города",clickhouse:"ClickHouse",collection:"Коллекция",company:"Компания",contest:"Contest",delivery:"Доставка",desktop:"Персональный поиск",direct:"Директ","direct.market":"Маркет",disk:"Диск",display:"Дисплей",ege:"ЕГЭ",ether:"Эфир",expert:"Эксперт",feedback:"Обратная связь",feedback2:"Обратная связь",ff:"ФФ с поиском Яндекса",fotki:"Фотки",fresh:"Свежее",games:"Игрушки",geocontext:"Геоконтекст",goroda:"Города",help:"Помощь",i:"Мои сервисы",ie:"ИЕ с поиском Яндекса",images:"Картинки","images-com":"Картинки",interests:"Интересы",internet:"Интернет",kassa:"Касса",keyboard:"Клавиатура",kraski:"Краски",kuda:"Куда все идут",large:"Яндекс для слабовидящих",legal:"Правовые документы",lenta:"Лента",libra:"Библиотека",literacy:"Неделя борьбы за грамотность",local:"Локальная сеть",lost:"Незабудки",love:"День взаимного тяготения — 13 августа",mail:"Почта",maps:"Карты","maps-wiki":"Народная карта",market:"Маркет","market.advertising":"Маркет",master:"Мастер",metrika:"Метрика",metro:"Метро",mirror:"Зеркало",mobile:"Мобильный",moikrug:"Мой Круг",money:"Деньги",museums:"Дни исторического и культурного наследия",music:"Музыка","music-partner":"Музыка: статистика",nahodki:"Мои находки",nano:"Нано",newhire:"Наниматор",news:"Новости",notifications:"Нотификационная панель",oauth:"Авторизация",online:"Онлайн",openid:"OpenID",opera:"Opera Software",opinion:"Цитаты",partners:"Рекламная сеть",partnersearch:"Поиск для партнеров",passport:"Паспорт",pdd:"Почта для домена",peoplesearch:"Люди",perevod:"Переводчик",plus:"Плюс",probki:"Пробки",pulse:"блоги: пульс",punto:"Punto switcher",pvo:"Ответы",rabota:"Работа",radar:"Радар",ramazan:"",rasp:"Расписания",realty:"Недвижимость",referats:"Рефераты",rk:"Есть вопросы?",root:"Яндекс.Олимпиада для Unix администраторов",school:"Школа",search:"Поиск",server:"Сервер",shtrafi:"Штрафы",site:"Поиск для сайта",slovari:"Словари",so:"Самооборона",social:"Социализм",soft:"Программы",sport:"Спорт",sprav:"Справочник",start:"Стартовая страница",stat:"Статистика",subs:"Подписки",taxi:"Такси",telephony:"Телефония",terms:"Разговорник",tests:"Тесты и опросы",tickets:"Билеты",time:"Яндекс.Время",toloka:"Яндекс.Толока",toster:"Тосты",translate:"Переводчик",tune:"Настройки",tv:"ТВ",ugc:"Отзывы",uslugi:"Услуги",video:"Видео","video-com":"Видео",vno:"ВНО",wdgt:"Виджеты",weather:"Погода",webmaster:"Вебмастер","webmaster-api":"API Вебмастера",widgets:"Виджеты",wordstat:"Статистика",wow:"Я.ру",www:"Поиск",xmlsearch:"XML",yaca:"Каталог",yamb:"Чаты",zakladki:"Закладки",admin:"Админка",dashboard:"Главная",staff:"Люди",tracker:"Трекер",wiki:"Вики"},{lang:"ru"}),i.decl("i-tanker__days",{acc1:"в понедельник",acc2:"во вторник",acc3:"в среду",acc4:"в четверг",acc5:"в пятницу",acc6:"в субботу",acc7:"в воскресенье",n1:"понедельник",n2:"вторник",n3:"среда",n4:"четверг",n5:"пятница",n6:"суббота",n7:"воскресенье",name:function(t){return function(t){return i.tanker.days[(t.short?"short":"n")+t.day]()}.call(this,t)},short1:"пн",short2:"вт",short3:"ср",short4:"чт",short5:"пт",short6:"сб",short7:"вс",today:"сегодня",tomorrow:"завтра",yesterday:"вчера"},{lang:"ru"}),i.decl("i-tanker__dynamic",{gender:function(t){return function(t){return t[t.gender]}.call(this,t)},plural:function(t){return function(t){var e=isNaN(parseInt(t.count))?0:t.count,i=e%10,n=e%100;return 1==i&&11!=n?t.one:i>1&&i<5&&(n<10||n>20)?t.some:t.many}.call(this,t)},plural_adv:function(t){return function(t){return 0===(isNaN(parseInt(t.count))?0:t.count)?t.none:this.keyset("i-tanker__dynamic").key("plural",{count:t.count,one:t.one,some:t.some,many:t.many})}.call(this,t)},toggle:function(t){return function(t){return Boolean(t.condition)?t.true:t.false}.call(this,t)}},{lang:"ru"}),i.decl("i-tanker__months",{g1:"Января",g10:"Октября",g11:"Ноября",g12:"Декабря",g2:"Февраля",g3:"Марта",g4:"Апреля",g5:"Мая",g6:"Июня",g7:"Июля",g8:"Августа",g9:"Сентября",n1:"Январь",n10:"Октябрь",n11:"Ноябрь",n12:"Декабрь",n2:"Февраль",n3:"Март",n4:"Апрель",n5:"Май",n6:"Июнь",n7:"Июль",n8:"Август",n9:"Сентябрь",name:function(t){return function(t){var e=i.tanker.months[(t.case||"n")+t.month]();return Boolean(t.lowercase)?e.toLowerCase():e}.call(this,t)},short1:"янв",short10:"окт",short11:"ноя",short12:"дек",short2:"фев",short3:"мар",short4:"апр",short5:"май",short6:"июн",short7:"июл",short8:"авг",short9:"сен"},{lang:"ru"}),i.decl("link",{cant_load_subpages:"Не удалось загрузить подстраницы."},{lang:"ru"}),i.decl("logo_type_link",{yandex:"Яндекс"},{lang:"ru"}),i.decl("m-datepicker",{clear:"очистить"},{lang:"ru"}),i.decl("m-datepicker__short-days",{1:"пн",2:"вт",3:"ср",4:"чт",5:"пт",6:"сб",7:"вс"},{lang:"ru"}),i.decl("m-editor",{clear:"очистить",unsaved_changes:"На странице есть несохранённые изменения. Хотите применить их?"},{lang:"ru"}),i.decl("m-editor-button",{header2:"Заголовок 2",header3:"Заголовок 3",bold:"Жирный",italic:"Курсив",underline:"Подчеркнутый",strike:"Перечеркнутый",ulist:"Маркированный список",olist:"Нумерованный список",indent:"Отступ слева",outdent:"Отступ справа",quote:"Цитата",separator:"Разделитель",link:"Создать ссылку",picture:"Создать картинку",code:"Вставить код",table:"Таблица",color:"Цветной текст",math:"Формула",spell:"Проверка орфографии",other:"Другие функции",readmore:"Врезка",drafts:"Черновики",help:"Помощь",user:"Пользователь",file:"Файл",form:"Форма",video:"Видео"},{lang:"ru"}),i.decl("m-editor-popup",{createLink:"Создание ссылки",pathToLink:"Ссылка",linkText:"Текст",createPicture:"Создание картинки",pictureSize:"Размеры",picturePixels:"в пикселях",pictureWidth:"Ширина",pictureHeight:"Высота",pictureLink:"Ссылка",pictureLinkPlaceholder:"Ссылка на картинку",loadFile:"Загрузить файл",createCode:"Код с подсветкой синтаксиса",createUser:"Пользователь",user:"пользователь",textForLink:"текст для ссылки",codeStyle:"Синтаксис",codeText:"Вставьте свой код сюда",drafts:"Черновики",uploadError:"Ошибка при загрузке",createVideo:"Вставка видео",videoLink:"URL/Код",videoLinkPlaceholder:"Вставьте URL/Код видео",videoLinkError:"Такой код не поддерживается!",videoParserError:"Ошибка парсинга исходного кода!",srcLinkError:"Такой код не поддерживается и вставлен как ссылка",notSupportVideo:"Ваш браузер не поддерживает это видео",notSupportAudio:"Ваш браузер не поддерживает тег audio",downloadVideo:"Скачайте видео",downloadAudio:"Скачайте аудио"},{lang:"ru"}),i.decl("m-head-arrow",{error:"Не удалось получить список сервисов."},{lang:"ru"}),i.decl("m-head-search",{hint:"поиск по интранету",find:"Найти"},{lang:"ru"}),i.decl("m-head-user",{staff:"Я на Стаффе",options:"Настройки",logout:"Выход"},{lang:"ru"}),i.decl("m-popup",{add:"Добавить",cancel:"Отмена",revert:"Вернуть",apply:"Применить"},{lang:"ru"}),i.decl("m-speller",{notfound:"Нет в словаре","correction-title":"Исправление","checking-language":"Язык проверки",options:"Варианты:","ignore-once":"Пропустить","ignore-all":"Пропустить все",add:"Добавить",replace:"Заменить",replaceAll:"Заменить все",dictLang:"Язык словаря:",cancel:"Отмена",select:"Выбрать:",en:"Английский",ru:"Русский",uk:"Украинский","ignore-uppercase":"Пропускать слова из ПРОПИСНЫХ букв","ignore-digits":"Пропускать слова с цифрами","ignore-urls":"Пропускать URL'ы  и имена файлов","find-repeat":"Подсвечивать повторяющиеся слова",userDict:"Словарь пользователя..",params:"Язык и настройки",hideparams:"Скрыть настройки",close:"Закрыть",complete:"Проверка правописания завершена","not-checked":"Проверка правописания не осуществлялась",recommended:"рекомендуется",correction:"исправлений",correction1:"исправление",correction2:"исправления","corr-not-found":"рекомендуемых исправлений не найдено","add-to-dict":"добавить в словарь","options-not-found":"варианты не найдены"},{lang:"ru"}),i.decl("m-suggest-item",{staff:"Сотрудник",maillist:"Рассылка",nav:"Ссылки",department:"Отдел",table:"Стол",equipment:"Оборудование",floor:"этаж",group:"Группа","b2b-people":"Сотрудники","b2b-groups":"Команды","b2b-departments":"Отделы","search-in-cluster":"Искать только в этом разделе"},{lang:"ru"}),i.decl("m-uploader",{cant_save_page:"Не удалось сохранить страницу.",choose_file:"Выбрать файл"},{lang:"ru"}),i.decl("mi-date",{h:function(t){return this.keyset("i-tanker__dynamic").key("plural_adv",{count:t.count,one:"час",some:"часа",many:"часов",none:"часов"})},"just-now":"только что",min:function(t){return this.keyset("i-tanker__dynamic").key("plural_adv",{count:t.count,one:"минута",some:"минуты",many:"минут",none:"минут"})},"today-at":"сегодня в","yesterday-at":"вчера в"},{lang:"ru"}),i.decl("mi-error",{ALREADY_EXISTS:"Вы пытаетесь создать то, что уже существует.",ALREADY_HAS_ACCESS:"Доступ уже предоставлен.",ALREADY_REQUESTED_ACCESS:"Запрос на доступ уже отправлен.",CLIENT_SENT_INVALID_DATA:"Не удалось разобрать запрос, проверьте, правильно ли заполнены поля формы.",CONTENT_TYPE_IS_NOT_SUPPORTED:"Переданный Content-Type не поддерживается.",FORM_ERROR:"Не удалось разобрать запрос, проверьте, правильно ли заполнены поля формы.",HTTP_TIMEOUT:"Запрос завершился по таймауту.",HTTP_TOO_MANY_REDIRECTS:"Циклическое перенаправление.",HTTP_UNKNOWN_ERROR:"Неизвестная ошибка. Если повторяется, пожалуйста, напишите администратору.",INVALID_FORM:"Проверьте, правильно ли заполнены поля формы.",NOT_FOUND:"Запрос отправлен на несуществующую ручку.",PARSE_ERROR:"Не удалось разобрать запрос.",REQUEST_DATA_ERROR:"Не удалось разобрать запрос, проверьте, правильно ли заполнены поля формы.",TEMPORARILY_UNAVAILABLE:"Сейчас Вики доступна только для чтения.",UNKNOWN_ERROR:"Неизвестная ошибка.",USER_HAS_NO_ACCESS:"Нет доступа.",WRONG_COLUMN_ID:"Неправильные ID колонок в параметре columns."},{lang:"ru"}),i.decl("multiple-suggest",{group:"Группы",staff:"Пользователи"},{lang:"ru"}),i.decl("page-editor",{more:"Подробнее",new_wf:"Новый форматер",page_edit:"Правка",page_save:"Сохранить",page_update_reject:"Отменить",page_update_warning:"Вы редактируете текст старой версии страницы. Если вы сохраните изменения, эта версия страницы станет актуальной.",page_view:"Просмотр",page_watcher_notify:"Сообщить подписчикам прямо сейчас.",split_mode:"Сплит-режим",wf_tooltip:function(t){return"Вы можете отформатировать эту страницу новым форматтером. В нём поддерживается "+t.markdown+" «из коробки», а ещё он гораздо быстрее старого! \n\nСтраница, сохранённая с этим признаком, будет по умолчанию преобразовываться новым форматтером. "+t.more}},{lang:"ru"}),i.decl("search2",{"search-button-text":"Найти","search-input-label":"Запрос","search-service-label":"Поиск по сервису","search-web-label":"Поиск в интернете"},{lang:"ru"}),i.decl("sidebar",{"cluster-tree-label":"Подстраницы","events-label":"События","files-label":"Файлы","grid-code-label":"Код для вставки таблицы","grid-settings-label":"Настройки","hotkeys-label":"Горячие клавиши","toc-label":"Оглавление"},{lang:"ru"}),i.decl("ticker__text",{notifications:"Уведомлений"},{lang:"ru"}),i.decl("tooltip__close",{close:"Закрыть"},{lang:"ru"}),i.decl("tumbler",{off:"Откл",on:"Вкл"},{lang:"ru"}),i.decl("user2",{"add-account":"Добавить аккаунт","add-organization":"Создать организацию","add-organization2":"Добавить организацию","edit-accounts":"Редактировать список",enter:"Войти",exit:"Выйти",help:"Помощь",mail:function(t){return this.keyset("i-tanker__dynamic").key("plural_adv",{count:t.count,one:"новое письмо",some:"новых письма",many:"новых писем",none:"Нет новых писем"})},mail_compose:"Написать письмо",organization:"Организация",passport:"Управление аккаунтом",settings:"Настройки",upload_files:"Мой диск",ya_plus:"Получить Плюс",ya_plus_on:"активен"},{lang:"ru"}),i.decl("w-access-button",{access:"Доступ:",access_free:"Все сотрудники",access_lock:"Только для меня",access_to_parent:"Доступ как к родительской странице ",b2b_groups:"Команды",button_type_common:"Доступно всем сотрудникам",button_type_owner:"Доступ закрыт",button_type_restricted:"Доступ ограничен","button_type_restricted-with-external":"Доступно не только Яндексу",cant_get_data:"Ошибка при получении данных",cant_get_list:"Не удалось загрузить список.",cant_save_changes:"Не удалось сохранить изменения.",common:"Все сотрудники",delete:"удалить",departments:"Отделы",division:"Подразделение",external_access:"Не только Яндекс",external_group:"Внешнее подразделение",external_user:"Внешний пользователь",groups:"Группы",lock:"Закрытый",owner:"владелец",restricted:"Ограниченный",services:"Сервисы","wiki-groups":"Вики-группы"},{lang:"ru"}),i.decl("w-action",{cant_get_authors:"Не удалось загрузить список авторов.",cant_get_settings:"Не удалось получить данные настроек.",cant_get_tree:"Не удалось загрузить структуру раздела.",cant_load_data:"Не удалось получить данные.",cant_load_subpages:"Не удалось загрузить подстраницы.",cant_load_subscribers:"Не удалось загрузить список подписчиков.",link_wiki_page:"Ссылка на страницу Вики",mark_as_actual:"Снять метку «Данные устарели»",mark_as_obsolete:"Поставить метку «Данные устарели»",mark_failed:"Не удалось пометить страницу."},{lang:"ru"}),i.decl("w-attach",{copy_clipboard_message:"Чтобы вставить файл на страницу, скопируйте и добавьте на страницу этот код",copy_link:"Скопировать ссылку на файл.",download_link:"Скачать файл",file_link_copied:"Ссылка на файл скопирована.",hide_options_hint:"Скрыть список действий",megabytes:"МБ",remove_attach_error:"При удалении файла возникли ошибки.",remove_link:"Удалить файл",show_options_hint:"Показать список действий"},{lang:"ru"}),i.decl("w-attachments",{body_to_large:"Размер загружаемого файла превышает 1 ГБ.","drop-panel-message":"или перетащите на эту панель","filed-to-load":"Не удалось загрузить файл.","filed-to-load-files":"Не удалось получить список файлов с сервера.",more:"Ещё","upload-btn-text":"Выберите файл","upload-cancel":"Отменить загрузку","upload-repeat":"Повторить попытку"},{lang:"ru"}),i.decl("w-authors",{cant_load_authors:"Не удалось загрузить информацию об авторах страницы.",hide:"Скрыть",more:function(t){return this.keyset("i-tanker__dynamic").key("plural_adv",{count:t.count,one:"Ещё "+t.count+" автор",some:"Ещё "+t.count+" автора",many:"Ещё "+t.count+" авторов",none:""})}},{lang:"ru"}),i.decl("w-comment",{cancel:"Отменить",comment_removed:"Комментарий удален.",edit:"Редактировать",remove:"Удалить","remove-confirm":"Вы действительно хотите удалить комментарий?",reply:"Ответить",save:"Сохранить",send:"Отправить"},{lang:"ru"}),i.decl("w-comments",{add:"Отправить",add_comment:"Комментировать",add_comment_error:"Не удалось добавить комментарий",cancel:"Отменить",comment:function(t){return this.keyset("i-tanker__dynamic").key("plural_adv",{count:t.count,one:"комментарий",some:"комментария",many:"комментариев",none:""})},comments:"Комментарии",expand:"Показать",first_form:"комментарий",get_comments_list_error:"Не удалось загрузить комментарии к этой странице.",no_comments:"Пока без комментариев",null_form:"комментариев",second_form:"комментария",show_more:"Показать еще",turn:"Скрыть"},{lang:"ru"}),i.decl("w-fav-button",{in_fav:"В избранном",to_fav:"В избранное"},{lang:"ru"}),i.decl("w-getting-started",{"access-1":"Если выбрать этот вид доступа, страницу смогут увидеть все сотрудники.","access-2":"Просматривать и редактировать страницу смогут только авторы.","access-3":"Вы можете открыть доступ к странице только определенным сотрудникам, командам и подразделениям.","access-button-1":"Вы можете открыть доступ к этой странице только определенным сотрудникам.","comments-1":"Вы можете оставить комментарий к любой странице.",complete:"Ок",continue:"Далее","create-1":"Выберите тип страницы.","create-2":"Укажите название страницы.","create-3":"Здесь отобразится относительный адрес вашей будущей страницы.","create-4":"Нажмите «Создать», чтобы начать работу с новой страницей.","edit-attaching-1":"Вы можете добавить ссылку. Например, ссылку на другую страницу Вики.","edit-attaching-2":"Вы также можете перетащить сюда файл, чтобы добавить картинку к странице.","edit-attaching-3":"Когда вы отредактируете страницу, сохраните результат и посмотрите, что получилось.","edit-basics-1":"Создайте заголовок второго уровня с помощью этой кнопки.","edit-basics-2":"Нажмите сюда, чтобы изменить название страницы.","edit-basics-3":"Сохраните страницу и посмотрите, что получилось.","edit-basics-4":"Вы также можете просто посмотреть, как будет выглядеть страница после сохранения.","edit-button-1":"Нажмите сюда, чтобы отредактировать страницу.","edit-formatting-1":"Сюда вы можете добавить любой текст или картинку.","edit-formatting-2":"Выделите текст курсивом.","edit-formatting-3":"А теперь оформите текст в виде списка.","edit-grid-1":"Чтобы отредактировать таблицу, нажмите сюда или дважды нажмите на любую ячейку таблицы. ","edit-grid-add-col-1":"Введите название столбца.","edit-grid-add-col-2":"Выберите тип столбца.","edit-grid-add-col-3":"Чтобы добавить новый столбец, нажмите сюда.","edit-grid-add-row-1":"Добавьте ещё одну строку.","edit-grid-sidebar-1":"Чтобы отобразить эту таблицу на нужной странице Вики, вставьте на страницу этот код.","favorites-1":"Добавьте страницу в Избранное.","favorites-2":"Здесь вы сможете просмотреть список всех страниц, добавленных в Избранное.","move-1":"Введите новый адрес страницы.","move-2":"Выберите, чтобы перенести страницу со всеми подстраницами.","move-3":"Выберите, если вы хотите изменить название страницы в адресе.","page-menu-1":"Здесь перечислены дополнительные настройки страницы.","page-menu-2":"Нажмите, если вам нужно создать подстраницу к этой странице.","promo-1-caption":"Привет!","promo-1-str":"Работать над большой задачей гораздо удобнее, если у команды есть общая база знаний. ","promo-2-caption":"Используйте Вики как справочник","promo-2-str":"Здесь можно хранить ответы на частые вопросы, формы заявлений и другую общую информацию.","promo-3-caption":"Храните личные записи","promo-3-str":"Ваши страницы хранятся в личном разделе и никогда не потеряются.","promo-4-caption":"Работайте с продвинутыми инструментами","promo-4-str":"Вики поддерживает форматирование кода и хранит историю изменения страниц.","settings-1":"Задайте ключевые слова, чтобы страницу было проще найти.","settings-2":"Вы можете передать права на страницу другому пользователю.","settings-3":"Здесь можно настроить перенаправление с этой страницы на другую.","sidebar-revisions-1":"Здесь хранится история изменений страницы.","sidebar-revisions-2":"Выберите версию, чтобы просмотреть её.","subscribe-1":"Введите имена сотрудников, которым будут приходить уведомления об изменениях на странице.","subscribe-2":"Добавьте сообщение, которое они получат с уведомлением о подписке.","subscribe-3":"Вы также можете посмотреть, кто подписан на эту страницу.","subscribe-button-1":"Подпишитесь на страницу, чтобы получать уведомления обо всех изменениях.","user-cluster-1":"У вас есть личный раздел на Вики. Нажмите сюда, чтобы перейти в него."},{lang:"ru"}),i.decl("w-grid-preview",{data_type:"Тип данных",false:"false",importing:"Загрузка",in_column:"В столбец",new:"Новый",strings_example:"Примеры строк",true:"true"},{lang:"ru"}),i.decl("w-notifier",{go:"Перейти"},{lang:"ru"}),i.decl("w-old-page-mark",{actual_pages:"Актуальная информация",last_update:"Последнее обновление",marked_obsolete:"поставлена метка «Данные устарели»",old_page:"Данные устарели",unmark:"Снять метку"},{lang:"ru"}),i.decl("w-page-info",{actual:"Страница актуальна",diff_wf_versions:"Обнаружено расхождение в версиях форматера",dismissed_author_message:"Автором страницы является бывший сотрудник",dismissed_authors_get_authorship:"Стать автором",dismissed_authors_message:"Авторами страницы являются бывшие сотрудники",dismissed_owner_get_ownership:"Стать владельцем",dismissed_owner_message:"Владельцем страницы является бывший сотрудник",not_actual:"Данные устарели",possible_obsolete_notification:"Страницу давно не редактировали. Возможно, данные стоит обновить.","redirect-message":"Это страница-перенаправление, её нельзя редактировать.",redirected:"Вы были перенаправлены на эту страницу со страницы",remove_redirect:"Удалить перенаправление"},{lang:"ru"}),i.decl("w-page-main-info",{official_page:"Официальная страница",updated:"Обновлено"},{lang:"ru"}),i.decl("w-page-official",{official_page:"Официальная страница",page_owners:"Владелец страницы",responsible:"Ответственный",responsible_group:"Ответственная группа",responsible_groups:"Ответственные группы",responsibles:"Ответственные"},{lang:"ru"}),i.decl("w-page-panel",{actions:"Действия",edit:"Редактировать",readonly:"Только для чтения"},{lang:"ru"}),i.decl("w-page-setting",{add:"Добавить",authors:"Авторы страницы",cant_set_author:"Не удалось сохранить данные об авторах",cant_set_comments:"Не удалось сохранить настройки комментариев",cant_set_keywords:"Не удалось сохранить ключевые слова.",cant_set_owner:"Не удалось сохранить данные о владельце.",change_author_in_cluster:"Сменить авторов во всем разделе","clusters-search":"Поиск по разделам",comments:"Комментарии","get-authorship":"Стать автором","hide-authors":"Скрыть",is_off:"Выключены",is_on:"Включены",keywords:"Ключевые слова","more-authors":function(t){return this.keyset("i-tanker__dynamic").key("plural_adv",{count:t.count,one:"Ещё "+t.count+" автор",some:"Ещё "+t.count+" автора",many:"Ещё "+t.count+" авторов",none:""})},"no-keywords":"не установлены","no-redirect":"не установлен",no_authors_error:"Укажите одного или нескольких авторов.",off:"выключены",on:"включены",owner:"Владелец страницы",redirect:"Перенаправление",save:"Сохранить","setup-authors":"Настроить данные об авторах страницы","setup-comments":"Настроить комментарии","setup-keywords":"Настроить ключевые слова","setup-owner":"Настроить данные о владельце страницы","setup-redirect":"Настроить перенаправление","staff-search":"Поиск по сотрудникам",tags_list:"Список тегов через запятую",to_off:"Выключены",to_on:"Включены"},{lang:"ru"}),i.decl("w-raw",{large_page:"Страница не выдерживает такой большой объём данных. Попробуйте сократить или перенести часть информации, чтобы страница отображалась правильно."},{lang:"ru"}),i.decl("w-subscribe-button",{button_type_cluster:"Подписан на раздел",button_type_none:"Подписаться",button_type_page:"Подписан на страницу",item_cluster:"Подписаться на весь раздел",item_none:"Отписаться",item_page:"Подписаться на страницу"},{lang:"ru"}),i.decl("w-user-settings",{content_translation:"Перевод контента",hide:"Скрывать",highlight_theme:"Тема для подсветки кода",new_wf:"Новый Вики-форматтер",save:"Сохранить",save_error:"Не удалось сохранить настройки пользователя.",settings:"Настройки",show:"Показывать",ui_lang:"Язык интерфейса",use_full_width_content:"Ограничить ширину статьи"},{lang:"ru"}),i.decl("wf-head",{edit:"правка"},{lang:"ru"}),i.decl("wf-ref",{download:"Скачать",view:"Просмотреть"},{lang:"ru"}),i.decl("wf-switcher",{old_wf:"Старый форматер",with_new_wf:"С новым форматером",with_old_wf:"Со старым форматером"},{lang:"ru"}),i.decl("wi-files-dropper",{drop_here:"Переместите файлы сюда"},{lang:"ru"}),i.decl("wi-notification",{"no-internet":"Нет подключения к сети."},{lang:"ru"}),i.decl("wiki-widget-action",{error:"Ошибка при получении экшена"},{lang:"ru"}),i.lang("ru"),i}();"object"==typeof exports&&(module.exports=e),"object"==typeof modules&&modules.define("i18n",function(t){t(e)}),(t.BEM||(t.BEM={})).I18N=e}("undefined"!=typeof window?window:global),function(t){function e(t){var e={},i=new(function(t,e){var i;i="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t};var n={},s=/[&<>]/;n.xmlEscape=function(t){var e,i=""+t,n=s.exec(i);if(!n)return i;var o="",r=0,a=0;for(r=n.index;r<i.length;r++){switch(i.charCodeAt(r)){case 38:e="&amp;";break;case 60:e="&lt;";break;case 62:e="&gt;";break;default:continue}a!==r&&(o+=i.substring(a,r)),a=r+1,o+=e}return a!==r?o+i.substring(a,r):o};var o=/["&]/;n.attrEscape=function(t){var e,i=""+t,n=o.exec(i);if(!n)return i;var s="",r=0,a=0;for(r=n.index;r<i.length;r++){switch(i.charCodeAt(r)){case 34:e="&quot;";break;case 38:e="&amp;";break;default:continue}a!==r&&(s+=i.substring(a,r)),a=r+1,s+=e}return a!==r?s+i.substring(a,r):s};var r=/['&]/;n.jsAttrEscape=function(t){var e,i=""+t,n=r.exec(i);if(!n)return i;var s="",o=0,a=0;for(o=n.index;o<i.length;o++){switch(i.charCodeAt(o)){case 38:e="&amp;";break;case 39:e="&#39;";break;default:continue}a!==o&&(s+=i.substring(a,o)),a=o+1,s+=e}return a!==o?s+i.substring(a,o):s},n.extend=function(t,e){if(!t||!e)return t||e;var i,n={};for(i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n};var a={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,wbr:1};n.isShortTag=function(t){return a.hasOwnProperty(t)},n.isSimple=function t(e){return!e||!0===e||(!(e.block||e.elem||e.tag||e.cls||e.attrs||!e.hasOwnProperty("html")||!t(e.html))||("string"==typeof e||"number"==typeof e))};var c=0,l=+new Date,d="__"+l,h="uniq"+l;function u(){return h+ ++c}n.getUniq=u,n.identify=function(t,e){if(!t)return u();if(e||t[d])return t[d];var i=u();return t[d]=i,i};var m=/^[:\w.-]+$/;function p(t){this.modDelim=t.mod||"_",this.elemDelim=t.elem||"__"}function f(t){this._bemxjst=t,this.ctx=null,this.block="",this._currBlock="",this.elem=null,this.mods={},this.elemMods={},this.position=0,this._listLength=0,this._notNewList=!1,this.escapeContent=!0===t.options.escapeContent}function _(t,e){this.template=t,this.keys=e.key,this.value=e.value}function g(t,e){this.template=t,this.body=e.body}function b(t){this.template=t,this.wrap=null}function v(t){this.template=t,this.wrap=null}function y(t,e){this.template=t,this.key=e.key,this.value=e.value}function k(t,e){this.predicates=t,this.body=e}function w(){}function M(t,e){this.conditions=[],this.children=[];for(var i=e.length-1;i>=0;i--){var n=e[i];n instanceof w?this.conditions.push(n):n===t.boundBody?this.children[i]=t.queue.pop():this.children[i]=n}}function x(t){w.call(this),this.refs=t}function E(t){w.call(this),this.refs=t}function B(t){w.call(this),this.refs=t}function I(t,e){w.call(this),this.mode=t,this.refs=e}function S(t){w.call(this),this.options=t}function C(t,e){w.call(this),this.key=t,this.value=e}function T(t){w.call(this),this.body=t}function N(t,e){this.entity=t,this.modeName=e,this.bemxjst=this.entity.bemxjst,this.templates=[],this.mask=[0],this.maskSize=0,this.maskOffset=0,this.count=0,this.depth=-1,this.thrownError=null}function D(t){this.options=t,this.refs=this.options.refs,this.boundBody=this.body.bind(this);for(var e=this.methods("body"),i=0;i<e.length;i++){var n=e[i];this.boundBody[D.methods[i]]=n}this.queue=[],this.templates=[],this.initializers=[]}function O(t,e,i){var n=t[i],s=t.boundBody;return"body"!==e?"replace"===i||"extend"===i||"wrap"===i?function(){return n.apply(t,arguments)}:function(){return n.apply(t,arguments),s}:function(){var e=n.apply(t,arguments),o=t.queue.pop(),r=t.queue[t.queue.length-1];return r.conditions=r.conditions.concat(o.conditions),r.children=r.children.concat(o.children),"replace"===i||"extend"===i||"wrap"===i?e:s}}function P(t,e,i,n){this.bemxjst=t,this.block=null,this.elem=null,this.options={},this.canFlush=!0,this.def=new N(this),this.content=new N(this,"content"),this.rest={},this.init(e,i),this.initModes(n)}function A(){return this.ctx.content}function L(t,e){this.name="BEMXJSTError",this.message=t,Error.captureStackTrace?Error.captureStackTrace(this,e||this.constructor):this.stack=(new Error).stack}function j(t){this.options=t||{},this.entities=null,this.defaultEnt=null,this.tree=null,this.match=null,this.contextConstructor=function(t){f.call(this,t)},i(this.contextConstructor,f),this.context=null,this.classBuilder=new p(this.options.naming||{}),this.depth=0,this.canFlush=!1,this.oninit=null,this.defaultEnt=new this.Entity(this,"","",[]),this.defaultElemEnt=new this.Entity(this,"","",[])}function R(t){this.bemxjst=t,this.jsClass=null,this.tag=new N(this,"tag"),this.attrs=new N(this,"attrs"),P.apply(this,arguments)}function z(t){j.apply(this,arguments),this._shortTagCloser=void 0!==t.xhtml&&t.xhtml?"/>":">",this._elemJsInstances=t.elemJsInstances,this._omitOptionalEndTags=t.omitOptionalEndTags,this._unquotedAttrs=void 0!==t.unquotedAttrs&&t.unquotedAttrs}n.isUnquotedAttr=function(t){return t&&m.exec(t)},p.prototype.build=function(t,e){return e?t+this.elemDelim+e:t},p.prototype.buildModPostfix=function(t,e){var i=this.modDelim+t;return!0!==e&&(i+=this.modDelim+e),i},p.prototype.buildBlockClass=function(t,e,i){var n=t;return i&&(n+=this.buildModPostfix(e,i)),n},p.prototype.buildElemClass=function(t,e,i,n){return this.buildBlockClass(t)+this.elemDelim+e+this.buildModPostfix(i,n)},p.prototype.split=function(t){return t.split(this.elemDelim,2)},f.prototype._flush=null,f.prototype.isSimple=n.isSimple,f.prototype.isShortTag=n.isShortTag,f.prototype.extend=n.extend,f.prototype.identify=n.identify,f.prototype.xmlEscape=n.xmlEscape,f.prototype.attrEscape=n.attrEscape,f.prototype.jsAttrEscape=n.jsAttrEscape,f.prototype.isFirst=function(){return 1===this.position},f.prototype.isLast=function(){return this.position===this._listLength},f.prototype.generateId=function(){return n.identify(this.ctx)},f.prototype.reapply=function(t){return this._bemxjst.run(t)},_.prototype.exec=function(t){for(var e=t,i=0;i<this.keys.length-1;i++)if(!(e=e[this.keys[i]]))return!1;return e=e[this.keys[i]],!0===this.value?void 0!==e&&""!==e&&!1!==e&&null!==e:String(e)===this.value},g.prototype.exec=function(t){return this.body.call(t,t,t.ctx)},b.prototype.exec=function(t){var e=this.wrap!==t.ctx;return this.wrap=t.ctx,e},v.prototype.exec=function(t){var e=this.ext!==t.ctx;return this.ext=t.ctx,e},y.prototype.exec=function(t){return t[this.key]===this.value},k.prototype.wrap=function(){for(var t=this.body,e=0;e<this.predicates.length;e++){t=this.predicates[e].wrapBody(t)}this.body=t},k.prototype.clone=function(){return new k(this.predicates.slice(),this.body)},w.prototype.wrapBody=function(t){return t},i(x,w),x.prototype.wrapBody=function(t){var e=this.refs.applyCtx;return"function"!=typeof t?function(){return e(t)}:function(){return e(t.call(this,this,this.ctx))}},i(E,w),E.prototype.wrapBody=function(t){var e=this.refs.applyCtx;return"function"!=typeof t?function(){return e(t)}:function(){return e(t.call(this,this,this.ctx))}},i(B,w),B.prototype.wrapBody=function(t){var e=this.refs.applyCtx,i=this.refs.local;return"function"!=typeof t?function(){for(var n={},s=Object.keys(t),o=0;o<s.length;o++)n[s[o]]=t[s[o]];return i(n)(function(){return e(this.ctx)})}:function(){for(var n={},s=t.call(this,this,this.ctx),o=Object.keys(s),r=0;r<o.length;r++)n[o[r]]=s[o[r]];return i(n)(function(){return e(this.ctx)})}},i(I,w),I.prototype.wrapBody=function(t){return this[this.mode+"WrapBody"](t)},I.prototype.appendContentWrapBody=function(t){var e=this.refs,i=e.applyCtx,n=e.apply;return"function"!=typeof t?function(){return[n("content"),t]}:function(){return[n("content"),i(t.call(this,this,this.ctx))]}},I.prototype.prependContentWrapBody=function(t){var e=this.refs,i=e.applyCtx,n=e.apply;return"function"!=typeof t?function(){return[t,n("content")]}:function(){return[i(t.call(this,this,this.ctx)),n("content")]}},i(S,w),i(C,w),i(T,w),N.prototype.prepend=function(t){for(this.templates=t.templates.concat(this.templates),this.count+=t.count;Math.ceil(this.count/31)>this.mask.length;)this.mask.push(0);this.maskSize=this.mask.length},N.prototype.push=function(t){this.templates.push(new function(t,e){this.mode=t,this.predicates=new Array(e.predicates.length),this.body=e.body;for(var i=[],n=0,s=0;n<this.predicates.length;n++,s++){var o=e.predicates[n];o instanceof C?this.predicates[s]=new _(this,o):o instanceof B?(s--,i.push(new v(this))):o instanceof I?this.predicates[n]=new y(this,o):o instanceof T?this.predicates[s]=new g(this,o):o instanceof x?(s--,i.push(new b(this))):s--}for(n=0;n<i.length;n++,s++)this.predicates[s]=i[n];this.predicates.length!==s&&(this.predicates.length=s)}(this,t)),this.count++,Math.ceil(this.count/31)>this.mask.length&&this.mask.push(0),this.maskSize=this.mask.length},N.prototype.tryCatch=function(t,e){try{return t.call(e,e,e.ctx)}catch(t){this.thrownError=t}},N.prototype.exec=function(t){for(var e,i=this.checkDepth(),n=this.maskOffset,s=this.mask[n],o=1,r=0;r<this.count;r++){if(0==(s&o)){e=this.templates[r];for(var a=0;a<e.predicates.length;a++){if(!e.predicates[a].exec(t))break}if(a===e.predicates.length)break}1073741824===o?(n++,s=this.mask[n],o=1):o<<=1}if(r===this.count)return this.restoreDepth(i),t.ctx[this.modeName];var c=s,l=this.bemxjst.match;this.mask[n]|=o,this.bemxjst.match=this,this.thrownError=null;var d="function"==typeof e.body?this.tryCatch(e.body,t):e.body;this.mask[n]=c,this.bemxjst.match=l,this.restoreDepth(i);var h=this.thrownError;if(null!==h)throw this.thrownError=null,h;return d},N.prototype.checkDepth=function(){if(-1===this.depth)return this.depth=this.bemxjst.depth,-1;if(this.bemxjst.depth===this.depth)return this.depth;var t=this.depth;for(this.depth=this.bemxjst.depth,this.maskOffset+=this.maskSize;this.mask.length<this.maskOffset+this.maskSize;)this.mask.push(0);return t},N.prototype.restoreDepth=function(t){-1!==t&&t!==this.depth&&(this.maskOffset-=this.maskSize),this.depth=t},D.methods=["match","wrap","block","elem","mode","mod","elemMod","def","tag","attrs","cls","js","bem","mix","content","replace","extend","oninit","xjstOptions","appendContent","prependContent"],D.prototype.build=function(t,e){var i=this.methods("global").concat(e);return i[0]=this.match.bind(this),t.apply({},i),{templates:this.templates.slice().reverse(),oninit:this.initializers}},D.prototype.methods=function(t){for(var e=new Array(D.methods.length),i=0;i<e.length;i++){var n=D.methods[i];e[i]=O(this,t,n)}return e},D.prototype.flush=function(t,e){for(var i=e.conditions?t.concat(e.conditions):e.conditions,n=0;n<e.children.length;n++){var s=e.children[n];if(s instanceof M)this.flush(i,e.children[n]);else{var o=new k(t,s);o.wrap(),this.templates.push(o)}}},D.prototype.body=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new M(this,t);return this.queue[this.queue.length-1].children.push(i),1===this.queue.length&&this.flush([],this.queue.shift()),this.boundBody},D.prototype.match=function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++){var i=arguments[e];if("function"==typeof i&&(i=new T(i)),!(i instanceof w))throw new Error("Wrong .match() argument");t[e]=i}return this.queue.push(new M(this,t)),this.boundBody},D.prototype.applyMode=function(t,e){if(t.length)throw new Error("Predicate should not have arguments but "+JSON.stringify(t)+" passed");return this.mode(e)},D.prototype.xjstOptions=function(t){return this.queue.push(new M(this,[new S(t)])),this.boundBody},D.prototype.block=function(t){return this.match(new C("block",t))},D.prototype.elem=function(t){return this.match(new C("elem",t))},D.prototype.mode=function(t){return this.match(new C("_mode",t))},D.prototype.mod=function(t,e){return this.match(new C(["mods",t],void 0===e||String(e)))},D.prototype.elemMod=function(t,e){return this.match(new C(["elemMods",t],void 0===e||String(e)))},D.prototype.def=function(){return this.applyMode(arguments,"default")},["tag","attrs","cls","js","bem","mix","content"].forEach(function(t){D.prototype[t]=function(){return this.applyMode(arguments,t)}}),["appendContent","prependContent"].forEach(function(t){D.prototype[t]=function(){return this.content.apply(this,arguments).match(new I(t,this.refs))}}),D.prototype.wrap=function(){return this.def.apply(this,arguments).match(new x(this.refs))},D.prototype.replace=function(){return this.def.apply(this,arguments).match(new E(this.refs))},D.prototype.extend=function(){return this.def.apply(this,arguments).match(new B(this.refs))},D.prototype.oninit=function(t){this.initializers.push(t)},P.prototype.init=function(t,e){this.block=t,this.elem=e},P.prototype.initModes=function(t){for(var e=0;e<t.length;e++){for(var i=t[e],s=i.predicates.length-1;s>=0;s--){if((o=i.predicates[s])instanceof C&&"_mode"===o.key){i.predicates.splice(s,1),this._initRest(o.value),this.rest[o.value].push(i);break}}-1===s&&this.def.push(i);for(s=i.predicates.length-1;s>=0;s--){var o;(o=i.predicates[s])instanceof S&&(this.options=n.extend(this.options,o.options))}}},P.prototype.prepend=function(t){for(var e=Object.keys(this.rest),i=0;i<e.length;i++){var n=e[i];t.rest[n]&&this.rest[n].prepend(t.rest[n])}e=Object.keys(t.rest);for(i=0;i<e.length;i++){n=e[i];this.rest[n]||(this._initRest(n),this.rest[n].prepend(t.rest[n]))}},P.prototype.run=function(t){return 0!==this.def.count?this.def.exec(t):this.defaultBody(t)},P.prototype.setDefaults=function(){if(0!==this.content.count&&this.content.push(new k([],A)),0!==this.def.count){this.canFlush=this.options.flush||!1;var t=this;this.def.push(new k([],function(){return t.defaultBody(this)}))}},L.prototype=Object.create(Error.prototype),L.prototype.constructor=L,j.prototype.locals=D.methods.concat("local","applyCtx","applyNext","apply"),j.prototype.compile=function(t){var e=this;function i(){return e._run(e.context.ctx)}function n(t,n){return n?e.local(n,function(){return e.local({ctx:t},i)}):e.local({ctx:t},i)}function s(t,i){return e.applyMode(t,i)}function o(t){return function(i){return e.local(t,i)}}var r=new D({refs:{applyCtx:n,local:o,apply:s}}),a=this.recompileInput(t),c=r.build(a,[o,n,function t(i){return i?e.local(i,t):e.applyNext()},s]);this.tree&&(c={templates:c.templates.concat(this.tree.templates),oninit:this.tree.oninit.concat(c.oninit)}),this.tree=c;var l=this.groupEntities(c.templates);l=this.transformEntities(l),this.entities=l,this.oninit=c.oninit},j.prototype.recompileInput=function(t){var e=j.prototype.locals;if("function"==typeof t&&t.length===e.length)return t;var i=t.toString();return i=i.replace(/^function[^{]+{|}$/g,""),i=new Function(e.join(", "),i)},j.prototype.groupEntities=function(t){for(var e={},i=0;i<t.length;i++){var n,s=t[i].clone(),o=null;n=void 0;for(var r=0;r<s.predicates.length;r++){if((c=s.predicates[r])instanceof C||c instanceof I){if("block"===c.key)o=c.value;else{if("elem"!==c.key)continue;n=c.value}s.predicates.splice(r,1),r--}}if(null===o){var a="block(…) subpredicate is not found.\n    See template with subpredicates:\n     * ";for(r=0;r<s.predicates.length;r++){var c=s.predicates[r];0!==r&&(a+="\n     * "),"_mode"===c.key?a+=c.value+"()":Array.isArray(c.key)?a+=c.key[0].replace("mods","mod").replace("elemMods","elemMod")+"('"+c.key[1]+"', '"+c.value+"')":c.value&&c.key?a+=c.key+"('"+c.value+"')":a+="match(…)"}throw new L(a+="\n    And template body: \n    ("+("function"==typeof s.body?s.body:JSON.stringify(s.body))+")")}var l=this.classBuilder.build(o,n);e[l]||(e[l]=[]),e[l].push(s)}return e},j.prototype.transformEntities=function(t){for(var e=[],i=Object.keys(t),n=0;n<i.length;n++){var s=i[n],o=this.classBuilder.split(s),r=o[0],a=o[1];"*"===a&&e.push(r),t[s]=new this.Entity(this,r,a,t[s])}if(t.hasOwnProperty("*")){var c=t["*"];for(n=0;n<i.length;n++){"*"!==(s=i[n])&&t[s].prepend(c)}this.defaultEnt.prepend(c),this.defaultElemEnt.prepend(c)}for(n=0;n<e.length;n++){r=e[n];var l=this.classBuilder.build(r,"*");for(c=t[l],n=0;n<i.length;n++){if((s=i[n])!==l){var d=t[s];d.block===r&&void 0!==d.elem&&t[s].prepend(c)}}this.defaultElemEnt.prepend(c)}for(n=0;n<i.length;n++){t[s=i[n]].setDefaults(),this.defaultEnt.setDefaults(),this.defaultElemEnt.setDefaults()}return t},j.prototype._run=function(t){return void 0===t||""===t||null===t?this.runEmpty():Array.isArray(t)?this.runMany(t):"string"!=typeof t.html||t.tag||void 0!==t.block||void 0!==t.elem||void 0!==t.cls||void 0!==t.attrs?n.isSimple(t)?this.runSimple(t):this.runOne(t):this.runUnescaped(t)},j.prototype.run=function(t){var e=this.match,i=this.context;this.match=null,this.context=new this.contextConstructor(this),this.canFlush=null!==this.context._flush,this.depth=0;var n=this._run(t);return this.canFlush&&(n=this.context._flush(n)),this.match=e,this.context=i,n},j.prototype.runEmpty=function(){return this.context._listLength--,""},j.prototype.runUnescaped=function(t){return this.context._listLength--,""+t.html},j.prototype.runSimple=function(t){return this.context._listLength--,!t&&0!==t||!0===t?"":"string"==typeof t&&this.context.escapeContent?n.xmlEscape(t):t},j.prototype.runOne=function(t){var e=this.context,i=e.ctx,n=e.block,s=e._currBlock,o=e.elem,r=e.mods,a=e.elemMods;t.block||t.elem?e._currBlock="":e._currBlock=e.block,e.ctx=t,t.block?(e.block=t.block,t.mods?e.mods=t.mods:t.block===n&&t.elem||(e.mods={})):t.elem?s&&(e.block=s):e.block="",e.elem=t.elem,t.elemMods?e.elemMods=t.elemMods:e.elemMods={};var c=e.block||"",l=e.elem;c||l?e.position++:e._listLength--,this.depth++;var d=!1,h=this.entities[this.classBuilder.build(c,l)];h?this.canFlush&&!h.canFlush&&(d=!0,this.canFlush=!1):(h=this.defaultEnt,void 0!==l&&(h=this.defaultElemEnt),h.init(c,l));var u=!0===this.options.production?this.tryRun(e,h):h.run(e);return e.ctx=i,e.block=n,e.elem=o,e.mods=r,e.elemMods=a,e._currBlock=s,this.depth--,d&&(this.canFlush=!0),u},j.prototype.tryRun=function(t,e){try{return e.run(t)}catch(e){return console.error("BEMXJST ERROR: cannot render "+["block "+t.block,"elem "+t.elem,"mods "+JSON.stringify(t.mods),"elemMods "+JSON.stringify(t.elemMods)].join(", "),e),""}},j.prototype.renderContent=function(t,e){var i=this.context,n=i.position,s=i._listLength,o=i._notNewList;i._notNewList=!1,e&&(i.position=0,i._listLength=1);var r=this._run(t);return i.position=n,i._listLength=s,i._notNewList=o,r},j.prototype.local=function(t,e){for(var i=Object.keys(t),n=[],s=0;s<i.length;s++){for(var o=i[s],r=o.split("."),a=this.context,c=0;c<r.length-1;c++)a=a[r[c]];n.push({parts:r,value:a[r[c]]}),a[r[c]]=t[o]}var l=e.call(this.context);for(s=0;s<n.length;s++){for(r=n[s].parts,a=this.context,c=0;c<r.length-1;c++)a=a[r[c]];a[r[c]]=n[s].value}return l},j.prototype.applyNext=function(){return this.match.exec(this.context)},j.prototype.applyMode=function(t,e){var i=this.match.entity.rest[t];if(!i)return this.context.ctx[t];if(!e)return i.exec(this.context);var n=this;return this.local(e,function(){return i.exec(n.context)})},j.prototype.exportApply=function(t){var e=this;t.apply=function(t){return e.run(t)},t.compile=function(t){return e.compile(t)},t.BEMContext=e.contextConstructor;for(var i=0;i<e.oninit.length;i++){(0,e.oninit[i])(t,{BEMContext:t.BEMContext})}},i(R,P),R.prototype.init=function(t,e){this.block=t,this.elem=e,this.jsClass=this.bemxjst.classBuilder.build(this.block,this.elem)},R.prototype._initRest=function(t){"default"===t?this.rest[t]=this.def:"tag"===t||"attrs"===t||"content"===t?this.rest[t]=this[t]:this.rest.hasOwnProperty(t)||(this.rest[t]=new N(this,t))},R.prototype.defaultBody=function(t){return this.bemxjst.render(t,this,this.tag.exec(t),!1!==t.ctx.js?this.rest.js?this.rest.js.exec(t):t.ctx.js:void 0,this.rest.bem?this.rest.bem.exec(t):t.ctx.bem,this.rest.cls?this.rest.cls.exec(t):t.ctx.cls,this.rest.mix?this.rest.mix.exec(t):t.ctx.mix,this.attrs.exec(t),this.content.exec(t))},i(z,j),t.exports=z,z.prototype.Entity=R,z.prototype.runMany=function(t){var e="",i=this.context,n=i.position,s=i._notNewList;if(s?i._listLength+=t.length-1:(i.position=0,i._listLength=t.length),i._notNewList=!0,this.canFlush)for(var o=0;o<t.length;o++)e+=i._flush(this._run(t[o]));else for(o=0;o<t.length;o++)e+=this._run(t[o]);return s||(i.position=n),e},z.prototype.render=function(t,e,i,s,o,r,a,c,l){var d=t.ctx;if(void 0===i)i="div";else if(!i)return l||0===l?this._run(l):"";var h,u="<"+i,m=d.js;!1!==m&&(!0===s&&(s={}),s&&s!==d.js?!0!==m&&(s=n.extend(m,s)):!0===m&&(s={})),s&&((h={})[e.jsClass]=s);var p=void 0!==o?o:e.block||e.elem;p=!!p;var f=h&&(this._elemJsInstances?e.block||e.elem:e.block&&!e.elem);if(!p&&!r)return this.renderClose(u,t,i,c,p,d,l);u+=" class=";var _="";if(p){if(_+=e.jsClass+this.buildModsClasses(e.block,e.elem,e.elem?t.elemMods:t.mods),d.mix&&a&&a!==d.mix&&(a=[].concat(a,d.mix)),a){var g=this.renderMix(e,a,h,f);_+=g.out,h=g.jsParams,f=g.addJSInitClass}r&&(_+=" "+("string"==typeof r?n.attrEscape(r).trim():r))}else _+="string"==typeof r?n.attrEscape(r).trim():r;return f&&(_+=" i-bem"),u+=this._unquotedAttrs&&n.isUnquotedAttr(_)?_:'"'+_+'"',p&&h&&(u+=" data-bem='"+n.jsAttrEscape(JSON.stringify(h))+"'"),this.renderClose(u,t,i,c,p,d,l)};var F={html:1,head:1,body:1,p:1,li:1,dt:1,dd:1,colgroup:1,thead:1,tbody:1,tfoot:1,tr:1,th:1,td:1,option:1,rb:1,rt:1,rtc:1,rp:1,optgroup:1};z.prototype.renderClose=function(t,e,i,s,o,r,a){var c=t;return c+=this.renderAttrs(s,r),n.isShortTag(i)?(c+=this._shortTagCloser,this.canFlush&&(c=e._flush(c))):(c+=">",this.canFlush&&(c=e._flush(c)),(a||0===a)&&(c+=this.renderContent(a,o)),this._omitOptionalEndTags&&F.hasOwnProperty(i)||(c+="</"+i+">")),this.canFlush&&(c=e._flush(c)),c};var q=function(t){return t&&"object"==typeof t&&!Array.isArray(t)&&null!==t};return z.prototype.renderAttrs=function(t,e){var i="";if(q(t)||q(e.attrs))for(var s in t=n.extend(t,e.attrs)){var o=t[s];if(void 0!==o&&!1!==o&&null!==o)if(!0===o)i+=" "+s;else{var r=n.isSimple(o)?o:this.context.reapply(o);i+=" "+s+"=",i+=this._unquotedAttrs&&n.isUnquotedAttr(r)?r:'"'+n.attrEscape(r)+'"'}}return i},z.prototype.renderMix=function(t,e,i,n){var s={},o=this.context,r=i,a=n;s[t.jsClass]=!0,Array.isArray(e)||(e=[e]);for(var c=this.classBuilder,l="",d=0;d<e.length;d++){var h=e[d];if(h){"string"==typeof h&&(h={block:h,elem:void 0});var u=!1;h.elem?u=h.elem!==t.elem&&h.elem!==o.elem||h.block&&h.block!==t.block:h.block&&(u=!(h.block===t.block&&h.mods)||h.mods&&t.elem);var m=h.block||h._block||o.block,p=h.elem||h._elem||o.elem,f=c.build(m,p),_=h.elem||h._elem||(h.block?void 0:o.elem);if(u&&(l+=" "+c.build(m,_)),l+=this.buildModsClasses(m,_,h.elem||!h.block&&(h._elem||o.elem)?h.elemMods:h.mods),h.js&&(r||(r={}),r[c.build(m,h.elem)]=!0===h.js?{}:h.js,a||(a=m&&!h.elem)),u&&!s[f]){s[f]=!0;var g=this.entities[f];if(g){var b=o.block,v=o.elem,y=g.rest.mix&&g.rest.mix.exec(o);if(o.elem=v,o.block=b,y)for(var k=0;k<y.length;k++){var w=y[k];if(w&&(!w.block&&!w.elem||!s[c.build(w.block,w.elem)])){if(w.block)continue;w._block=m,w._elem=p,e=e.slice(0,d+1).concat(w,e.slice(d+1))}}}}}}return{out:l,jsParams:r,addJSInitClass:a}},z.prototype.buildModsClasses=function(t,e,i){if(!i)return"";var n="";for(var s in i)if(i.hasOwnProperty(s)&&""!==s){var o=i[s];if(o||0===o){"boolean"!=typeof o&&(o+="");var r=this.classBuilder;n+=" "+(e?r.buildElemClass(t,e,s,o):r.buildBlockClass(t,s,o))}}return n},t.exports||{}.BEMHTML}({}))({escapeContent:!0,xhtml:!0});return i.compile(function(e,i,n,s,o,r,a,c,l,d,h,u,m,p,f,_,g,b,v,y,k,w,M,x,E){n("i-bem").elem("i18n").def()(function(){if(!this.ctx)return"";var t=this.ctx,e=t.keyset,i=t.key,n=t.params||{};return e||i?(t.content&&(n.content=this.reapply(t.content)),BEM.I18N(e,i,n)):""}),n("b-page").elem("cc")(l()(!1),f()(function(){var t=this.ctx.others,e=this.ctx.condition.indexOf("!")>-1;return[{html:["\x3c!--[if "+this.ctx.condition+"]>",t?"<!":"",e||t?"--\x3e":""].join("")},this.ctx.content,{html:[e||t?"\x3c!--":"","<![endif]--\x3e"].join("")}]})),n("button2").elem("text").tag()("span"),n("spin2")(c()(function(){return void 0===this.mods.view&&(this.mods.view="default"),void 0===this.mods.tone&&(this.mods.tone="default"),x()})),n("b-page").elem("icon")(l()("link"),m()(!1),d()(function(){return{rel:"icon",type:"image/png",href:this.ctx.url,sizes:this.ctx.sizes}})),n("sidebar").elem("close").tag()("span"),n("w-toc").elem("item")(_().match(function(){return"heading"===this.ctx.data.type})(function(){return{block:"link",mix:{block:"w-toc",elem:"item",elemMods:{depth:this.ctx.data.depth}},mods:{theme:E("theme")},text:this.ctx.data.value,url:"#"+this.ctx.data.anchor}}),o("theme")("dark")),b(function(t){t.BEMContext.prototype.util||(t.BEMContext.prototype.util={})}),n("editor-help").elem("syntax").content()(function(){return{elem:"group",title:BEM.I18N("editor-help","syntax-title"),content:[{elem:"syntax-sample",content:[{elem:"syntax-code",content:"==="}," ",BEM.I18N("editor-help","syntax-h2-title")]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"===="}," ",BEM.I18N("editor-help","syntax-h3-title")]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"(("},BEM.I18N("editor-help","syntax-url-title"),{elem:"syntax-code",content:"))"}]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"<{"},BEM.I18N("editor-help","syntax-cat-title-upper"),{tag:"br"},BEM.I18N("editor-help","syntax-cat-title-bottom"),{elem:"syntax-code",content:"}>"}]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"кто:"},BEM.I18N("editor-help","syntax-login-title"),{elem:"syntax-code",content:"@"}," ",BEM.I18N("editor-help","syntax-login-description-title")]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"QUEUE-123"}," ",BEM.I18N("editor-help","syntax-queue-title")]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"%%("+BEM.I18N("editor-help","lang")+")"},BEM.I18N("editor-help","syntax-highlight-title"),{elem:"syntax-code",content:"%%"}]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"{{"},BEM.I18N("editor-help","syntax-action-title"),{elem:"syntax-code",content:"}}"}]}]}}),n("editor-help").elem("syntax").content()(function(){return{elem:"group",title:BEM.I18N("editor-help","syntax-title"),content:[{elem:"syntax-sample",content:[{elem:"syntax-code",content:"==="}," ",BEM.I18N("editor-help","syntax-h2-title")]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"===="}," ",BEM.I18N("editor-help","syntax-h3-title")]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"(("},BEM.I18N("editor-help","syntax-url-title"),{elem:"syntax-code",content:"))"}]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"<{"},BEM.I18N("editor-help","syntax-cat-title-upper"),{tag:"br"},BEM.I18N("editor-help","syntax-cat-title-bottom"),{elem:"syntax-code",content:"}>"}]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"%%("+BEM.I18N("editor-help","lang")+")"},BEM.I18N("editor-help","syntax-highlight-title"),{elem:"syntax-code",content:"%%"}]},{elem:"syntax-sample",content:[{elem:"syntax-code",content:"{{"},BEM.I18N("editor-help","syntax-action-title"),{elem:"syntax-code",content:"}}"}]}]}}),n("editor-help").elem("hotkeys").content()(function(){return{elem:"group",title:BEM.I18N("editor-help","hotkeys-title"),content:[{key:"B",description:BEM.I18N("editor-help","hotkey-bold-title")},{key:"I",description:BEM.I18N("editor-help","hotkey-italic-title")},{key:"Shift + S",description:BEM.I18N("editor-help","hotkey-stroke-title")},{key:"Shift + L",description:BEM.I18N("editor-help","hotkey-list-title")},{key:"Z",description:BEM.I18N("editor-help","hotkey-undo-title")},{key:"Enter",description:BEM.I18N("editor-help","hotkey-save-title")}].map(function(t){return{elem:"hotkey",key:t.key,description:t.description}})}}),n("editor-help").elem("hotkey").content()(function(){return[{elem:"hotkey-key",tag:"span",content:"Ctrl + "+this.ctx.key},{elem:"hotkey-description",tag:"span",content:" - "+this.ctx.description}]}),n("select2").elem("button").mode("iconMods")(function(){return{type:"arrow",direction:"bottom"}},r("view","default")(function(){return{glyph:"carets-v"}})),n("select2").elem("button").replace()(function(){var t,e=this.generateId(),i=this.ctx,n=i.button||{};return this.isSimple(n.text)&&(n.text={content:{html:this.xmlEscape(n.text)}}),this.mods.popup&&i.items.some(function(e){return!!(i.val.indexOf(e.val)>-1&&e.icon)&&(t=e.icon,!0)}),this.util.mergeBemjson({block:"button2",mods:{width:"max"},attrs:{role:"listbox","aria-labelledby":e,"aria-expanded":"false","aria-multiselectable":this.ctx.multiselectable?"true":void 0},iconLeft:t,iconRight:{mods:E("iconMods"),mix:{block:"select2",elem:"arrow"}},mix:{block:"select2",elem:"button",elemMods:this.elemMods},text:{attrs:{id:e}}},n)}),n("button2").elem("icon").def()(function(){var t=this.extend({},this.ctx.icon);return t.block="icon",t.mix=[{block:"button2",elem:"icon",elemMods:this.elemMods}].concat(t.mix),t.mods=this.extend({size:this.mods.size},t.mods),M(t)}),n("icon")(l()("span"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t=this.ctx,e=void 0!==t.url,i=void 0!==Object(t.attrs).style,n=(i?t.attrs.style:"")+(e?";background-image:url('"+t.url+"');":"");return i&&(t.attrs.style=n),{style:n||void 0}})),n("icon").match(function(){return void 0!==this.mods.glyph}).def()(function(){return this.mods["has-glyph"]="yes",x()}),n("menu").elem("item")(e(function(){return this._inMenuTypeNavigation}).wrap()(function(){return{elem:"list-item",content:this.ctx}}),("undefined"!=typeof addJs?addJs:u)()(function(){return{val:this.ctx.val}}),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{title:this.ctx.title,"aria-disabled":!!this.elemMods.disabled&&"true","aria-selected":!!this.elemMods.checked&&"true"}}),e(function(){return!this.ctx.content}).content()(function(){return[this.ctx.icon&&{elem:"icon",icon:this.ctx.icon},void 0!==this.ctx.text&&{elem:"text",content:{html:this.isSimple(this.ctx.text)?this.xmlEscape(this.ctx.text):this.reapply(this.ctx.text)}}].filter(Boolean)})),n("menu").elem("list-item").tag()("li"),n("checkbox").elem("control")(l()("input"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{type:"checkbox",autocomplete:"off"}})),n("b-event").elem("date").content()(function(){var t=BEM.blocks["mi-helpers"].getDateFromHumanString(this.ctx.timestamp),e=function(t){return t<10?"0"+t:t},i=[],n=e(t.getDate()),s=e(t.getMonth()+1),o=t.getFullYear(),r=e(t.getHours()),a=e(t.getMinutes());return i.push([n,s,o].join("."),[r,a].join(":")),i.join(", ")}),n("b-event").elem("user").content()(function(){var t=this.ctx.login;return{block:"m-username",mods:{theme:this.ctx.theme,dismissed:this.ctx.isDismissed?"yes":""},mix:[{block:"mi-staff-card",js:{user:t}}],url:this["i-global"].hosts.staff.url+"/"+t,content:t+"@"}}),n("b-event").elem("user").content()(function(){var t=this.ctx.login;return{block:"m-username",mods:{theme:this.ctx.theme,dismissed:this.ctx.isDismissed?"yes":""},login:t,content:t+"@"}}),n("m-username")(l()(function(){return this.ctx.url?"a":"span"}),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t={href:this.ctx.url};return this.ctx.counter&&(t.onmousedown=this.ctx.counter),t}),f()(function(){return[{elem:"first-letter",content:this.ctx.content.charAt(0)},this.ctx.content.slice(1)]}),s("first-letter").tag()("span")),n("m-username")(l()("a"),d()(function(){return{href:this["i-global"].hosts.staff.url+"/"+this.ctx.login}}),p()(function(){return{block:"staff-lite-card",js:{staffLiteHost:this["i-global"].hosts.staff.url,user:this.ctx.login}}})),n("b-event").elem("action").elemMod("type","subscribe-other-user").content()(function(){return{block:"i-bem",elem:"i18n",keyset:"b-events-log",key:"subscribe_other_user",content:{block:"b-event",elem:"user",theme:this.ctx.theme,login:this.ctx.data.subscribed_user_login}}}),n("b-event").elem("action").elemMod("type","default").content()(function(){return BEM.I18N("b-events-log",this.ctx.type)}),n("w-attachments").elem("more").content()(function(){return[{block:"link",mods:{pseudo:"yes",theme:this._theme},content:[BEM.I18N("w-attachments","more")," ",{block:"w-attachments",elem:"more-count",tag:"span",content:0}," ",{block:"awesome-icon",mods:{icon:"angle-down"}}]}]}),n("button2").elem("control")(l()("input"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{type:this._type,autocomplete:"off"}})),n("attach").elem("holder")(c()(function(){return this.elemMods.state="hidden",x()}),l()("span"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{"aria-hidden":"true"}}),f()(function(){return[{block:"image",mix:{block:"attach",elem:"icon-file"}},{elem:"text",tag:"label",attrs:{for:this._id},content:this.ctx.content||BEM.I18N("attach","no-file")},{block:"image",mix:{block:"attach",elem:"reset"}}]})),n("image")(l()("img"),d()(function(){var t=this.ctx,e={};return e.src=t.url||"https://yastatic.net/lego/_/La6qi18Z8LwgnZdsAr1qy1GwCwo.gif",e.alt=t.alt||"",e.width=t.width,e.height=t.height,this.extend(e,x())})),n("w-file-name")(l()("span"),d()(function(){return{style:"max-width: "+this.ctx.width.max+"px"}}),f()(function(){var t=this["w-file-name"].splitFileName(this.ctx.content);return[{elem:"name",tag:"span",attrs:{style:"max-width: "+this.ctx.width.name+"px"},content:t.name},{elem:"ext",tag:"span",content:t.ext}]}),c().match(function(){return!this["w-file-name"]})(function(){return this["w-file-name"]={splitFileName:function(t){var e=t.lastIndexOf(".");return-1===e?t:{name:t.substr(0,e),ext:t.substr(e)}}},x()})),n("w-attach").elem("size")(l()("span"),d()(function(){return{title:this.ctx.content}}),f()(function(){return this.ctx.content+" "+BEM.I18N("w-attach","megabytes")})),n("input").elem("box")(l()("span"),f()(function(){return[this._iconLeft&&{elem:"icon",icon:this._iconLeft,elemMods:{side:"left"}},this._iconRight&&{elem:"icon",icon:this._iconRight,elemMods:{side:"right"}},this._hasClear&&{elem:"clear",elemMods:this._value||0===this._value?{visibility:"visible"}:void 0,content:" "},this.ctx.content].filter(Boolean)})),n("input").elem("control")(l()("input"),d()(function(){var t=this.extend({id:this._inputId,name:this._name,placeholder:this._placeholder},this.ctx.controlAttrs);return(this._value||0===this._value||""===this._value)&&(t.value=this._value),this.mods.disabled&&(t.disabled=!0),this._live&&(t.autocomplete="off"),t["aria-labelledby"]=this._labelId+" "+this._hintId,this.extend(t,x())}),i()(function(){return{elem:"box",content:this.ctx}})),n("b-grid-table-width-controll").content()(function(){var t=this.ctx.width_units||"%";return[{block:"input",value:this.ctx.width||"",placeholder:BEM.I18N("b-grid-table-width-controll","auto"),mods:{size:this.ctx.size,theme:this.mods.theme},content:[this.ctx.label&&{elem:"label",content:this.ctx.label},{elem:"control",attrs:{autocomplete:"off"}}]},{block:"select2",mods:{size:this.ctx.size,theme:this.mods.theme||"normal",type:"radiocheck",text:"vary"},text:t,val:t,items:[{val:"%",text:"%"},{val:"px",text:"px"}],button:{mods:{theme:this.mods.theme||"normal"}}}]}),n("radiobox").elem("radio")(c()(function(){var t=this.ctx,e=this.elemMods,i=this.extend({id:this.generateId(),type:"radio",name:this._name,value:t.value},t.controlAttrs),n=void 0!==i.value&&i.value===this._value;return e.disabled||(e.disabled=this._disabled),e.checked||(e.checked=n?"yes":""),e.disabled&&(i.disabled=!0,i.tabindex=-1),e.checked&&(i.checked=!0),x({_controlAttrs:i})}),l()("label"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{for:this._controlAttrs.id}}),f()(function(){return[{elem:"box",tag:"span",content:{elem:"control"}},{elem:"text",tag:"span",content:x()}]})),n("radio-button").elem("control")(l()("input"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t=this._controlAttrs;return t.checked=Boolean(t.checked),t.disabled=Boolean(t.disabled),t.disabled&&(t.tabindex="-1"),t.type="radio",t.name=this._radioButton.name,t})),n("w-userpic")(l()("img"),d()(function(){var t=this.ctx.size+"px";return{width:t,height:t}})),b(function(t){t.BEMContext.prototype["w-userpic"]={getAvatarUrl:function(t,e,i){return t+e+"/islands-"+(i||"middle")}}}),n("w-userpic")(d()(function(){var t=this.ctx.user?this.ctx.user.uid:this.ctx.uid,e=x();return Object.assign({},e,{src:this.ctx.src||this["w-userpic"].getAvatarUrl(this["i-global"].hosts.avatars.url,t)})})),n("textinput").elem("box").tag()("span"),n("textinput").elem("control").tag()("input"),n("textinput").elem("clear")(_()(function(){return{elem:"icon",icon:this.extend({mods:{type:E("icon-type"),glyph:E("icon-glyph")},mix:{block:this.block,elem:"clear",elemMods:this.elemMods}},this.ctx.icon)}})),n("textinput").elem("icon").replace()(function(){var t=this.ctx.icon||{};return t.block="icon",t.mix=[].concat(t.mix,{block:this.block,elem:this.elem,elemMods:this.elemMods}),t.mods=this.extend({size:this.mods.size,disabled:this.mods.disabled},t.mods),t}),n("textarea").elem("box").tag()("span"),n("textarea").elem("wrap").tag()("span"),n("textarea").elem("control").tag()("textarea"),n("checkbox").elem("label")(l()("label"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return this.extend({"aria-hidden":"true"},this._labelAttrs)})),n("select").elem("item")["undefined"!=typeof addAttrs?"addAttrs":"attrs"]()(function(){return{id:this.generateId()}}),n("select").elem("group")(("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{role:"group","aria-labelledby":this._labelId}}),("undefined"!=typeof addJs?addMix:p)()(function(){return{elemMods:{position:this.isFirst()?this.isLast()?"both":"first":this.isLast()?"last":"middle"}}}),c()(function(){return x({_labelId:this.generateId()})})),n("select").elem("control")(e(function(){return this._initValue}).def()(function(){var t=this.ctx;return t.attrs=this.extend(t.attrs,{value:this._initValue}),x()}),l()("select"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t={};return["id","name","tabindex"].forEach(function(e){this._controlAttrs[e]&&(t[e]=this._controlAttrs[e])}.bind(this)),t.disabled=Boolean(this.mods.disabled),t.tabindex=-1,t["aria-hidden"]="true",this.ctx.controlAttrs||t})),n("m-editor-button").content()(function(){var t=this.ctx,e=t.content,i=t.buttonJs,n=t.pin;return{block:"button2",mix:{block:"m-editor-button",elem:"button"},js:i,title:t.title,tabindex:-1,mods:{theme:"normal",size:"m",pin:n},content:{elem:"text",content:e}}}),n("m-editor-button").elem("caption").tag()("span"),n("m-editor-button").mod("type","h2").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","header2"),t["ctx.buttonJs"]={placeholder:"Header 2",before:"===",after:"===",hotkey:"Ctrl+Shift+2, Command+Shift+2"},t["ctx.content"]=["h2",{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","header2")}],x(t)}),n("m-editor-button").mod("type","h3").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","header3"),t["ctx.buttonJs"]={placeholder:"Header 3",before:"====",after:"====",hotkey:"Ctrl+Shift+3, Command+Shift+3"},t["ctx.content"]=["h3",{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","header3")}],x(t)}),n("m-editor-button").mod("type","bold").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","bold"),t["ctx.buttonJs"]={placeholder:"Bold",before:"**",after:"**",hotkey:"Ctrl+B, Command+B"},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"bold"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","bold")}],x(t)}),n("m-editor-button").mod("type","italic").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","italic"),t["ctx.buttonJs"]={placeholder:"Italic",before:"//",after:"//",hotkey:"Ctrl+I, Command+I"},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"italic"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","italic")}],x(t)}),n("m-editor-button").mod("type","underline").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","underline"),t["ctx.buttonJs"]={placeholder:"Underline",before:"__",after:"__",hotkey:"Ctrl+U, Command+U"},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"underline"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","underline")}],x(t)}),n("m-editor-button").mod("type","strikethrough").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","strike"),t["ctx.buttonJs"]={placeholder:"Strike",before:"--",after:"--",hotkey:"Ctrl+Shift+S, Command+Shift+S"},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"strikethrough"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","strike")}],x(t)}),n("m-editor-button").mod("type","ul").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","ulist"),t["ctx.buttonJs"]={placeholder:"Unordered List",before:"* ",multilineInsert:!0,toggle:"([\\w]{1}|[0-9]{1,3})\\.(\\+ | |\\#[0-9]+ )",wrap:"none",hotkey:"Ctrl+Shift+L, Command+Shift+L"},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"list-ul"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","ulist")}],x(t)}),n("m-editor-button").mod("type","ol").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","olist"),t["ctx.buttonJs"]={placeholder:"Ordered List",before:"1. ",toggle:"\\*((\\+ )| |(\\#[0-9]+ ))",wrap:"none",hotkey:"Ctrl+Shift+N, Command+Shift+N"},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"list-ol"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","olist")}],x(t)}),n("m-editor-button").mod("type","indent").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","indent"),t["ctx.buttonJs"]={del:"  "},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"outdent"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","indent")}],x(t)}),n("m-editor-button").mod("type","outdent").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","outdent"),t["ctx.buttonJs"]={add:"  ",hotkey:"Ctrl+Shift+T, Command+Shift+T"},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"indent"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","outdent")}],x(t)}),n("m-editor-button").mod("type","quote").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","quote"),t["ctx.buttonJs"]={ignoreExceptions:!0,placeholder:"quote",before:"<[",after:"]>",selection:!0},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"quote-right"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","quote")}],x(t)}),n("m-editor-button").mod("type","readmore").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","readmore"),t["ctx.buttonJs"]={placeholder:"readmore",before:"<{",after:"}>",selection:!0},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"cut"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","readmore")}],x(t)}),n("m-editor-button").mod("type","separator").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","separator"),t["ctx.buttonJs"]={before:"\n-----------\n",after:""},t["ctx.content"]=["—",{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","separator")}],x(t)}),n("m-editor-button").mod("type","link").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","link"),t["ctx.buttonJs"]={popup:{title:BEM.I18N("m-editor-popup","createLink"),type:"link"}},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"link"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","createLink")}],x(t)}),n("m-editor-button").mod("type","picture").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","picture"),t["ctx.buttonJs"]={popup:{title:BEM.I18N("m-editor-popup","createPicture"),type:"picture"}},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"image"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","picture")}],x(t)}),n("m-editor-button").mod("type","code").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","code"),t["ctx.buttonJs"]={popup:{title:BEM.I18N("m-editor-button","code"),type:"code"}},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"code"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","code")}],x(t)}),n("m-editor-button").mod("type","table").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","table"),t["ctx.buttonJs"]={before:"",after:"\n#|\n|| cell text| cell text||\n|| cell text| cell text||\n|#\n"},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"table"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","table")}],x(t)}),n("m-editor-button").mod("type","color").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","color"),t["ctx.buttonJs"]={placeholder:"Colored text",before:"!!",after:"!!"},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"font"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","color")}],x(t)}),n("m-editor-button").mod("type","math").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","math"),t["ctx.buttonJs"]={before:"%%(math outline)",after:"%%"},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"rub"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","math")}],x(t)}),n("m-editor-button").mod("type","spell").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","spell"),t["ctx.buttonJs"]={popup:{title:BEM.I18N("m-editor-popup","spell"),type:"spell"},notEditor:!0},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"check"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","spell")}],x(t)}),n("m-editor-button").mod("type","other").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","other"),t["ctx.buttonJs"]={popup:{title:BEM.I18N("m-editor-popup","other"),type:"other"},notEditor:!0,data:this.ctx.data},t["ctx.content"]="…",x(t)}),n("m-editor-button").mod("type","drafts").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","drafts"),t["ctx.buttonJs"]={popup:{title:BEM.I18N("m-editor-popup","drafts"),type:"drafts"},data:this.ctx.data},t["ctx.content"]=[{block:"m-editor-button",elem:"caption",content:this.ctx.data.drafts.length},{block:"awesome-icon",mods:{icon:"history"}}],x(t)}),n("m-editor-button").mod("type","help").def()(function(){var t={"ctx.buttonJs":{notPrevent:!0}};return t["ctx.title"]=BEM.I18N("m-editor-button","help"),t["ctx.target"]="_blank",t["ctx.url"]=this.ctx.helpURL,t["ctx.content"]={block:"awesome-icon",mods:{icon:"question"}},x(t)}),n("m-editor-button").mod("type","user").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","user"),t["ctx.buttonJs"]={popup:{title:BEM.I18N("m-editor-button","user"),type:"user"},separate:!0},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"user"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","user")}],x(t)}),n("m-editor-button").mod("type","file").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","file"),t["ctx.buttonJs"]={popup:{title:BEM.I18N("m-editor-popup","loadFile"),type:"file"}},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"file"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","file")}],x(t)}),n("m-editor-button").mod("type","form").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","form"),t["ctx.buttonJs"]={popup:{title:BEM.I18N("m-editor-button","form"),type:"form"}},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"wpforms"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","form")}],x(t)}),n("m-editor-button").mod("type","video").def()(function(){var t={};return t["ctx.title"]=BEM.I18N("m-editor-button","video"),t["ctx.buttonJs"]={popup:{title:BEM.I18N("m-editor-popup","createVideo"),type:"video"}},t["ctx.content"]=[{block:"awesome-icon",mods:{icon:"video-camera"}},{block:"m-editor-button",elem:"caption",content:this.ctx.caption&&BEM.I18N("m-editor-button","video")}],x(t)}),n("m-editor-button").mod("type","italic").mix()({block:"w-getting-started",elem:"elem",elemMods:{"edit-formatting":"2"}}),n("m-editor-button").mod("type","ul").mix()({block:"w-getting-started",elem:"elem",elemMods:{"edit-formatting":"3"}}),n("m-editor-button").mod("type","link").mix()({block:"w-getting-started",elem:"elem",elemMods:{"edit-attaching":"1"}}),n("m-editor-button").mod("type","h2").mix()({block:"w-getting-started",elem:"elem",elemMods:{"edit-basics":"1"}}),n("m-editor-button").mod("type","help").content()(function(){return{block:"button2",mix:{block:"m-editor-button",elem:"button"},js:{notPrevent:!0},title:BEM.I18N("m-editor-button","help"),tabindex:-1,url:this.ctx.helpURL,target:"_blank",mods:{theme:"normal",size:"m",pin:this.ctx.pin,type:"link"},content:{elem:"text",content:this.ctx.content}}}),n("m-userpic")(l()("span"),e(function(){return this.ctx.url})(l()("a"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{href:this.ctx.url}})),f()(function(){return{elem:"img",tag:"img",login:this.ctx.login,size:this.ctx.size}}),s("img")["undefined"!=typeof addAttrs?"addAttrs":"attrs"]()(e(function(){return!0})(function(){return{src:"//center.yandex-team.ru/api/v1/user/"+this.ctx.login+"/avatar.jpg"}}),e(function(){return this.ctx.size})(function(){return{src:"//center.yandex-team.ru/api/v1/user/"+this.ctx.login+"/avatar/"+this.ctx.size+".jpg"}}))),n("m-suggest-item").elem("info-title-type").tag()("span"),n("m-suggest-item").elem("info-link").tag()("span"),n("m-suggest-item").elem("info-icon").tag()("i"),n("w-username").replace()(function(){var t=this.ctx.user;return{block:"m-username",mods:{dismissed:t.is_dismissed?"yes":""},mix:this.ctx.mix,login:t.login,content:t.display}}),n("menu").elem("text").tag()("span"),n("menu").elem("icon").def()(function(){var t=this.extend({},this.ctx.icon);return t.block=t.block||"icon",t.mix=[{block:"menu",elem:"icon",elemMods:this.elemMods}].concat(t.mix),t.mods=this.extend({size:this.mods.size},t.mods),M(t)}),n("page-editor").elem("header")(f()([{elem:"title"},{elem:"actions"}])),n("page-editor").elem("title")(f()(function(){return{block:"m-replacer",mods:{type:"page-title"},content:this.ctx.title}}),p()({block:"w-getting-started",elem:"elem",elemMods:{"edit-basics":"2"}})),n("page-editor").elem("actions")(f()(function(){return{block:"radio-button",js:{id:"edit-action"},mix:{block:"b-editor-actions",js:!0},mods:{theme:"normal",size:"m"},name:"edit-action",value:"edit",content:[{elem:"radio",controlAttrs:{value:"edit"},content:BEM.I18N("page-editor","page_edit")},{elem:"radio",mix:{block:"w-getting-started",elem:"elem",elemMods:{"edit-basics":"4"}},controlAttrs:{value:"view"},content:BEM.I18N("page-editor","page_view")}]}})),n("page-editor").elem("topbar")(f()({block:"m-editor-buttons",mods:{type:"page-editor"}})),n("page-editor").elem("info")(_()(function(){return{block:"b-revision-info",content:{elem:"text",content:BEM.I18N("page-editor","page_update_warning")},mix:{block:this.block,elem:"info"}}})),n("page-editor").elem("editor")(p()({block:"w-getting-started",elem:"elem",elemMods:{"edit-formatting":"1"}})),n("page-editor").elem("editor").match(function(){return this.ctx.key}).content()(function(){return{block:"m-editor",mix:{block:"w-editor-suggest",js:{url:this["i-global"].hosts.suggest.url,layers:{people:{itemType:"staff",keywords:["@","staff:","кто:","укого:","ского:","кому:","кого:","кем:","ком:","оком:"],valueField:"login"}}}},mods:{type:"edit-page",split:!0},js:{drafts:{key:this.ctx.key+"#page-editor"},uploadParams:{reqParams:{type:"PUT",url:this.ctx.uploadUrl,xhrFields:{withCredentials:!0}},URLPath:"data.data.url"},forms:{apiUrl:this.ctx.formsApiUrl,adminUrl:this.ctx.formsAdminUrl,user:this.ctx.user},buttons:[["h2","h3"],["bold","italic","strikethrough"],["ul","ol"],["indent","outdent"],["quote","link","picture","video","code","table","readmore","help"],["form"]],virtualButtons:["underline"]}}}),n("page-editor").elem("editor").match(function(){return this.ctx.key}).content()(function(){return{block:"m-editor",mix:{block:"w-editor-suggest",js:{url:this["i-global"].hosts.suggest.url,layers:{people:{itemType:"b2b-people",keywords:["@","staff:","кто:","укого:","ского:","кому:","кого:","кем:","ком:","оком:"],valueField:"login"}},addRequestParams:{org_id:this["i-global"].orgId}}},mods:{type:"edit-page",split:!0},js:{drafts:{key:this.ctx.key+"#page-editor"},uploadParams:{reqParams:{type:"PUT",url:this.ctx.uploadUrl,xhrFields:{withCredentials:!0}},URLPath:"data.data.url"},buttons:[["h2","h3"],["bold","italic","strikethrough"],["ul","ol"],["indent","outdent"],["quote","link","code","table","readmore"]],virtualButtons:["underline"]}}}),n("page-editor").elem("preview")(f()(function(){return[{block:"spin2",mods:{size:"l",position:"center"}},{elem:"preview-content"}]})),n("page-editor").elem("bottombar")(f()(function(){var t=[{block:"button2",mix:{block:"b-editor-close-button",js:!0},tabindex:1,mods:{theme:"normal",size:"m",editor:"cancel"},text:BEM.I18N("page-editor","page_update_reject")},{block:"button2",mix:[{block:"b-readonly-item",js:!0},{block:"b-editor-save-button",js:!0},{block:"w-getting-started",elem:"elem",elemMods:{"edit-attaching":"3"}},{block:"w-getting-started",elem:"elem",elemMods:{"edit-basics":"3"}}],tabindex:0,mods:{size:"m",editor:"save",theme:"action"},text:BEM.I18N("page-editor","page_save")},{block:"spin2",mods:{size:"m",editor:"save"}}];return this.ctx.canSwitchWf&&(t=t.concat({block:this.block,elem:"wf-switcher",withNewWf:this.ctx.withNewWf})),t.concat({block:this.block,elem:"split-switcher"})})),n("page-editor").elem("wf-switcher")(f()(function(){return[{block:"tumbler",mods:{size:"m",theme:"normal",checked:this.ctx.withNewWf?"yes":""},content:{elem:"option",side:"left",content:BEM.I18N("page-editor","new_wf")}}]})),n("tumbler").elem("option").replace()(function(){return{elem:"label",tag:"span",elemMods:{side:this.ctx.side},content:{elem:"text",tag:"span",elemMods:{side:this.ctx.side},content:this.ctx.text||this.ctx.content}}}),n("tumbler").elem("text").attrs()(function(){var t=x()||{},e=this.elemMods.side;return t.id="left"===e?this._leftId:this._rightId,t["aria-hidden"]="true",t}),n("tumbler").elem("sticker").attrs()(function(){var t=x()||{};return t["aria-hidden"]="true",t}),n("page-editor").elem("split-switcher")(f()(function(){return{block:"tumbler",mods:{size:"m",theme:"normal"},content:{elem:"option",side:"left",content:BEM.I18N("page-editor","split_mode")}}})),n("tooltip").elem("close")(("undefined"!=typeof addAttrs?addAttrs:d)()({title:BEM.I18N("tooltip__close","close")})),n("input").elem("label")(l()("label"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{id:this._labelId,for:this._inputId,"aria-hidden":"true"}})),n("menu").elem("group")(e(function(){return this._inMenuTypeNavigation}).tag()("ul"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{role:"group"}}),e(function(){return this.ctx.title})(d()(function(){return this.extend(x(),{"aria-labelledby":this.generateId()})}),f()(function(){var t=this.ctx.title;return[{elem:"title",attrs:{id:this.generateId(),"aria-hidden":"true"},content:{html:this.isSimple(t)?this.xmlEscape(t):this.reapply(t)}},x()]}))),n("footer")(c()(function(){return x({_inFooter:!0})}),("undefined"!=typeof addJs?addMix:p)()(function(){return[{block:"clearfix"}]}),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{role:"contentinfo"}}),e(function(){return!this.ctx.content}).content()(function(){var t=this["i-services"],e=this.ctx.region,i=[],n=[];i.push({elem:"link",url:e?t.serviceUrl("mobile",e):BEM.I18N("footer","apps-url"),content:BEM.I18N("footer","apps")});var s=-1===this.ctx.tld.indexOf("com");return s&&n.push({elem:"link",url:e?t.serviceUrl("advertising",e)+"/kupislova.xml?advertising":BEM.I18N("footer","advert-url"),content:BEM.I18N("footer","advert")}),s&&this.ctx.statUrl&&n.push({elem:"link",url:this.ctx.statUrl,content:BEM.I18N("footer","stat")}),n.push({elem:"link",url:e?t.serviceUrl("legal",e)+"/termsofuse":BEM.I18N("footer","termsofuse-url"),content:BEM.I18N("footer","termsofuse")}),n.push({elem:"link",url:e?t.serviceUrl("company",e):BEM.I18N("footer","about-url"),content:BEM.I18N("footer","about")}),n.push({block:"copyright",elemLinkMix:{block:this.block,elem:"link"},start:this.ctx.start}),[{elem:"column",content:i},{elem:"column",elemMods:{side:"right"},content:n}]})),n("copyright")(o("wrapLink")(function(){var t=this.ctx;return{block:"i-bem",elem:"i18n",keyset:"copyright",key:"link",content:{block:"copyright",elem:"link",mix:t.elemLinkMix,url:void 0===t.url?this["i-services"].serviceUrl("www"):t.url}}}),f()(function(){return["© ",{elem:"dates",start:this.ctx.start},"  ",this.ctx.content||E("wrapLink")]})),n("copyright").elem("link")(l()(!1),e(function(){return this.ctx.url})(l()("a"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{href:this.ctx.url}})),f()(function(){return this.ctx.content||BEM.I18N("copyright","yandex")})),n("copyright").elem("dates")(l()("span"),f()(function(){var t=this.ctx.start,e=(new Date).getFullYear();return[t&&t!==e&&t+"–",e]})),n("b-link")(l()("a"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t=this.ctx,e={href:this.isSimple(t.url)?t.url:this.reapply(t.url)};return["title","target"].forEach(function(i){t[i]&&(e[i]=t[i])}),e})),n("wiki-ticket").elem("issue").def()(function(){var t=this.ctx["wiki-attrs"]&&this.ctx["wiki-attrs"].status;return M({block:"b-link",url:this.ctx.url,mix:[{block:"wiki-ticket",elem:"issue"}],content:"Closed"==t?{block:"wiki-strike",content:this.ctx.content}:this.ctx.content})}),n("b-menu").elem("title").tag()("h2"),n("b-link").match(function(){return this.mods.pseudo})(l()(function(){return this.ctx.url?"a":"span"}),("undefined"!=typeof addJs?addJs:u)()(!0),d().match(function(){return!this.ctx.url})(function(){return{}}),f().match(function(){return!this.ctx._wrap}).match(function(){return!this.mods.inner})(function(){return{html:this.reapply({block:this.block,elem:"inner",content:this.ctx.content,_wrap:!0})}})),n("b-link").elem("inner").tag()("span"),n("wiki-headcut").elem("head").def()(function(){return M({block:"wiki-head","wiki-attrs":this.ctx["wiki-attrs"],content:[{block:"link",mods:{pseudo:"yes",theme:"pseudo"},mix:[{block:"wiki-headcut",elem:"head"}],content:this.ctx.content}]})}),n("wiki-question").tag()("span"),n("b-popupa").elem("tail").tag()("i"),n("tabs-panes").elem("pane")["undefined"!=typeof addAttrs?"addAttrs":"attrs"]()(function(){return{role:"tabpanel","aria-labelledby":this._tabsPanesId+"-tab-"+(this.position-1),"aria-expanded":String(Boolean(this.elemMods.active))}}),n("m-head-services").elem("icon")(l()("i"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{style:"background-image: url(data:image/svg+xml;base64,"+this.ctx.icon+")"}})),n("notifier").elem("icon")(f()(function(){return{tag:"svg",attrs:{xmlns:"http://www.w3.org/2000/svg",width:21,height:21,viewbox:"0 0 21 21",overflow:"visible"},content:[{elem:"bell",tag:"path",attrs:{d:"M0 18v-2l3-2V8c.21-3.154 2.41-5.67 5.5-6.5V0h4v1.5c3.09.83 5.304 3.346 5.5 6.5v6l3 2v2H0z"}},{tag:"path",attrs:{d:"M10.5 21a2.5 2.5 0 0 0 2.5-2.5l.004-2.5H8v2.5a2.5 2.5 0 0 0 2.5 2.5z"}}]}})),n("header2")(("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{role:"banner"}}),e(function(){return void 0===this.ctx.content}).content()(function(){var t=this.ctx;return[{elem:"main",content:[t.logo,{elem:"left",content:t.left},t.right&&{elem:"right",content:t.right}]},t.under&&{elem:"under",content:t.under}]}),s("logo").content()(function(){return this.ctx.serviceLogo?[].concat(x(),{block:"icon",mix:[{block:"header2",elem:"logo"},{block:"logo",mods:{service:"yes"}}]}):x()})),n("header2").elem("menu-item").content()(function(){return{block:"link",url:this.ctx.url,content:this.ctx.name}}),n("header2").elem("gap").tag()("span"),n("logo").tag()("span"),n("search2")(l()("form"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{role:"search",action:this.ctx.url,"aria-label":this.ctx.label}}),e(function(){return!this.ctx.content})(f()(function(){return[{elem:"input",content:this.ctx.input},{elem:"button",content:this.ctx.button},this.ctx.hidden&&Object.keys(this.ctx.hidden).map(function(t){return{elem:"hidden",attrs:{name:t,value:this.ctx.hidden[t]}}},this)]}))),n("services-table").elem("item")(l()("li"),e(function(){return!this.ctx.content}).content()(function(){return{block:"service",service:this.ctx.service,urlAttrs:{target:this.ctx.prefsTarget},serviceIconMods:this.ctx.serviceIconMods}})),n("service")(c()(function(){var t=this.ctx;return x({_url:!1!==t.url&&(t.url||this["i-services"].serviceUrl(t.service)),_icon:!1!==t.icon,_name:!1!==t.name})}),f().match(function(){return this._url})(function(){return{elem:"url",url:this._url,urlParams:this.ctx.urlParams||"",urlAttrs:this.ctx.urlAttrs,counter:this.ctx.counter,content:x({_url:!1})}}),f().match(function(){return!this._url})(function(){var t=[];return this._icon&&t.push({elem:"icon",service:this.ctx.service,elemMods:this.ctx.iconMods,serviceIconMods:this.ctx.serviceIconMods}),this._name&&t.push({elem:"name",service:this.ctx.service,name:this.ctx.name}),t})),n("service")(f().match(function(){return!this._url})(function(){var t=[];return this._icon&&t.push({elem:"icon",service:this.ctx.service,elemMods:this.ctx.iconMods,serviceIconMods:this.ctx.serviceIconMods,icon:this.ctx.icon}),this._name&&t.push({elem:"name",service:this.ctx.service,name:this.ctx.name}),t})),n("service").elem("name")(l()("span"),f()(function(){var t=this.ctx,e=t.service;return t.name||this["i-services"].serviceName(e)||e})),n("service").elem("url")(l()("a"),("undefined"!=typeof addJs?addMix:p)()(function(){return[{block:"link",mods:{theme:"normal"}}]}),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t=this.ctx.urlAttrs||{};return t.href=this.ctx.url+this.ctx.urlParams,this.ctx.counter&&(t.onmousedown=this.ctx.counter),t}),f()(function(){return this.ctx.content})),n("service").elem("icon")(l()("span"),("undefined"!=typeof addJs?addMix:p)()(function(){return[{block:"service-icon",elem:this.ctx.service,elemMods:this.ctx.serviceIconMods||this.elemMods}]})),n("service").elem("icon")(d()(function(){return this.ctx.icon?{style:"background: url("+this.ctx.icon+"); background-size: contain; background-position: center; background-repeat: no-repeat;"}:null})),n("services-table").elem("all").replace()(function(){return{elem:"footer",tag:"li",content:{block:"button2",mods:{theme:"pseudo",size:"m",type:"link"},mix:{block:"services-table",elem:"all"},url:this["i-services"].serviceUrl("all"),text:this["i-services"].serviceName("all")}}}),n("user2").elem("enter").replace()(function(){var t=BEM.I18N("user2","enter"),e=this._params,i=e.passportHost+"/auth?retpath="+e.retpathEncoded;return""!==e.passportLinkParams&&(i+="&"+e.passportLinkParams),[{block:"button2",mods:{size:"m",theme:"pseudo",type:"link"},mix:{block:"user2",elem:"enter"},url:i,tabindex:"-1",iconLeft:{mix:{block:"user2",elem:"enter-icon"}},title:t,text:t}]}),n("user2").elem("current-account").replace()(function(){var t=!1!==this.ctx.avatarId&&"yes",e=this._params.passportHost;return""!==this._params.passportLinkParams&&(e+="?"+this._params.passportLinkParams),this.util.mergeBemjson({block:"user-account",mix:{block:"user2",elem:"current-account",elemMods:this.elemMods},mods:{"has-ticker":t,"has-accent-letter":"yes",provider:this.ctx.provider},name:this.ctx.name,maxLength:this.ctx.maxLength,subname:this.ctx.subname,url:e,ticker:t?{count:this.ctx.unreadCount}:void 0,pic:!1===this.ctx.avatarId?void 0:{avatarId:this.ctx.avatarId,plus:this.ctx.plus},avatarHost:this.ctx.avatarHost},this._params.userAccount)}),n("user-account").elem("pic").match(function(){return this.ctx.pic}).replace()(function(){return this.util.mergeBemjson({block:"user-pic",mods:{provider:this.ctx.provider},host:this.ctx.avatarHost,mix:{block:"user-account",elem:"pic",elemMods:this.elemMods}},this.ctx.pic)}),n("user-pic")(c()(function(){return this.ctx.plus&&(this.mods["has-plus"]="yes"),this.ctx.camera&&(this.mods["has-camera"]="yes"),x()}),o("avatar-url")(function(){var t=this.ctx.host||"https://avatars.mds.yandex.net",e=this.ctx.avatarId||"0/0-0";return{lodpiUrl:t+"/get-yapic/"+e+"/islands-middle",hidpiUrl:t+"/get-yapic/"+e+"/islands-retina-middle"}}),e(function(){return void 0===this.ctx.content}).content()(function(){var t=E("avatar-url");return{elem:"image",tag:"img",attrs:{src:t.lodpiUrl,srcset:t.lodpiUrl+" 1x, "+t.hidpiUrl+" 2x"}}})),n("user-account").elem("name")(l()("span"),e(function(){return void 0===this.ctx.content&&this.ctx.text}).content()(function(){return{html:this.xmlEscape(this.ctx.text)}})),n("user-account").elem("ticker").replace()(function(){return this.util.mergeBemjson({block:"ticker",mix:{block:"user-account",elem:"ticker",elemMods:this.elemMods}},this.ctx.ticker)}),n("ticker").elem("count")(l()("span"),e(function(){return!this.ctx.url})["undefined"!=typeof addJs?"addMix":"mix"]()(function(){return[{elem:"plain"}]}),e(function(){return this.ctx.url})(l()("a"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{href:this.ctx.url}})),f()(function(){return[{elem:"text"},{elem:"value",count:this.ctx.content}]})),n("ticker").elem("text")(l()("span"),("undefined"!=typeof addJs?addMix:p)()(function(){return[{block:"a11y-hidden"}]}),f()(function(){return BEM.I18N("ticker__text","notifications")})),n("ticker").elem("value")(l()("span"),o("format-value")(function(){return this._count>this._maxCount?this._maxCount:this._count}),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{title:this._count}}),f()(function(){return E("format-value")})),n("user2").elem("popup").replace()(function(){var t=this.ctx;return t.block="light-popup",t.mods={autoclosable:"yes",animated:"yes"},t.mix=[{block:"user2",elem:"popup",elemMods:t.elemMods}].concat(t.mix||[]),t.js=this.extend(t.js,{moved:!0}),delete t.elem,t}),n("user2").elem("menu")(e(function(){return void 0!==this.ctx.hat}).mode("hat")(function(){var t=this.ctx.hat;return!t.banner&&(t.banner={}),t.banner.closeButtonMix={block:"user2",elem:"hat-closer"},{block:"user2",elem:"menu-hat",content:t}}),o("menu-group")(function(){var t=function(e){return[].concat.apply([],e.map(function(e){return e.items?t(e.items):(e.block="user2",e.elem="menu-item",e.action&&(e.elemMods=this.extend(e.elemMods,{action:e.action})),e)},this))}.bind(this),e=this.ctx.actionsMenu||[],i=this.ctx.multiAuthMenu||[],n=[].concat(e,i);return{block:"menu",elem:"group",content:t(n)}}),o("organizations")(function(){if("yes"===this._user2Mods["with-organizations"])return{block:"user2",elem:"organizations",organizations:this.ctx.organizations?this.ctx.organizations[this._params.uid]:[],currentOrgId:this.ctx.currentOrgId}}),_()(function(){return{block:"menu",mix:[{block:"user2",elem:"menu",elemMods:this.ctx.elemMods}].concat(this.ctx.mix||[]),mods:this.extend({type:"navigation"},this.ctx.elemMods),attrs:this.ctx.attrs,content:this.ctx.content||[E("hat"),{block:"user2",elem:"menu-header",content:{block:"user-account",mods:{provider:this.ctx.provider},mix:{block:"user2",elem:"account"},name:this._params.name,maxLength:this._params.maxLength,subname:this._params.subname,avatarHost:this._params.avatarHost,pic:{avatarId:this._params.avatarId,origin:this.ctx.origin||"authchooser",camera:this.ctx.camera}}},E("organizations"),E("menu-group"),{block:"user2",elem:"multi-auth",addAccount:this.ctx.addAccount,accounts:this.ctx.accounts,avatarHost:this.ctx.avatarHost,maxLength:this.ctx.maxLength,provider:this.ctx.provider},{block:"user2",elem:"menu-footer",settingsUrl:this.ctx.settingsUrl,settingsLinkTarget:this.ctx.settingsLinkTarget,helpUrl:this.ctx.helpUrl,helpLinkTarget:this.ctx.settingsLinkTarget}]}})),n("user2").elem("multi-auth").content()(function(){return this.ctx.content||[{elem:"accounts",addAccount:this.ctx.addAccount,accounts:this.ctx.accounts,avatarHost:this.ctx.avatarHost,maxLength:this.ctx.maxLength,provider:this.ctx.provider},this.ctx.menu&&this.ctx.menu.length?{block:"menu",elem:"group",content:this.ctx.menu}:""]}),n("user2").elem("menu-item").replace()(function(){var t=this.extend(this.ctx,{block:"menu",elem:"item"});return t.mix=[{block:"user2",elem:"menu-item",elemMods:{action:this.elemMods.action}}].concat(this.ctx.mix||[]),delete this.elemMods.action,t.elemMods=this.extend({type:"link"},this.elemMods),t.attrs=this.extend(t.attrs||{},{tabindex:0}),t.content=this.ctx.content,t}),n("user2").elem("menu-item").elemMod("action","edit-accounts").def()(function(){return this.ctx.text=BEM.I18N("user2","edit-accounts"),this.ctx.url=this._params.passportHost+"/auth?mode=edit&retpath="+this._params.retpathEncoded,""!==this._params.passportLinkParams&&(this.ctx.url+="&"+this._params.passportLinkParams),x()}),n("user2").elem("menu-item").elemMod("action","exit").def()(function(){return this.ctx.text=BEM.I18N("user2","exit"),this.ctx.url=this._exitUrl,""!==this._params.passportLinkParams&&(this.ctx.url+="&"+this._params.passportLinkParams),x()}),n("user2").elem("menu-counter")(c()(function(){return x({params:{maxCount:this.ctx.maxCount||9999}})}),l()("span"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{role:"alert"}}),e(function(){return 0===this.ctx.count})["undefined"!=typeof addJs?"addMix":"mix"]()([{elemMods:{state:"empty"}}]),f()(function(){return this.ctx.count>this.params.maxCount?this.params.maxCount:this.ctx.count})),n("user2").elem("menu-item").elemMod("action","passport").def()(function(){return this.ctx.text=BEM.I18N("user2","passport"),this.ctx.url=this._params.passportHost,""!==this._params.passportLinkParams&&(this.ctx.url+="?"+this._params.passportLinkParams),x()}),n("user2").elem("menu-item").elemMod("action","plus").def()(function(){var t=this.ctx.plus,e="string"==typeof this.ctx.plusLinkParams?this.ctx.plusLinkParams:"";return this.ctx.url=this.ctx.url||this["i-services"].serviceUrl("plus")+e,t&&(this.ctx.target="_blank",this.ctx.mix=[].concat(this.ctx.mix,{block:"user2",elem:"menu-item",elemMods:{"plus-icon":"yes"}})),this.ctx.content=this.ctx.content||[t&&{block:"user2",elem:"plus-badge"},{block:"menu",elem:"text",content:BEM.I18N("user2",t?"ya_plus_on":"ya_plus")}],x()}),n("user2").elem("plus-badge")(l()("span")),n("icon").mod("glyph","x-sign").content()(function(){return{html:'<svg focusable="false" width="0" height="0" viewBox="0 0 20 20"><path d="M10,20 C4.5,20 0,15.5 0,10 C0,4.5 4.5,0 10,0 C15.5,0 20,4.5 20,10 C20,15.5 15.5,20 10,20 L10,20 L10,20 L10,20 Z M15,6.4 L13.6,5 L10,8.6 L6.4,5 L5,6.4 L8.6,10 L5,13.6 L6.4,15 L10,11.4 L13.6,15 L15,13.6 L11.4,10 L15,6.4 L15,6.4 L15,6.4 L15,6.4 Z"/></svg>'}}),n("user2").elem("accounts").match(function(){return void 0===this.ctx.content}).content()(function(){return[{elem:"accounts-container",content:[].concat(this.ctx.accounts).map(function(t){return{block:"menu",elem:"item",content:this.extend({mods:{provider:this.ctx.provider},avatarHost:this.ctx.avatarHost,maxLength:this._params.maxLength},t)}},this)},{block:"user2",elem:"add-account",account:this.ctx.addAccount}]}),n("user2").elem("add-account").replace()(function(){var t=this._params.passportHost+"/auth?mode=add-user&retpath="+this._params.retpathEncoded;""!==this._params.passportLinkParams&&(t+="&"+this._params.passportLinkParams);var e=this.util.mergeBemjson({block:"user-account",name:BEM.I18N("user2","add-account"),url:t,mix:{block:"user2",elem:"add-account"}},this.ctx.account);return e.content=void 0!==e.content?e.content:[{elem:"pic"},{elem:"name",text:e.name}],{block:"menu",elem:"item",content:e}}),n("user-account").elem("subname")(l()("span"),f().match(function(){return void 0===this.ctx.content&&this.ctx.text})(function(){return{html:this.xmlEscape(this.ctx.text)}})),n("user-organization").elem("pic")(c()(function(){return x()}),o("default-logo")("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='43' height='31' viewBox='0 0 43 31' fill='none'%3E%3Cpath fill='%23DADADA' d='M6.25.6h30v20h-30z'/%3E%3Cpath fill='%23979797' fill-rule='evenodd' d='M6.25 20.6h30v5H0l6.25-5z' clip-rule='evenodd'/%3E%3Cpath fill='%23C6C6C6' d='M13.75 10.6h22.5v15h-22.5z'/%3E%3Cpath fill='%23979797' fill-rule='evenodd' d='M13.75 25.6h22.5l6.25 5H13.75v-5z' clip-rule='evenodd'/%3E%3C/svg%3E%0A"),e(function(){return void 0===this.ctx.content}).content()(function(){return{elem:"image",tag:"img",attrs:{src:this.ctx.logo||E("default-logo")}}})),n("user-organization").elem("name")(l()("span"),e(function(){return void 0===this.ctx.content&&this.ctx.text}).content()(function(){return{html:this.xmlEscape(this.ctx.text)}})),n("user2").elem("add-organization")(p()({block:"menu",elem:"item"}),l()("a"),d()(function(){return{href:this._params.addOrganizationUrl}}),f()(function(){return[{tag:"span",elem:"add-org-pic"},{elem:"add-org-name",tag:"span",content:BEM.I18N("user2","add-organization2")}]})),n("icon").mod("glyph","type-arrow").content()({html:'<svg width="0" height="0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 13 8"><path d="M11.3 1L6.5 5.7 1.7 1l-.7.7L6.5 7 12 1.7l-.7-.7z"/></svg>'}),n("icon").mod("size","xs").mod("glyph","type-arrow").content()({html:'<svg focusable="false" width="0" height="0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 11 7"><path d="M9.25 1L5.5 4.6 1.75 1 1 1.72 5.5 6 10 1.72 9.25 1z"/></svg>'}),n("b-page").elem("edit-special").content()(function(){return[{block:"button2",mods:{type:"link",theme:"normal",size:"m"},text:BEM.I18N("w-page-panel","edit"),url:"/homepage/.edit"},{block:"button2",mods:{type:"link",theme:"normal",size:"m",role:"subpage"},text:BEM.I18N("b-page-more-panel","create_page"),url:"/homepage/.create"}]}),b(function(){!function(t,e){if(!e.I18N){t.BEM=e;var i=e.I18N=function(t,e){return e};i.keyset=function(){return i},i.key=function(t){return t},i.lang=function(){}}}(this,"undefined"==typeof BEM?{}:BEM)}),n("awesome-icon").tag()("span"),b(function(t){var e=Object.prototype.toString;function i(t){return"object"==typeof t&&"[object Object]"===e.call(t)}function n(t,e,s){var o,r;for(o in t=Object(t),e=Object(e))"__proto__"!==o&&"prototype"!==o&&"constructor"!==o&&(void 0!==(r=s&&s(t[o],e[o],o))?t[o]=r:i(t[o])&&i(e[o])?t[o]=n(t[o],e[o],s):t[o]=e[o]);return t}t.BEMContext.prototype.util.merge=n,t.BEMContext.prototype.util.mergeBemjson=function(t,e){return n(t,e,function(t,e,i){if("mix"===i)return[].concat(t,e)})}}),n("icon").mod("glyph","carets-v").content()({html:'<svg focusable="false" xmlns="http://www.w3.org/2000/svg" width="0" height="0" viewBox="0 0 8 14"><path d="M4 0l4 6H0l4-6zm0 14l4-6H0l4 6z"/></svg>'}),n("b-event").elem("action").elemMod("type","change-owner").content()(function(){var t=this.ctx.data,e=this.ctx.theme;return[{block:"i-bem",elem:"i18n",keyset:"b-events-log",key:"change_owner",content:{block:"b-event",elem:"user",theme:e,login:t.previous_owner}},{block:"b-event",elem:"user",theme:e,login:t.new_owner}]}),n("textinput").elem("clear").elemMod("theme","normal")(o("icon-type")("cross")),n("select").elem("item").match(function(){return this.elemMods.label}).attrs()(function(){var t=x()||{};return this._labelId&&(t.id=this._labelId),t["aria-hidden"]="true",t}),n("b-menu").mod("layout","vert")(f()(function(){return[this.ctx.title,{elem:"layout-vert",content:this.ctx.content}]}),s("layout-vert").tag()("ul"),s("item").wrap()(function(){var t=this.ctx.position;return{elem:"layout-vert-cell",elemMods:t?{position:t}:{},content:this.ctx}}),s("separator").wrap()(function(){return{elem:"layout-vert-separator",content:this.ctx}}),s("layout-vert-cell").tag()("li"),s("layout-vert-separator").tag()("li")),n("header2").elem("logo").elemMod("preset","ru").replace()(function(){var t=this.util.mergeBemjson({elemMods:{size:"m"},content:{block:"logo",mods:{type:"link",name:"ru-84x36"},tabindex:-1}},this.ctx);return delete t.elemMods.preset,t}),n("logo").mod("type","link")(l()("a"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t=this.ctx;return{href:void 0===t.url?this["i-services"].serviceUrl("www"):t.url,title:t.title,tabindex:t.tabindex}}),f()(function(){return void 0===this.ctx.text?BEM.I18N("logo_type_link","yandex"):{html:this.xmlEscape(this.ctx.text)}})),n("header2").elem("logo").elemMod("preset","en").replace()(function(){var t=this.util.mergeBemjson({elemMods:{size:"m"},content:{block:"logo",mods:{type:"link",name:"en-84x36"},tabindex:-1}},this.ctx);return delete t.elemMods.preset,t}),n("input").mod("theme","websearch")(e(function(){return this.ctx.filter}).def()(function(){return x({_filter:this.ctx.filter})}),s("box").match(function(){return this._filter}).wrap()(function(){return[this.util.mergeBemjson({mix:{block:"input",elem:"filter"}},this._filter),this.ctx]})),n("user-pic").mod("has-camera","yes").match(function(){return!this.ctx.avatarId||"0/0-0"===this.ctx.avatarId})(u()(function(){return{origin:this.ctx.origin}}),f()(function(){return[x(),{elem:"camera"}]})),n("menu").elem("item").elemMod("type","link")(l()("a"),d()(function(){return this.extend(x(),{role:"link",href:this.ctx.url,target:this.ctx.target})})),b(function(t){var e=t.BEMContext.prototype,i=t["i-global"]=e["i-global"]=e.extend({lang:"ru",tld:"ru","content-region":"ru","click-host":"//clck.yandex.ru","passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","social-host":"https://social.yandex.ru","export-host":"https://export.yandex.ru",login:"","lego-static-host":"https://yastatic.net/lego/2.10-142"},e["i-global"]);i._public={id:!0,lang:!0,tld:!0,"content-region":!0,"user-region":!0,login:!0,displayName:!0,index:!0,yandexuid:!0,"passport-host":!0,"pass-host":!0,"passport-msg":!0,"static-host":!0,"lego-static-host":!0,"social-host":!0,clck:!0,"click-host":!0,"export-host":!0,"i-host":!0,"social-retpath":!0,"lego-path":!0,sid:!0,retpath:!0,uid:!0},i.makePublic=function(t,n){"object"!=typeof t?(void 0===n&&(n=!0),i._public[t]=n):i._public=e.extend(i._public,t)},i.isPublic=function(t){return Boolean(i._public[t])},i.setTld=function(t){var e="tr"===t?"yandex.com.tr":"yandex."+t,n=-1!==["ua","by","kz"].indexOf(t)?"yandex.ru":e;i.tld=t,i["content-region"]=t,i["click-host"]="//clck."+n,i["passport-host"]="https://passport."+n,i["pass-host"]="https://pass."+e,i["social-host"]="https://social."+e,i["export-host"]="https://export."+e},e._iGlobalBackup={_backup:null,exists:function(){return Boolean(this._backup)},save:function(){this._backup=e.extend({},i)},restore:function(){var t;for(t in i)delete i[t];for(t in this._backup)i[t]=this._backup[t]}}}),n("i-global")(l()(""),c()(function(){var t=this.ctx.params||{},e=this["i-global"];for(var i in this._iGlobalBackup.exists()?!1!==this.ctx.reset&&this._iGlobalBackup.restore():this._iGlobalBackup.save(),t.tld&&t.tld!==e.tld&&e.setTld(t.tld),t)e[i]=t[i];return""})),b(function(t){t["i-global"].makePublic("hosts"),t["i-global"].makePublic("secretkey"),t["i-global"].makePublic("force_desktop"),t["i-global"].makePublic("page_data"),t["i-global"].makePublic("hostname"),t["i-global"].makePublic("userSettings"),t["i-global"].makePublic("forceOldWf"),t["i-global"].makePublic("forceNewWf"),t["i-global"].makePublic("orgId")}),n("i-ua")(m()(!1),l()("script"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{nonce:this.ctx.nonce||this["i-global"].nonce}}),f()(function(){return[{html:[";(function(d,e,c,r){","e=d.documentElement;",'c="className";','r="replace";','e[c]=e[c][r]("i-ua_js_no","i-ua_js_yes");','if(d.compatMode!="CSS1Compat")','e[c]=e[c][r]("i-ua_css_standart","i-ua_css_quirks")',"})(document);"].join("")}]})),n("i-metrica").js()(!0),n("b-page").elem("js")(m()(!1),l()("script"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{src:this.ctx.url,nonce:this.ctx.content?this.ctx.nonce||this["i-global"].nonce:null}})),n("b-page").elem("css")(c()(function(){return x()}),m()(!1),l()("style"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{nonce:this.ctx.nonce||this["i-global"].nonce}}),_().match(function(){return void 0!==this.ctx.ie})(e(function(){return!1===this.ctx.ie})(function(){return{elem:"cc",condition:"gt IE 9",others:!0,content:{elem:"css",url:this.ctx.url,content:this.ctx.content}}}),e(function(){return"string"==typeof this.ctx.ie})(function(){return{elem:"cc",condition:this.ctx.ie,others:this.ctx.ie.indexOf("!")>-1,content:{elem:"css",url:this.ctx.url,content:this.ctx.content}}})),e(function(){return this.ctx.url})(l()("link"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{rel:"stylesheet",href:this.ctx.url}}))),n("popup2")(c()(function(){return void 0===this.mods.view&&(this.mods.view="classic"),x()}),("undefined"!=typeof addJs?addJs:u)()(function(){var t=this.ctx;return{mainOffset:t.mainOffset,secondaryOffset:t.secondaryOffset,viewportOffset:t.viewportOffset,tailOffset:t.tailOffset,tailSize:t.tailSize,directions:t.directions,zIndexGroupLevel:t.zIndexGroupLevel}}),e(function(){return this.ctx.hasTail}).content()(function(){var t=this.ctx,e=[].concat(t.content);return[].concat({elem:"tail"},e)})),n("w-promo-slider")(s("slide")(f()(function(){this.ctx.data;return[{block:"w-promo-slider",elem:"slide-img",elemMods:{index:this.ctx.index}},{block:"w-promo-slider",elem:"slide-text",content:[{block:"w-promo-slider",elem:"slide-caption",content:BEM.I18N("w-getting-started","promo-"+this.ctx.index+"-caption")},{block:"w-promo-slider",elem:"slide-description",content:BEM.I18N("w-getting-started","promo-"+this.ctx.index+"-str")}]}]}))),n("modal")(("undefined"!=typeof addJs?addJs:u)()(!0),("undefined"!=typeof addJs?addMix:p)()(function(){return{block:"popup2",js:{zIndexGroupLevel:this.ctx.zIndexGroupLevel||20},mods:{autoclosable:this.mods.autoclosable}}}),f()(function(){return{elem:"table",content:{elem:"cell",content:{elem:"content",content:this.ctx.content}}}})),n("sidebar").def()(function(){var t=this.mods;return t.state||(t.state="close"),this.ctx.selected&&(t.selected=this.ctx.selected),this.ctx.tabs||(this.ctx.tabs=[]),x()}),n("sidebar")(u()(function(){return this.ctx.js||!0}),f()(function(){return[{elem:"tabs",tabs:this.ctx.tabs,selected:this.ctx.selected},{elem:"content-container",mix:[{block:"w-getting-started",elem:"elem",elemMods:{"edit-attaching":"2"}}],content:{block:"sidebar",elem:"tab-content",elemMods:{tab:this.ctx.selected},preLoad:this.ctx.preLoad,redirect:this.ctx.redirect}},{block:"sidebar",elem:"loader"}]})),n("sidebar").elem("tabs")(l()("ul"),f()(function(){return[this.ctx.tabs.map(function(t){return{elem:"tab",mix:["events"===t&&{block:"w-getting-started",elem:"elem",elemMods:{"sidebar-revisions":"1"}}],elemMods:{type:t,selected:t===this.ctx.selected?"yes":""}}},this),{elem:"close"}]})),n("sidebar").elem("tab")(l()("li"),f()(function(){return[{block:"awesome-icon",attrs:{title:this._label},mods:{icon:this._icon}}]})),n("sidebar").elem("tab").elemMod("type","cluster-tree").def()(function(){return x({_label:BEM.I18N("sidebar","cluster-tree-label"),_icon:"sitemap"})}),n("sidebar").elem("tab").elemMod("type","files").def()(function(){return x({_label:BEM.I18N("sidebar","files-label"),_icon:"paperclip"})}),n("sidebar").elem("tab").elemMod("type","events").def()(function(){return x({_label:BEM.I18N("sidebar","events-label"),_icon:"clock-o"})}),n("sidebar").elem("tab").elemMod("type","hotkeys").def()(function(){return x({_label:BEM.I18N("sidebar","hotkeys-label"),_icon:"question-circle"})}),n("sidebar").elem("tab").elemMod("type","grid-code").def()(function(){return x({_label:BEM.I18N("sidebar","grid-code-label"),_icon:"code"})}),n("sidebar").elem("tab").elemMod("type","grid-settings").def()(function(){return x({_label:BEM.I18N("sidebar","grid-settings-label"),_icon:"cogs"})}),n("b-toc")(i()(function(){var t=this.mods,e=this.ctx,i=this.ctx.data;return i?(i.content[0].mods={type:"sidebar"},e.content=i):t.load="yes",e}),u()(function(){return this.ctx.js||!0})),n("wiki-toc").def().match(function(){return!this.ctx._wrap})(function(){return this._toc=this.ctx["wiki-attrs"]&&this.ctx["wiki-attrs"].page?this.ctx["wiki-attrs"].page:"",M([{html:"\x3c!--dynamic action--\x3e"},{bem:!1,tag:"div",content:[{block:"wiki-toc",mods:this.ctx.mods||{},tag:"fieldset",js:!0,_wrap:!0,content:[{elem:"title",content:[this._helper[this.wiki.lang].txt.contents,this.ctx["wiki-attrs"]&&(this.ctx["wiki-attrs"].page||this.ctx["wiki-attrs"].title)&&[{html:"&#160;"},{block:"b-link",url:this.ctx["wiki-attrs"].page||"#",content:this.ctx["wiki-attrs"].title||this.ctx["wiki-attrs"].page}]]}].concat(this.ctx.content)}]},{html:"\x3c!--/dynamic action--\x3e"}])}),n("wiki-toc").elem("title").tag()("legend"),n("w-toc")(u()(!0),f()(function(){return this.ctx.toc.map(function(t){return{elem:"item",data:t}})})),n("link")(c()(function(){this.mods;var t=this.ctx.url;return void 0===this.ctx.tabindex&&(this.ctx.tabindex="0"),this._url=this.isSimple(t)?t:this.reapply(t),x()}),l()(function(){return void 0!==this._url?"a":"span"}),("undefined"!=typeof addJs?addJs:u)()(function(){return{_tabindex:this.mods.disabled?this.ctx.tabindex:void 0}}),e(function(){return"_blank"===this.ctx.target}).attrs()(function(){var t=this.ctx.attrs,e=void 0!==Object(t).rel?String(t.rel):"";return e&&-1===e.indexOf("noopener")&&(t.rel=e+" noopener"),this.extend({rel:"noopener"},x())}),d()(function(){var t=this.ctx,e=this._url,i=void 0!==e,n=Boolean(this.mods.disabled),s=n?i&&-1:t.tabindex;return this.extend(x(),{id:t.id,name:t.name,title:t.title,target:t.target,tabindex:s,href:e,role:i?void 0:"button","aria-disabled":n?"true":void 0})}),e(function(){return void 0===this.ctx.content}).content()(function(){var t,e=this.ctx,i=Boolean(e.text),n=[e.icon,e.iconLeft,e.iconRight].filter(Boolean),s=n.length>0,o=i||n.length>1,r=(t=this.xmlEscape,function(e){return"string"==typeof e?{html:t(e)}:e});return[e.icon&&this.util.mergeBemjson({block:"icon",mix:{block:"link",elem:"icon",elemMods:{side:o?"left":""}}},e.icon),e.iconLeft&&this.util.mergeBemjson({block:"icon",mix:{block:"link",elem:"icon",elemMods:{side:o?"left":""}}},e.iconLeft),i&&(this.isSimple(e.text)?s?{elem:"inner",content:r(e.text)}:r(e.text):e.text.block?this.util.mergeBemjson({mix:{block:"link",elem:"inner"}},e.text):this.extend({block:"link",elem:"inner"},e.text)),e.iconRight&&this.util.mergeBemjson({block:"icon",mix:{block:"link",elem:"icon",elemMods:{side:o?"right":""}}},e.iconRight)]}),s("inner").tag()("span")),n("link").match(function(){return!this.mods.theme}).def()(function(){return x({"mods.theme":"normal"})}),n("link").match(function(){return"string"==typeof this.ctx.content}).content()(function(){return this.xmlEscape(this.ctx.content)}),n("sidebar").elem("tab-content").elemMod("tab","hotkeys").content()({block:"editor-help",mods:{type:"sidebar",theme:"dark"}}),n("editor-help")(u()(function(){return this.ctx.js||!0}),f()(function(){return[{elem:"group",title:BEM.I18N("editor-help","manual-title"),content:[{elem:"items-list",items:[{url:"/wiki/vodstvo/syntax/",text:BEM.I18N("editor-help","full-syntax-link")},{url:"/wiki/vodstvo/tables/",text:BEM.I18N("editor-help","tables-syntax-link")},{url:"/wiki/vodstvo/actions/",text:BEM.I18N("editor-help","actions-list-link")},{url:"/wiki/vodstvo/formatters/code/",text:BEM.I18N("editor-help","highlighting-link")}]}]},{elem:"syntax"},{elem:"hotkeys"}]}),s("items-list")(l()("ul"),f()(function(){return this.ctx.items.map(function(t){return{elem:"list-item",content:{block:"link",mods:{theme:this.mods.theme},url:t.url,target:"_blank",title:t.text,content:t.text}}},this)})),s("list-item").tag()("li"),s("syntax-code").tag()("span")),n("editor-help").elem("group").content()(function(){return[{elem:"group-title",content:this.ctx.title},x()]}),n("editor-help")(f()(function(){return[{elem:"group",title:BEM.I18N("editor-help","manual-title"),content:[{elem:"items-list",items:[{url:"/sandbox",text:BEM.I18N("editor-help","full-syntax-link")},{url:"/sandbox/tables",text:BEM.I18N("editor-help","tables-syntax-link")},{url:"/sandbox/actions",text:BEM.I18N("editor-help","actions-list-link")},{url:"/sandbox/formatters/code",text:BEM.I18N("editor-help","highlighting-link")}]}]},{elem:"syntax"},{elem:"hotkeys"}]})),n("sidebar").elem("tab-content").elemMod("tab","cluster-tree").content()({block:"b-cluster-tree",mods:{type:"sidebar",theme:"dark"}}),n("b-cluster-tree").def()(function(){var t=this.ctx.mods||{};return t.theme=t.theme||"normal",this.ctx.mods=t,x()}),n("b-cluster-tree")(u()(function(){return this.ctx.js||!0}),f()(function(){return[{elem:"total",content:[BEM.I18N("b-cluster-tree","subpages")+" ",{elem:"total-count",content:""}]},{block:"b-cluster-tree-sort",mods:{theme:this.mods.theme}},{block:"b-cluster-tree-filter",mods:{theme:this.mods.theme}},{elem:"list",content:[]}]})),n("b-cluster-tree").elem("total-count").tag()("span"),n("b-cluster-tree").elem("date").match(function(){return this.ctx.timestamp}).content()(function(){var t=BEM.blocks["mi-helpers"].getDateFromHumanString(this.ctx.timestamp),e=function(t){return t<10?"0"+t:t},i=[],n=e(t.getDate()),s=e(t.getMonth()+1),o=t.getFullYear(),r=e(t.getHours()),a=e(t.getMinutes());return i.push([n,s,o].join("."),[r,a].join(":")),i.join(", ")}),n("b-cluster-tree-sort")(u()(function(){return this.ctx.js||!0}),s("select").content()(function(){return{block:"select2",mods:{theme:"normal",size:"s",type:"radiocheck",text:"vary"},val:this.ctx.val,items:[{val:"title",text:BEM.I18N("b-cluster-tree-sort","sort_by_name")},{val:"tag",text:BEM.I18N("b-cluster-tree-sort","sort_by_address")},{val:"created_at",text:BEM.I18N("b-cluster-tree-sort","sort_by_createDate")},{val:"modified_at",text:BEM.I18N("b-cluster-tree-sort","sort_by_updates")}],button:{mods:{theme:"dark"}}}})),n("select2")(c()(function(){var t,e=this.mods,i=[];return(t=this.extend({},this.ctx)).flattenItems=[],void 0===e.view&&(e.view="classic"),e.popup||(e.native="yes"),t.items.forEach(function e(n){n.items?n.items.forEach(e):(t.flattenItems.push(n),i.push(n.val))},this),t.val=void 0===t.val?[]:[].concat(t.val).filter(function(t){var e=-1!==i.indexOf(t);return e}),-1!==["radio","radiocheck"].indexOf(e.type)&&(t.val.length>1?t.val=t.val.slice(-1):t.val&&t.val.length||"radio"!==e.type||(t.val=t.flattenItems[0]&&[t.flattenItems[0].val]||[])),void 0===t.text&&(t.text="—"),x({ctx:t})}),l()("span"),("undefined"!=typeof addJs?addJs:u)()(!0),e(function(){return void 0===this.ctx.content}).content()(function(){var t=this.ctx,e=this.mods,i=t.items,n=t.flattenItems,s=Boolean(t.val.length),o=s&&-1!==["check","radiocheck"].indexOf(e.type),r="fixed"!==e.width&&s?n.reduce(function(e,i){return-1!==t.val.indexOf(i.val)&&e.push(i.checkedText||i.text),e},[]).join(", "):t.text;if(t.control=t.control||Boolean(e.native),!s&&"radio"===e.type&&i[0]){i[0]=function t(e){e.items?e.items=[t(e.items[0])].concat(e.items.slice(1)):(e.elemMods=Object(e.elemMods),e.elemMods.checked="yes");return e}(i[0]),r=n[0].text}return[{elem:"button",multiselectable:"check"===e.type,required:t.required,items:n,val:t.val,button:this.util.merge({mods:{size:e.size,theme:e.theme,view:e.view,tone:e.tone,disabled:e.disabled,checked:o?"yes":void 0,pin:t.button&&t.button.pin},text:r},t.button)},t.control&&this.util.merge({elem:"control",elemMods:{disabled:e.disabled},multiple:"radio"!==e.type,required:t.required,name:t.name,items:n,val:t.val},t.control)].filter(Boolean)})),n("select2")(e(function(){return!this.mods.native}).def()(function(){return this.mods.popup="yes",x()})),n("select2").elem("control")(l()("select"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{name:this.ctx.name,tabindex:"-1",multiple:this.ctx.multiple,required:this.ctx.required,disabled:Boolean(this.mods.disabled)}}),e(function(){return void 0===this.ctx.content}).content()(function(){var t=this.ctx.val,e=this.xmlEscape;return this.ctx.items.map(function(i){return{tag:"option",attrs:{value:i.val,disabled:Boolean((i.elemMods||{}).disabled),selected:-1!==t.indexOf(i.val)?"selected":void 0},content:{html:e(i.text)}}})})),n("menu")(o("tabindex")(void 0),c()(function(){var t=this.ctx,e=void 0!==t.tabindex?t.tabindex:E("tabindex");return t.val=void 0!==t.val?[].concat(t.val):[],void 0===this.mods.view&&(this.mods.view="classic"),-1!==["radio","radiocheck"].indexOf(this.mods.type)&&(t.val=t.val.slice(0,1)),x({_tabindex:e})}),("undefined"!=typeof addJs?addJs:u)()(function(){return{_tabindex:null!==this._tabindex&&this.mods.disabled?this._tabindex:void 0}}),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{tabindex:this.mods.disabled?void 0:null===this._tabindex?void 0:this._tabindex,"aria-disabled":!!this.mods.disabled&&"true"}}),e(function(){return!this.ctx.content}).content()(function(){return(this.ctx.items||[]).map(function t(e){if(!1!==e&&null!==e&&void 0!==e)return this.isSimple(e)&&(e={text:e}),e.items?(e.elem="group",e.content||(e.content=e.items.map(t,this))):(e.elem="item",-1!==["check","radio","radiocheck"].indexOf(this.mods.type)?e.elemMods=this.extend({type:"option",checked:-1!==this.ctx.val.indexOf(e.val)?"yes":void 0},e.elemMods):"navigation"===this.mods.type&&(e.elemMods=this.extend({type:"link"},e.elemMods))),e},this)})),n("b-cluster-tree-filter")(u()(function(){return this.ctx.js||!0}),s("select").replace()(function(){return{block:"select2",mods:{theme:"normal",size:"s",type:"check"},items:this.ctx.items||[],val:this.ctx.val||null,button:{mods:{theme:"dark"},content:[{block:"icon",mods:{size:"s",type:"arrow",direction:"bottom"},mix:[{block:"button2",elem:"icon",elemMods:{side:"right"}},{block:"select2",elem:"arrow"}]},{block:"button2",elem:"text",content:{block:"awesome-icon",mods:{icon:"filter"}}}]}}})),n("menu").mod("type","check")(o("tabindex")("0"),d()(function(){return this.extend(x(),{role:"listbox","aria-multiselectable":"true"})})),n("sidebar").elem("tab-content").elemMod("tab","events").content()({block:"b-events-log",mods:{type:"sidebar",theme:"dark"}}),n("b-events-log")(c()(function(){return this.ctx.mods=this.ctx.mods||{},this.ctx.mods.theme=this.ctx.mods.theme||"normal",x()}),u()(function(){return this.ctx.js||!0}),s("list").tag()("ol"),s("item").tag()("li"),f()(function(){return[{block:"b-events-select",mods:{theme:this.ctx.mods.theme}},{elem:"list"},{elem:"more",content:[{block:"link",mix:{block:"b-events-log",elem:"more-link",tag:"span"},mods:{pseudo:"yes",theme:this.ctx.mods.theme},content:[BEM.I18N("b-events-log","more_events")," ",{block:"awesome-icon",mods:{icon:"angle-down"}}]},{block:"spin2",mods:{size:"xs"}}]},{elem:"mask",content:{block:"spin2",mods:{size:"s"}}}]})),n("b-events-log")(f()(function(){return x().concat({elem:"limit-exceeded",content:BEM.I18N("b-events-log","limit_exceeded")})})),n("b-events-select")(u()(!0),f()(function(){return{block:"select2",name:"events",mods:{size:"s",theme:"normal",text:"vary",type:"radiocheck"},button:{mods:{theme:"dark"}},text:BEM.I18N("b-events-select","only_edits"),val:"create,edit",items:[{val:"create,edit",text:BEM.I18N("b-events-select","only_edits")},{val:"watch,unwatch,subscribe_other_user",text:BEM.I18N("b-events-select","only_subscribes")},{val:"add_file,delete_file",text:BEM.I18N("b-events-select","only_attaches")},{val:"add_comment,delete_comment,remove_comment",text:BEM.I18N("b-events-select","only_comments")},{val:"",text:BEM.I18N("b-events-select","all_events")}]}})),n("checkbox")(c()(function(){var t=this.ctx;return t.controlAttrs=this.extend({id:this.generateId(),checked:Boolean(this.mods.checked),indeterminate:Boolean(this.mods.indeterminate),disabled:Boolean(this.mods.disabled),tabindex:t.tabindex,name:t.name,value:t.value},void 0===t.controlAttrs?t.checkboxAttrs:t.controlAttrs),t.controlAttrs["aria-labelledby"]="label"+t.controlAttrs.id,t.controlAttrs["aria-checked"]=t.controlAttrs.indeterminate?"mixed":t.controlAttrs.checked.toString(),void 0===this.mods.view&&(this.mods.view="classic"),void 0===this.mods.lines&&(this.mods.lines="multi"),x({_labelAttrs:{id:t.controlAttrs["aria-labelledby"],for:t.controlAttrs.id}})}),l()("span"),u()(function(){return this.extend({live:!1},x())}),e(function(){return void 0===this.ctx.content}).content()(function(){return[this.util.merge({elem:"box",tag:"span",content:[this.util.merge({elem:"control",attrs:this.ctx.controlAttrs,checked:this.mods.checked,indeterminate:this.mods.indeterminate},this.ctx.control),{elem:"tick",tag:"i",indeterminate:this.mods.indeterminate}]},this.ctx.box),void 0!==this.ctx.text&&this.util.merge({elem:"label"},this.isSimple(this.ctx.text)?{content:{html:this.xmlEscape(this.ctx.text)}}:this.ctx.text)].filter(Boolean)})),b(function(t,e){var i,n,s,o,r;t.BEMContext.prototype["mi-helpers"]={getDateFromHumanString:function(t){var e,i=Math.abs(~t.search(/\./)||~t.search("Z")),n=t;return n=n.replace(/-/g,",").replace("T",",").replace(/:/g,","),(n=(n=i?n.substr(0,i-1):n).split(","))[1]=n[1]-1,e=this.getUTC_YMD(n[0],n[1],n[2]),n[3]&&e.setHours(n[3]),n[4]&&e.setMinutes(n[4]),n[5]&&e.setSeconds(n[5]),e},getUTC_YMD:function(t,e,i){var n=new Date(Date.UTC(2e3,10));return n.setUTCFullYear(t),n.setUTCMonth(e),n.setUTCDate(i),n.setUTCMinutes(n.getMinutes()+n.getTimezoneOffset()),n},getHumanStringFromDate:function(t){var e,i=t.date,n=i.getFullYear(),s=(i.getMonth()+1).toString(),o=i.getDate().toString(),r=i.getHours().toString(),a=i.getMinutes().toString(),c=i.getSeconds().toString();return 1===s.length&&(s="0"+s),e=n+"-"+s,!1!==t.needDay&&(1===o.length&&(o="0"+o),e=e+"-"+o,t.needHours&&(1===r.length&&(r="0"+r),e=e+"T"+r,t.needMinutes&&(1===a.length&&(a="0"+a),e=e+":"+a,t.needSeconds&&(1===c.length&&(c="0"+c),e=e+":"+c)))),e},htmlSpecialChars:function(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):t},dateFormat:(i=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,n=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,s=/[^-+\dA-Z]/g,o=function(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t},r={default:"d mmm yyyy",shortDate:"d mmm yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"HH:MM",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",dayMonthTime:"dd.mm hh:mm",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},function(t,e,a){1!=arguments.length||"[object String]"!=Object.prototype.toString.call(t)||/\d/.test(t)||(e=t,t=void 0);try{if(t=t?new Date(t):new Date,isNaN(t))throw SyntaxError("invalid date");"UTC:"==(e=String(r[e]||e||r.default)).slice(0,4)&&(e=e.slice(4),a=!0);var c=a?"getUTC":"get",l=t[c+"Date"](),d=t[c+"Day"](),h=t[c+"Month"](),u=t[c+"FullYear"](),m=t[c+"Hours"](),p=t[c+"Minutes"](),f=t[c+"Seconds"](),_=t[c+"Milliseconds"](),g=a?0:t.getTimezoneOffset(),b={d:l,dd:o(l),ddd:BEM.I18N("i-tanker__days","short"+(d||7)),dddd:BEM.I18N("i-tanker__days","n"+(d||7)),m:h+1,mm:o(h+1),mmm:BEM.I18N("i-tanker__months","short"+(h+1)),mmmm:BEM.I18N("i-tanker__months","g"+(h+1)),yy:String(u).slice(2),yyyy:u,h:m%12||12,hh:o(m%12||12),H:m,HH:o(m),M:p,MM:o(p),s:f,ss:o(f),l:o(_,3),L:o(_>99?Math.round(_/10):_),t:m<12?"a":"p",tt:m<12?"am":"pm",T:m<12?"A":"P",TT:m<12?"AM":"PM",Z:a?"UTC":(String(t).match(n)||[""]).pop().replace(s,""),o:(g>0?"-":"+")+o(100*Math.floor(Math.abs(g)/60)+Math.abs(g)%60,4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10]};return e.replace(i,function(t){return t in b?b[t]:t.slice(1,t.length-1)})}catch(t){}})}}),n("mi-date")(l()(""),("undefined"!=typeof addJs?addJs:u)()(function(){return this.ctx.params||!0}),f()(function(){var t,e,i=this;function n(t){return[t.getHours(),(e=t.getMinutes(),(e<10?"0":"")+e)].join(":");var e}function s(t){var e=t.getMonth()+1,n=(new Date).getFullYear(),s=BEM.I18N("i-tanker__months",(i.ctx.short?"short":"g")+e).toLowerCase(),o=[t.getDate(),s];return i.ctx.alwaysShowYear||n!==t.getFullYear()?o.concat(t.getFullYear()).join(" "):o.join(" ")}return this.ctx.timestamp?"full"===this.ctx.format?(t=this.ctx.timestamp,s(e=i["mi-helpers"].getDateFromHumanString(t))+" "+n(e)):"middle"===this.ctx.format?s(i["mi-helpers"].getDateFromHumanString(this.ctx.timestamp)):function(t){var e=i["mi-helpers"].getDateFromHumanString(t),o=new Date,r=o-e,a=e.getDate(),c=o.getDate(),l=c-1;if(c===a&&0<r&&r<864e5){if(r<6e4)return BEM.I18N("mi-date","just-now");var d=Math.floor(r/6e4);if(d<60)return d+" "+BEM.I18N("mi-date","min",{count:d});var h=Math.floor(r/36e5);return h<60?h+" "+BEM.I18N("mi-date","h",{count:h}):BEM.I18N("mi-date","today-at")+" "+n(e)}return l===a&&0<r&&r<1728e5?BEM.I18N("mi-date","yesterday-at")+" "+n(e):s(e)}(this.ctx.timestamp):[]})),n("mi-date")(f()(function(){var t,e,i=this;function n(t){return[t.getHours(),(e=t.getMinutes(),(e<10?"0":"")+e)].join(":");var e}function s(t){var e=t.getMonth()+1,n=(new Date).getFullYear(),s=BEM.I18N("i-tanker__months",(i.ctx.short?"short":"g")+e).toLowerCase();"en"===BEM.I18N.lang()&&(s=s.charAt(0).toUpperCase()+s.slice(1));var o=[t.getDate(),s];return i.ctx.alwaysShowYear||n!==t.getFullYear()?o.concat(t.getFullYear()).join(" "):o.join(" ")}return this.ctx.timestamp?"full"===this.ctx.format?(t=this.ctx.timestamp,s(e=i["mi-helpers"].getDateFromHumanString(t))+" "+n(e)):"middle"===this.ctx.format?s(i["mi-helpers"].getDateFromHumanString(this.ctx.timestamp)):function(t){var e=i["mi-helpers"].getDateFromHumanString(t),o=new Date,r=o-e,a=e.getDate(),c=o.getDate(),l=c-1;if(c===a&&0<r&&r<864e5){if(r<6e4)return BEM.I18N("mi-date","just-now");var d=Math.floor(r/6e4);if(d<60)return d+" "+BEM.I18N("mi-date","min",{count:d});var h=Math.floor(r/36e5);return h<60?h+" "+BEM.I18N("mi-date","h",{count:h}):BEM.I18N("mi-date","today-at")+" "+n(e)}return l===a&&0<r&&r<1728e5?BEM.I18N("mi-date","yesterday-at")+" "+n(e):s(e)}(this.ctx.timestamp):[]})),n("b-diff-grid").tag()("table"),n("b-diff-grid").elem("row").tag()("tr"),n("b-diff-grid").elem("field").tag()("td"),n("b-diff-string").elem("chunk").tag()("span"),n("b-diff-string").elem("chunk").elemMod("diff-type","added").tag()("ins"),n("b-diff-string").elem("chunk").elemMod("diff-type","deleted").tag()("del"),n("sidebar").elem("tab-content").elemMod("tab","files").content()({block:"w-attachments",mods:{type:"sidebar",theme:"dark"}}),n("w-attachments")(c()(function(){var t=this.mods;return t.theme=t.theme||"normal",x({_theme:t.theme})}),u()(!0),f()([{elem:"overall-progress"},{elem:"attach-button"},{elem:"attachments"},{elem:"more"}]),s("attach-button").content()(function(){return[{block:"attach",mods:{size:"s",theme:this._theme},text:BEM.I18N("w-attachments","upload-btn-text")},{tag:"br"},{elem:"drop-message",tag:"span",content:BEM.I18N("w-attachments","drop-panel-message")}]}),s("attach-loader")(d()(function(){return{id:this.ctx.id}}),f()(function(){return[{block:"w-file-name",width:{max:260,name:230},mix:{block:"w-attachments",elem:"attach-loader-file"},content:this.ctx.name},{elem:"progress"}]})),s("attach").replace()(function(){return{block:"w-attach",mods:{theme:this.elemMods.theme},mix:{block:"w-attachments",elem:"attach"},attach:this.ctx.attach,redirect:this.ctx.redirect}})),n("w-attachments").elem("progress").content()(function(){return[{elem:"percent",tag:"span",content:"0"},{elem:"meter",tag:"span"},{elem:"error-controls",content:[{block:"awesome-icon",mods:{icon:"repeat"},attrs:{title:BEM.I18N("w-attachments","upload-repeat")},mix:{block:"w-attachments",elem:"repeat"}},{block:"awesome-icon",mods:{icon:"ban-circle"},attrs:{title:BEM.I18N("w-attachments","upload-cancel")},mix:{block:"w-attachments",elem:"cancel"}}]}]}),n("w-attach")(c()(function(){var t=this.ctx.mods||{};return t.theme=t.theme||"normal",this.ctx.mods=t,x({_theme:t.theme,_attach:this.ctx.attach})}),d()(function(){return{title:this._attach.name}}),u()(function(){return{attach:this.ctx.attach}}),f()(function(){return[{elem:"attach-name",url:this._attach.docviewer_url?this._attach.docviewer_url:this._attach.url+"?download=1",target:this._attach.docviewer_url?"_blank":"_self",content:this.ctx.attach.name},{elem:"about",content:[{elem:"author",content:this.ctx.attach.user_name}," / ",{elem:"date",content:this.ctx.attach.upload_date}," / ",{elem:"size",content:this.ctx.attach.size}]},{elem:"controls",redirect:this.ctx.redirect},{elem:"hider",attrs:{title:BEM.I18N("w-attach","hide_options_hint")},content:{block:"awesome-icon",mods:{icon:"angle-right"}}},{block:"tooltip",mods:{size:"s",theme:"normal",autoclosable:"yes"},js:{offset:10},content:BEM.I18N("w-attach","file_link_copied")}]})),n("w-attach").elem("author")(l()("span"),f()(function(){return[{block:"m-username",mods:{theme:this._theme},mix:{block:"mi-staff-card",js:{user:this.ctx.content}},url:"//staff.yandex-team.ru/"+this.ctx.content,content:this.ctx.content+"@"}]})),n("w-attach").elem("author").content()(function(){return{block:"m-username",mods:{theme:this._theme},login:this.ctx.content,content:this.ctx.content+"@"}}),n("w-attach").elem("attach-name").content()(function(){return{block:"link",mods:{theme:this._theme},target:this.ctx.target,title:this.ctx.content,url:this.ctx.url,content:{block:"w-file-name",width:{max:260,name:230},content:this.ctx.content}}}),n("w-attach").elem("date")(l()("span"),d()(function(){return{title:this["mi-helpers"].getHumanStringFromDate({date:new Date(this.ctx.content)})}})),n("w-attach").elem("controls")(l()("span"),d()(function(){return{title:this._attach.name}}),f()(function(){return[{elem:"controls-container",content:[{block:"awesome-icon",mods:{icon:"trash"},attrs:{title:BEM.I18N("w-attach","remove_link")},mix:[{block:"w-attach",elem:"control",elemMods:{type:"remove",visible:!this._attach.can_delete||this.ctx.redirect?"no":""}}]},{block:"w-attach",elem:"control",elemMods:{type:"download"},content:{block:"link",url:this._attach.url+"?download=1",content:{block:"awesome-icon",mods:{icon:"download"},attrs:{title:BEM.I18N("w-attach","download_link")}}}},{block:"awesome-icon",mods:{icon:"link"},attrs:{title:BEM.I18N("w-attach","copy_link")},mix:[{block:"w-attach",elem:"control",elemMods:{type:"copy"}}]}]}]})),n("tooltip").def()(function(){var t=this.ctx,e=this.mods;void 0===e.view&&(e.view="classic");var i={target:"anchor",hiding:"yes",autoclosable:e.autoclosable||"no",view:e.view,theme:"normal"},n=E("js"),s=void 0===(n=(n?this.extend(n,Object(t.js)):t.js)||{}).mainOffset?n.offset:n.mainOffset,o=n.to&&[].concat(n.to);return o&&(o=o.map(function(t){return t.indexOf("-")<0&&(t+="-center"),t})),M({block:"popup2",mods:i,attrs:t.attrs,directions:o||["right-center","bottom-center","top-center","left-center"],mainOffset:s,secondaryOffset:n.secondaryOffset,tailOffset:n.tailOffset,zIndexGroupLevel:n.zIndexGroupLevel,mix:[{block:"tooltip",mods:e}].concat(t.mix),content:[{block:"tooltip",elem:"backdrop",content:!1!==t.tail&&{block:"popup2",elem:"tail"}},{block:"tooltip",elem:"content",content:t.content}]})}),n("m-notification")(u()(!0),f()(function(){return[{elem:"icon"},{elem:"content",content:this.ctx.content},{block:"awesome-icon",mods:{icon:"remove",type:"clear"}}]})),n("m-notification").mod("theme","warning").elem("icon").content()({block:"awesome-icon",mods:{icon:"warning",type:"theme-icon"}}),n("m-notification").mod("theme","error").elem("icon").content()({block:"awesome-icon",mods:{icon:"exclamation-circle",type:"theme-icon"}}),n("m-notification").mod("theme","success").elem("icon").content()({block:"awesome-icon",mods:{icon:"check",type:"theme-icon"}}),n("sidebar").elem("tab-content").elemMod("tab","grid-code").content()({block:"b-grid-table-code",mods:{type:"sidebar",theme:"dark"}}),n("b-grid-table-code")(p()({block:"b-sidebar-section"}),f()(function(){return{block:"b-grid-table-code-form",mix:[{block:"w-getting-started",elem:"elem",elemMods:{"edit-grid-sidebar":"1"}}],mods:{theme:this.mods.theme}}})),n("b-grid-table-code-form").js()({data:{width:100,width_units:"%",read_only:!1,show_numbers:!0,show_sorting:!0}}),n("input")(l()("span"),o("live")(!1),o("getLive")(function(){var t=E("live"),e=this.ctx.js,i=this.mods,n={autofocus:"yes",width:"content","tap-ahead":"yes"};return e?(void 0!==e.live?Boolean(e.live):t)&&!e.autoFocus&&!Object.keys(n).some(function(t){return i[t]===n[t]}):t}),("undefined"!=typeof addJs?addJs:u)()(function(){return{live:this._live}}),c()(function(){var t,e=E("value",{ctx:this.ctx.value}),i=this.ctx.id||this.generateId(),n=this.mods,s=E("getLive",{}),o=this.ctx.placeholder;return n.theme=n.theme||"normal",this.ctx.hasOwnProperty("placeholder")&&(t=this.isSimple(o)?o:this.reapply(o)),x({_inputId:i,_labelId:"label"+i,_hintId:"hint"+i,_name:this.ctx.name||"",_value:e,_inputLink:!0,_iconLeft:this.ctx.icon||this.ctx.iconLeft,_iconRight:this.ctx.iconRight,_disabled:n.disabled,_live:s,_placeholder:t,_hasClear:"no"!==n.clear})}),o("value")("",e(function(){return this.ctx})(function(){return this.reapply(this.ctx)}),e(function(){return this.isSimple(this.ctx)})(function(){return this.ctx}))),n("input").elem("clear")(l()("span"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{unselectable:"on"}}),f().match(function(){return!this.ctx.content})("")),n("sidebar").elem("tab-content").elemMod("tab","grid-settings").content()(function(){return{block:"b-grid-table-settings",mods:{type:"sidebar",theme:"dark"},redirect:this.ctx.redirect}}),n("b-grid-table-settings")(c()(function(){return this.ctx.mods=this.ctx.mods||{},this.ctx.mods.theme=this.ctx.mods.theme||"normal",x()}),p()({block:"b-sidebar-section"}),u()(function(){return this.ctx.js||!0}),f()(function(){return[{elem:"settings",content:[{elem:"grid-title",content:{block:"input",mods:{size:"m",theme:this.ctx.mods.theme},value:"",content:{elem:"control",controlAttrs:{placeholder:BEM.I18N("b-grid-table-settings","table_name"),autocomplete:"off"}}}},{elem:"sorting",content:{block:"b-grid-table-sorting-controll",mods:{theme:this.ctx.mods.theme}}},{elem:"submit",content:{block:"button2",mods:{size:"m",theme:"action",disabled:this.ctx.redirect?"yes":""},text:BEM.I18N("b-grid-table-settings","save")}}]}]})),n("b-grid-table-sorting-controll")(c()(function(){return this.ctx.mods=this.ctx.mods||{},this.ctx.mods.theme=this.ctx.mods.theme||"normal",x()}),u()(function(){return this.ctx.js||!0}),f()(function(){return[{elem:"sortings"},{elem:"add-sorting",content:{block:"link",mods:{pseudo:"yes",theme:this.ctx.mods.theme},content:BEM.I18N("b-grid-table-sorting-controll","add_sort")}}]})),n("b-grid-table-fields-list")(c()(function(){var t=this.ctx.selected,e=this.ctx.fields.map(function(e){return{name:e.name,title:e.title,selected:e.name===t}});return this.ctx.mods=this.ctx.mods||{},this.ctx.mods.theme=this.ctx.mods.theme||"normal",x({_options:e})}),f()(function(){return{block:"select2",js:{defaultValue:this.ctx.selected},name:"grid-fields",mods:{size:"m",theme:this.mods.theme,text:"vary",type:"radiocheck"},val:this.ctx.selected,text:this.ctx.selected,items:this._options.map(function(t){return{val:t.name,text:t.title}}),button:{mods:{theme:this.mods.theme}}}})),n("b-grid-table-sorting-list")(c()(function(){return this.ctx.mods=this.ctx.mods||{},this.ctx.mods.theme=this.ctx.mods.theme||"normal",x()}),l()("span"),f()(function(){return{block:"radio-button",mods:{size:"m",theme:this.mods.theme},name:"sorting_"+Date.now(),value:"asc"===this.ctx.selected?"asc":"desc",content:[{elem:"radio",controlAttrs:{value:"asc"},content:BEM.I18N("b-grid-table-sorting-list","a_z")},{elem:"radio",controlAttrs:{value:"desc"},content:BEM.I18N("b-grid-table-sorting-list","z_a")}]}})),n("radiobox")(c()(function(){var t=this.ctx,e=this.mods;return void 0===this.mods.view&&(this.mods.view="classic"),x({_disabled:e.disabled,_name:t.name,_value:t.value})}),l()("span"),("undefined"!=typeof addJs?addJs:u)()(function(){return this.extend({live:!1},this.ctx.js)})),n("radiobox").elem("control")(l()("input"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return this._controlAttrs})),n("radio-button").elem("radio")(c()(function(){var t=this.elemMods,e=this._radioButton,i=e.disabled,n=this.extend({},this.ctx.controlAttrs);return void 0!==n.value&&n.value===e.value&&(t.checked="yes"),i&&(t.disabled="yes"),"default"===this.mods.view||t.side||(t.side=["","right","left","both"][2*this.isFirst()+this.isLast()]),n.checked=Boolean(t.checked),n.disabled=Boolean(t.disabled),n.id||(n.id=this.generateId()),x({_controlAttrs:n})}),l()("label"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{for:this._controlAttrs.id}}),f()(function(){return[{elem:"control"},{elem:"text",tag:"span",content:this.ctx.content}]})),n("sidebar").elem("loader").content()({block:"spin2",mods:{size:"l",progress:"yes"}}),n("wi-files-dropper").elem("drop-zone").content()(function(){return{elem:"drop-text",tag:"span",content:BEM.I18N("wi-files-dropper","drop_here")}}),n("wiki-html")(c()(e(function(){return!(this.ctx["wiki-attrs"]&&(this.ctx["wiki-attrs"].style||this.ctx["wiki-attrs"].normalize))})(function(){return M({block:"wiki-txt",noEscape:!0,"wiki-attrs":{txt:this.ctx["wiki-attrs"].txt}})}),e(function(){return!this.ctx._wrapped}).match(function(){return this.ctx["wiki-attrs"]&&(this.ctx["wiki-attrs"].style||this.ctx["wiki-attrs"].normalize)})(function(){var t=this.ctx,e=this.ctx["wiki-attrs"];return t.mods=t.mods||{},e.style&&(t.mods.style=e.style),e.normalize&&(t.mods.normalize=e.normalize),t._wrapped=!0,M(t)})),f()(function(){return{block:"wiki-txt",noEscape:!0,"wiki-attrs":{txt:this.ctx["wiki-attrs"].txt}}})),n("w-translate-item")(u()(function(){return{from:"us"===this.ctx.from?"en":this.ctx.from,to:"us"===this.ctx.to?"en":this.ctx.to}}),f()(function(){return[{block:"country-flag",mods:{s16:this.ctx.from}},{block:"awesome-icon",mods:{icon:"arrow-right"}},{block:"country-flag",mods:{s16:this.ctx.to}}]})),n("w-comments")(u()(!0),e(function(){return!this.ctx.replaced}).replace()(function(){var t={short:"yes"},e=this.ctx;return e.js.commentsCount||(t["no-comments"]="yes"),Object.assign(e.mods,t),e.replaced=!0,e}),f()(function(){return[{elem:"header",content:[{block:"awesome-icon",mods:{icon:"comments",type:"comments"}},{elem:"caption",mix:[{block:"w-getting-started",elem:"elem",elemMods:{comments:"1"}}],count:this.ctx.js.commentsCount},{block:"button2",mods:{theme:"normal",size:"s",role:"short-switch"},mix:{block:"w-comments",elem:"show-comments"},text:BEM.I18N("w-comments","expand")},{block:"button2",mods:{theme:"normal",size:"s",role:"add-comment-header"},mix:{block:"w-comments",elem:"add-comment"},text:BEM.I18N("w-comments","add_comment")},{block:"spin2",mods:{size:"xxs",type:"load-comments"}}]},{elem:"comments-list"},{elem:"show-more",content:[{block:"spin2",mods:{size:"xs",role:"show-more"}},{block:"button2",mods:{theme:"normal",size:"s",role:"show-more"},text:BEM.I18N("w-comments","show_more")}]},{elem:"add-comments",content:[{block:"button2",mods:{theme:"normal",size:"m",role:"add-comment"},text:BEM.I18N("w-comments","add_comment")},{elem:"add-comment-form",content:[{elem:"add-comment-caption",content:BEM.I18N("w-comments","new_comment")},{elem:"add-comment-editor"},{elem:"add-comment-buttons",content:[{block:"button2",mods:{theme:"normal",size:"s",role:"cancel-new-comment"},text:BEM.I18N("w-comments","cancel")},{elem:"right",content:[{block:"spin2",mods:{size:"xxs",type:"add-comment"}},{block:"button2",mods:{size:"s",theme:"action",role:"submit-new-comment",disabled:"yes"},text:BEM.I18N("w-comments","add")}]}]}]}]}]}),s("caption").content()(function(){var t=this.ctx.count,e=t%10;return t?!e||t>=11&&t<=20?t+" "+BEM.I18N("w-comments","null_form"):1===e?t+" "+BEM.I18N("w-comments","first_form"):e>=2&&e<=4?t+" "+BEM.I18N("w-comments","second_form"):t+" "+BEM.I18N("w-comments","null_form"):BEM.I18N("w-comments","no_comments")})),n("w-comment")(u()(!0),f()(function(){var t=this.ctx.data;return[{elem:"icon",login:t.user.login},{elem:"wrapper",content:[{elem:"created",content:[{elem:"username",content:{block:"m-username",mods:{dismissed:t.user.is_dismissed?"yes":""},mix:[{block:"mi-staff-card",js:{user:t.user.login}}],url:"//staff.yandex-team.ru/"+t.user.login,content:t.user.display}},{elem:"date",content:this["mi-helpers"].dateFormat(t.created_at)}]},{elem:"content",content:this.ctx.bemjson},{elem:"actions",content:[{elem:"reply",content:BEM.I18N("w-comment","reply")},{elem:"edit",content:BEM.I18N("w-comment","edit")},{elem:"remove",content:BEM.I18N("w-comment","remove")}]},{elem:"form",content:[{elem:"comment-editor"},{elem:"comment-buttons",content:[{block:"button2",mods:{theme:"normal",size:"s",role:"cancel"},text:BEM.I18N("w-comment","cancel")},{elem:"right",content:[{block:"spin2",mods:{size:"xs",type:"editor-submit"}},{block:"button2",mods:{size:"s",theme:"action",role:"submit"},text:""}]}]}]}]}]}),s("icon")(l()("img"),d()(function(){return{src:"//center.yandex-team.ru/api/v1/user/"+this.ctx.login+"/avatar/100.jpg"}}))),n("w-comment")(u()(!0),f()(function(){var t=this.ctx.data;return[{block:"w-userpic",uid:t.user.uid,size:30},{elem:"wrapper",content:[{elem:"created",content:[{elem:"username",content:{block:"m-username",login:t.user.login,content:t.user.display}},{elem:"date",content:this["mi-helpers"].dateFormat(t.created_at)}]},{elem:"content",content:this.ctx.bemjson},{elem:"actions",content:[{elem:"reply",content:BEM.I18N("w-comment","reply")},{elem:"edit",content:BEM.I18N("w-comment","edit")},{elem:"remove",content:BEM.I18N("w-comment","remove")}]},{elem:"form",content:[{elem:"comment-editor"},{elem:"comment-buttons",content:[{block:"button2",mods:{theme:"normal",size:"s",role:"cancel"},text:BEM.I18N("w-comment","cancel")},{elem:"right",content:[{block:"spin2",mods:{size:"xs",type:"editor-submit"}},{block:"button2",mods:{size:"s",theme:"action",role:"submit"},text:""}]}]}]}]}]})),n("textinput")(l()("span"),("undefined"!=typeof addJs?addJs:u)()(function(){return{_tabindex:this.mods.disabled?this.ctx.tabindex:void 0}}),f()(function(){var t=this.ctx,e=this.mods;return void 0===e.view&&(e.view="classic"),[{elem:"control",attrs:this.extend({type:e.type,id:t.id,name:t.name,value:t.text,tabindex:t.tabindex,placeholder:t.placeholder,autocomplete:!1===t.autocomplete&&"off",disabled:Boolean(e.disabled)},t.controlAttrs)},{elem:"box"}]})),n("textinput")(e(function(){return this.ctx.mods&&this.ctx.mods.focused||this.ctx.controlAttrs&&this.ctx.controlAttrs.autofocus}).js()(function(){var t=Boolean(this.ctx.mods&&this.ctx.mods.focused||this.ctx.controlAttrs.autofocus);return this.extend(x(),{autofocus:t,live:!t})})),n("menu").mod("type","radio")(o("tabindex")("0"),d()(function(){return this.extend(x(),{role:"listbox"})})),n("textarea")(l()("span"),("undefined"!=typeof addJs?addJs:u)()(function(){return{_tabindex:this.mods.disabled?this.ctx.tabindex:void 0}}),f()(function(){var t=this.ctx,e=this.mods;return void 0===e.view&&(e.view="classic"),[{elem:"wrap",content:{elem:"control",attrs:this.extend({id:t.id,name:t.name,tabindex:t.tabindex,placeholder:t.placeholder,autocomplete:!1===t.autocomplete&&"off",cols:t.cols||10,rows:t.rows||10,disabled:Boolean(e.disabled)},t.controlAttrs),content:t.text}},{elem:"box"}]})),n("textarea")(e(function(){return this.ctx.mods&&this.ctx.mods.focused||this.ctx.controlAttrs&&this.ctx.controlAttrs.autofocus}).js()(function(){var t=Boolean(this.ctx.mods&&this.ctx.mods.focused||this.ctx.controlAttrs.autofocus);return this.extend(x(),{autofocus:t,live:!t})})),n("select")(c()(function(){var t=this.ctx,e=t.id||this.generateId();return x({_controlAttrs:{id:e,name:t.name},_formSelect:{block:this.block,mods:this.mods,tabindex:t.tabindex}})}),("undefined"!=typeof addJs?addJs:u)()(function(){return this.extend({live:!1},this.ctx.js)}),l()("span"),s("option").tag()("option"),s("option-group").tag()("optgroup"),s("text").tag()("span")),n("select").def()(function(){var t=this.ctx;if((E("js")||{}).live){var e=t.content.filter(function(t){return"control"===t.elem})[0].content;if(e.length){var i=function(t){for(var e,n,s=0;s<t.length&&("option"===(e=t[s]).elem&&Object(e.attrs).selected?n=e:"option-group"===e.elem&&(n=i(e.content)),!n);s++);return n},n=i(e);return n||"option-group"===(n=e[0]).elem&&(n=n.content[0]),x({_initValue:n.attrs.value,_initText:n.content})}}return x()}),n("button")(c()(function(){this.mods;return x()}),l()("button"),e(function(){return this.ctx.url}).tag()("a"),("undefined"!=typeof addJs?addJs:u)()(!0),d()(e(function(){return void 0!==this.ctx.tabindex})(function(){return this.extend({tabindex:this.ctx.tabindex},x())}),e(function(){return this.ctx.url})(function(){var t=this.ctx,e=t.attrs,i={href:t.url,target:t.target},n=void 0!==Object(e).rel?String(e.rel):"";return"_blank"===i.target&&(i.rel="noopener",n&&-1===n.indexOf("noopener")&&(e.rel=n+" noopener")),this.extend(i,x())}),e(function(){return!this.ctx.url})(function(){var t=this.ctx,e={type:t.type||"button",autocomplete:"off",name:t.name,value:t.value};return this.extend(e,x())})),f()(function(){return{elem:"text",tag:"span",content:this.ctx.content}})),n("m-editor-popup").mod("type","other")(("undefined"!=typeof addJs?addJs:u)()(function(){return{data:this.ctx.data}}),f()(function(){return this.ctx.data.map(function(t){return[{block:"m-editor-button",mods:{type:t},caption:!0}]})})),n("m-suggest")(c()(e(function(){return!this.ctx.mods})(function(){return this.ctx.mods={size:"s"},x()}),e(function(){return!this.mods.size})(function(){return this.mods.size="s",x()}),e(function(){return!this.ctx.inputMods||!this.ctx.inputMods.size})(function(){var t=this.ctx;return t.inputMods=this.extend(t.inputMods,{size:t.mods&&t.mods.size||"s"}),x()})),("undefined"!=typeof addJs?addJs:u)()(function(){return this.extend({types:this.ctx.types||["staff"],labels:this.ctx.labels,inHeader:this.ctx.inHeader,inSearchHeader:this.ctx.inSearchHeader,multiple:this.ctx.multiple,url:this.ctx.url,dataKey:this.ctx.dataKey,textKey:this.ctx.textKey,maxCount:this.ctx.maxCount,target:this.ctx.target},this.ctx.js)}),f()(function(){return this.ctx.input||[{block:"textinput",mix:{block:"m-suggest",elem:"textinput"},mods:this.extend({"has-clear":"yes",theme:"normal",size:"m"},this.ctx.inputMods),placeholder:this.ctx.hint,controlAttrs:this.extend({name:"text",autocomplete:"off"},this.ctx.inputAttrs),text:this.ctx.value}]}),s("popup-items").tag()("ul")),n("m-suggest")(s("cloud").content()(function(){return[this.ctx.data.fullData.first_name&&this.ctx.data.fullData.last_name?this.ctx.data.fullData.first_name+" "+this.ctx.data.fullData.last_name:this.ctx.data.value,{block:"awesome-icon",mods:{icon:"remove"}}]})),n("m-suggest")(s("cloud").content()(function(){var t=this.ctx.data.fullData;t.login=this.ctx.data.value;var e=t.title;return t.first_name&&t.last_name&&(e=t.first_name+" "+t.last_name),[{block:"m-username",login:t.login,content:e||t.login},{block:"awesome-icon",mods:{icon:"remove"}}]})),n("m-suggest-item")(("undefined"!=typeof addJs?addJs:u)()(function(){return{inputData:this.ctx.inputData,inSearchHeader:this.ctx.inSearchHeader,fullData:this.ctx.data}}),s("selected").tag()("b"),s("black")(l()("span"),("undefined"!=typeof addAttrs?addAttrs:d)()({style:"color: black;"}))),n("m-suggest-item").mod("type","department")(u()(function(){var t=this.ctx.data;return this.extend(x(),{value:t.name})}),f()(function(){var t,e,i,n=this.ctx.data.name,s=n.indexOf(this.ctx.inputData.text);return-1!==s?(t=n.substr(0,s),e=n.substr(s+this.ctx.inputData.text.length),i=[{html:this.xmlEscape(t)},{elem:"selected",content:{html:this.xmlEscape(this.ctx.inputData.text)}},{html:this.xmlEscape(e)}]):i={html:this.xmlEscape(n)},{elem:"info-wrapper",content:i}})),n("m-suggest-item").mod("type","maillist")(u()(function(){var t=this.ctx.data;return this.extend(x(),{value:t.email||t.name})}),f()(function(){var t,e,i,n,s,o;return this.ctx.data.email===this.ctx.data.name?(n=this.ctx.data.email.replace(/(.*@)/,""),i=this.ctx.data.email.replace(i,"")):(i=this.ctx.data.name+(this.ctx.data.email&&"@"),n=this.ctx.data.email.replace(i,"")),-1!==(s=(i+n).indexOf(this.ctx.inputData.text))?(t=i.substr(0,s),e=i.substr(s+this.ctx.inputData.text.length),o=[{html:this.xmlEscape(t)},{elem:"selected",content:{html:this.xmlEscape(this.ctx.inputData.text)}},{html:this.xmlEscape(e)}]):o={html:this.xmlEscape(i)},{elem:"info-wrapper",content:[{elem:"black",content:o},{html:this.xmlEscape(n)}]}})),n("m-suggest-item").mod("type","group")(u()(function(){var t=this.ctx.data;return this.extend(x(),{value:t.name})}),f()(function(){var t,e,i,n=this.ctx.data.name,s=n.indexOf(this.ctx.inputData.text);return-1!==s?(t=n.substr(0,s),e=n.substr(s+this.ctx.inputData.text.length),i=[{html:this.xmlEscape(t)},{elem:"selected",content:{html:this.xmlEscape(this.ctx.inputData.text)}},{html:this.xmlEscape(e)}]):i={html:this.xmlEscape(n)},{elem:"info-wrapper",content:i}})),n("m-suggest-item").mod("type","table")(u()(function(){var t=this.ctx.data;return this.extend(x(),{value:t.name})}),f()(function(){var t,e,i,n=this.ctx.data,s=n.office_name,o=n.id+", "+n.status_display,r=o.indexOf(this.ctx.inputData.text);return parseInt(n.floor_display,10)>=0&&(s+=", "+n.floor_display.replace("floor",BEM.I18N("m-suggest-item","floor"))),-1!==r?(t=o.substr(0,r),e=o.substr(r+this.ctx.inputData.text.length),i=[{html:this.xmlEscape(t)},{elem:"selected",content:{html:this.xmlEscape(this.ctx.inputData.text)}},{html:this.xmlEscape(e)}]):i={html:this.xmlEscape(o)},[{elem:"info-wrapper",content:[{elem:"table",content:i},{elem:"office",content:{html:this.xmlEscape(s)}}]}]})),n("m-suggest-item").mod("type","equipment")(u()(function(){var t=this.ctx.data;return this.extend(x(),{value:t.name})}),f()(function(){var t,e,i,n=this.ctx.data,s=n.office_name,o=n.name+", "+n.type_display,r=o.indexOf(this.ctx.inputData.text);return parseInt(n.floor_display,10)>=0&&(s+=", "+n.floor_display.replace("floor",BEM.I18N("m-suggest-item","floor"))),-1!==r?(t=o.substr(0,r),e=o.substr(r+this.ctx.inputData.text.length),i=[{html:this.xmlEscape(t)},{elem:"selected",content:{html:this.xmlEscape(this.ctx.inputData.text)}},{html:this.xmlEscape(e)}]):i={html:this.xmlEscape(o)},[{elem:"info-wrapper",content:[{elem:"equipment",content:i},{elem:"office",content:{html:this.xmlEscape(s)}}]}]})),n("m-suggest-item").mod("type","simple")(("undefined"!=typeof addJs?addJs:u)()(function(){var t=this.ctx.data,e=x();return e.value=t.text,e}),f()(function(){var t=this.ctx.data.text||"",e=t.indexOf(this.ctx.inputData.text);return-1!==e?[{html:this.xmlEscape(t.substr(0,e))},{elem:"selected",content:{html:this.xmlEscape(this.ctx.inputData.text)}},{html:this.xmlEscape(t.substr(e+this.ctx.inputData.text.length))}]:{html:this.xmlEscape(t)}})),n("m-suggest-item").mod("type","room")(u()(function(){var t=this.ctx.data;return this.extend(x(),{value:t.name})}),f()(function(){var t=this.ctx.data,e=(t.name?t.name+", ":"")+t.type_display,i=t.office_name,n=[];return function(t,e,i,n){if(e){var s=0;t.replace(new RegExp(e,"gi"),function(e,o){s!==o&&i(t.slice(s,o)),n(e),s=o+e.length}),t.length>s&&i(t.substr(s))}else i(t)}(e,this.ctx.inputData.text,function(t){n.push({html:this.xmlEscape(t)})}.bind(this),function(t){n.push({elem:"selected",content:{html:this.xmlEscape(t)}})}.bind(this)),[{elem:"info-wrapper",content:[{elem:"room",content:n},{elem:"office",content:{html:this.xmlEscape(i)}}]}]})),n("m-suggest-item").mod("type","nav")(c()(function(){var t=Object(this.ctx.inputData);return x({_data:Object(this.ctx.data),_normalizedInput:String(t.text).toLowerCase()})}),u()(function(){return this.extend(x(),{value:this._data.title||this._data._text,href:this._data.href})}),f()(function(){return[{elem:"item-label",content:BEM.I18N("m-suggest-item",this.ctx.mods.type)},{elem:"info-wrapper",mix:{block:"link",mods:{theme:"normal"}},content:[E("title"),E("abc")]}]}),o("title")(function(){return E("select-word-part",{_word:this._data.service_name})}),e(function(){return this._data.title}).mode("title")(function(){return[E("title")," (",{elem:"title",tag:"span",content:E("select-word-part",{_word:this._data.title})},")"]}),e(function(){return this._data.abc}).mode("abc")(function(){return{elem:"info",content:[{elem:"icon",elemMods:{type:"abc"}}," ",E("select-word-part",{_word:this._data.href.replace(/^https?:\/\//,"")})]}}),o("select-word-part")(function(){var t=this._word.toLowerCase().indexOf(this._normalizedInput);return t>=0?[{html:this.xmlEscape(this._word.substr(0,t))},{elem:"selected",content:{html:this.xmlEscape(this._word.substr(t,this._normalizedInput.length))}},{html:this.xmlEscape(this._word.substr(t+this._normalizedInput.length))}]:{html:this.xmlEscape(this._word)}})),n("m-suggest-item").mod("type","nav").mod("labels","yes")(u()(function(){var t=this.ctx.data;return this.extend(x(),{value:t.title||t._text,href:t.href})}),f()(function(){var t=this.ctx.data,e=[],i=this.ctx.inputData.text.toLowerCase(),n=function(t,e){var i=e.toLowerCase().indexOf(t),n=e;return i>=0&&(n=[e.substr(0,i),{elem:"selected",content:e.substr(i,t.length)},e.substr(i+t.length)]),n};return e.push(n(i,t.service_name)),t.title&&e.push({elem:"info-title-type",content:[" (",n(i,t.title),")"]}),t.abc&&e.push({elem:"info-icon",elemMods:{type:"abc"}},{elem:"info-link",content:n(i,t.href.substring(8))}),[{elem:"info-wrapper",content:e}]})),n("m-suggest-item").mod("type","b2b-people")(u()(function(){return this.extend(x(),{value:this.ctx.data.title})}),f()(function(){var t=this.ctx.data,e=t.title,i=t.fields.reduce(function(t,e){return t[e.type]=e.value,t},{});return[{block:"image",mix:{block:"m-suggest-item",elem:"avatar"},url:i.avatar_url,width:"40px",height:"40px",alt:i.login+" avatar"},{elem:"main-info",content:[{elem:"title",content:{html:this.xmlEscape(e)}},{elem:"description",content:{html:this.xmlEscape("@"+i.login+", "+i.department_name)}}]}]})),n("m-suggest-item").mod("type","b2b-people")(f()(function(){var t=this.ctx.data;console.assert(Array.isArray(t.fields),"m-suggest-item: поле fields должно быть массивом");var e=t.title,i=t.fields.reduce(function(t,e){return t[e.type]=e.value,t},{});return[{block:"image",mix:{block:"m-suggest-item",elem:"avatar"},url:this.ctx.intranet?"//center.yandex-team.ru/api/v1/user/"+i.login+"/avatar/50.jpg":i.avatar_url,width:"40px",height:"40px",alt:i.login+" avatar"},{elem:"main-info",content:[{elem:"title",content:{html:this.xmlEscape(e)}},{elem:"description",content:{html:this.xmlEscape("@"+i.login+", "+i.department_name)}}]}]})),n("m-suggest-item").mod("type","b2b-people")(u()(function(){return this.extend(x(),{value:this.ctx.data.fields.find(function(t){return"login"===t.type}).value})})),n("m-suggest-item").mod("type","b2b-groups")(u()(function(){return this.extend(x(),{value:this.ctx.data.title})}),f()(function(){var t=this.ctx.data;return[{elem:"avatar"},{elem:"main-info",content:[{elem:"title",content:{html:this.xmlEscape(t.title)}}]}]})),n("m-suggest-item").mod("type","b2b-departments")(u()(function(){return this.extend(x(),{value:this.ctx.data.title})}),f()(function(){var t=this.ctx.data;return[{elem:"avatar"},{elem:"main-info",content:[{elem:"title",content:{html:this.xmlEscape(t.title)}}]}]})),n("m-suggest-group").content()(function(){var t=this.ctx.content;return this.ctx.groupLabel&&(t=[{elem:"group-label",content:this.ctx.groupLabel&&BEM.I18N("m-suggest-item",this.ctx.groupLabel)},t]),t}),n("m-editor-popup").mod("type","form")(f()({elem:"content",content:[{block:"spin2",mods:{size:"m"},mix:{block:"m-editor-popup",elem:"loading"},js:!0},{elem:"iframe",tag:"iframe",attrs:{src:""}}]}),("undefined"!=typeof addJs?addJs:u)()(function(){return{forms:this.ctx.forms}})),n("m-editor-popup").mod("type","video")(u()(!0),f()(function(){return[{elem:"header",tag:"h3",content:BEM.I18N("m-editor-popup","createVideo")},{elem:"content",content:[{tag:"label",block:"textinput",elem:"label",content:[{tag:"span",block:"textinput",elem:"label-text",content:BEM.I18N("m-editor-popup","videoLink")},{block:"textinput",mods:{theme:"normal","has-clear":"yes",size:"s",video:"link"},text:"",placeholder:BEM.I18N("m-editor-popup","videoLinkPlaceholder")}]}]}]})),n("m-editor-popup").mod("type","video")(f()(function(){return[{elem:"header",tag:"h3",content:BEM.I18N("m-editor-popup","createVideo")},{elem:"content",content:[{tag:"label",block:"textinput",elem:"label",content:[{tag:"span",block:"textinput",elem:"label-text",content:BEM.I18N("m-editor-popup","videoLink")},{block:"textinput",mods:{theme:"normal","has-clear":"yes",size:"s",video:"link"},controlAttrs:{name:"videoSrc"},text:"",placeholder:BEM.I18N("m-editor-popup","videoLinkPlaceholder")}]}]}]})),n("w-nps").js()(!0),n("w-nps").js()(!0),n("b-page-official-user").content()(function(){return[{block:"m-userpic",url:"http://staff/"+this.ctx.user.login,size:"30",login:this.ctx.user.login},{block:"m-username",mods:{dismissed:this.ctx.user.is_dismissed?"yes":""},mix:[{block:"mi-staff-card",js:{user:this.ctx.user.login}}],url:"//staff.yandex-team.ru/"+this.ctx.user.login,content:this.ctx.user.display}]}),n("b-page-official-user").content()(function(){return[{block:"w-userpic",size:30,uid:this.ctx.user.uid},{block:"m-username",mods:{dismissed:this.ctx.user.is_dismissed?"yes":""},login:this.ctx.user.login,content:this.ctx.user.display}]}),n("dropdown2")(("undefined"!=typeof addJs?addJs:u)()(!0),f()(function(){var t=this.ctx.popup;return(this.isSimple(t)||t.block&&"popup2"!==t.block)&&(t={content:t}),this.mods["has-tail"]&&(t.content=[{elem:"tail"}].concat(t.content||[])),void 0===this.mods.view&&(this.mods.view="classic"),t=this.util.mergeBemjson({block:"popup2",mods:{view:this.mods.view,tone:this.mods.tone,theme:"normal",autoclosable:"yes",target:"anchor"}},t),[{elem:"switcher",switcher:this.ctx.switcher,hasTick:this.mods["has-tick"]},t]})),n("b-page-more-panel")(f()(function(){return[{block:"b-page-more-panel-item",mix:[{block:"w-action",mods:{type:"sub"},js:!0},{block:"w-getting-started",elem:"elem",elemMods:{"page-menu":"2"}}],content:BEM.I18N("b-page-more-panel","create_page")},{block:"b-page-more-panel-item",mix:[{block:"w-action",mods:{type:"tree"},js:!0}],content:BEM.I18N("b-page-more-panel","tree")},{block:"b-page-more-panel-item",mods:{disabled:this.ctx.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"move"},js:{type:"page"}}],content:BEM.I18N("b-page-more-panel","move")},{block:"b-page-more-panel-item",mods:{disabled:this.ctx.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"subscribe"},js:!0}],content:BEM.I18N("b-page-more-panel","subscriptions_control")},{block:"b-page-more-panel-item",mods:{disabled:this.ctx.redirect?"yes":""},mix:{block:"w-action",mods:{type:"access"},js:!0},content:BEM.I18N("b-page-more-panel","page_access")},{block:"b-page-more-panel-item",mods:{type:"old-page",disabled:this.ctx.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"old-page"},js:{actuality:"obsolete"===this.ctx.actuality?"obsolete":"actual"}}],content:"obsolete"===this.ctx.actuality?BEM.I18N("b-page-more-panel","mark_as_actual"):BEM.I18N("b-page-more-panel","mark_as_obsolete")},{block:"b-page-more-panel-item",mix:[{block:"w-action",mods:{type:"referrers"},js:!0}],content:BEM.I18N("b-page-more-panel","referrers")},{block:"b-page-more-panel-item",mix:[{block:"w-action",mods:{type:"settings"},js:{user:this.ctx.user}}],content:BEM.I18N("b-page-more-panel","settings")},{block:"b-page-more-panel-item",mods:{disabled:this.ctx.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"delete"},js:{type:"page",breadcrumbs:this.ctx.breadcrumbs}}],content:BEM.I18N("b-page-more-panel","delete")},{block:"w-action",mods:{type:"unsubscribe"},js:!0},{block:"w-action",mods:{type:"files"},js:!0},{block:"w-action",mods:{type:"subpages-change-author"},js:!0},{block:"w-action",mods:{type:"unsubscribe"},js:!0},{block:"w-action",mods:{type:"authors"},js:!0},E("rejected-access"),{block:"w-action",mods:{type:"authorship"},js:!0},{block:"w-action",mods:{type:"request-page-author"},js:!0}]})),n("b-page-more-panel")(f()(function(){return[{block:"b-page-more-panel-item",mix:[{block:"w-action",mods:{type:"sub"},js:!0},{block:"w-getting-started",elem:"elem",elemMods:{"page-menu":"2"}}],content:BEM.I18N("b-page-more-panel","create_page")},{block:"b-page-more-panel-item",mix:[{block:"w-action",mods:{type:"tree"},js:!0}],content:BEM.I18N("b-page-more-panel","tree")},{block:"b-page-more-panel-item",mods:{disabled:this.ctx.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"move"},js:{type:"page"}}],content:BEM.I18N("b-page-more-panel","move")},{block:"b-page-more-panel-item",mods:{disabled:this.ctx.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"subscribe"},js:!0}],content:BEM.I18N("b-page-more-panel","subscriptions_control")},{block:"b-page-more-panel-item",mods:{disabled:this.ctx.redirect?"yes":""},mix:{block:"w-action",mods:{type:"access"},js:!0},content:BEM.I18N("b-page-more-panel","page_access")},{block:"b-page-more-panel-item",mods:{type:"old-page",disabled:this.ctx.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"old-page"},js:{actuality:"obsolete"===this.ctx.actuality?"obsolete":"actual"}}],content:"obsolete"===this.ctx.actuality?BEM.I18N("b-page-more-panel","mark_as_actual"):BEM.I18N("b-page-more-panel","mark_as_obsolete")},{block:"b-page-more-panel-item",mix:[{block:"w-action",mods:{type:"referrers"},js:!0}],content:BEM.I18N("b-page-more-panel","referrers")},{block:"b-page-more-panel-item",mix:[{block:"w-action",mods:{type:"settings"},js:{user:this.ctx.user}}],content:BEM.I18N("b-page-more-panel","settings")},{block:"b-page-more-panel-item",mods:{disabled:this.ctx.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"delete"},js:{type:"page",breadcrumbs:this.ctx.breadcrumbs}}],content:BEM.I18N("b-page-more-panel","delete")},{block:"w-action",mods:{type:"unsubscribe"},js:!0},{block:"w-action",mods:{type:"subpages-change-author"},js:!0},{block:"w-action",mods:{type:"files"},js:!0},{block:"w-action",mods:{type:"authors"},js:!0},{block:"w-action",mods:{type:"authorship"},js:!0},{block:"w-action",mods:{type:"request-page-author"},js:!0}]})),n("paranja").def()(function(){return x({"mods.state":this.mods.state||"close","mods.theme":this.mods.theme||"normal"})}),n("b-old-page-mark").content()(function(){return[{elem:"text",content:BEM.I18N("b-old-page-mark","old_page")},{elem:"popup",content:[{block:"popup2",mods:{target:"anchor",theme:"normal",autoclosable:"yes",page:"old-page"},directions:["bottom-center"],content:[{elem:"content",content:[{block:"b-old-page-mark",elem:"date",content:[BEM.I18N("b-old-page-mark","last_update")+" ",{block:"m-date",format:"full",timestamp:this.ctx.modified_at}]}]}]}]}]}),n("b-autocomplete-item")(l()("li"),e(function(){return this.ctx.search_cgi&&Array.isArray(this.ctx.search_cgi)})["undefined"!=typeof addJs?"addJs":"js"]()(function(){return{cgi:this.ctx.search_cgi}}),("undefined"!=typeof addJs?addJs:u)()(!0),("undefined"!=typeof addJs?addMix:p)()(function(){return[{mods:{pers:this.ctx.pers?"yes":""}}]}),f()(function(){var t=this.ctx.data;return(0,BEM.blocks["b-autocomplete-item"].highlight)(this.xmlEscape(Array.isArray(t)?t[1]:t),this.ctx.hl)})),n("b-autocomplete-item").mod("type","foot")(("undefined"!=typeof addJs?addMix:p)()(function(){return[{mods:{enterable:"no"}}]}),f()(function(){return this.ctx.data.slice(1).map(function(t){return Array.isArray(t)?{tag:"span",elem:"foot",content:t[0]}:t},this)})),n("b-autocomplete-item").mod("type","lingvo").content()(function(){var t=this.ctx.data[1];return[{tag:"span",elem:"text",content:t.text},{tag:"span",elem:"translation",content:[" — ",t.translation]}]}),n("b-page-more-panel-item").js()(!0),n("page-editor").content()(function(t,e){return[{elem:"header"},{elem:"topbar"},{elem:"info"},{elem:"editor"},{elem:"preview"},{elem:"bottombar",pageUrl:e.pageUrl,withNewWf:e.withNewWf,canSwitchWf:e.canSwitchWf}]}),n("m-replacer")(u()(!0),f()(function(){return[{elem:"text",content:this.ctx.content}]})),n("m-replacer").elem("text").tag()("span"),n("m-replacer").elem("field")(l()("span"),f()(function(){return[{block:"input",js:{autoFocus:"yes"},mods:{size:"s",type:"replace"},value:this.ctx.val,content:{elem:"control"}}]})),n("popup2").mod("target","position").js()(function(){return this.extend({position:this.ctx.position},x())}),n("tumbler")(l()("span"),u()(function(){return this.extend({live:!1},x())}),c()(function(){var t=this.ctx,e=this.generateId(),i=[].concat(t.content||[]),n="",s="",o=function(t){"left"===t.side?n=t:"right"===t.side&&(s=t)};return void 0===this.mods.view&&(this.mods.view="classic"),i[0]&&o(i[0]),i[1]&&o(i[1]),x({_view:this.mods.view,_name:t.name||(t.name=e),_leftId:!!n&&"left"+e,_rightId:!!s&&"right"+e,_tabindex:t.tabindex||0,_checked:Boolean(this.mods.checked),_disabled:Boolean(this.mods.disabled),_leftLabel:n,_rightLabel:s})}),f()(function(){var t=this._leftLabel,e=this._rightLabel;return[t,{elem:"box"},e,{elem:"input",values:[Object(t).value||"false",Object(e).value||"true"]}]})),n("tumbler").elem("input")(l()("input"),("undefined"!=typeof addJs?addJs:u)()(function(){return{_values:this.ctx.values}}),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t=this._checked?this._rightId||this._leftId:this._leftId||this._rightId;return{type:"checkbox",name:this._name,checked:this._checked,value:this.ctx.values[Number(this._checked)],disabled:this._disabled,tabindex:"-1",autocomplete:"off","aria-hidden":"true","aria-labelledby":t}})),n("tooltip").mod("theme","promo")(("undefined"!=typeof addJs?addJs:u)()(function(){return{secondaryOffset:-30,tailOffset:30}})),n("b-grid-table").elem("table").tag()("table"),n("b-grid-table-cell")(r("type","td").tag()("td"),r("type","th").tag()("th"),s("old-changed").tag()("span"),s("new-changed").tag()("span"),s("br").tag()("br")),n("m-datepicker")(u()(!0),s("great-chooser").tag()("form")),n("m-suggest").mod("type","b2b")(u()(function(){const t=x()||{},e=Object.assign({},t.addRequestParams,{org_id:this["i-global"].orgId});return Object.assign({},t,{addRequestParams:e})})),n("b-grid-table-head")(s("old-changed").tag()("span"),s("new-changed").tag()("span")),n("b-grid-table-list-options")(u()(function(){return{options:this.ctx.options}}),f()(function(){return[{elem:"items-container",content:[{elem:"drag-delimiter"}].concat(this.ctx.options.map(function(t){return{block:"b-grid-table-list-options-item",text:t}}))},{elem:"add-item",content:{block:"awesome-icon",mods:{icon:"plus",type:"add-item"}}},{block:"tooltip",js:{to:["right"]},mods:{size:"xs",theme:"error",type:"duplicate"},content:BEM.I18N("b-grid-table-list-options","duplicate")}]})),n("b-grid-table-list-options-item")(u()(function(){return{text:this.ctx.text}}),f()(function(){return[{block:"awesome-icon",mods:{icon:"reorder",type:"sort"},attrs:{draggable:"true"}},{elem:"item-content-wrapper",content:[{elem:"item-content",content:this.ctx.text},{block:"input",mods:{size:"s",type:"item-val"},content:[{elem:"control"}],value:this.ctx.text}]},{block:"awesome-icon",mods:{icon:"trash",type:"remove"}}]})),n("b-grid-table-bar")(u()(function(){return{isAction:this.ctx.isAction}}),f()(function(){return[{block:"b-grid-table-options",js:{gridUrl:this.ctx.gridUrl,isAction:this.ctx.isAction,actuality:this.ctx.actuality,fieldsCount:this.ctx.fieldsCount,redirect:this.ctx.redirect},breadcrumbs:this.ctx.breadcrumbs,user:this.ctx.user},{block:"b-grid-table-editors",js:{supertag:this.ctx.gridUrl}},{elem:"scroll-arrows",content:[{block:"awesome-icon",mods:{icon:"angle-left",type:"scroll-left"}},{block:"awesome-icon",mods:{icon:"angle-right",type:"scroll-right"}}]},{block:"button2",mix:[{block:"w-getting-started",elem:"elem",elemMods:{"edit-grid":"1"}}],mods:{size:"s",theme:"action",role:"edit"},text:BEM.I18N("b-grid-table","edit")}]})),n("b-grid-table-editors")(u()(!0),s("editor")(l()("img"),d()(function(){return{src:"//center.yandex-team.ru/api/v1/user/"+this.ctx.user.login+"/avatar/50.jpg"}}))),n("b-grid-table-editors").elem("editor").attrs()(function(){return{src:this["w-userpic"].getAvatarUrl(this["i-global"].hosts.avatars.url,this.ctx.user.uid)}}),n("b-grid-table-options").content()(function(){return[{block:"dropdown2",mods:{switcher:"button2",theme:"normal",autoclosable:"yes",role:"table-options"},switcher:{block:"button2",mods:{theme:"normal",size:"s"},content:{block:"awesome-icon",mods:{icon:"cog"}}},popup:{block:"popup2",mods:{role:"table-options"},directions:["top-left","bottom-left","right-center"],content:[{block:"b-grid-table-options-item",content:BEM.I18N("b-grid-table-options","tree"),mods:{action:"tree"},mix:{block:"w-action",mods:{type:"tree"},js:!0},js:!0},{block:"b-grid-table-options-item",content:BEM.I18N("b-grid-table-options","copy"),mods:{action:"copy",disabled:!this.ctx.js.isAction&&this.ctx.js.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"copy"},js:{type:"grid",isAction:this.ctx.js.isAction||!1,source:"/"+this.ctx.js.gridUrl}}],js:!0},{block:"b-grid-table-options-item",content:BEM.I18N("b-grid-table-options","move"),mods:{action:"move",disabled:!this.ctx.js.isAction&&this.ctx.js.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"move"},js:{type:"grid",isAction:this.ctx.js.isAction||!1,source:"/"+this.ctx.js.gridUrl}}],js:!0},{block:"b-grid-table-options-item",content:BEM.I18N("b-grid-table-options","import"),mods:{action:"import",disabled:!this.ctx.js.isAction&&this.ctx.js.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"import"},js:{type:"grid",isAction:this.ctx.js.isAction||!1,source:"/"+this.ctx.js.gridUrl,fieldsCount:this.ctx.js.fieldsCount}}],js:!0},{block:"b-grid-table-options-item",content:BEM.I18N("b-grid-table-options","export"),mods:{action:"export",disabled:!this.ctx.js.isAction&&this.ctx.js.redirect?"yes":""},js:!0},this.ctx.js.isAction&&{block:"b-grid-table-options-item",content:BEM.I18N("b-grid-table-options","parent_table"),mods:{action:"parent"},js:!0},!this.ctx.js.isAction&&{block:"b-grid-table-options-item",content:"obsolete"===this.ctx.js.actuality?BEM.I18N("b-grid-table-options","mark_as_actual"):BEM.I18N("b-grid-table-options","mark_as_obsolete"),mods:{action:"old-page",disabled:!this.ctx.js.isAction&&this.ctx.js.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"old-page"},js:{actuality:"obsolete"===this.ctx.js.actuality?"obsolete":"actual"}}],js:!0},{block:"b-grid-table-options-item",content:BEM.I18N("b-grid-table-options","referrers"),mods:{action:"settings"},mix:[{block:"w-action",mods:{type:"referrers"},js:!0}],js:!0},{block:"b-grid-table-options-item",content:BEM.I18N("b-grid-table-options","settings"),mods:{action:"settings"},mix:[{block:"w-action",mods:{type:"settings"},js:{isAction:this.ctx.js.isAction||!1,source:"/"+this.ctx.js.gridUrl,user:this.ctx.user}}],js:!0},{elem:"line"},{block:"b-grid-table-options-item",content:BEM.I18N("b-grid-table-options","delete"),mods:{action:"delete",disabled:!this.ctx.js.isAction&&this.ctx.js.redirect?"yes":""},mix:[{block:"w-action",mods:{type:"delete"},js:{type:"grid",isAction:this.ctx.js.isAction||!1,source:"/"+this.ctx.js.gridUrl,breadcrumbs:this.ctx.breadcrumbs}}],js:!0},{block:"w-action",mods:{type:"subscribe"},js:!0},{block:"w-action",mods:{type:"unsubscribe"},js:!0},{block:"w-action",mods:{type:"subpages-change-author"},js:!0},{block:"w-action",mods:{type:"access"},js:!0},{block:"w-action",mods:{type:"files"},js:!0},{block:"w-action",mods:{type:"authors"},js:!0},{block:"w-action",mods:{type:"authorship"},js:!0},E("rejected-access"),{block:"w-action",mods:{type:"request-page-author"},js:!0}]}}]}),n("w-authors")(u()(function(){return{visibleCount:this.ctx.visibleCount,inline:this.ctx.inline,withPhoto:this.ctx.withPhoto}}),f()(function(){return{block:"spin2",mods:{size:"xs",progress:""}}})),n("w-authors").elem("button").replace()(function(){return{block:"button2",mods:{theme:"normal",size:"s",type:"submit",pin:"circle-circle"},text:BEM.I18N("w-authors","more",{count:this.ctx.count})}}),n("w-authors").elem("author")(f()(function(){return{block:"w-username",user:this.ctx.author}})),n("w-authors").elem("author").elemMod("with-photo",!0)(f()(function(){return[{elem:"photo",tag:"img",attrs:{src:"//center.yandex-team.ru/api/v1/user/"+this.ctx.author.login+"/avatar/100.jpg"}},this.ctx.author.display]}),p()(function(){return{block:"mi-staff-card",js:{user:this.ctx.author.login}}})),n("w-authors").elem("author").elemMod("with-photo",!0)(f()(function(){return[{elem:"photo",content:{block:"w-userpic",uid:this.ctx.author.uid||this.ctx.author.id,size:25}},this.ctx.author.display]}),p()(function(){return{block:"staff-lite-card",js:{staffLiteHost:this["i-global"].hosts.staff.url,user:this.ctx.author.login}}})),n("b-readonly").content()(function(){return[{elem:"wrapper",content:[{elem:"text",content:[BEM.I18N("b-readonly","in_readonly"),{html:"<br/>"},BEM.I18N("b-readonly","cant_change")]},{elem:"close",content:{block:"awesome-icon",mods:{icon:"remove"}}}]},{elem:"icon"}]}),n("b-footer").js()(!0),b(function(t){var e=t["i-services"]=t.BEMContext.prototype["i-services"]={},i=t["i-global"];e.serviceName=function(t){return BEM.I18N("i-services",t||i.id)},e.serviceUrl=function(t,n){var s=i;return t||(t=s.id),n||(n=s["content-region"]),e._data[t](n)}}),n("i-services").def()(s("name")(function(){return M(this["i-services"].serviceName(this.ctx.id))}),s("url")(function(){return M(this["i-services"].serviceUrl(this.ctx.id,this.ctx.region))})),b(function(t){t["i-services"]._data={ads:function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://yandex.com";case"tr":return"https://yandex.com.tr";case"az":return"https://yandex.az";case"il":return"https://yandex.co.il";case"am":return"https://yandex.com.am";case"ge":return"https://yandex.com.ge";case"ee":return"https://yandex.ee";case"fr":return"https://yandex.fr";case"kg":return"https://yandex.kg";case"lt":return"https://yandex.lt";case"lv":return"https://yandex.lv";case"md":return"https://yandex.md";case"tj":return"https://yandex.tj";case"tm":return"https://yandex.tm";case"uz":return"https://yandex.uz";default:return"https://yandex.ru"}},advertising:function(t){switch(t){case"ua":return"https://advertising.yandex.ua";case"by":return"https://advertising.yandex.by";case"kz":return"https://advertising.yandex.kz";case"com":return"https://advertising.yandex.com";case"tr":return"https://yandex.com.tr/adv";default:return"https://advertising.yandex.ru"}},afisha:function(t){switch(t){case"ua":return"https://afisha.yandex.ua";case"by":return"https://afisha.yandex.by";case"kz":return"https://afisha.yandex.kz";default:return"https://afisha.yandex.ru"}},all:function(t){switch(t){case"ua":return"https://yandex.ua/all";case"by":return"https://yandex.by/all";case"kz":return"https://yandex.kz/all";case"com":return"https://yandex.com/all";case"tr":return"https://yandex.com.tr/all";case"ee":return"https://yandex.ee/all";case"uz":return"https://yandex.uz/all";default:return"https://yandex.ru/all"}},api:function(t){switch(t){case"com":return"https://api.yandex.com";default:return"https://api.yandex.ru"}},appmetrica:function(t){switch(t){case"ua":return"https://appmetrica.yandex.ua";case"by":return"https://appmetrica.yandex.by";case"kz":return"https://appmetrica.yandex.kz";case"com":return"https://appmetrica.yandex.com";case"tr":return"https://appmetrica.yandex.com.tr";default:return"https://appmetrica.yandex.ru"}},audience:function(t){switch(t){case"ua":return"https://audience.yandex.ua";case"by":return"https://audience.yandex.by";case"kz":return"https://audience.yandex.kz";case"com":return"https://audience.yandex.com";case"tr":return"https://audience.yandex.com.tr";default:return"https://audience.yandex.ru"}},auto:function(t){switch(t){case"ua":return"https://auto.yandex.ua";default:return"https://auto.yandex.ru"}},autoru:function(){return"https://auto.ru"},avia:function(t){switch(t){case"ua":return"https://avia.yandex.ua";default:return"https://avia.yandex.ru"}},ba:function(t){switch(t){case"ua":return"https://ba.yandex.ua";case"by":return"https://ba.yandex.by";case"kz":return"https://ba.yandex.kz";case"com":return"https://ba.yandex.com";default:return"https://ba.yandex.ru"}},balance:function(){return"https://balance.yandex.ru"},bar:function(t){switch(t){case"ua":return"https://bar.yandex.ua";case"by":return"https://bar.yandex.by";case"kz":return"https://bar.yandex.kz";case"tr":return"https://bar.yandex.com.tr";default:return"https://bar.yandex.ru"}},"bar-ie":function(t){switch(t){case"ua":return"https://bar.yandex.ua/ie";case"by":return"https://bar.yandex.by/ie";case"kz":return"https://bar.yandex.kz/ie";case"com":return"https://bar.yandex.com/ie";case"tr":return"https://bar.yandex.com.tr/ie";default:return"https://bar.yandex.ru/ie"}},"bar-ie9":function(t){switch(t){case"ua":return"https://bar.yandex.ua/ie";case"by":return"https://bar.yandex.by/ie";case"kz":return"https://bar.yandex.kz/ie";case"com":return"https://bar.yandex.com/ie";case"tr":return"https://bar.yandex.com.tr/ie";default:return"https://bar.yandex.ru/ie"}},blogs:function(t){switch(t){case"ua":return"https://yandex.ua/blogs";case"by":return"https://yandex.by/blogs";case"kz":return"https://yandex.kz/blogs";case"com":return"https://yandex.com/blogs";case"tr":return"https://yandex.com.tr/blogs";case"az":return"https://yandex.az/blogs";case"il":return"https://yandex.co.il/blogs";case"am":return"https://yandex.com.am/blogs";case"ge":return"https://yandex.com.ge/blogs";case"ee":return"https://yandex.ee/blogs";case"fr":return"https://yandex.fr/blogs";case"kg":return"https://yandex.kg/blogs";case"lt":return"https://yandex.lt/blogs";case"lv":return"https://yandex.lv/blogs";case"md":return"https://yandex.md/blogs";case"tj":return"https://yandex.tj/blogs";case"tm":return"https://yandex.tm/blogs";case"uz":return"https://yandex.uz/blogs";default:return"https://yandex.ru/blogs"}},browser:function(t){switch(t){case"ua":return"https://browser.yandex.ua";case"by":return"https://browser.yandex.by";case"kz":return"https://browser.yandex.kz";case"com":return"https://browser.yandex.com";case"tr":return"https://browser.yandex.com.tr";default:return"https://browser.yandex.ru"}},"business-all":function(t){switch(t){case"com":return"https://business.yandex.com";default:return"https://business.yandex.ru"}},calendar:function(){return"https://calendar.yandex.ru"},chat:function(){return" "},city:function(t){switch(t){case"ua":return"https://gorod.yandex.ua";case"by":return"https://gorod.yandex.by";case"kz":return"https://gorod.yandex.kz";case"com":return"https://city.yandex.com";case"tr":return"https://city.yandex.com.tr";default:return"https://gorod.yandex.ru"}},clickhouse:function(){return"https://clickhouse.yandex/"},collections:function(t){switch(t){case"ua":return"https://yandex.ua/collections/";case"by":return"https://yandex.by/collections/";case"kz":return"https://yandex.kz/collections/";default:return"https://yandex.ru/collections/"}},commander:function(t){switch(t){case"ua":case"by":case"kz":case"com":case"tr":default:return"https://yandex.ru/promo/commander/new"}},company:function(t){switch(t){case"com":return"https://company.yandex.com";case"tr":return"https://company.yandex.com.tr";default:return"https://company.yandex.ru"}},connectApi:function(t){switch(t){case"ru":return"https://connect.yandex.ru";case"com":return"https://connect.yandex.com";default:return" "}},contest:function(t){switch(t){case"com":return"https://contest.yandex.com";default:return"https://contest.yandex.ru"}},delivery:function(){return"https://delivery.yandex.ru"},desktop:function(){return"https://desktop.yandex.ru"},direct:function(t){switch(t){case"ua":return"https://direct.yandex.ua";case"by":return"https://direct.yandex.by";case"kz":return"https://direct.yandex.kz";case"com":return"https://direct.yandex.com";case"tr":return"https://direct.yandex.com.tr";default:return"https://direct.yandex.ru"}},"direct-api":function(t){switch(t){case"ua":case"by":case"kz":return"https://tech.yandex.ru/direct";case"com":case"tr":return"https://tech.yandex.com/direct";default:return"https://tech.yandex.ru/direct"}},"direct-page":function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://yandex.com";case"tr":return"https://yandex.com.tr";case"az":return"https://yandex.az";case"il":return"https://yandex.co.il";case"am":return"https://yandex.com.am";case"ge":return"https://yandex.com.ge";case"ee":return"https://yandex.ee";case"fr":return"https://yandex.fr";case"kg":return"https://yandex.kg";case"lt":return"https://yandex.lt";case"lv":return"https://yandex.lv";case"md":return"https://yandex.md";case"tj":return"https://yandex.tj";case"tm":return"https://yandex.tm";case"uz":return"https://yandex.uz";default:return"https://yandex.ru"}},"direct.market":function(){return"https://partner.market.yandex.ru/yandex.market/"},directoryApi:function(t){switch(t){case"ru":return"https://api.directory.yandex.ru";case"com":return"https://api.directory.yandex.com";default:return" "}},disk:function(t){switch(t){case"ua":return"https://disk.yandex.ua";case"by":return"https://disk.yandex.by";case"kz":return"https://disk.yandex.kz";case"com":return"https://disk.yandex.com";case"tr":return"https://disk.yandex.com.tr";case"az":return"https://disk.yandex.az";case"il":return"https://disk.yandex.co.il";case"am":return"https://disk.yandex.com.am";case"ge":return"https://disk.yandex.com.ge";case"ee":return"https://disk.yandex.ee";case"fr":return"https://disk.yandex.fr";case"kg":return"https://disk.yandex.kg";case"lt":return"https://disk.yandex.lt";case"lv":return"https://disk.yandex.lv";case"md":return"https://disk.yandex.md";case"tj":return"https://disk.yandex.tj";case"tm":return"https://disk.yandex.tm";case"uz":return"https://disk.yandex.uz";default:return"https://disk.yandex.ru"}},display:function(t){switch(t){case"tr":return"https://display.yandex.com.tr";default:return"https://display.yandex.ru"}},ege:function(){return"https://ege.yandex.ru"},ether:function(t){switch(t){case"kz":return"https://yandex.kz/portal/efir";default:return"https://yandex.ru/portal/efir"}},expert:function(){return"https://expert.yandex.ru"},feedback:function(t){switch(t){case"ua":return"https://feedback.yandex.ua";case"by":return"https://feedback.yandex.by";case"kz":return"https://feedback.yandex.kz";case"com":return"https://feedback.yandex.com";case"tr":return"https://contact.yandex.com.tr";default:return"https://feedback.yandex.ru"}},feedback2:function(t){switch(t){case"ua":return"https://feedback2.yandex.ua";case"by":return"https://feedback2.yandex.by";case"kz":return"https://feedback2.yandex.kz";case"com":return"https://feedback2.yandex.com";case"tr":return"https://contact2.yandex.com.tr";default:return"https://feedback2.yandex.ru"}},ff:function(){return"https://ff.yandex.ru"},fotki:function(){return"https://fotki.yandex.ru"},fresh:function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://yandex.com";case"tr":return"https://yandex.com.tr";default:return"https://yandex.ru"}},fx:function(t){switch(t){case"ua":return"https://fx.yandex.ua";case"tr":return"https://fx.yandex.com.tr";default:return"https://fx.yandex.ru"}},games:function(){return"https://games.yandex.ru"},help:function(t){switch(t){case"ua":return"https://help.yandex.ua";case"com":return"https://help.yandex.com";case"tr":return"https://yardim.yandex.com.tr";default:return"https://help.yandex.ru"}},i:function(){return"https://i.yandex.ru"},ie:function(t){switch(t){case"ua":return"https://ie.yandex.ua";case"tr":return"https://ie.yandex.com.tr";default:return"https://ie.yandex.ru"}},images:function(t){switch(t){case"ua":return"https://yandex.ua/images/";case"by":return"https://yandex.by/images/";case"kz":return"https://yandex.kz/images/";case"com":return"https://yandex.com/images/";case"tr":return"https://yandex.com.tr/gorsel/";case"az":return"https://yandex.az/images/";case"il":return"https://yandex.co.il/images/";case"am":return"https://yandex.com.am/images/";case"ge":return"https://yandex.com.ge/images/";case"ee":return"https://yandex.ee/images/";case"fr":return"https://yandex.fr/images/";case"kg":return"https://yandex.kg/images/";case"lt":return"https://yandex.lt/images/";case"lv":return"https://yandex.lv/images/";case"md":return"https://yandex.md/images/";case"tj":return"https://yandex.tj/images/";case"tm":return"https://yandex.tm/images/";case"uz":return"https://yandex.uz/images/";case"fi":return"https://yandex.fi/images/";case"pl":return"https://yandex.pl/images/";default:return"https://yandex.ru/images/"}},internet:function(t){switch(t){case"com":return"https://internet.yandex.com";case"tr":return"https://internet.yandex.com.tr";default:return"https://internet.yandex.ru"}},kassa:function(){return"https://kassa.yandex.ru"},legal:function(t){switch(t){case"ua":return"https://yandex.ua/legal";case"com":return"https://yandex.com/legal";case"tr":return"https://yandex.com.tr/legal";default:return"https://yandex.ru/legal"}},literacy:function(){return"https://literacy.yandex.ru"},local:function(){return"https://local.yandex.ru"},mail:function(t){switch(t){case"ua":return"https://mail.yandex.ua";case"by":return"https://mail.yandex.by";case"kz":return"https://mail.yandex.kz";case"com":return"https://mail.yandex.com";case"tr":return"https://mail.yandex.com.tr";case"az":return"https://mail.yandex.az";case"il":return"https://mail.yandex.co.il";case"am":return"https://mail.yandex.com.am";case"ge":return"https://mail.yandex.com.ge";case"ee":return"https://mail.yandex.ee";case"fr":return"https://mail.yandex.fr";case"kg":return"https://mail.yandex.kg";case"lt":return"https://mail.yandex.lt";case"lv":return"https://mail.yandex.lv";case"md":return"https://mail.yandex.md";case"tj":return"https://mail.yandex.tj";case"tm":return"https://mail.yandex.tm";case"uz":return"https://mail.yandex.uz";default:return"https://mail.yandex.ru"}},maps:function(t){switch(t){case"ua":return"https://yandex.ua/maps/";case"by":return"https://yandex.by/maps/";case"kz":return"https://yandex.kz/maps/";case"com":return"https://yandex.com/maps/";case"tr":return"https://yandex.com.tr/harita/";case"az":return"https://yandex.az/maps/";case"il":return"https://yandex.co.il/maps/";case"am":return"https://yandex.com.am/maps/";case"ge":return"https://yandex.com.ge/maps/";case"ee":return"https://yandex.ee/maps/";case"fr":return"https://yandex.fr/maps/";case"kg":return"https://yandex.kg/maps/";case"lt":return"https://yandex.lt/maps/";case"lv":return"https://yandex.lv/maps/";case"md":return"https://yandex.md/maps/";case"tj":return"https://yandex.tj/maps/";case"tm":return"https://yandex.tm/maps/";case"uz":return"https://yandex.uz/maps/";case"fi":return"https://yandex.fi/maps/";default:return"https://yandex.ru/maps/"}},market:function(t){switch(t){case"ua":return"https://market.yandex.ua";case"by":return"https://market.yandex.by";case"kz":return"https://market.yandex.kz";default:return"https://market.yandex.ru"}},"market.advertising":function(t){switch(t){case"com":return"https://yandex.com/adv/products/classified/market";default:return"https://yandex.ru/adv/products/classified/market"}},mediametrica:function(){return"https://media.metrika.yandex.ru"},metrika:function(t){switch(t){case"ua":return"https://metrika.yandex.ua";case"by":return"https://metrika.yandex.by";case"kz":return"https://metrika.yandex.kz";case"com":return"https://metrica.yandex.com";case"tr":return"https://metrica.yandex.com.tr";case"az":return"https://metrika.yandex.az";case"il":return"https://metrika.yandex.co.il";case"am":return"https://metrika.yandex.com.am";case"ge":return"https://metrika.yandex.com.ge";case"ee":return"https://metrika.yandex.ee";case"fr":return"https://metrika.yandex.fr";case"kg":return"https://metrika.yandex.kg";case"lt":return"https://metrika.yandex.lt";case"lv":return"https://metrika.yandex.lv";case"md":return"https://metrika.yandex.md";case"tj":return"https://metrika.yandex.tj";case"tm":return"https://metrika.yandex.tm";case"uz":return"https://metrika.yandex.uz";default:return"https://metrika.yandex.ru"}},metro:function(){return"https://metro.yandex.ru"},mobile:function(t){switch(t){case"ua":return"https://mobile.yandex.ua";case"tr":return"https://mobil.yandex.com.tr";default:return"https://mobile.yandex.ru"}},moikrug:function(){return"https://moikrug.ru"},money:function(){return"https://money.yandex.ru"},music:function(t){switch(t){case"ua":return"https://music.yandex.ua";case"by":return"https://music.yandex.by";case"kz":return"https://music.yandex.kz";default:return"https://music.yandex.ru"}},"music-partner":function(){return"https://music-partner.yandex.ru"},news:function(t){switch(t){case"ua":return"https://news.yandex.ua";case"by":return"https://news.yandex.by";case"kz":return"https://news.yandex.kz";case"com":return"https://news.yandex.com";case"tr":return"https://haber.yandex.com.tr";case"az":return"https://news.yandex.az";case"il":return"https://news.yandex.co.il";case"am":return"https://news.yandex.com.am";case"ge":return"https://news.yandex.com.ge";case"ee":return"https://news.yandex.ee";case"fr":return"https://news.yandex.fr";case"kg":return"https://news.yandex.kg";case"lt":return"https://news.yandex.lt";case"lv":return"https://news.yandex.lv";case"md":return"https://news.yandex.md";case"tj":return"https://news.yandex.tj";case"tm":return"https://news.yandex.tm";case"uz":return"https://news.yandex.uz";default:return"https://news.yandex.ru"}},oauth:function(t){switch(t){case"com":return"https://oauth.yandex.com";default:return"https://oauth.yandex.ru"}},online:function(){return"https://online.yandex.ru"},openid:function(){return"https://openid.yandex.ru"},opera:function(t){switch(t){case"tr":return"https://opera.yandex.com.tr";default:return"https://opera.yandex.ru"}},opinion:function(){return"https://opinion.yandex.ru"},partners:function(t){switch(t){case"ua":return"https://partner.yandex.ua";case"by":return"https://partner.yandex.by";case"kz":return"https://partner.yandex.kz";case"com":return"https://partner.yandex.com";default:return"https://partner2.yandex.ru"}},"partners-en":function(t){switch(t){case"ua":return"https://partner.yandex.ua";case"by":return"https://partner.yandex.by";case"kz":return"https://partner.yandex.kz";case"com":return"https://partner.yandex.com";default:return"https://partner2.yandex.ru"}},partnersearch:function(){return"https://yandex.ru"},pass:function(t){switch(t){case"ua":return"https://pass.yandex.ua";case"by":return"https://pass.yandex.by";case"kz":return"https://pass.yandex.kz";case"com":return"https://pass.yandex.com";case"tr":return"https://pass.yandex.com.tr";case"az":return"https://pass.yandex.az";case"il":return"https://pass.yandex.co.il";case"am":return"https://pass.yandex.com.am";case"ge":return"https://pass.yandex.com.ge";case"ee":return"https://pass.yandex.ee";case"fr":return"https://pass.yandex.fr";case"kg":return"https://pass.yandex.kg";case"lt":return"https://pass.yandex.lt";case"lv":return"https://pass.yandex.lv";case"md":return"https://pass.yandex.md";case"tj":return"https://pass.yandex.tj";case"tm":return"https://pass.yandex.tm";case"uz":return"https://pass.yandex.uz";default:return"https://pass.yandex.ru"}},passport:function(t){switch(t){case"ua":return"https://passport.yandex.ua";case"by":return"https://passport.yandex.by";case"kz":return"https://passport.yandex.kz";case"com":return"https://passport.yandex.com";case"tr":return"https://passport.yandex.com.tr";case"az":return"https://passport.yandex.az";case"il":return"https://passport.yandex.co.il";case"am":return"https://passport.yandex.com.am";case"ge":return"https://passport.yandex.com.ge";case"ee":return"https://passport.yandex.ee";case"fr":return"https://passport.yandex.fr";case"kg":return"https://passport.yandex.kg";case"lt":return"https://passport.yandex.lt";case"lv":return"https://passport.yandex.lv";case"md":return"https://passport.yandex.md";case"tj":return"https://passport.yandex.tj";case"tm":return"https://passport.yandex.tm";case"uz":return"https://passport.yandex.uz";default:return"https://passport.yandex.ru"}},passportApi:function(t){switch(t){case"ua":return"https://api.passport.yandex.ua";case"by":return"https://api.passport.yandex.by";case"kz":return"https://api.passport.yandex.kz";case"com":return"https://api.passport.yandex.com";case"tr":return"https://api.passport.yandex.com.tr";case"az":return"https://api.passport.yandex.az";case"il":return"https://api.passport.yandex.co.il";case"am":return"https://api.passport.yandex.com.am";case"ge":return"https://api.passport.yandex.com.ge";case"ee":return"https://api.passport.yandex.ee";case"fr":return"https://api.passport.yandex.fr";case"kg":return"https://api.passport.yandex.kg";case"lt":return"https://api.passport.yandex.lt";case"lv":return"https://api.passport.yandex.lv";case"md":return"https://api.passport.yandex.md";case"tj":return"https://api.passport.yandex.tj";case"tm":return"https://api.passport.yandex.tm";case"uz":return"https://api.passport.yandex.uz";default:return"https://api.passport.yandex.ru"}},patents:function(){return"https://yandex.ru/patents"},pdd:function(){return"https://pdd.yandex.ru"},peoplesearch:function(t){switch(t){case"ua":return"https://yandex.ua/people";case"by":return"https://yandex.by/people";case"kz":return"https://yandex.kz/people";case"com":return"https://yandex.com/people";case"tr":return"https://yandex.com.tr/people";case"az":return"https://yandex.az/people";case"il":return"https://yandex.co.il/people";case"am":return"https://yandex.com.am/people";case"ge":return"https://yandex.com.ge/people";case"ee":return"https://yandex.ee/people";case"fr":return"https://yandex.fr/people";case"kg":return"https://yandex.kg/people";case"lt":return"https://yandex.lt/people";case"lv":return"https://yandex.lv/people";case"md":return"https://yandex.md/people";case"tj":return"https://yandex.tj/people";case"tm":return"https://yandex.tm/people";case"uz":return"https://yandex.uz/people";default:return"https://yandex.ru/people"}},perevod:function(){return"https://perevod.yandex.ru"},plus:function(t){switch(t){case"by":return"https://plus.yandex.by";case"kz":return"https://plus.yandex.kz";default:return"https://plus.yandex.ru"}},probki:function(t){switch(t){case"ua":return"https://probki.yandex.ua";default:return"https://probki.yandex.ru"}},punto:function(){return"https://punto.yandex.ru"},q:function(){return"https://yandex.ru/q"},rabota:function(t){switch(t){case"ua":return"https://rabota.yandex.ua";case"by":return"https://rabota.yandex.by";case"kz":return"https://rabota.yandex.kz";default:return"https://rabota.yandex.ru"}},radar:function(t){switch(t){case"ru":return"https://radar.metrika.yandex?lang=ru";case"com":return"https://radar.metrika.yandex?lang=en";case"tr":return"https://radar.metrika.yandex?lang=tr";default:return"https://radar.metrika.yandex"}},rasp:function(t){switch(t){case"ua":return"https://rasp.yandex.ua";case"by":return"https://rasp.yandex.by";case"kz":return"https://rasp.yandex.kz";case"tr":return"https://seferler.yandex.com.tr";default:return"https://rasp.yandex.ru"}},realty:function(t){switch(t){case"ua":return"https://realty.yandex.ua";case"by":return"https://realty.yandex.by";case"kz":return"https://realty.yandex.kz";default:return"https://realty.yandex.ru"}},referats:function(){return"https://referats.yandex.ru"},review:function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://yandex.com";case"tr":return"https://yandex.com.tr";default:return"https://yandex.ru"}},rk:function(){return"https://rk.yandex.ru"},school:function(){return"https://school.yandex.ru"},search:function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://yandex.com";case"tr":return"https://yandex.com.tr";case"az":return"https://yandex.az";case"il":return"https://yandex.co.il";case"am":return"https://yandex.com.am";case"ge":return"https://yandex.com.ge";case"ee":return"https://yandex.ee";case"fr":return"https://yandex.fr";case"kg":return"https://yandex.kg";case"lt":return"https://yandex.lt";case"lv":return"https://yandex.lv";case"md":return"https://yandex.md";case"tj":return"https://yandex.tj";case"tm":return"https://yandex.tm";case"uz":return"https://yandex.uz";case"fi":return"https://yandex.fi";case"pl":return"https://yandex.pl";default:return"https://yandex.ru"}},serp:function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://yandex.com";case"tr":return"https://yandex.com.tr";case"az":return"https://yandex.az";case"il":return"https://yandex.co.il";case"am":return"https://yandex.com.am";case"ge":return"https://yandex.com.ge";case"ee":return"https://yandex.ee";case"fr":return"https://yandex.fr";case"kg":return"https://yandex.kg";case"lt":return"https://yandex.lt";case"lv":return"https://yandex.lv";case"md":return"https://yandex.md";case"tj":return"https://yandex.tj";case"tm":return"https://yandex.tm";case"uz":return"https://yandex.uz";case"fi":return"https://yandex.fi";case"pl":return"https://yandex.pl";default:return"https://yandex.ru"}},shtrafi:function(){return"https://money.yandex.net/debts"},site:function(t){switch(t){case"ua":return"https://site.yandex.ua";case"tr":return"https://ozel.yandex.com.tr";default:return"https://site.yandex.ru"}},slovari:function(t){switch(t){case"ua":return"https://slovari.yandex.ua";case"by":return"https://slovari.yandex.by";case"kz":return"https://slovari.yandex.kz";default:return"https://slovari.yandex.ru"}},social:function(t){switch(t){case"ua":return"https://social.yandex.ua";case"by":return"https://social.yandex.by";case"kz":return"https://social.yandex.kz";case"com":return"https://social.yandex.ru";case"tr":return"https://social.yandex.com.tr";default:return"https://social.yandex.ru"}},soft:function(t){switch(t){case"ua":return"https://soft.yandex.ua";case"tr":return"https://soft.yandex.com.tr";default:return"https://soft.yandex.ru"}},sport:function(){return"https://sports.ru"},sprav:function(t){switch(t){case"ua":return"https://yandex.ru/sprav";case"by":return"https://sprav.yandex.by";case"kz":return"https://sprav.yandex.kz";case"com":return"https://yandex.com/sprav";case"tr":return"https://rehber.yandex.com.tr";default:return"https://sprav.yandex.ru"}},stat:function(t){switch(t){case"ua":return"https://stat.yandex.ua";case"by":return"https://stat.yandex.by";default:return"https://stat.yandex.ru"}},support:function(t){switch(t){case"ua":return"https://yandex.ua/support/";case"by":return"https://yandex.by/support/";case"kz":return"https://yandex.kz/support/";case"com":return"https://yandex.com/support/";case"tr":return"https://yandex.com.tr/support/";default:return"https://yandex.ru/support/"}},surveys:function(t){switch(t){case"kz":return"https://surveys.yandex.kz";default:return"https://surveys.yandex.ru"}},tasix:function(){return"https://yandex.uz"},taxi:function(t){switch(t){case"ua":return"https://taxi.yandex.ua";case"by":return"https://taxi.yandex.by";case"kz":return"https://taxi.yandex.kz";case"com":return"https://taxi.yandex.com";case"ee":return"https://taxi.yandex.ee";case"kg":return"https://taxi.yandex.kg";case"lt":return"https://taxi.yandex.lt";case"lv":return"https://taxi.yandex.lv";case"md":return"https://taxi.yandex.md";case"uz":return"https://taxi.yandex.uz";case"rs":return"https://taxi.yandex.rs";default:return"https://taxi.yandex.ru"}},telephony:function(){return"https://telephony.yandex.ru/"},time:function(t){switch(t){case"ua":return"https://time.yandex.ua";case"by":return"https://time.yandex.by";case"kz":return"https://time.yandex.kz";case"com":return"https://time.yandex.com";case"tr":return"https://saat.yandex.com.tr";default:return"https://time.yandex.ru"}},toloka:function(t){switch(t){case"com":return"https://toloka.yandex.com";case"tr":return"https://toloka.yandex.com.tr";default:return"https://toloka.yandex.ru"}},translate:function(t){switch(t){case"ua":return"https://translate.yandex.ua";case"by":return"https://translate.yandex.by";case"kz":return"https://translate.yandex.kz";case"com":return"https://translate.yandex.com";case"tr":return"https://ceviri.yandex.com.tr";case"az":return"https://translate.yandex.az";case"il":return"https://translate.yandex.co.il";case"am":return"https://translate.yandex.com.am";case"ge":return"https://translate.yandex.com.ge";case"ee":return"https://translate.yandex.ee";case"fr":return"https://translate.yandex.fr";case"kg":return"https://translate.yandex.kg";case"lt":return"https://translate.yandex.lt";case"lv":return"https://translate.yandex.lv";case"md":return"https://translate.yandex.md";case"tj":return"https://translate.yandex.tj";case"tm":return"https://translate.yandex.tm";case"uz":return"https://translate.yandex.uz";default:return"https://translate.yandex.ru"}},tune:function(t){switch(t){case"ua":return"https://yandex.ua/tune";case"by":return"https://yandex.by/tune";case"kz":return"https://yandex.kz/tune";case"com":return"https://yandex.com/tune";case"tr":return"https://yandex.com.tr/tune";case"uz":return"https://yandex.uz/tune";default:return"https://yandex.ru/tune"}},tv:function(t){switch(t){case"ua":return"https://tv.yandex.ua";case"by":return"https://tv.yandex.by";case"kz":return"https://tv.yandex.kz";default:return"https://tv.yandex.ru"}},tvonline:function(){return"https://yandex.ru/?stream_channel=default"},ugc:function(t){switch(t){case"ua":return"https://yandex.ua/ugcpub/cabinet";case"by":return"https://yandex.by/ugcpub/cabinet";case"kz":return"https://yandex.kz/ugcpub/cabinet";case"com":return"https://yandex.com/ugcpub/cabinet";case"tr":return"https://yandex.com.tr/ugcpub/cabinet";case"az":return"https://yandex.az/ugcpub/cabinet";case"il":return"https://yandex.co.il/ugcpub/cabinet";case"am":return"https://yandex.com.am/ugcpub/cabinet";case"ge":return"https://yandex.com.ge/ugcpub/cabinet";case"ee":return"https://yandex.ee/ugcpub/cabinet";case"fr":return"https://yandex.fr/ugcpub/cabinet";case"kg":return"https://yandex.kg/ugcpub/cabinet";case"lt":return"https://yandex.lt/ugcpub/cabinet";case"lv":return"https://yandex.lv/ugcpub/cabinet";case"md":return"https://yandex.md/ugcpub/cabinet";case"tj":return"https://yandex.tj/ugcpub/cabinet";case"tm":return"https://yandex.tm/ugcpub/cabinet";case"uz":return"https://yandex.uz/ugcpub/cabinet";default:return"https://yandex.ru/ugcpub/cabinet"}},uslugi:function(){return"https://yandex.ru/uslugi"},video:function(t){switch(t){case"ua":return"https://yandex.ua/video/";case"by":return"https://yandex.by/video/";case"kz":return"https://yandex.kz/video/";case"com":return"https://yandex.com/video/";case"tr":return"https://yandex.com.tr/video/";case"az":return"https://yandex.az/video/";case"il":return"https://yandex.co.il/video/";case"am":return"https://yandex.com.am/video/";case"ge":return"https://yandex.com.ge/video/";case"ee":return"https://yandex.ee/video/";case"fr":return"https://yandex.fr/video/";case"kg":return"https://yandex.kg/video/";case"lt":return"https://yandex.lt/video/";case"lv":return"https://yandex.lv/video/";case"md":return"https://yandex.md/video/";case"tj":return"https://yandex.tj/video/";case"tm":return"https://yandex.tm/video/";case"uz":return"https://yandex.uz/video/";case"fi":return"https://yandex.fi/video/";case"pl":return"https://yandex.pl/video/";default:return"https://yandex.ru/video/"}},wdgt:function(t){switch(t){case"ua":return"https://wdgt.yandex.ua";case"by":return"https://wdgt.yandex.by";case"kz":return"https://wdgt.yandex.kz";case"tr":return"https://wdgt.yandex.com.tr";default:return"https://wdgt.yandex.ru"}},weather:function(t){switch(t){case"ua":return"https://pogoda.yandex.ua";case"by":return"https://pogoda.yandex.by";case"kz":return"https://pogoda.yandex.kz";case"tr":return"https://hava.yandex.com.tr";case"az":return"https://pogoda.yandex.az";case"il":return"https://pogoda.yandex.co.il";case"am":return"https://pogoda.yandex.com.am";case"ge":return"https://pogoda.yandex.com.ge";case"ee":return"https://pogoda.yandex.ee";case"fr":return"https://pogoda.yandex.fr";case"kg":return"https://pogoda.yandex.kg";case"lt":return"https://pogoda.yandex.lt";case"lv":return"https://pogoda.yandex.lv";case"md":return"https://pogoda.yandex.md";case"tj":return"https://pogoda.yandex.tj";case"tm":return"https://pogoda.yandex.tm";case"uz":return"https://pogoda.yandex.uz";default:return"https://pogoda.yandex.ru"}},webmaster:function(t){switch(t){case"ua":return"https://webmaster.yandex.ua";case"com":return"https://webmaster.yandex.com";case"tr":return"https://webmaster.yandex.com.tr";default:return"https://webmaster.yandex.ru"}},"webmaster-api":function(t){switch(t){case"com":case"tr":return"https://tech.yandex.com/webmaster/";default:return"https://tech.yandex.ru/webmaster/"}},widgets:function(t){switch(t){case"ua":return"https://widgets.yandex.ua";case"by":return"https://widgets.yandex.by";case"kz":return"https://widgets.yandex.kz";case"tr":return"https://widgets.yandex.com.tr";default:return"https://widgets.yandex.ru"}},wordstat:function(){return"https://wordstat.yandex.ru"},www:function(t){switch(t){case"ua":return"https://yandex.ua";case"by":return"https://yandex.by";case"kz":return"https://yandex.kz";case"com":return"https://yandex.com";case"tr":return"https://yandex.com.tr";case"az":return"https://yandex.az";case"il":return"https://yandex.co.il";case"am":return"https://yandex.com.am";case"ge":return"https://yandex.com.ge";case"ee":return"https://yandex.ee";case"fr":return"https://yandex.fr";case"kg":return"https://yandex.kg";case"lt":return"https://yandex.lt";case"lv":return"https://yandex.lv";case"md":return"https://yandex.md";case"tj":return"https://yandex.tj";case"tm":return"https://yandex.tm";case"uz":return"https://yandex.uz";case"fi":return"https://yandex.fi";case"pl":return"https://yandex.pl";default:return"https://yandex.ru"}},xmlsearch:function(t){switch(t){case"ua":return"https://xml.yandex.ua";case"by":return"https://xml.yandex.by";case"kz":return"https://xml.yandex.kz";case"com":return"https://xml.yandex.com";case"tr":return"https://xml.yandex.com.tr";default:return"https://xml.yandex.ru"}},yaca:function(t){switch(t){case"ua":return"https://yaca.yandex.ua";case"by":return"https://yaca.yandex.by";default:return"https://yaca.yandex.ru"}},yamb:function(){return"https://yamb.yandex.ru"},znatoki:function(){return"https://yandex.ru/znatoki"}}}),b(function(t){t["i-services"]._data.dashboard=function(t){switch(t){case"com":return"https://connect.yandex.com/home";default:return"https://connect.yandex.ru/home"}},t["i-services"]._data.staff=function(t){switch(t){case"com":return"https://connect.yandex.com/staff";default:return"https://connect.yandex.ru/staff"}},t["i-services"]._data.wiki=function(t){switch(t){case"com":return"https://wiki.yandex.com";default:return"https://wiki.yandex.ru"}},t["i-services"]._data.admin=function(t){switch(t){case"com":return"https://connect.yandex.com/portal";default:return"https://connect.yandex.ru/portal"}},t["i-services"]._data.tracker=function(t){switch(t){case"com":return"https://tracker.yandex.com";default:return"https://tracker.yandex.ru"}}}),n("w-user-settings")(u()(function(){return{settings:this.ctx.settings}}),f()(function(){var t=this.ctx.settings;return{block:"island",content:[{block:"w-user-settings",elem:"header",content:BEM.I18N("w-user-settings","settings")},{block:"w-user-settings",elem:"row",content:[{block:"w-user-settings",elem:"col",mix:{block:"w-user-settings",elem:"left-col"},content:BEM.I18N("w-user-settings","ui_lang")},{block:"w-user-settings",elem:"col",content:{block:"radio-button",mods:{theme:"normal",size:"s",type:"language"},name:"lang",value:t.language,content:[{elem:"radio",controlAttrs:{value:"ru"},content:"Русский"},{elem:"radio",controlAttrs:{value:"en"},content:"English"}]}}]},{block:"w-user-settings",elem:"row",content:[{block:"w-user-settings",elem:"col",mix:{block:"w-user-settings",elem:"left-col"},content:BEM.I18N("w-user-settings","content_translation")},{block:"w-user-settings",elem:"col",content:{block:"radio-button",mods:{theme:"normal",size:"s",type:"show-translate"},name:"translate",value:String(t.propose_content_translation),content:[{elem:"radio",controlAttrs:{value:"true"},content:BEM.I18N("w-user-settings","show")},{elem:"radio",controlAttrs:{value:"false"},content:BEM.I18N("w-user-settings","hide")}]}}]},{block:"w-user-settings",elem:"row",content:[{block:"w-user-settings",elem:"col",mix:{block:"w-user-settings",elem:"left-col"},content:BEM.I18N("w-user-settings","use_full_width_content")},{block:"w-user-settings",elem:"col",content:{block:"tumbler",mods:{theme:"normal",size:"s",checked:t.use_full_width_content?"":"yes",type:"use_full_width_content"}}}]},{block:"w-user-settings",elem:"submit",content:[{block:"spin2",mods:{size:"xs"}},{block:"button2",mods:{size:"s",theme:"action",role:"submit"},text:BEM.I18N("w-user-settings","save")}]}]}})),n("w-user-settings")(f()(function(){var t=this.ctx.settings;return{block:"island",content:[{block:"w-user-settings",elem:"header",content:BEM.I18N("w-user-settings","settings")},{block:"w-user-settings",elem:"row",content:[{block:"w-user-settings",elem:"col",mix:{block:"w-user-settings",elem:"left-col"},content:BEM.I18N("w-user-settings","use_full_width_content")},{block:"w-user-settings",elem:"col",content:{block:"tumbler",mods:{theme:"normal",size:"s",checked:t.use_full_width_content?"":"yes",type:"use_full_width_content"}}}]},{block:"w-user-settings",elem:"submit",content:[{block:"spin2",mods:{size:"xs"}},{block:"button2",mods:{size:"s",theme:"action",role:"submit"},text:BEM.I18N("w-user-settings","save")}]}]}})),n("wi-store").attrs()({style:"display: none"}),n("wiki-txt").replace()(function(){var t=this.ctx["wiki-attrs"].txt;return t=this.ctx.noEscape?{html:t}:t}),n("wiki-helper-label").def().match(function(){return!this._helper.length})(function(){return this._helper={en:{warn:{unclosed_opening_marker:"Unclosed opening marker",unclosed_opening_parenthesis:"Unclosed opening parenthesis",unclosed_opening_marker_till_eol:"Unclosed (within the line) opening marker",unpaired_closing_style_marker:"Unpaired closing style marker",empty_element:"Empty element",invalid_char_in_table:"Invalid char in the table inter-cell space",li_type_overriden_by_list_type:"Specified listitem type is overriden by list type",li_level_possibly_incorrect:"Listitem level is possibly incorrect",element_is_not_allowed_within_current_element:"Element is not allowed within the current element",element_disabled:"Element is disabled",style_opening_marker_inside_same_style:"Opening style marker inside the same style",invalid_filename:"invalid filename",result_may_be_incorrect_for_preview:"Result may be incorrect in preview",invalid_hostname:"Invalid hostname",invalid_formatter_name:"Invalid formatter name",invalid_action_name:"Invalid action name",invalid_protocol:"Invalid protocol",unknown_formatter_name:"Unknown formatter name",unknown_action_name:"Unknown action name",too_long_wiki_link:"Too long wiki page link"},err:{invalid_parameter:"Invalid parameter",invocation_error:"Invocation error",action_include_cycle:"Include action - cycle detected",action_include_error_loading:"Include action - error loading",action_include_no_access:"Content of the included page should be displayed here. But you have no access to the included page.",action_include_page_not_found:"Include action - page not found",action_include_incorrect_syntax_version:"Include action - page to include has incorrect syntax version",file_not_found:"File not found",action_include_incorrect_page_type:"Include action - unsupported page type. Use the action grid for tables.",action_include_anchor_not_found:"Anchor not found",action_include_invalid_boundaries:"Invalid include boundaries"},txt:{attention:"Attention!",contents:"Contents",more:"Details",empty:"empty","assign-jira":"Assign","comment-jira":"Comment","edit-jira":"Edit",edit:"edit",external_link:"External link (opens in new window)",ticket_soon:"The ticket details will soon be here"}},ru:{warn:{unclosed_opening_marker:"Незакрытый открывающий маркер",unclosed_opening_parenthesis:"Незакрытая открывающая скобка",unclosed_opening_marker_till_eol:"Незакрытый (в той же строке) открывающий маркер",unpaired_closing_style_marker:"Непарный закрывающий маркер стиля",empty_element:"Пустой элемент",invalid_char_in_table:"Недопустимый символ в межстрочном пространстве таблицы",li_type_overriden_by_list_type:"Указанный тип пункта списка перекрыт типом списка",li_level_possibly_incorrect:"Уровень пункта списка возможно неверен",element_is_not_allowed_within_current_element:"Элемент недопустим внутри текущего элемента",element_disabled:"Элемент отключен",style_opening_marker_inside_same_style:"Открывающий маркер стиля внутри такого же стиля",invalid_filename:"Недопустимое имя файла",result_may_be_incorrect_for_preview:"Результат может быть неверным при предварительном просмотре",invalid_hostname:"Неверное имя хоста",invalid_formatter_name:"Некорректное имя форматера",invalid_action_name:"Некорректное имя действия",invalid_protocol:"Некорректный протокол",unknown_formatter_name:"Неизвестное имя форматера",unknown_action_name:"Неизвестное имя действия",too_long_wiki_link:"Слишком длинная ссылка на вики страницу"},err:{invalid_parameter:"Некорректный параметр",invocation_error:"Ошибка при вызове",action_include_cycle:"Действие include - обнаружен цикл",action_include_error_loading:"На этом месте должен отображаться текст включенной страницы. Но у вас нет прав на включенную страницу.",action_include_no_access:"Действие include - нет доступа",action_include_page_not_found:"Действие include - страница не найдена",action_include_incorrect_syntax_version:"Действие include - неверная версия синтаксиса включаемой страницы",file_not_found:"Файл не найден",action_include_incorrect_page_type:"Действие include - неподдерживаемый тип страницы. Для таблиц используйте действие grid.",action_include_anchor_not_found:"Якорь не найден",action_include_invalid_boundaries:"Неверные границы в действии include"},txt:{attention:"Внимание!",contents:"Оглавление документа",more:"Детали",empty:"пусто","assign-jira":"Назначить","comment-jira":"Комментировать","edit-jira":"Редактировать",edit:"правка",external_link:"Внешняя ссылка (откроется в новом окне)",ticket_soon:"Тут скоро будет описание тикета"}},tr:{warn:{unclosed_opening_marker:"Unclosed opening marker",unclosed_opening_parenthesis:"Unclosed opening parenthesis",unclosed_opening_marker_till_eol:"Unclosed (within the line) opening marker",unpaired_closing_style_marker:"Unpaired closing style marker",empty_element:"Empty element",invalid_char_in_table:"Invalid char in the table inter-cell space",li_type_overriden_by_list_type:"Specified listitem type is overriden by list type",li_level_possibly_incorrect:"Listitem level is possibly incorrect",element_is_not_allowed_within_current_element:"Element is not allowed within the current element",element_disabled:"Element is disabled",style_opening_marker_inside_same_style:"Opening style marker inside the same style",invalid_filename:"invalid filename",result_may_be_incorrect_for_preview:"Result may be incorrect in preview",invalid_hostname:"Invalid hostname",invalid_formatter_name:"Invalid formatter name",invalid_action_name:"Invalid action name",invalid_protocol:"Invalid protocol",unknown_formatter_name:"Unknown formatter name",unknown_action_name:"Unknown action name",too_long_wiki_link:"Too long wiki page link"},err:{invalid_parameter:"Invalid parameter",invocation_error:"Invocation error",action_include_cycle:"Include action - cycle detected",action_include_error_loading:"Include action - error loading",action_include_no_access:"Content of the included page should be displayed here. But you have no access to the included page.",action_include_page_not_found:"Include action - page not found",action_include_incorrect_syntax_version:"Include action - page to include has incorrect syntax version",file_not_found:"File not found",action_include_incorrect_page_type:"Include action - unsupported page type. Use the action grid for tables.",action_include_anchor_not_found:"Anchor not found",action_include_invalid_boundaries:"Invalid include boundaries"},txt:{attention:"Dikkat!",contents:"İçerik",more:"Detaylar",empty:"boş","assign-jira":"Ata","comment-jira":"Yorum yaz","edit-jira":"Düzenle",edit:"düzenle",external_link:"Harici bağlantı (yeni pencerede açılır)",ticket_soon:"Bilet detayları yakında burada olacak"}}},""}),n("wiki-username").mode("staff_url")(function(){return this.wiki&&"production"==this.wiki.env?"https://staff.yandex-team.ru/":"https://staff.test.yandex-team.ru/"}),n("wiki-username")(l()(function(){return this.ctx.href||this.ctx.login?"a":"span"}),d()(function(){var t={href:this.ctx.href||this.ctx.login&&E("staff_url")+this.ctx.login};return this.ctx.counter&&(t.onmousedown=this.ctx.counter),t}),f()(function(){return Array.isArray(this.ctx.content)?this.ctx.content:[{elem:"first-letter",content:String(this.ctx.content).charAt(0)},String(this.ctx.content).slice(1)]}),s("first-letter").tag()("span")),n("wiki-username").mode("staff_url")(function(){return this.wiki&&"production"==this.wiki.env?"https://staff.yandex.ru/":"https://team.test.yandex.ru/"}),n("wiki-username").mod("staffCard","yes")(p()(function(){return{block:"staff-lite-card",js:{staffLiteHost:E("staff_url"),user:this.ctx.login}}})),n("wiki-username").mod("staffCard","yes").mix()(function(){return[{block:"mi-staff-card",js:{user:this.ctx.login}}]}),n("wiki-username").mod("staffCard","yes")(p()(function(){return{block:"staff-lite-card",js:{staffLiteHost:this["i-global"].hosts.staff.url,user:this.ctx.login}}})),n("wiki-ticket").mode("tracker_url")(function(){return this.wiki.tracker_url||"https://st.yandex-team.ru/"}),n("wiki-ticket")(l()("span"),c().match(function(){return!this.ctx.content})(function(){var t="",e=this.ctx["wiki-attrs"],i=e.link_view?e.link_view:E("tracker_url")+e.issue;return i&&(-1!==i.indexOf("st.yandex-team")?t="startrek":-1!==i.indexOf("jira.yandex-team")?t="jira":-1!==i.indexOf("lunapark.yandex-team")&&(t="lunapark")),M({block:"wiki-ticket",mods:{mode:e.ticket_type||t||"jira"},"wiki-attrs":e,content:[{elem:"issue",url:i,content:e.issue,"wiki-attrs":{issue:e.issue,status:e.status}}]})})),n("wiki-ticket").mode("tracker_url")(function(){return this.wiki.tracker_url||"https://tracker.yandex.ru/"}),n("wiki-strike").tag()("del"),n("wiki-ref")(o("helpers")(function(){return{getUrl:function(t){return"wiki"==t.type?t.file?t.page+"/.files/"+t.file:t.page:t.link},getExtLink:function(t){return t._helper[t.wiki.lang].txt.external_link},getAttrs:function(t,e){return"wiki"!=t.type?{title:this.getExtLink(e)}:"wiki"==t.type&&!t.ext&&e.ctx.content&&e.ctx.content[0]?{"data-title":"1"}:{}},getTarget:function(t){return"wiki"!=t.type&&"_blank"},getIconType:function(t){var e;return t.ext&&"unc"!=t.type?-1!=["doc","docx","mht","odt","rtf","txt","pdf","odp","ppt","pptx","csv","ods","ots","xls","xlsx","eml","vcf","exe","aac","mka","mp3","ogg","wav","wma","ai","bmp","cdr","djvu","eps","ps","psd","tga","tif","tiff","3gp","avi","flv","m2v","mkv","mov","mp4","mpe","mpeg","mpg","qt","vob","wmv","7z","arj","bz2","lzh","uc2","zip","rar","ads","adb","ada","a","asm","def","inc","ins","s","sa","S","src","c","h","cc","cpp","cxx","hh","hpp","hxx","M","pdb","cs","hs","cob","erl","hrl","fth","tok","f","f90","for","java","cl","clisp","el","l","lisp","LSP","lsp","ml","lua","makefile","GNUMakefile","Makefilein","Makefileam","lm","m","p","pas","pl","pm","ps","psw","pc","prolog","py","oak","sch","scheme","SCM","scm","SM","sm","ss","t","bib","clo","cls","ltx","sty","tex","texi","texinfo","txi","y","ym","yxx","yy","css","js","json","sql","hs","sh","bash","pyx","pyd"].indexOf(t.ext)&&(e="file"):"mailto"!=t.protocol&&"xmpp"!=t.protocol||(e="mail"),e},getMix:function(t){var e=t.ctx["wiki-attrs"],i=[];return this.getIconType(e)&&i.push({block:"b-link",mods:{ico:"ico-l"}}),i.push({block:"wiki-ref"}),e.docviewer&&i.push({block:"wiki-ref",mods:{type:"docviewer"},js:{docviewer:e.docviewer,url:this.getUrl(t.ctx["wiki-attrs"])}}),"uri"===e.type&&t.wiki.magiclinks_url&&i.push({block:"wiki-ref",mods:{magiclink:"yes"}}),e.hidden&&i.push({block:"wiki-ref",mods:{hidden:"yes"}}),i},getData:function(t){var e,i=t.ctx["wiki-attrs"],n=this.getIconType(i);return e=t.ctx.content&&t.ctx.content[0]?t.ctx.content:i.ext&&"wiki"==i.type?"file:"+i.file:i.link,[t.ctx.content&&"wiki-img"==t.ctx.content[0].block?"":n&&{block:"b-icon",mix:[{mods:{type:n,first:"yes"}}]},e]},getContent:function(t){return[{block:"b-link",url:this.getUrl(t.ctx["wiki-attrs"]),attrs:this.getAttrs(t.ctx["wiki-attrs"],t),target:this.getTarget(t.ctx["wiki-attrs"]),mix:this.getMix(t),content:this.getData(t)}]},isHiddenCtx:function(t){return{block:"b-hidereferer",tag:"span",cls:"g-js",attrs:{"data-bem":"{ name: b-hidereferer }"},content:t.ctx}}}}),c()(function(){var t=E("helpers"),e=this.ctx["wiki-attrs"];return this.ctx.content&&"wiki-err"==this.ctx.content[0].block?M(this.ctx.content):e?(e.hidden&&(ctx=t.isHiddenCtx(this)),ctx=t.getContent(this),M([ctx,e.docviewer&&this.wiki.noDocviewer?{block:"wiki-docviewer"}:""])):void 0})),n("wiki-ref").mode("helpers")(function(){var t=x(),e=this.wiki.path,i=this["i-global"].hosts||this.wiki.hosts;return wikiApiHost=i&&i.wikiApi?i.wikiApi.host:"",t.getUrl=function(t){return"wiki"===t.type?t.file?(t.page||e)+"/.files/"+t.file:t.page||t.link:t.link},t.getAttrs=function(t,e){if("wiki"!==t.type)return{title:this.getExtLink(e)};if("wiki"===t.type&&!t.ext&&e.ctx.content&&e.ctx.content[0]){var i={"data-title":"1"};return t.page&&("/"===t.page[0]?i["data-link"]=t.page:i["data-link"]=t.link),i}return"wiki"===t.type&&t.page&&t.link?"/"===t.page[0]?{"data-link":t.page}:{"data-link":t.link}:{}},t.getData=function(e){var i,n=e.ctx["wiki-attrs"],s=t.getIconType(n);return i=e.ctx.content&&e.ctx.content[0]?e.ctx.content:n.ext&&"wiki"===n.type?"file:"+n.file:n.link,[e.ctx.content&&"wiki-img"===e.ctx.content[0].block?"":s&&{block:"awesome-icon",mix:[{mods:{icon:s,first:"yes"}}]},i]},t.getMix=function(t){var i=t.ctx["wiki-attrs"],n=[];if(this.getIconType(i)&&n.push({block:"b-link",mods:{ico:"ico-l"}}),n.push({block:"wiki-ref"}),i.docviewer_host){var s=e+"/"+i.docviewer_link;i.page&&"/"===i.docviewer_link[0]&&(s=i.docviewer_link),"/"!==s[0]&&(s="/"+s),n.push({block:"wiki-ref",mods:{type:"docviewer"},js:{docviewer:"https://"+i.docviewer_host+"/?url=ya-wiki%3A//"+wikiApiHost+s,url:this.getUrl(t.ctx["wiki-attrs"])}})}"uri"===i.type&&t.wiki.magiclinks_url&&n.push({block:"wiki-ref",mods:{magiclink:"yes"}}),i.hidden&&n.push({block:"wiki-ref",mods:{hidden:"yes"}});for(var o=-1,r=0;r<n.length;r++)n[r].mods&&n[r].mods.ico&&(o=r,r=n.length);return o>-1&&n.splice(o,1),"wiki"!==i.type||i.docviewer_host||n.push({block:"wiki-ref",mods:{wiki:"yes"},js:!0}),i.file&&n.push({block:"wiki-ref",mods:{file:"yes"}}),n},t}),n("wiki-ref")(_()(function(){var t=E("helpers"),e=this.ctx["wiki-attrs"];return this.ctx.content&&"wiki-err"===this.ctx.content[0].block?this.ctx.content:e?[t.getContent(this),e.docviewer_host&&this.wiki.noDocviewer?{block:"wiki-docviewer"}:""]:""})),n("b-icon")(l()("img"),d()(function(){var t,e=this.ctx,i={src:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",alt:""},n=["alt","width","height"];for(e.url&&(i.src=e.url);t=n.shift();)e[t]&&(i[t]=e[t]);return i})),n("b-icon")(l()("img"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t=this.ctx,e={src:"https://yastatic.net/lego/_/La6qi18Z8LwgnZdsAr1qy1GwCwo.gif",alt:""};return t.url&&(e.src=t.url),["alt","width","height"].forEach(function(i){t[i]&&(e[i]=t[i])}),e})),n("wiki-docviewer")(l()(""),f()([{block:"b-popupa",mods:{theme:"ffffff",direction:"right"},mix:[{block:"wiki-docviewer"}],content:[{elem:"tail"},{elem:"content",content:[{block:"b-menu",mods:{layout:"vert"},content:[{elem:"item",content:{block:"b-link",mods:{type:"download"},url:"",content:"Скачать"}},{elem:"item",content:{block:"b-link",mods:{type:"view"},url:"",content:"Просмотреть"}}]}]}]}])),n("b-popupa")(u()(!0),("undefined"!=typeof addJs?addMix:p)()(function(){var t={},e=this.ctx.mods||{};return e.theme||(t.theme="ffffff"),e.direction||(t.direction="down"),t=[{mods:t}],this._inBDropdowna&&(t.push({block:"b-dropdowna",elem:"popup",elemMods:this._dropdownaColor&&{color:this._dropdownaColor}}),this._dropdownaColor=!1,this._inBDropdowna=!1),t}),r("has-close","yes").content()(function(){return Array.isArray(this.ctx.content)||(this.ctx.content=[this.ctx.content]),this.ctx.content.push({elem:"close"}),this.ctx.content}),s("shadow").tag()("i"),s("content").wrap()(function(){return[{elem:"shadow"},{elem:"wrap",content:this.ctx}]}),s("wrap")(l()("table"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{cellpadding:0,cellspacing:0}}),f()(function(){return{tag:"tr",content:{elem:"wrap-cell",content:this.ctx.content}}})),s("wrap-cell").tag()("td")),n("wiki-img")(l()("img"),d()(function(){var t={src:this.ctx["wiki-attrs"].link,alt:"",border:"0"};return this.ctx["wiki-attrs"].width&&(t.width=this.ctx["wiki-attrs"].width),this.ctx["wiki-attrs"].height&&(t.height=this.ctx["wiki-attrs"].height),t})),n("wiki-img")(d()(function(){var t={src:this.ctx["wiki-attrs"].link||(this.ctx["wiki-attrs"].page||this.wiki.path)+"/.files/"+this.ctx["wiki-attrs"].file,alt:"",border:"0"};return this.ctx["wiki-attrs"].width&&(t.width=this.ctx["wiki-attrs"].width),this.ctx["wiki-attrs"].height&&(t.height=this.ctx["wiki-attrs"].height),t})),n("wiki-widget-action")(f()({block:"spin2",mods:{size:"s",progress:"yes"}}),s("error").content()(function(){return[{block:"awesome-icon",mods:{icon:"warning"}},{elem:"error-message",content:this.ctx.message}]})),n("wiki-user")(l()("b"),f()(function(){var t=this.ctx.content;return t=t?[{elem:"first-letter",content:t[0]},{block:"wiki-txt","wiki-attrs":{txt:t.slice(1)}}]:"",{elem:"link",cls:"auto-person-card",attrs:{lang:this.ctx.card},url:this.ctx.url||"http://staff.yandex-team.ru/"+this.ctx.card,counter:this.ctx.counter,content:t}}),s("link")(l()("a"),d()(function(){var t={href:this.ctx.url};return this.ctx.counter&&(t.onmousedown=this.ctx.counter),t}),f()(function(){return this.ctx.content})),s("first-letter")(l()("b"),f()(function(){return{block:"wiki-txt","wiki-attrs":{txt:this.ctx.content}}}))),n("wiki-user").mix()(function(){return[{block:"mi-staff-card",js:{user:this.ctx.card}}]}),n("wiki-user").mix()({}),n("wiki-htmlentity")(l()(""),f()(function(){return[{block:"wiki-txt",noEscape:!0,"wiki-attrs":{txt:this.ctx["wiki-attrs"].txt}}]})),n("wiki-action").def().match(function(){return!this.ctx._wrap})(function(){var t=[],e=this.ctx["wiki-attrs"],i=["grid","serviceteam","tree","wanted"];return e&&e.txt&&(this.wiki.action=e.txt,this.wiki.formatter=!1),this.ctx.content&&this.ctx.content.forEach(function(n){"wiki-json"===n.block?t.push({block:n["wiki-attrs"].data.url_with_data&&-1!==i.indexOf(n["wiki-attrs"].data.action_name)?"wiki-widget-action":"b-wiki-"+e.name,js:{data:n["wiki-attrs"].data,attrs:e}}):t.push(n)}),M([e&&e.dynamic&&{html:"\x3c!--dynamic action--\x3e"},{block:"wiki-action",attrs:e&&e.name&&e.number_local&&{id:e.name+e.number_local},content:t,_wrap:!0},e&&e.dynamic&&{html:"\x3c!--/dynamic action--\x3e"}])}),n("wiki-nirvana").def()(function(){var t=this.ctx["wiki-attrs"];return this.ctx.block="wiki-ticket",t.ticket_type="nirvana",t.issue=t.flow_id,t.flow_block_id&&(t.issue+="/"+t.flow_block_id),this.ctx["wiki-attrs"].link_view=t.url,M(this.ctx)}),n("wiki-anchor")(l()("a"),d()(function(){return this.ctx["wiki-attrs"]&&this.ctx["wiki-attrs"].name&&{name:this.ctx["wiki-attrs"].name}}),f()(function(){return this.ctx["wiki-attrs"]&&this.ctx["wiki-attrs"].text?this.ctx["wiki-attrs"].text:""})),n("wiki-block").mix()(function(){var t=this.ctx["wiki-attrs"],e={},i=!1;return t&&(!1===t.multiline&&(e.type="inline"),t.mod&&(e.role=t.mod),(e.type||e.role)&&(i=[{mods:e}])),i}),n("wiki-bold").tag()("strong"),n("wiki-bquot").tag()("blockquote"),n("wiki-br")(m()(!1),l()("br")),n("wiki-cell")(l()("td"),d()(function(){return this.ctx["wiki-attrs"]&&{colspan:this.ctx["wiki-attrs"].colspan}}),f()(function(){return this.ctx.content})),n("wiki-color")(l()("span"),f()(function(){return[{elem:"example",content:{html:"&#160;&#160;&#160;&#160;"},"wiki-attrs":this.ctx["wiki-attrs"]},{elem:"hex",content:{block:"wiki-txt","wiki-attrs":{txt:"#"+this.ctx["wiki-attrs"].rgb}}}]}),s("example")(l()("span"),d()(function(){var t=this.ctx["wiki-attrs"].rgb,e="background-color: #"+t+";";return{style:e="fff"==t||"ffffff"==t?e+"border: 1px solid #eee;":e}})),s("hex").tag()("span")),n("wiki-cut")(c()(function(){return this.ctx.chead=this.ctx.content&&this.ctx.content[0]&&this.ctx.content[0].content,this.ctx.cbody=this.ctx.content&&this.ctx.content[1]&&this.ctx.content[1].content,x()}),u()(function(){var t=this.ctx.cbody||"";return{body:this.xmlEscape(JSON.stringify(t))}}),f()(function(){return[{elem:"chead",content:this.ctx.chead},{elem:"cbody",content:this.ctx.cbody}]}),s("chead").content()(function(){return[{block:"link",mods:{theme:"pseudo",pseudo:"yes"},mix:{block:"wiki-cut",elem:"head-link"},content:[{block:"b-icon",mix:[{block:"wiki-cut",elem:"ico"}]}].concat(this.ctx.content)}]}),s("cbody").match(function(){return!this.wiki.render_html}).content()("")),n("wiki-cut")(c().match(function(){return this.wiki.render_html&&!this.ctx._wrap})(function(){var t=this.ctx.content&&this.ctx.content[0]&&this.ctx.content[0].content,e=this.ctx.content&&this.ctx.content[1]&&this.ctx.content[1].content;return M({block:"wiki-cut",_wrap:!0,content:[{elem:"chead",content:t},{elem:"cbody",content:e}]})}),s("chead").content()(function(){return[{block:"link",mods:{theme:"pseudo",pseudo:"yes"},mix:{block:"wiki-cut",elem:"head-link"},content:this.ctx.content}]})),n("wiki-definition")(l()("def"),d()(function(){return{title:this.ctx["wiki-attrs"].txt}}),f()(function(){return{block:"wiki-txt","wiki-attrs":{txt:this.ctx["wiki-attrs"].term}}})),n("wiki-err")(u()(!0),f()(function(){var t=this.wiki.formatter||this.wiki.action,e=this.ctx["wiki-attrs"];for(var i in e)if("id"!=i&&"action_include_page_not_found"!=e.id)var n=e[i];return e&&"invocation_error"==e.id&&e.summary&&(n=e.summary),[{block:"b-icon",mix:[{mods:{type:"err"}}]},this._helper[this.wiki.lang].err[this.ctx["wiki-attrs"].id],void 0!=n&&{html:"&#160;"},void 0!=n&&{elem:"param",content:[n||"<i>"+this._helper[this.wiki.lang].txt.empty+"</i>"]}," ","action_include_page_not_found"==e.id&&{block:"b-link",url:e.page,content:e.page},t&&{html:"&#160;"},t&&{block:"b-link",mods:{pseudo:"yes"},mix:[{block:"wiki-err",elem:"more"}],content:[{block:"b-icon",mix:[{mods:{type:"arrow"}}]},this._helper[this.wiki.lang].txt.more]},t&&{elem:"description",content:t}]}),s("param").tag()("span")),n("wiki-footnote")(c().match(function(){return!this.ctx._wrap})(function(){var t,e,i=this.ctx,n=i["wiki-attrs"].type,s=i["wiki-attrs"].kind,o=i["wiki-attrs"].label?i["wiki-attrs"].label:"",r=this.xmlEscape(i["wiki-attrs"].name),a=i["wiki-attrs"].number,c=i.content||o;return"asterisk"==n?(t="ref"==s?"#oftn"+a:"#ftn"+a,e=("ref"==s?"ftn":"oftn")+a,c||(c=new Array(a+1).join("*"))):"numeric"==n?(t="ref"==s?"#oftnd"+a:"#ftnd"+a,e=("ref"==s?"ftnd":"oftnd")+a,c||(c=a)):"named"==n&&(t="ref"==s?"#o"+r:"#"+r,e=("ref"==s?"":"o")+r,c||(c=r)),M({block:"wiki-footnote",tag:"named"===n&&"note"===s?"span":"sup",_wrap:!0,content:[{block:"b-link",url:t,attrs:{name:e},content:c}]})})),n("wiki-footnote")(u()(!0)),n("wiki-superscript").tag()("sup"),n("wiki-formatter")(l()("span"),e(function(){return this.ctx["wiki-attrs"]}).match(function(){return this.ctx["wiki-attrs"].name}).match(function(){return!this.ctx._wrapper}).replace()(function(){var t=[],e=this.ctx["wiki-attrs"];return this.ctx.content&&this.ctx.content.forEach(function(i){"wiki-json"===i.block?t.push({block:"wiki-"+e.name,js:{data:i["wiki-attrs"].data,attrs:e}}):t.push(i)}),{block:"wiki-formatter","wiki-attrs":e,_wrapper:!0,content:t}}),p()(function(){var t={},e=!1,i=this.ctx["wiki-attrs"];if(i)return["wrapper","align","width","height"].forEach(function(t){i.hasOwnProperty(t)&&(e=!0)}),i.hasOwnProperty("wrapper")&&(t.wrapper=this.attrEscape(i.wrapper)),e||i.multiline||(t.type="inline"),[{mods:t}]}),d()(function(){if(this.ctx["wiki-attrs"]){var t={style:""},e=this.ctx["wiki-attrs"];return e.txt&&(this.wiki.formatter=e.txt,this.wiki.action=!1),e.border&&("0"==e.border?t.style+="border: none;":t.style+="border: "+e.border+";"),e.width&&(t.style+="width: "+e.width+"px;"),e.height&&(t.style+="height: "+e.height+"px;"),e.align&&"center"!==e.align?t.style+="float: "+e.align+";":("center"===e.align&&(t.style+="float: none;"),!e.multiline&&e.width&&(t.style+="word-wrap: break-word; overflow: auto")),e.align&&"text"===e.wrapper&&(t.style+="text-align: "+e.align+";"),t}})),n("wiki-formatter")(u()(function(){return{attrs:this.ctx["wiki-attrs"]}}),p()(function(){var t=x();return"center"!==this.ctx["wiki-attrs"].align&&(t[0].mods.float=this.ctx["wiki-attrs"].align),t})),n("wiki-head")(l()(function(){return"h"+this.ctx["wiki-attrs"].level}),u()(function(){return{anchor:this.ctx["wiki-attrs"].anchor}}),f()(function(){return[{elem:"anchors",content:"view"==this.wiki.mode&&[this.ctx["wiki-attrs"].anchor&&{elem:"anchor",attrs:{name:this.ctx["wiki-attrs"].anchor}},this.ctx["wiki-attrs"].section_global&&{elem:"anchor",attrs:{name:"h-"+this.ctx["wiki-attrs"].section_global}},this.ctx["wiki-attrs"].id&&{elem:"anchor",attrs:{name:"p-"+this.ctx["wiki-attrs"].id}}]},this.ctx.content,"view"==this.wiki.mode&&this.ctx["wiki-attrs"].anchor&&{elem:"edit",cls:"no-print",content:[this.wiki.anchors&&{block:"b-link",url:"#"+this.ctx["wiki-attrs"].anchor,mix:[{block:"wiki-head",elem:"link",elemMods:{type:"anchor"}}],content:["§"]}]}]})),n("wiki-head").elem("anchor").tag()("a"),n("wiki-head").elem("edit").tag()("span"),n("wiki-head").content()(function(){var t,e=x(),i=this.ctx["wiki-attrs"],n=this.wiki;return this.wiki.grid?e.splice(4,1):(t=i.page?i.page+"/.edit?section="+i.section_local+"&gopage="+n.path+"&goanchor=h-"+i.section_global:n.path+"/.edit?section="+i.section_local+"&goanchor=h-"+i.section_global,i.edit&&(t=i.edit),"view"==this.wiki.mode&&this.ctx["wiki-attrs"].anchor&&(e.splice(1,1),e.splice(1,0,{elem:"text",tag:"span",content:this.ctx.content})),i.section_local&&e[e.length-1].content&&e[e.length-1].content.push({block:"b-link",url:t||"#",mix:[{block:"wiki-head",elem:"link",elemMods:{type:"edit"}}],content:[this._helper[this.wiki.lang].txt.edit]})),e}),n("wiki-headcut")(c()(function(){return this.ctx.chead=this.ctx.content&&this.ctx.content[0],this.ctx.cbody=this.ctx.content&&this.ctx.content[1]&&this.ctx.content[1].content,x()}),u()(function(){var t=this.ctx.cbody||"";return{body:this.xmlEscape(JSON.stringify(t))}}),f()(function(){return[{elem:"head","wiki-attrs":this.ctx.chead["wiki-attrs"],content:this.ctx.chead.content},{elem:"cbody",content:this.ctx.cbody}]}),s("cbody").match(function(){return!this.wiki.render_html}).content()("")),n("wiki-headcut").match(function(){return this.wiki.render_html}).content()(function(){var t=this.ctx.content&&this.ctx.content[0],e=this.ctx.content&&this.ctx.content[1];return[{elem:"head","wiki-attrs":t["wiki-attrs"],content:t.content},{elem:"cbody",content:e.content}]}),n("wiki-hr")(l()("hr"),d()({size:1})),n("wiki-include").def()(e(function(){return!this.ctx._wrap})(function(){var t=this.ctx["wiki-attrs"],e="view"==this.wiki.mode&&t.page+"/.edit?gopage="+this.wiki.path+"&goanchor=p-"+t.id,i="view"==this.wiki.mode&&t.mark&&{elem:"edit",content:[{block:"b-link",url:t.page,content:[t.page]}," :: ",{block:"b-link",url:e,content:["("+this._helper[this.wiki.lang].txt.edit+")"]}]};return M({_wrap:!0,block:"wiki-include",content:[t.mark&&{elem:"anchor",attrs:{name:"#p-"+t.id}},i,t.title&&{block:"wiki-head",content:[{block:"wiki-txt","wiki-attrs":{txt:t.title}}],"wiki-attrs":{anchor:t.title,level:1,edit:e,section_local:1,id:t.id}},this.ctx.content,i]})})),n("wiki-include").elem("anchor").tag()("a"),n("wiki-interwiki")(l()("span"),f()(function(){return[{block:"b-link",mix:[{mods:{ico:"ico-l"}},{block:"wiki-ref",mods:{magiclink:"yes",interwiki:"yes"}}],url:this.ctx["wiki-attrs"].link,target:"_blank",content:[{block:"b-icon",mix:[{mods:{type:"icotype",first:"yes"}}],alt:this._helper[this.wiki.lang].txt.external_link}].concat(this.ctx.content)}]})),n("wiki-italic").tag()("i"),n("wiki-jira").def()(function(){return this.ctx.block="wiki-ticket",this.ctx["wiki-attrs"].mode="jira",this.ctx["wiki-attrs"].issue=this.ctx["wiki-attrs"].project+"-"+this.ctx["wiki-attrs"].ticket,M(this.ctx)}),n("wiki-label").def()(function(){return M({block:"wiki-txt","wiki-attrs":{txt:this.ctx["wiki-attrs"].txt}})}),n("wiki-li")(l()("li"),d()(function(){return this.ctx["wiki-attrs"]&&this.ctx["wiki-attrs"].value&&{value:this.ctx["wiki-attrs"].value}})),n("wiki-li")(l()("li"),d()(function(){return this.ctx["wiki-attrs"]&&this.ctx["wiki-attrs"].value&&{value:this.ctx["wiki-attrs"].value}}),f()(function(){var t=this.ctx["wiki-attrs"],e="";return t&&(void 0!==t.checked&&(e={block:"chBox",tag:"input",attrs:{type:"checkbox",disabled:"disabled"}},t.checked&&(e.attrs.checked="")),t.value&&e.constructor===Object&&(e.attrs.value=t.value)),{elem:"wrapper",content:[e,this.ctx.content]}})),n("wiki-list")(l()(function(){return"outline"==this.ctx["wiki-attrs"].type||"bullet"==this.ctx["wiki-attrs"].type?"ul":"ol"}),p()(function(){var t=!1,e=this.ctx["wiki-attrs"],i={},n=e.type;return"number"==n?t="decimal":"letter_lower"==n?t="lower-alpha":"letter_upper"==n?t="upper-alpha":"rome_lower"==n?t="lower-roman":"rome_upper"==n&&(t="upper-roman"),t&&(i["list-type"]=t),"outline"==e.type&&(i.type="outline"),[{mods:i}]})),n("wiki-list").mix()(function(){var t=x();return"bullet"==this.ctx["wiki-attrs"].type&&(t[0].mods["list-type"]="default"),t}),n("wiki-lquot")(p()(function(){return[{mods:{parity:this.ctx["wiki-attrs"].level%2?"odd":"even"}}]}),f()(function(){for(var t=this.ctx["wiki-attrs"].level,e="",i=0;i<t;i++)e+=">";return[e].concat(this.ctx.content)})),n("wiki-lunapark").def()(function(){var t=this.ctx["wiki-attrs"];return this.ctx.block="wiki-ticket",this.ctx["wiki-attrs"].ticket_type="lunapark",this.ctx["wiki-attrs"].issue=t.project?t.project+"-"+t.ticket:t.fire,M(this.ctx)}),n("wiki-monospace").tag()("tt"),n("wiki-otrs").def()(function(){var t=this.ctx["wiki-attrs"];return this.ctx.block="wiki-ticket",t.ticket_type="otrs",t.link_view=t.link,t.issue=t.ticket,M(this.ctx)}),n("wiki-remark")(l()("span"),p()(function(){var t=this.ctx["wiki-attrs"]&&this.ctx["wiki-attrs"].color;return t&&[{mods:{color:t}}]})),n("wiki-row")(m()(!1),l()("tr")),n("wiki-row").bem()(!0),n("wiki-small").tag()("small"),n("wiki-staff")(c()(function(){var t,e=this.ctx.mods||{},i=function(t){return{block:"b-link",url:this.ctx["wiki-attrs"].link,content:{block:"wiki-username",mods:e,login:this.ctx["wiki-attrs"].login,content:t}}}.bind(this);return this.ctx["wiki-attrs"].hasOwnProperty("is_active")&&!1===this.ctx["wiki-attrs"].is_active&&(e.type="fired"),e.style="portal",this.ctx.content?(t=[],this.ctx.content[0]&&this.ctx.content[0]["wiki-attrs"].txt&&(t.push(i(this.ctx.content[0]["wiki-attrs"].txt)),this.ctx.content.splice(0,1)),this.ctx.content.length&&t.push(i(this.ctx.content))):t=i(this.ctx["wiki-attrs"].name||this.ctx["wiki-attrs"].login),M(t)})),n("wiki-staff").def()(function(){return this.ctx.mods=this.extend(this.ctx.mods||{},{style:"portal",staffCard:"yes"}),x()}),n("wiki-subscript").tag()("sub"),n("wiki-table")(l()("table"),p()(function(){var t={};return this.ctx["wiki-attrs"]&&"wide"==this.ctx["wiki-attrs"].type?t.wide="yes":t.border="yes",[{mods:t}]})),n("wiki-tocitem")(u()(function(){return{anchor:this.ctx["wiki-attrs"].anchor}}),p()(function(){return[{mods:{level:String(this.ctx["wiki-attrs"].level)}}]}),f()(function(){return{block:"b-link",url:this._toc+"#"+this.ctx["wiki-attrs"].anchor,content:[this.ctx["wiki-attrs"].number&&this.ctx["wiki-attrs"].number+". ",{block:"wiki-txt","wiki-attrs":{txt:this.ctx["wiki-attrs"].txt}}]}})),n("wiki-tocitem").content()(function(){var t=x(),e="/HomePage"===this._toc||this._toc.toLowerCase()===this.wiki.path.toLowerCase();return t.url=(e?"":this._toc)+"#"+this.ctx["wiki-attrs"].anchor,t.attrs={title:this.ctx["wiki-attrs"].txt},t}),n("wiki-underline").tag()("ins"),n("wiki-warn").content()(function(){return[this._helper[this.wiki.lang].warn[this.ctx["wiki-attrs"].id]]}),n("wiki-warnset").def()(e(function(){return this.ctx.content.length&&!this.ctx.js})(function(){var t=this.ctx.ids?this.ctx.ids:[],e=this.ctx.c?this.ctx.c:[];if("wiki-warn"==this.ctx.content[0].block){var i=this.ctx.content.shift();t.push(this._helper[this.wiki.lang].warn[i["wiki-attrs"].id])}else e.push(this.ctx.content.shift());return M({block:"wiki-warnset",ids:t,c:e,content:this.ctx.content})}),e(function(){return!this.ctx.content.length})(function(){return M({block:"wiki-warnset",js:this.ctx.ids,mix:this.ctx.c[0]&&this.ctx.c[0].block&&"wiki-err"==this.ctx.c[0].block&&[{mods:{type:"wide"}}],content:[{block:"b-icon",mix:[{mods:{type:"warn"}}]},{block:"b-popupa",mods:{theme:"feffd6",direction:"left",type:"my-popupa"},content:[{elem:"tail"},{elem:"content",content:[{block:"wiki-bold",content:this._helper[this.wiki.lang].txt.attention}]}]}].concat(this.ctx.c)})})),n("wiki-wikiword").def().match(function(){return!this.ctx._wrap})(function(){return M({block:"b-link",url:this.ctx["wiki-attrs"].link,mix:[{block:"wiki-wikiword",_wrap:!0}],content:[{block:"wiki-txt","wiki-attrs":{txt:this.ctx["wiki-attrs"].txt}}]})}),n("wiki-math").replace().match(function(){return!this.ctx._wrap})(function(){var t=this.ctx,e=(t.js||{}).data||{},i=e.style||"inline",n=e.text||"";return t.style=i,t.content=n,t.js={tex:n,staticHost:"production"==this.wiki.env?"//yastatic.net":"//betastatic.yastatic.net"},t._wrap=!0,t}),n("wiki-math").content()(function(){var t=x();return"$$("+this.ctx.style+")"+t+"$$"}),n("wiki-math").elem("tex-view")(l()("pre"),f()(function(){return{tag:"code",cls:"tex",content:this.ctx.content}})),n("wiki-club").def()(function(){var t={block:"wiki-username",mods:this.extend(this.ctx.mods,{style:"portal"}),login:this.ctx["wiki-attrs"].name,href:this.ctx["wiki-attrs"].link};return this.ctx.content?(t.content=this.ctx.content?this.ctx.content:this.ctx["wiki-attrs"].link,M(t)):(t.content=this.ctx["wiki-attrs"].name||this.ctx["wiki-attrs"].link,M(t))}),n("wiki-club").def()(function(){return this.ctx.mods=this.extend(this.ctx.mods||{},{style:"portal"}),x()}),n("b-page-title").tag()("h1"),n("b-widget").content()(function(){return[{block:"spin2",mods:{type:"load",size:"s"}},{elem:"content",content:[],parentCtx:this.ctx}]}),n("b-user-group").tag()("span"),n("b-user-group").elem("remove").tag()("span"),n("b-widget").mod("type","page-access")(u()(function(){return{user:this.ctx.user,data:this.ctx.data,canChange:this.ctx.canChange}}),c()(function(){var t=this.ctx.mods||{};return t["show-users"]="restricted"===this.ctx.data.type?"yes":"",this.ctx.mods=t,this.ctx.canChange=E("can-change"),x()}),o("can-change")()(function(){var t=this.ctx.data,e=this.ctx.user;return e.is_admin||Boolean(t.authors.find(function(t){return t.login===e.login}))}),s("content").content()(function(){var t=this.ctx.parentCtx.data,e=this.ctx.parentCtx.canChange;return{elem:"content-wrapper",content:[{elem:"header",tag:"h2",content:BEM.I18N("b-widget","access_caption")},{block:"radiobox",mods:{theme:"normal",size:"m",disabled:e?"":"yes"},name:"access_type",value:t.type,content:[{elem:"radio",content:[BEM.I18N("b-widget","access_to_parent")+" ",{block:"b-widget",elem:"parent-access",tag:"span"}],controlAttrs:{value:"inherited"}},{tag:"br"},{elem:"radio",mix:[{block:"w-getting-started",elem:"elem",elemMods:{access:"1"}}],content:BEM.I18N("b-widget","access_free"),controlAttrs:{value:"common"}},{tag:"br"},{elem:"radio",mix:[{block:"w-getting-started",elem:"elem",elemMods:{access:"2"}}],content:BEM.I18N("b-widget","access_lock"),controlAttrs:{value:"owner"}},{tag:"br"},{elem:"radio",mix:[{block:"w-getting-started",elem:"elem",elemMods:{access:"3"}}],content:BEM.I18N("b-widget","restricted"),controlAttrs:{value:"restricted"}}]},{block:"spin2",mods:{size:"xxs",type:"action-load"}},{elem:"restricted-groups",content:[{block:"m-suggest",js:{addRequestParams:{limit:80},maxPopupHeight:330},mods:{type:"multicomplete",size:"s",role:"restricted"},inputMods:{disabled:e?"":"yes"},hint:BEM.I18N("b-widget","add_department_or_person"),types:[{name:"staff",maxCount:4,fields:"login|gender|uid|id|affiliation"},{name:"group",fields:"type|externals_count"}]},{elem:"users-list"},{block:"b-groups-list"},{block:"b-services-list"},{block:"b-wiki-list"}]},{elem:"buttons",content:[{block:"spin2",mods:{size:"xs",type:"save-access"}},{block:"button2",mods:{size:"m",role:"cancel",theme:"normal"},tabindex:1,text:BEM.I18N("b-widget","reject")},{block:"button2",mods:{theme:"action",size:"m",role:"save",disabled:e?"":"yes"},tabindex:0,text:BEM.I18N("b-widget","save")}]}]}})),n("b-widget").mod("type","page-access").elem("content").content()(function(){var t=this.ctx.parentCtx.data,e=this.ctx.parentCtx.canChange;return{elem:"content-wrapper",content:[{elem:"header",tag:"h2",content:BEM.I18N("b-widget","access_caption")},{block:"radiobox",mods:{theme:"normal",size:"m",disabled:e?"":"yes"},name:"access_type",value:t.type,content:[{elem:"radio",content:[BEM.I18N("b-widget","access_to_parent")+" ",{block:"b-widget",elem:"parent-access",tag:"span"}],controlAttrs:{value:"inherited"}},{tag:"br"},{elem:"radio",mix:[{block:"w-getting-started",elem:"elem",elemMods:{access:"1"}}],content:BEM.I18N("b-widget","school-common"),controlAttrs:{value:"common"}},{tag:"br"},{elem:"radio",mix:[{block:"w-getting-started",elem:"elem",elemMods:{access:"2"}}],content:BEM.I18N("b-widget","access_lock"),controlAttrs:{value:"owner"}},{tag:"br"},{elem:"radio",mix:[{block:"w-getting-started",elem:"elem",elemMods:{access:"3"}}],content:BEM.I18N("b-widget","restricted"),controlAttrs:{value:"restricted"}}]},{block:"spin2",mods:{size:"xs",type:"action-load"}},{elem:"restricted-groups",content:[{block:"m-suggest",js:{layers:"people,departments,groups",addRequestParams:{"people.order":1,"departments.order":2,"groups.order":3,org_id:this["i-global"].orgId}},mods:{type:"b2b",multicomplete:"yes"},url:this["i-global"].hosts.suggest.url,hint:BEM.I18N("b-widget","add_department_or_person"),inputMods:{size:"s",theme:"normal",disabled:e?"":"yes"},value:""},{elem:"users-list"},{block:"b-groups-list"},{block:"b-services-list"},{block:"b-wiki-list"},{block:"b-departments-list"}]},{elem:"buttons",content:[{block:"spin2",mods:{size:"s",type:"save-access"}},{block:"button2",mods:{size:"m",role:"cancel",theme:"normal"},tabindex:1,text:BEM.I18N("b-widget","reject")},{block:"button2",mods:{theme:"action",size:"m",role:"save",disabled:e?"":"yes"},tabindex:0,text:BEM.I18N("b-widget","save")}]}]}}),n("b-widget").mod("type","old-page").content()(function(){var t=x(),e=[];return e.push([{elem:"title",elemMods:{actuality:"obsolete"},content:BEM.I18N("b-widget","mark_page_as_obsolete")},{elem:"title",elemMods:{actuality:"actual"},content:BEM.I18N("b-widget","mark_page_as_actual")},{elem:"comment",content:{block:"input",mods:{type:"textarea",size:"s"},name:"test",placeholder:BEM.I18N("b-widget","comment"),content:{elem:"control",attrs:{rows:"3"}}}},{elem:"links",content:{elem:"link",content:{block:"input",mods:{size:"s"},placeholder:BEM.I18N("b-widget","link_wiki_page"),content:[{elem:"label",content:BEM.I18N("b-widget","add_links_text")},{elem:"control"}]}}},{elem:"add-link",content:[{block:"link",content:BEM.I18N("b-widget","add_link")}]},{elem:"buttons",content:[{block:"spin2",mods:{size:"xs",type:"old-page"}},{block:"button2",mods:{size:"m",role:"old-page-cancel",theme:"normal"},tabindex:1,text:BEM.I18N("b-widget","cancel")},{block:"button2",mods:{size:"m",role:"old-page",theme:"action"},tabindex:0,text:BEM.I18N("b-widget","mark")}]}]),t[1]&&(t[1].content=e),t}),n("b-widget").mod("type","page-move").elem("content").content()(function(){var t=this.ctx.parentCtx.js.type;return[[{elem:"additional-text",content:"grid"==t?BEM.I18N("b-widget","move_table"):BEM.I18N("b-widget","move_page")},{elem:"current-address-title",content:"grid"==t?BEM.I18N("b-widget","current_address_table"):BEM.I18N("b-widget","current_address_of_cluster")},{elem:"current-state",content:[{elem:"current-address-url"},{elem:"current-address-page"}]}],{elem:"current-page"},{elem:"controls",content:[{elem:"current-address-title",elemMods:{type:"subpage"},content:"grid"==t?BEM.I18N("b-widget","set_page_name_to_move_table"):BEM.I18N("b-widget","set_page_name_to_move_cluster")},{block:"m-suggest",mix:[{block:"w-getting-started",elem:"elem",elemMods:{move:"1"}}],mods:{type:"cluster",size:"s"},inputMods:{size:"m"}},{elem:"current-address-subpages",content:{block:"checkbox",mix:[{block:"w-getting-started",elem:"elem",elemMods:{move:"2"}}],mods:{theme:"normal",size:"s",checked:"yes",type:"clusters"},text:""}},{elem:"page-rename",content:[{block:"checkbox",mix:[{block:"w-getting-started",elem:"elem",elemMods:{move:"3"}}],mods:{theme:"normal",size:"s",type:"page-title"},text:"grid"==t?BEM.I18N("b-widget","rename_table"):BEM.I18N("b-widget","rename_page")},{elem:"page-rename-controls",content:[{elem:"page-rename-title",content:"grid"==t?BEM.I18N("b-widget","input_new_table_address"):BEM.I18N("b-widget","input_new_cluster_address")},{block:"input",js:!0,mods:{size:"s",type:"page-title"},content:{elem:"control"}}]}]}]},{elem:"current-address-title",content:"grid"==t?BEM.I18N("b-widget","table_new_address"):BEM.I18N("b-widget","cluster_new_address")},{elem:"new-url"},{elem:"new-url-page"},{elem:"buttons",content:[{block:"spin2",mods:{size:"xs",type:"move-load"}},{block:"button2",mods:{theme:"normal",size:"m",role:"move-cluster-cancel"},tabindex:1,text:BEM.I18N("b-widget","cancel")},{block:"button2",mods:{size:"m",role:"move-cluster",theme:"action"},tabindex:0,text:"grid"===t?BEM.I18N("b-widget","move_the_table"):BEM.I18N("b-widget","move_the_cluster")}]}]}),n("m-suggest-item").mod("type","cluster")(u()(function(){var t=this.ctx.data;return this.extend(x(),{value:t.tag})}),f()(function(){var t,e,i,n=this.ctx.data.tag,s=n.indexOf(this.ctx.inputData.text);return-1!==s?(t=n.substr(0,s),e=n.substr(s+this.ctx.inputData.text.length),i=[t,{elem:"selected",content:this.ctx.inputData.text},e]):i=n,{elem:"info-wrapper",content:i}})),n("b-widget").mod("type","subscribe")(u()(function(){return{subscribers:this.ctx.subscribers}}),s("content").content()(function(){var t=this.ctx.parentCtx.subscribers,e=Boolean(this.ctx.parentCtx.mods&&"yes"===this.ctx.parentCtx.mods.subscribers);return[{block:"tabs",mods:{control:"menu",size:"m",theme:"normal",layout:"horiz"},panes:"oh-my-tabs",content:[{elem:"tab",elemMods:{active:e?"":"yes"},content:BEM.I18N("b-widget","sign_on_page")},{elem:"tab",mix:[{block:"w-getting-started",elem:"elem",elemMods:{subscribe:"3"}}],elemMods:{active:e?"yes":"",type:"subscribers"},content:BEM.I18N("b-widget","subscribers")+(t.length?" "+t.length:"")}]},{block:"tabs-panes",id:"oh-my-tabs",content:[{elem:"pane",elemMods:{active:e?"":"yes"},content:[{block:"m-suggest",mix:[{block:"w-getting-started",elem:"elem",elemMods:{subscribe:"1"}}],mods:{type:"multicomplete",size:"m",multiple:"yes"},hint:BEM.I18N("b-widget","add_users"),js:{addRequestParams:{staff_fields:"uid"}},types:[{name:"staff",maxCount:10}]},{block:"input",mix:[{block:"w-getting-started",elem:"elem",elemMods:{subscribe:"2"}}],mods:{type:"textarea",subscribe:"comment"},content:{elem:"control",attrs:{placeholder:BEM.I18N("b-widget","comment"),rows:5}}},{block:"b-widget",elem:"users-result",content:BEM.I18N("b-widget","success_subscribe")}]},{elem:"pane",elemMods:{active:e?"yes":""},content:{block:"b-widget",elem:"subscribers"}}]},{elem:"buttons",content:[{block:"spin2",mods:{size:"s",type:"subscribe-load"}},{block:"button2",mods:{theme:"normal",size:"m",role:"close"},tabindex:0,text:BEM.I18N("b-widget","close")},{block:"button2",mods:{theme:"normal",size:"m",role:"cancel"},tabindex:-1,text:BEM.I18N("b-widget","cancel")},{block:"button2",mods:{theme:"action",size:"m",role:"save",disabled:"yes"},tabindex:0,text:BEM.I18N("b-widget","subscribe")}]}]})),n("b-widget").mod("type","subscribe").elem("content").content()(function(){var t=this.ctx.parentCtx.subscribers,e=Boolean(this.ctx.parentCtx.mods&&"yes"===this.ctx.parentCtx.mods.subscribers);return[{block:"tabs",mods:{control:"menu",size:"m",theme:"normal",layout:"horiz"},panes:"oh-my-tabs",content:[{elem:"tab",elemMods:{active:e?"":"yes"},content:BEM.I18N("b-widget","sign_on_page")},{elem:"tab",mix:[{block:"w-getting-started",elem:"elem",elemMods:{subscribe:"3"}}],elemMods:{active:e?"yes":"",type:"subscribers"},content:BEM.I18N("b-widget","subscribers")+(t.length?" "+t.length:"")}]},{block:"tabs-panes",id:"oh-my-tabs",content:[{elem:"pane",elemMods:{active:e?"":"yes"},content:[{block:"m-suggest",mix:[{block:"w-getting-started",elem:"elem",elemMods:{subscribe:"1"}}],mods:{type:"b2b",multicomplete:"yes",multiple:"yes"},js:{addRequestParams:{org_id:this["i-global"].orgId}},url:this["i-global"].hosts.suggest.url,input:{block:"input",mods:{size:"m",theme:"normal"},placeholder:BEM.I18N("b-widget","add_users"),content:{elem:"control",attrs:{name:"text",autocomplete:"off"}}}},{block:"input",mix:[{block:"w-getting-started",elem:"elem",elemMods:{subscribe:"2"}}],mods:{type:"textarea",subscribe:"comment"},content:{elem:"control",attrs:{placeholder:BEM.I18N("b-widget","comment"),rows:5}}},{block:"b-widget",elem:"users-result",content:BEM.I18N("b-widget","success_subscribe")}]},{elem:"pane",elemMods:{active:e?"yes":""},content:{block:"b-widget",elem:"subscribers",content:t.length?t.map(function(t){return{block:"b-widget",elem:"subscriber",content:{block:"m-username",mods:{is_dismissed:t.is_dismissed?"yes":""},login:t.login,content:t.display}}}):{block:"b-widget",elem:"no-subscribers",content:BEM.I18N("b-widget","no-subscribers")}}}]},{elem:"buttons",content:[{block:"spin2",mods:{size:"s",type:"subscribe-load"}},{block:"button2",mods:{theme:"normal",size:"m",role:"close"},tabindex:0,text:BEM.I18N("b-widget","close")},{block:"button2",mods:{theme:"normal",size:"m",role:"cancel"},tabindex:-1,text:BEM.I18N("b-widget","cancel")},{block:"button2",mods:{theme:"action",size:"m",role:"save",disabled:"yes"},tabindex:0,text:BEM.I18N("b-widget","subscribe")}]}]}),n("tabs-panes")(c().match(function(){return this.ctx.id&&this.ctx.id!==this._tabsPanesId})(function(){return E("default",{_tabsPanesId:this.ctx.id})}),("undefined"!=typeof addJs?addJs:u)()(function(){return{id:this._tabsPanesId}})),n("tabs-menu")(l()("ul"),("undefined"!=typeof addJs?addJs:u)()(!0),d()(function(){return this.extend({role:"menu"},x())})),n("b-widget").mod("type","unsubscribe").elem("content").content()(function(){var t=x();return Array.isArray(t)||(t=[t]),t.push({elem:"header",tag:"h2",content:BEM.I18N("b-widget","unsubscribe_propose")},{elem:"buttons",content:[{block:"button2",mods:{theme:"normal",size:"s",role:"cancel"},text:BEM.I18N("b-widget","cancel")},{elem:"right",content:[{block:"spin2",mods:{size:"xs",type:"unsubscribe-load"}},{block:"button2",mods:{theme:"action",size:"s",role:"unsubscribe"},text:BEM.I18N("b-widget","unsubscribe")}]}]}),t}),n("b-widget").mod("type","page-settings")(u()(!0),s("content").content()(function(){var t=this.ctx.parentCtx.js;return[{block:"b-widget",elem:"header",content:BEM.I18N("b-widget","page-settings")},{elem:"settings",content:[{block:"w-page-setting",mix:[{block:"w-getting-started",elem:"elem",elemMods:{settings:"1"}}],mods:{type:"keywords",readonly:t.isRedirectPage?"yes":""},data:t.keywords,path:t.ajaxPath},{block:"w-page-setting",mix:[{block:"w-getting-started",elem:"elem",elemMods:{settings:"2"}}],mods:{type:"authors",readonly:t.canEdit&&!t.isRedirectPage?"":"yes"},showGetAuthorship:!t.isRedirectPage&&!t.canEdit,data:{authors:t.authors},path:t.ajaxPath},{block:"w-page-setting",mix:[{block:"w-getting-started",elem:"elem",elemMods:{settings:"3"}}],mods:{type:"redirect",readonly:t.canEdit?"":"yes"},data:t.redirect,path:t.ajaxPath},{block:"w-page-setting",mods:{type:"comments",readonly:t.canEdit?"":"yes"},data:t.comments,path:t.ajaxPath},{block:"checkbox",mods:{theme:"normal",size:"s",checked:t.readonly?"yes":"",disabled:t.canEdit?"":"yes",role:"readonly"},text:BEM.I18N("b-widget","readonly_page")}]},{elem:"redirected-from"}]})),n("w-page-setting")(u()(function(){return{data:this.ctx.data,path:this.ctx.path}}),f()(function(){return[{elem:"top-line",content:[{elem:"header"},{block:"spin2",mods:{size:"xxs"}},{elem:"data-preview",data:this.ctx.data}]},{elem:"form",data:this.ctx.data}]})),n("w-page-setting").mod("type","authors")(d()(function(){return{title:BEM.I18N("w-page-setting","setup-authors")}}),f()(function(){return[{elem:"top-line",content:[{elem:"header",showGetAuthorship:this.ctx.showGetAuthorship},{block:"spin2",mods:{size:"xxs"}},{elem:"data-preview",data:this.ctx.data}]},{elem:"form",data:this.ctx.data}]}),s("header").content()(function(){return[BEM.I18N("w-page-setting","authors"),this.ctx.showGetAuthorship&&{elem:"get-authorship"}]}),s("get-authorship").content()(function(){return{block:"button2",mods:{size:"m",theme:"normal"},text:BEM.I18N("w-page-setting","get-authorship")}}),s("data-preview").content()(function(){return{block:"w-authors",visibleCount:3,inline:!0,withPhoto:!0}}),s("form").content()(function(){return[{block:"link",mods:{theme:"black",pseudo:"yes",type:"mass-change-author"},text:BEM.I18N("w-page-setting","change_author_in_cluster")},{block:"multiple-suggest",size:"s",js:{addRequestParams:{staff_fields:"uid"}},hint:BEM.I18N("w-page-setting","staff-search"),types:[{name:"staff",maxCount:5}]},{block:"button2",mods:{theme:"normal",size:"s",role:"save-authors"},text:BEM.I18N("b-widget","save")}]})),n("w-page-setting").mod("type","authors")(s("form").content()(function(){return[{block:"link",mods:{theme:"black",pseudo:"yes",type:"mass-change-author"},text:BEM.I18N("w-page-setting","change_author_in_cluster")},{block:"multiple-suggest",size:"s",hint:BEM.I18N("w-page-setting","staff-search"),types:[{name:"people",maxCount:5}]},{block:"button2",mods:{theme:"normal",size:"s",role:"save-authors"},text:BEM.I18N("b-widget","save")}]})),n("multiple-suggest")(f()(function(){return{block:"m-suggest",js:this.ctx.js,mods:{size:this.ctx.size,type:"multicomplete"},inputMods:{disabled:this.ctx.disabled?"yes":""},url:this["i-global"].hosts.suggest.url,hint:this.ctx.hint,types:this.ctx.types}}),u()(function(){return{listHeaders:this.ctx.listHeaders,active:!this.ctx.disabled,types:this.ctx.types.map(function(t){return t.name})}})),n("multiple-suggest")(f()(function(){const t=Object.assign({},this.ctx.js&&this.ctx.js.addRequestParams,{org_id:this["i-global"].orgId});return{block:"m-suggest",js:Object.assign({},this.ctx.js,{addRequestParams:t}),mods:{size:this.ctx.size,type:"b2b",multicomplete:"yes"},url:this["i-global"].hosts.suggest.url,inputMods:{disabled:this.ctx.disabled?"yes":""},hint:this.ctx.hint,types:this.ctx.types}})),n("multiple-suggest-item").mod("type","group")(f()(function(){var t=this.ctx.data;return[t.name,t.externals_count>0&&{block:"awesome-icon",mods:{icon:"warning"},attrs:{title:BEM.I18N("w-access-button","external_group")},mix:{block:this.block,elem:"external-warning"}},this.ctx.active&&{block:"awesome-icon",mods:{icon:"remove"},mix:{block:this.block,elem:"remove"}}]})),n("multiple-suggest-item").mod("type","people")(f()(function(){var t=this.ctx.data;return[{block:"w-username",user:t},(t.is_external_employee||"external"===t.affiliation)&&{block:"awesome-icon",mods:{icon:"warning"},attrs:{title:BEM.I18N("w-access-button","external_user")},mix:{block:this.block,elem:"external-warning"}},this.ctx.active&&{block:"awesome-icon",mods:{icon:"remove"},mix:{block:this.block,elem:"remove"}}]})),n("w-page-setting").mod("type","keywords")(d()(function(){return{title:BEM.I18N("w-page-setting","setup-keywords")}}),s("header").content()(function(){return BEM.I18N("w-page-setting","keywords")}),s("data-preview").content()(function(){return this.ctx.data&&this.ctx.data.join(", ")||BEM.I18N("w-page-setting","no-keywords")}),s("form").content()(function(){return[{block:"input",mods:{size:"s",clear:"no"},placeholder:BEM.I18N("w-page-setting","tags_list"),content:[{elem:"control"}]},{block:"button2",mods:{theme:"normal",size:"s",disabled:"yes"},text:BEM.I18N("w-page-setting","add")},{elem:"keywords",content:this.ctx.data&&this.ctx.data.map(function(t){return{block:"w-baloon",text:t}})}]})),n("i-ua").content()(function(){var t=[";(function(d,e,p){","e=d.documentElement;",'p="placeholder";','e.className+=" i-ua_"+p+(p in d.createElement("input")?"_yes":"_no")',"})(document);"].join("");return[].concat(x()||[],{html:t})}),n("w-baloon")(u()(function(){return{text:this.ctx.text}}),f()(function(){return[this.ctx.text,{elem:"clear"}]})),n("w-page-setting").mod("type","comments")(d()(function(){return{title:BEM.I18N("w-page-setting","setup-comments")}}),s("header").content()(function(){return BEM.I18N("w-page-setting","comments")}),s("data-preview").content()(function(){return BEM.I18N("w-page-setting","enabled"===this.ctx.data.comments_status?"on":"off")}),s("form").content()(function(){return[{block:"select2",mods:{size:"s",type:"radio",width:"fixed",theme:"normal",role:"comments",text:"vary"},name:Math.random().toString(),val:"enabled"===this.ctx.data.comments_status?"on":"off",text:BEM.I18N("w-page-setting","enabled"===this.ctx.data.comments_status?"is_on":"is_off"),items:[{val:"on",text:BEM.I18N("w-page-setting","to_on")},{val:"off",text:BEM.I18N("w-page-setting","to_off")}]},{block:"button2",mods:{theme:"normal",size:"s",disabled:"yes",role:"save-comments"},text:BEM.I18N("b-widget","save")},this.ctx.data.subpages_count?{elem:"with-subpages",content:{block:"checkbox",mods:{theme:"normal",size:"s",checked:"disabled_on_page"!==this.ctx.data.comments_status?"yes":"",type:"with_subpages"},text:" +"+this.ctx.data.subpages_count+" "+BEM.I18N("b-widget","cluster_subpages",{count:this.ctx.data.subpages_count})}}:""]})),n("b-widget").mod("type","approve-rejected-access")(s("rejects").tag()("ol"),s("reject-item").tag()("li"),s("content").content()(function(){return[{elem:"header",content:BEM.I18N("b-widget","attention")},{elem:"approve-rejected-text1",content:BEM.I18N("b-widget","approve_rejected_text1")},{elem:"rejects",content:this.ctx.parentCtx.data.rejects.users.map(function(t){return{block:"b-widget",elem:"reject-item",content:{block:"w-username",user:t}}}).concat(this.ctx.parentCtx.data.rejects.groups.map(function(t){return{block:"b-widget",elem:"reject-item",content:t.name}}))},{elem:"approve-rejected-text2",content:BEM.I18N("b-widget","approve_rejected_text2")},{elem:"approve-rejected-more",content:[{elem:"approve-rejected-text3",content:BEM.I18N("b-widget","approve_rejected_text3")},{block:"link",mods:{theme:"normal",type:"more"},url:"/wiki/vodstvo/idm/",content:"wiki"},{elem:"approve-rejected-text3",content:"."}]},{elem:"approve-rejected-text4",content:BEM.I18N("b-widget","approve_rejected_text4")},{elem:"buttons",content:[{block:"button2",mods:{size:"m",theme:"normal",role:"cancel"},tabindex:1,text:BEM.I18N("b-widget","reject_cancel")},{block:"button2",mods:{size:"m",type:"link",theme:"action"},url:this.ctx.parentCtx.data.request_role_url,tabindex:0,text:BEM.I18N("b-widget","reject_approve")}]}]})),n("b-widget").mod("type","authorship")(s("content").content()(function(){return[{elem:"header",content:BEM.I18N("b-widget","get_authorship")},{elem:"message",content:{block:"input",mods:{type:"textarea",size:"s"},placeholder:BEM.I18N("b-widget","get_authorship_message_placeholder"),content:{elem:"control",attrs:{rows:"6"}}}},{elem:"buttons",content:[{block:"button2",mods:{size:"m",role:"cancel",theme:"normal"},tabindex:1,text:BEM.I18N("b-widget","cancel")},{elem:"right-buttons",content:[{block:"spin2",mods:{size:"xs",type:"send"}},{block:"button2",mods:{size:"m",role:"send",theme:"action"},tabindex:0,text:BEM.I18N("b-widget","send")}]}]}]})),n("b-widget").mod("type","page-copy").elem("content").content()(function(){var t=this.ctx.parentCtx.js.type;return[["grid"==t&&{elem:"additional-text",content:BEM.I18N("b-widget","copy_table")},{elem:"current-address-title",content:"grid"==t?BEM.I18N("b-widget","current_address_table")+":":BEM.I18N("b-widget","current_address_of_cluster")+":"},{elem:"current-address-url"},{elem:"current-address-page"}],{elem:"current-page"},{elem:"controls",content:[{elem:"current-address-title",elemMods:{type:"subpage"},content:"grid"==t?BEM.I18N("b-widget","set_page_name_to_copy_table"):BEM.I18N("b-widget","set_page_name_to_copy_cluster")},{block:"m-suggest",mods:{type:"cluster",size:"s"},inputMods:{size:"m"}},{elem:"copy-data",content:{block:"checkbox",mods:{theme:"normal",size:"s",type:"copy-data"},text:BEM.I18N("b-widget","copy-data")}},{elem:"page-rename",content:[{block:"checkbox",mods:{theme:"normal",size:"s",type:"page-title"},text:"grid"==t?BEM.I18N("b-widget","rename_table"):BEM.I18N("b-widget","rename_page")},{elem:"page-rename-controls",content:[{elem:"page-rename-title",content:"grid"==t?BEM.I18N("b-widget","input_new_table_address"):BEM.I18N("b-widget","input_new_cluster_address")},{block:"input",js:!0,mods:{size:"s",type:"page-title"},content:{elem:"control"}}]}]}]},{elem:"current-address-title",content:"grid"==t?BEM.I18N("b-widget","table_new_address")+":":BEM.I18N("b-widget","cluster_new_address")+":"},{elem:"new-url"},{elem:"new-url-page"},{elem:"buttons",content:[{block:"spin2",mods:{size:"xs",type:"copy-load"}},{block:"button2",mods:{size:"m",role:"copy-cluster-cancel",theme:"normal"},tabindex:1,text:BEM.I18N("b-widget","cancel")},{block:"button2",mods:{size:"m",role:"copy-cluster",theme:"action"},tabindex:0,text:"grid"===t?BEM.I18N("b-widget","copy_the_table"):BEM.I18N("b-widget","copy_the_cluster")}]}]}),n("b-widget").mod("type","page-delete")(u()(!0),s("content").content()(function(){var t=this.ctx.parentCtx.js.pages,e=this.ctx.parentCtx.js.users;return[{elem:"header",content:BEM.I18N("b-widget","page-remove")},t.length?{elem:"linked-pages",content:[{elem:"linked-pages-title",content:BEM.I18N("b-widget","linked-pages")+" ("+t.length+"):"},{elem:"linked-pages-list",content:t.map(function(t){return{elem:"linked-page",content:{block:"link",url:t.url,content:t.tag}}})}]}:"",e.length?{elem:"page-watchers",content:[{elem:"page-watchers-title",content:BEM.I18N("b-widget","page-watchers")+" ("+e.length+"):"},{elem:"page-watchers-list",content:e.map(function(t){return{elem:"watcher",content:{block:"m-username",mods:{dismissed:t.is_dismissed?"yes":""},mix:[{block:"mi-staff-card",js:{user:t.login}}],url:"//staff.yandex-team.ru/"+t.login,content:t.display}}})}]}:"",{elem:"delete-message",content:BEM.I18N("b-widget","delete-message")},{elem:"buttons",content:[{block:"button2",mods:{theme:"normal",size:"m",role:"cancel"},tabindex:1,text:BEM.I18N("b-widget","cancel")},{elem:"right-buttons",content:[{block:"spin2",mods:{size:"xs",type:"page-delete"}},{block:"button2",mods:{size:"m",role:"page-delete",theme:"action"},tabindex:0,text:BEM.I18N("b-widget","remove")}]}]}]})),n("b-widget").mod("type","page-delete").elem("content").content()(function(){var t=this.ctx.parentCtx.js.pages,e=this.ctx.parentCtx.js.users;return[{elem:"header",content:BEM.I18N("b-widget","page-remove")},t.length?{elem:"linked-pages",content:[{elem:"linked-pages-title",content:BEM.I18N("b-widget","linked-pages")+" ("+t.length+"):"},{elem:"linked-pages-list",content:t.map(function(t){return{block:"link",url:t.url,content:t.tag}})}]}:"",e.length?{elem:"page-watchers",content:[{elem:"page-watchers-title",content:BEM.I18N("b-widget","page-watchers")+" ("+e.length+"):"},{elem:"page-watchers-list",content:e.map(function(t){return{elem:"watcher",content:{block:"m-username",login:t.login,content:t.display}}})}]}:"",{elem:"delete-message",content:BEM.I18N("b-widget","delete-message")},{elem:"buttons",content:[{block:"button2",mods:{theme:"normal",size:"m",role:"cancel"},tabindex:1,text:BEM.I18N("b-widget","cancel")},{elem:"right-buttons",content:[{block:"spin2",mods:{size:"xs",type:"page-delete"}},{block:"button2",mods:{size:"m",role:"page-delete",theme:"action"},tabindex:0,text:BEM.I18N("b-widget","remove")}]}]}]}),n("b-widget").mod("type","page-export")(s("content").content()(function(){var t=this.ctx.parentCtx.js.filename,e=this.ctx.parentCtx.js.subpagesCount;return[{elem:"title",content:BEM.I18N("b-widget","download_in_format")},{block:"radio-button",mods:{theme:"normal",size:"m",role:"export-type"},name:"export_type",value:"pdf",content:[{elem:"radio",controlAttrs:{value:"pdf"},content:"PDF"},{elem:"radio",controlAttrs:{value:"docx"},content:"DOCX"}]},e>0&&{elem:"count",content:[{block:"radiobox",mods:{size:"m",theme:"normal",role:"export-count"},name:"export_count",value:"one",content:[{elem:"radio",content:BEM.I18N("b-widget","export_page"),controlAttrs:{value:"one"}},{elem:"radio",content:[BEM.I18N("b-widget","export_page")+" "+BEM.I18N("b-widget","export_and")+" ",{block:"link",mods:{theme:"normal",pseudo:"yes",role:"tree"},content:e+" "+BEM.I18N("b-widget","export_subpages",{count:e})}],controlAttrs:{value:"with-subpages"}}]},{elem:"subpages-hint",content:BEM.I18N("b-widget","subpages_hint")}]},{elem:"bottom-line",content:[{elem:"file",attrs:{title:t+".pdf"},content:[{elem:"file-title",content:t},{elem:"file-type",content:".pdf"}]},{elem:"buttons",content:[{block:"spin2",mods:{size:"xs",theme:"normal",role:"download"}},{block:"button2",mods:{theme:"normal",size:"m",role:"cancel"},text:BEM.I18N("b-widget","cancel")},{block:"button2",mods:{theme:"action",size:"m",role:"download"},text:BEM.I18N("b-widget","download")}]}]}]})),n("b-widget").mod("type","page-import").elem("content").content()(function(){this.ctx.parentCtx.js.type;return[{block:"b-widget",elem:"header",content:BEM.I18N("b-widget","import-data")},{block:"button2",mods:{size:"s",role:"load-another-file",visibility:"hidden",theme:"normal"},content:{elem:"text",content:[{block:"awesome-icon",mods:{icon:"upload"}},BEM.I18N("b-widget","load_another_file")]}},{elem:"configs",content:[{elem:"attach",content:[{block:"attach",mods:{size:"s",theme:"normal"},tabindex:1,holder:BEM.I18N("b-widget","select_file"),text:BEM.I18N("attach","button-text"),button:{control:{attrs:{autocomplete:"off",accept:".csv,.tsv,.txt"}}}}]},BEM.I18N("b-widget","fields_seperator"),{block:"select2",mods:{size:"s",theme:"normal",type:"radiocheck",role:"fields-separator",text:"vary"},text:";",val:";",items:[{val:",",text:","},{val:";",text:";"},{val:"\t",text:"\\t"}]},BEM.I18N("b-widget","rows_separator"),{block:"select2",mods:{size:"s",theme:"normal",type:"radiocheck",role:"rows-separator",text:"vary"},text:'"',val:'"',items:[{val:'"',text:'"'},{val:"'",text:"'"}]},{block:"checkbox",mods:{theme:"normal",size:"s",type:"import-head"},text:BEM.I18N("b-widget","import_first_line")}]},{elem:"preview"},{elem:"errors",elemMods:{visibility:"hidden"}},{elem:"buttons",content:[{block:"spin2",mods:{size:"xs",type:"file-load"}},{block:"button2",mods:{theme:"normal",size:"s",role:"import-cancel"},text:BEM.I18N("b-widget","cancel")},{block:"button2",mods:{size:"s",role:"load",theme:"action",disabled:"yes"},text:BEM.I18N("b-widget","load")},{block:"button2",mods:{size:"s",role:"import",theme:"action",disabled:"yes",visibility:"hidden"},text:BEM.I18N("b-widget","import")},{block:"tooltip",mods:{size:"s",theme:"error",type:"import"},content:BEM.I18N("b-widget","import_error")}]}]}),n("b-widget").mod("type","referrers")(u()(!0),s("content").content()(function(){var t=this.ctx.parentCtx.js.pages;return[{elem:"header",content:BEM.I18N("b-widget","linked-pages")+" ("+t.length+"):"},{elem:"linked-pages",content:{elem:"linked-pages-list",content:t.map(function(t){return{elem:"linked-page",content:{block:"link",url:t.url,content:t.tag}}})}},{elem:"buttons",content:[{block:"button2",mods:{theme:"normal",size:"m",role:"close"},text:BEM.I18N("b-widget","close")}]}]})),n("b-widget").mod("type","request-page-author")(u()(function(){return{request_login:this.ctx.request_login}}),s("content").content()(function(){var t=x();return Array.isArray(t)||(t=[t]),t.push({elem:"header",tag:"h2",content:BEM.I18N("b-widget","request_page_author_propose")},{elem:"buttons",content:[{block:"spin2",mods:{size:"xs",type:"add"}},{block:"button2",mods:{theme:"normal",size:"s",role:"cancel"},text:BEM.I18N("b-widget","cancel")},{block:"button2",mods:{theme:"action",size:"s",role:"add"},text:BEM.I18N("b-widget","add")}]}),t})),n("b-widget").mod("type","subpages-change-author")(u()(function(){return{currentUser:this.ctx.currentUser,authors:this.ctx.authors,baseWidgetData:this.ctx.baseWidgetData}}),s("content").content()(function(){return[{elem:"inputs",parentCtx:this.ctx.parentCtx},{elem:"tree"},{elem:"buttons",content:[{block:"spin2",mods:{size:"s",role:"save"}},this.ctx.parentCtx.baseWidgetData?{block:"button2",mods:{size:"m",theme:"normal",role:"back"},text:BEM.I18N("b-widget","back")}:{block:"button2",mods:{size:"m",theme:"normal",role:"cancel"},text:BEM.I18N("b-widget","cancel")},{block:"button2",mods:{size:"m",theme:"action",role:"save",disabled:"yes"},text:BEM.I18N("b-widget","change_authors")}]}]}),s("suggest-from").replace()(function(){return{block:"m-suggest",mods:{type:"b2b",multicomplete:"yes",role:"from"},js:{intranet:!0},url:BEM.blocks["i-global"].param("hosts").suggest.url,input:{block:"textinput",mix:{block:"m-suggest",elem:"textinput"},mods:{size:"s",theme:"normal",disabled:this.ctx.canEditLeftInput?"":"yes","has-clear":"no"},autocomplete:!1,name:"text",text:this.ctx.canEditLeftInput?"":this.ctx.currentUser.first_name+" "+this.ctx.currentUser.last_name}}}),s("suggest-to").replace()(function(){return{block:"m-suggest",mods:{type:"b2b",multicomplete:"yes",role:"to"},js:{intranet:!0},url:BEM.blocks["i-global"].param("hosts").suggest.url,input:{block:"textinput",mix:{block:"m-suggest",elem:"textinput"},mods:{size:"s",theme:"normal","has-clear":"no"},autocomplete:!1,name:"text",text:""}}}),s("inputs").content()(function(){var t=this.ctx.parentCtx.currentUser,e=t.is_admin||this.ctx.parentCtx.authors.some(function(e){return e.login===t.login});return[{elem:"suggest-from",currentUser:t,canEditLeftInput:e},{elem:"change-to",content:BEM.I18N("b-widget","change-to")},{elem:"suggest-to"}]})),n("b-widget").mod("type","subpages-change-author")(s("suggest-from").replace()(function(){var t=this.ctx.currentUser.first_name?this.ctx.currentUser.first_name+" "+this.ctx.currentUser.last_name:this.ctx.currentUser.login;return{block:"m-suggest",mods:{type:"b2b",multicomplete:"yes",role:"from"},js:{addRequestParams:{org_id:this["i-global"].orgId}},url:this["i-global"].hosts.suggest.url,input:{block:"input",mods:{size:"s",clear:"no",theme:"normal",disabled:this.ctx.canEditLeftInput?"":"yes"},content:{elem:"control",attrs:{name:"text",autocomplete:"off"}},value:this.ctx.canEditLeftInput?"":t}}}),s("suggest-to").replace()(function(){return{block:"m-suggest",mods:{type:"b2b",multicomplete:"yes",role:"to"},js:{addRequestParams:{org_id:this["i-global"].orgId}},url:this["i-global"].hosts.suggest.url,input:{block:"input",mods:{size:"s",clear:"no",theme:"normal"},content:{elem:"control",attrs:{name:"text",autocomplete:"off"}},value:""}}})),n("b-wiki-tree")(e(function(){return!this.ctx.replaced}).replace()(function(){var t=this.ctx,e=t.mods||{};return t.js.data&&t.js.data.nomark&&(e.nomark="yes"),t.replaced=!0,t.mods=e,t}),f()(function(){var t=this.ctx.js.totalData||this.ctx.totalData,e=t.page;return[{elem:"head",content:[{elem:"title",content:[BEM.I18N("b-wiki-tree","cluster_tree")+" ",{block:"link",url:e.url,content:{html:this.require("xss")(e.title||e.cluster)}}]},t.expand_all_url&&{elem:"expand-all",content:[{block:"button2",mods:{theme:"normal",size:"s",role:"expand-all"},text:BEM.I18N("b-wiki-tree","expand_all")},t.limit_exceeded&&{elem:"not-full-loaded"}]}]},{block:"spin2",mods:{size:"xxs",type:"update-tree"}},{elem:"tree",content:t.subpages&&t.subpages.map(function(t){return{block:"b-wiki-tree-page",mods:{expandable:t.expand_url||t.subpages.length?"yes":"",expanded:t.subpages.length?"yes":"","data-loaded":t.subpages.length?"yes":"",type:t.page.type.toLowerCase()},data:t}})}]}),s("not-full-loaded").content()(function(){return BEM.I18N("b-wiki-tree","not_full_loaded")}),s("full-loaded").content()(function(){return BEM.I18N("b-wiki-tree","full_loaded")})),n("b-wiki-tree-page")(u()(function(){return{data:this.ctx.data}}),f()(function(){return[{elem:"expand"},{elem:"content",data:this.ctx.data}]}),s("content").content()(function(){var t=this.ctx.data,e=t.page.type.toLowerCase(),i=t.page.url;return"n"===e&&(i+="/.create"),[{elem:"self",content:[{block:"link",mods:{type:e},url:i,content:{html:this.require("xss")(t.page.title||t.page.cluster)}},{elem:"type-icon"},t.page.authors&&{elem:"authors",authors:t.page.authors},{elem:"created",time:t.page.created_at},{elem:"modified",time:t.page.modified_at},t.page.files&&{elem:"files",files:t.page.files}]},{elem:"children",subpages:t.subpages}]}),s("authors").replace()(function(){var t=this.ctx.authors;return t&&t.map(function(e,i){return e.display=e.login,[{block:"w-username",user:e},i!==t.length-1?",":""]})}),s("created").match(function(){return this.ctx.time}).content()(function(){return BEM.I18N("b-wiki-tree-page","created")+": "+this["mi-helpers"].dateFormat(new Date(1e3*this.ctx.time))}),s("created").match(function(){return!this.ctx.time}).replace()(""),s("modified").match(function(){return this.ctx.time}).content()(function(){return BEM.I18N("b-wiki-tree-page","modified")+": "+this["mi-helpers"].dateFormat(new Date(1e3*this.ctx.time))}),s("modified").match(function(){return!this.ctx.time}).replace()(""),s("files").content()(function(){var t=this.ctx.files;return[{elem:"left-bracket"},t.slice(0,2).map(function(e,i){return[{elem:"file",data:e},!(i===t.length-1)&&","]}),t.length>2&&" ...",{elem:"right-bracket"}]}),s("file").content()(function(){return[{block:"awesome-icon",mods:{icon:"file"}},{block:"link",mods:{type:"file"},url:this.ctx.data.url,content:this.ctx.data.name}]}),s("left-bracket").content()("("),s("right-bracket").content()(")"),s("children").content()(function(){return this.ctx.subpages&&this.ctx.subpages.map(function(t){return{block:"b-wiki-tree-page",mods:{expandable:t.expand_url||t.subpages.length?"yes":"",expanded:t.subpages.length?"yes":"","data-loaded":t.subpages.length?"yes":"",type:t.page.type.toLowerCase()},data:t}})})),n("b-wiki-tree-page").mod("type","c").elem("type-icon").content()({block:"awesome-icon",mods:{icon:"lock"}}),n("b-wiki-tree-page").mod("type","r").elem("type-icon").content()({block:"awesome-icon",mods:{icon:"share"}}),n("b-wiki-tree-page").mod("type","g").elem("type-icon").content()({block:"awesome-icon",mods:{icon:"table"}}),n("b-widget").mod("type","tree")(u()(!0),s("content").content()(function(){var t=this.ctx.parentCtx;return[{elem:"header",content:BEM.I18N("b-widget","subpages")+" "+(t.data.page.title||t.data.page.cluster)},{block:"b-wiki-tree",js:{totalData:this.ctx.parentCtx.data,data:{nomark:!0}}},{elem:"buttons",content:[{block:"button2",mods:{theme:"normal",size:"s",role:"back"},text:BEM.I18N("b-widget","back")},{elem:"right-buttons",content:{block:"button2",mods:{theme:"normal",size:"s",role:"close"},text:BEM.I18N("b-widget","close")}}]}]})),n("b-widget").mod("type","redirect-message")(u()(!0),s("content").content()(function(){return[{elem:"message",content:BEM.I18N("b-widget","operation_for_redirect")},{elem:"buttons",content:[{block:"button2",mods:{size:"m",role:"cancel",theme:"normal"},text:BEM.I18N("b-widget","cancel")},{block:"button2",mods:{size:"m",theme:"action",role:"settings"},text:BEM.I18N("b-widget","remove_redirect")}]}]})),n("w-page-info")(u()(!0),f()(function(){return[{elem:"content",parentCtx:this.ctx},{elem:"right"}]}),s("right").content()({block:"awesome-icon",mods:{icon:"remove",type:"hide"}})),n("w-page-info").mod("type","possibly-obsolete").elem("content").content()(function(){return[BEM.I18N("w-page-info","possible_obsolete_notification"),{block:"button2",mods:{size:"xs",theme:"normal"},mix:[{block:"w-action",mods:{type:"old-page"},js:{actuality:"actual"}}],text:BEM.I18N("w-page-info","not_actual")},{block:"button2",mods:{theme:"normal",size:"xs"},mix:[{block:"w-action",mods:{type:"old-page"},js:{actuality:"obsolete"}}],text:BEM.I18N("w-page-info","actual")}]}),n("w-page-info").mod("type","redirect").elem("content").content()(function(){return[{block:"awesome-icon",mods:{icon:"lock"}},BEM.I18N("w-page-info","redirect-message"),{block:"button2",mods:{theme:"normal",size:"xs",role:"settings"},text:BEM.I18N("w-page-info","remove_redirect")}]}),n("w-page-info").mod("type","redirected-from").elem("content").content()(function(){return[BEM.I18N("w-page-info","redirected")+" ",{block:"link",url:this.xmlEscape(this.ctx.parentCtx.url)+"?noredirect",content:decodeURIComponent(this.ctx.parentCtx.url)}]}),n("w-page-info").mod("type","diff-wf-versions").elem("content").content()(BEM.I18N("w-page-info","diff_wf_versions")),n("spin")(e(function(){return!this.mods.theme}).def()(function(){return this.mods.theme="gray-32",x()}),f()(function(){return{block:"image",mix:{block:"spin",elem:"icon"}}})),n("popup")(c().match(function(){return!this._popupDefaults})(function(){var t=this.ctx,e=this.mods;if(e.hasOwnProperty("theme")||(e.theme="ffffff"),e.hasOwnProperty("autoclosable")||(e.autoclosable="yes"),e.hasOwnProperty("adaptive")||(e.adaptive="yes"),e.hasOwnProperty("animate")||(e.animate="yes"),t.zIndex){var i=t.attrs||(t.attrs={});i.style=(i.style||"")+";z-index:"+t.zIndex+";"}return E("default",{_popupDefaults:!0})}),f()(function(){return delete this._popupDefaults,[{elem:"under",elemMods:this.ctx.underMods},this.ctx.content]})),n("i-ua").content()(function(){var t=[";(function(d,e,c,n,w,v,f){","e=d.documentElement;",'c="className";','n="createElementNS";','f="firstChild";','w="http://www.w3.org/2000/svg";','e[c]+=" i-ua_svg_"+(!!d[n]&&!!d[n](w,"svg").createSVGRect?"yes":"no");','v=d.createElement("div");','v.innerHTML="<svg/>";','e[c]+=" i-ua_inlinesvg_"+((v[f]&&v[f].namespaceURI)==w?"yes":"no");',"})(document);"].join("");return[].concat(x(),{html:t})}),n("m-suggest-item").mod("type","service")(u()(function(){var t=this.ctx.data;return this.extend(x(),{value:t.name})}),f()(function(){var t=this.ctx.data.name,e=this.ctx.inputData.text,i=t.indexOf(e);return{elem:"info-wrapper",content:-1!==i?[t.substr(0,i),{elem:"selected",content:e},t.substr(i+e.length)]:t}})),n("select-multiple")(l()("select"),d()(function(){return{name:this.ctx.name,multiple:"multiple"}})),n("select-multiple").elem("option").tag()("option"),n("b-wiki-forms")(u()(function(){return{path:this.ctx.js.data.path,name:this.ctx.js.data.name}}),f()(function(){return[{block:"spin2",mods:{size:"s",progress:"yes",type:"load"}},{elem:"form",name:this.ctx.js.data.name}]}),s("form")(l()("iframe"),d()(function(){return{frameborder:0,name:this.ctx.name}}))),n("b-wiki-serviceteam")(f()(function(){var t=this.ctx.js.totalData||this.ctx.totalData,e=t.roles?"roles":"contacts";return[{elem:"header",label:t.service_name,editUrl:t.edit_url,type:e},{elem:"content",data:t}]}),s("header").content()(function(){return[{elem:"label",content:BEM.I18N("b-wiki-serviceteam",this.ctx.type)+" «"+this.ctx.label+"»"},{block:"link",url:this.ctx.editUrl,mix:{block:this.block,elem:"edit"},content:{block:"awesome-icon",mods:{icon:"pencil",type:"edit"}}}]}),s("content").match(function(){return this.ctx.data.roles}).content()(function(){return this.ctx.data.roles.map(function(t){return{elem:"role",data:t}})}),s("content").match(function(){return this.ctx.data.contacts}).content()(function(){return this.ctx.data.contacts.map(function(t){return{elem:"contact",data:t}})}),s("role").content()(function(){var t=this.ctx.data.persons,e=BEM.I18N.lang();return[{elem:"role-header",content:this.ctx.data.name},{elem:"persons",content:t.map(function(i,n){var s=n===t.length-1;return[{elem:"person",content:[{block:"m-username",mix:[{block:"mi-staff-card",js:{user:i.login}}],url:"//staff.yandex-team.ru/"+i.login,content:"string"==typeof i.first_name?i.first_name+" "+i.last_name:i.name[e]},!s&&","]},!s&&" "]})}]}),s("contact").content()(function(){var t=BEM.I18N.lang();return{block:"link",mix:{block:this.block,elem:"link"},url:this.ctx.data.link,text:this.ctx.data.text[t],icon:{mods:{type:this.ctx.data.type.replace(/_/g,"-")},mix:{block:this.block,elem:"icon"}}}})),n("b-wiki-wanted")(l()("ul"),f()(function(){return(this.ctx.js.totalData||this.ctx.totalData).links.map(function(t){return{elem:"link",content:{block:"link",url:t,content:t}}})}),s("link").tag()("li")),n("b-head")(s("org-logo")(l()("img"),d()(function(){return{src:this.ctx.src}}))),n("b-favs-widget").content()(function(){return[{elem:"paranja"},{elem:"content",content:[{block:"b-favs-folders",js:!0},{block:"b-favs-links",js:!0},{block:"button2",mods:{theme:"normal",size:"m"},mix:[{block:"b-readonly-item",js:!0},{block:"b-favs-options-button",js:!0}],text:BEM.I18N("b-favs-widget","settings")}]}]}),n("b-favs-folders").content()({block:"scroll",mods:{theme:"normal",tech:"js"},content:[{block:"spin2",mods:{size:"xs",show:"no"}},{block:"b-favs-folders",elem:"list",content:[]}]}),n("b-favs-folders").elem("list").tag()("ol"),n("b-favs-folders").elem("item").tag()("li"),n("b-favs-folder").elem("name").tag()("span"),n("b-favs-folder").elem("count").tag()("span"),n("b-favs-links").content()(function(){return[{block:"spin2",mods:{size:"xs",show:"no",type:"load"}},{block:"input",mods:{size:"m",theme:"lite",type:"filter"},placeholder:BEM.I18N("b-favs-links","name_search"),content:{elem:"control"}},{block:"scroll",mods:{theme:"normal",tech:"js"},content:{block:"b-favs-links",elem:"list",content:[]}}]}),n("b-favs-links").elem("list").tag()("ol"),n("b-favs-links").elem("item").tag()("li"),n("b-favs-link").elem("date").match(function(){return this.ctx.timestamp}).content()(function(){var t=BEM.blocks["mi-helpers"].getDateFromHumanString(this.ctx.timestamp),e=function(t){return t<10?"0"+t:t};return[e(t.getDate()),e(t.getMonth()+1),t.getFullYear()].join(".")}),n("m-suggest-item").mod("type","cluster-search")(u()(function(){return this.extend(x(),{value:this.ctx.data.cluster})}),f()(function(){return{elem:"info-wrapper",content:[{elem:"selected",content:this.ctx.inputData.text}," - ",BEM.I18N("m-suggest-item","search-in-cluster")," «"+this.ctx.data.cluster+"»"]}})),n("textinput").match(function(){return this.mods.pin}).def()(function(){return this.mods["has-pin"]="yes",x()}),n("messenger")(u()(function(){return this.extend({live:!1},this.ctx.js)})),n("w-header-settings")(u()(!0),f()({block:"awesome-icon",mods:{icon:"gear"}}),s("item").content()(function(){return{block:"link",url:this.ctx.url,content:[{block:"awesome-icon",mods:{icon:this.ctx.icon}},this.ctx.text]}})),n("services-table")(l()("ul"),c()(function(){return this.mods.type||"tr"!==this["i-global"]["content-region"]||(this.mods.type="turkish"),x()}),e(function(){return!this.ctx.content}).content()(function(){return[this.ctx.items&&this.ctx.items.map(function(t){return this.extend(t,{elem:"item"})},this),this.ctx.all&&{elem:"all"}].filter(Boolean)})),n("user2")(c()(function(){var t=this.ctx,e=E("params"),i=E("exit-url",e),n=t.accounts||[],s=t.organizations,o=t.currentOrgId;return this.mods["with-organizations"]&&["ru","com"].indexOf(this["i-global"].tld)<0&&(delete this.mods["with-organizations"],delete this.mods["fetch-organizations"]),this.mods["fetch-accounts"]&&n.push({block:"user-account",mods:{template:"yes"},mix:[{block:"user2",elem:"account"}],content:[{block:"user-pic",mix:{block:"user-account",elem:"pic"},content:{block:"user-pic",elem:"image",tag:"img"}},{elem:"name",tag:"span",content:[{elem:"name-text",tag:"span",content:""},{elem:"subname",tag:"span",content:""}]}]}),x({"ctx.accounts":n,"ctx.organizations":s,"ctx.currentOrgId":o,_user2Mods:this.mods,_params:this.extend(e,this._params),_exitUrl:i,_unreadCount:this.ctx.unreadCount||0})}),o("params")(function(){var t=this.ctx,e="undefined"!=typeof window?window.location:{},i=this["i-services"],n=t.accountAttributes||{},s={uid:!!t.hasOwnProperty("uid")&&t.uid,yu:t.yu,plus:n.has_plus||n.plus_available&&!1,retpath:t.hasOwnProperty("retpath")?t.retpath:e.href||"",name:t.hasOwnProperty("name")?t.name:t.uid||!1,maxLength:t.maxLength,subname:t.subname,avatarId:t.hasOwnProperty("avatarId")?t.avatarId:"",passportHost:t.hasOwnProperty("passportHost")?t.passportHost:i.serviceUrl("passport"),userAccount:t.userAccount||{},addAccount:t.addAccount||{},avatarHost:t.avatarHost,passportLinkParams:t.passportLinkParams||""};return s.retpathEncoded=encodeURIComponent(s.retpath),s}),o("exit-url")(function(t){return[t.passportHost,"/passport?mode=embeddedauth","&action=logout","&yu="+t.yu,"&uid="+t.uid,"&retpath="+t.retpathEncoded].join("")}),u()(function(){return this.extend({_uid:this._params.uid,_plus:this._params.plus,_retpath:this._params.retpath,_yu:this._params.yu,_passportHost:this._params.passportHost,_avatarHost:this._params.avatarHost,accountsUrl:this["i-services"].serviceUrl("passportApi")+"/all_accounts"},x())}),e(function(){return void 0===this.ctx.content}).content()(function(){return E("default-content")}),f()(function(){return this.ctx.uid?x():{block:"user2",elem:"enter"}}),o("default-content")(function(){var t=this.ctx.accounts||[],e=this.ctx.organizations,i=this.ctx.currentOrgId,n=this.mods.provider||"",s=this.ctx.accountAttributes||{},o=!1===this.ctx.yaplus?this.ctx.hat:void 0,r=o&&(o.mods||{})["fetch-data"],a=s.has_plus||s.plus_available&&!1;this.ctx.mods&&this.ctx.mods["has-logout"]&&(t=t.map(function(t){return t.mods=t.mods||{},t.mods["has-logout"]="yes",t}));var c={action:"plus",elemMods:{hidden:o&&!r&&"yes"},plus:Boolean(this.ctx.yaplus),plusLinkParams:this.ctx.plusLinkParams},l=this.ctx.actionsMenu?[].concat(this.ctx.actionsMenu).filter(function(t){return"plus"===t.action?(c=this.extend(c,t),!1):t},this).filter(Boolean):[{action:"mail"}];return[{elem:"current-account",plus:this.ctx.yaplus,name:this._params.name,maxLength:this._params.maxLength,unreadCount:this._unreadCount,avatarId:this._params.avatarId,avatarHost:this._params.avatarHost,provider:n},{elem:"a11y-exit"},this.extend({elem:"popup",content:{block:"user2",elem:"menu",hat:o,plus:a,addAccount:this._params.addAccount,actionsMenu:void 0===this.ctx.yaplus?l:l.concat(c),multiAuthMenu:this.ctx.multiAuthMenu||[{action:"passport"},{action:"exit"}],settingsUrl:this.ctx.settingsUrl,settingsLinkTarget:this.ctx.settingsLinkTarget,helpUrl:this.ctx.helpUrl,helpLinkTarget:this.ctx.helpLinkTarget,accounts:t,organizations:e,currentOrgId:i,avatarHost:this._params.avatarHost,provider:n,origin:this.ctx.origin,camera:this.ctx.camera}},this.ctx.popup)]})),n("i-ua").content()(function(){return[].concat(x(),{html:';document.documentElement.className+=" i-ua_orient_"+(window.innerWidth>window.innerHeight?"landscape":"portrait");'})}),n("user-account")(("undefined"!=typeof addJs?addJs:u)()(!0),("undefined"!=typeof addAttrs?addAttrs:d)()({tabindex:"0"}),e(function(){return this.ctx.url})(l()("a"),d()(function(){return this.extend(x(),{href:this.ctx.url})})),e(function(){return!1!==this.ctx.name&&void 0===this.ctx.content}).content()(function(){var t=this.ctx.maxLength||16,e=this.ctx.name&&this.ctx.name.length>t?this.ctx.name.substring(0,t-1)+"…":this.ctx.name;return[this.isSimple(e)?{elem:"name",text:e||"",subname:this.ctx.subname}:this.extend(e,{elem:"name",subname:this.ctx.subname})]}),e(function(){return void 0!==this.ctx.pic})(f()(function(){return[{elem:"pic",pic:this.extend({plus:this.ctx.plus},this.ctx.pic),avatarHost:this.ctx.avatarHost,provider:this.ctx.mods&&this.ctx.mods.provider},x()]}))),n("i-ua").content()(function(){var t=[";(function(w,e,s,c,x,l,p,d){",'c="className";','x="deviceXDPI";','l="logicalXDPI";','p="devicePixelRatio";',"d=x in s&&l in s&&s[x]/s[l]||p in w&&w[p];",'d>1&&(e[c]+=" i-ua_retina_yes")',"})(window,document.documentElement,screen);"].join("");return[].concat(x(),{html:t})}),n("user-pic").elem("camera")(f()(function(){return[{tag:"a",elem:"link"}]})),n("ticker")(c()(function(){return x({_count:this.ctx.count||0,_maxCount:this.ctx.maxCount||99,_url:this.ctx.url})}),l()("span"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{role:"alert","aria-live":"assertive","aria-atomic":"true"}}),e(function(){return!this._count})["undefined"!=typeof addJs?"addMix":"mix"]()(function(){return[{mods:{state:"empty"}}]}),("undefined"!=typeof addJs?addJs:u)()(function(){return{count:this._count,maxCount:this._maxCount}}),f()(function(){return{elem:"count",url:this.ctx.url,content:this.ctx.count}})),n("user2").elem("a11y-exit").replace()(function(){var t=this._exitUrl;return""!==this._params.passportLinkParams&&(t+="&"+this._params.passportLinkParams),{block:"link",mods:{theme:"pseudo"},mix:[{block:"user2",elem:"a11y-exit"},{block:"a11y-hidden"}],attrs:{accesskey:"x"},tabindex:"-1",url:t,content:BEM.I18N("user2","exit")}}),n("user2").elem("menu-footer").content()(function(){return[{block:"button2",mods:{theme:"clear",size:"s",type:"link"},mix:{block:this.block,elem:"footer-link"},url:this.ctx.settingsUrl||this["i-services"].serviceUrl("tune"),target:this.ctx.settingsLinkTarget||void 0,text:BEM.I18N("user2","settings")},{block:"button2",mods:{theme:"clear",size:"s",type:"link"},mix:{block:this.block,elem:"footer-link"},url:this.ctx.helpUrl||this["i-services"].serviceUrl("support"),target:this.ctx.helpLinkTarget||void 0,text:BEM.I18N("user2","help")}]}),n("menu").mod("type","navigation")(l()("ul"),c()(function(){return x({_inMenuTypeNavigation:!0})})),n("user2").elem("menu-item").elemMod("action","disk")(c()(function(){return this.ctx.url=E("url"),this.ctx.text=E("text"),x()}),o("url")(function(){return this["i-services"].serviceUrl("disk")+"?source=main-loginmenu"}),o("text")(function(){return BEM.I18N("user2","upload_files")})),n("user2").elem("menu-item").elemMod("action","mail-compose")(c()(function(){return this.ctx.url=E("url"),this.ctx.text=E("text"),x()}),o("url")(function(){return this["i-services"].serviceUrl("mail")+"/compose"}),o("text")(function(){return BEM.I18N("user2","mail_compose")})),n("user2").elem("menu-item").elemMod("action","mail")(c()(function(){return this.ctx.url=E("url"),this.ctx.text=E("text"),x()}),o("url")(function(){return this["i-services"].serviceUrl("mail")}),o("text")(function(){return[this["i-services"].serviceName("mail"),{block:"user2",elem:"menu-counter",count:this._unreadCount}]})),n("user2").elem("menu-item").elemMod("action","settings").def()(function(){return this.ctx.text=BEM.I18N("user2","settings"),this.ctx.url=this["i-services"].serviceUrl("tune"),x()}),n("user-account").match(function(){return void 0!==this.ctx.subname}).def()(function(){return this.mods["has-subname"]="yes",x()}),n("user-account").mod("has-subname","yes").elem("name").content()(function(){var t="object"==typeof this.ctx.subname?{fb:"Facebook",tw:"Twitter",mr:"Mail.ru",gg:"Google",ok:"Odnoklassniki",vk:"Vkontakte",dz:"Deezer",fs:"Foursquare",ig:"Instagram",lf:"Last.FM",lj:"LiveJournal",in:"LinkedIn",mt:"МТС-Россия",ms:"Microsoft",yh:"Yahoo",ya:"Yandex",vf:"Vodafone-Украина",tg:"Telegram"}[this.ctx.subname.provider]:this.ctx.subname;return t&&t!==this.ctx.text?[x(),{elem:"subname",text:t}]:x()}),n("user2").elem("organizations")(c()(function(){return this._hasOrganizationsInCtx=this.ctx.organizations&&0!==this.ctx.organizations.length,this.elemMods.collapsed="yes",x()}),o("hidden-orgs")(function(t){return{block:"user2",elem:"organizations-cropper",content:t.hiddenOrgs}}),o("org")(function(t){return{block:"user-organization",mods:t.mods,url:this._params.contextSwitchUrl+(t.id?"&org_id="+t.id:""),name:t.name,logo:t.logo,mix:t.mix}}),e(function(){return void 0===this.ctx.content&&this._hasOrganizationsInCtx&&!this._user2Mods["fetch-organizations"]}).content()(function(){var t=this.ctx.currentOrgId||this.ctx.organizations[0].id,e={current:null,others:[]};return this.ctx.organizations.forEach(function(i){i.id===t?e.current=i:e.others.push(i)}),e.current||(e.current=e.others[0],e.others=e.others.slice(1)),e.others=e.others.map(function(t){return E("org",t)}),e.current.mix=[{block:"user2",elem:"organizations-trigger"}].concat(e.current.mix),e.others.length>0&&(this.elemMods.expandable="yes"),[E("org",e.current),E("hidden-orgs",{hiddenOrgs:e.others}),x()]}),e(function(){return void 0===this.ctx.content&&this._user2Mods["fetch-organizations"]}).content()(function(){return[E("org",{mods:{template:"yes"},name:""}),E("hidden-orgs",{hiddenOrgs:[]}),x()]}),e(function(){return void 0===this.ctx.content&&(!this.ctx.organizations||this.ctx.organizations.length<15)}).content()(function(){return[x(),{block:"user2",elem:"add-organization"}]}),f()(function(){return[x(),{block:"icon",mods:{glyph:"type-arrow",size:"s"},mix:{block:"user2",elem:"expand-organizations-icon"}}]})),n("user-organization")(("undefined"!=typeof addJs?addJs:u)()(!0),("undefined"!=typeof addAttrs?addAttrs:d)()({tabindex:"0"}),l()("a"),d()(function(){return this.extend(x(),{href:this.ctx.url})}),e(function(){return void 0===this.ctx.content})(f()(function(){return[{elem:"pic",logo:this.ctx.logo},{elem:"name",text:this.ctx.name},x()]}))),n("w-bug-report")(f()(function(){return{block:"button2",mix:{block:this.block,elem:"button"},mods:{theme:"normal",size:"l",type:"check"},icon:{mods:{type:"bug"}}}})),n("w-bug-report").elem("frame")(l()("iframe"),d()(function(){return{name:this.ctx.name,frameborder:0,src:E("iframe-src").href}}),o("iframe-src")(function(){var t=new URL(this["i-global"].hosts.feedbackForm);return t.searchParams.append("iframe",1),t.searchParams.append("ref",location.href),t.searchParams.append("user-agent",navigator.userAgent),t.searchParams.append("lang",BEM.I18N.lang()),t})),n("w-bug-report").elem("dialog")(f()(function(){return[{block:"spin2",mods:{size:"s",position:"center"}},{elem:"frame",name:this.ctx.name}]})),n("w-notifier")(u()(function(){return{notifyId:this.ctx.data.id}}),f()(function(){var t=this.ctx;return[{elem:"main",content:[{tag:"span",elem:"text",content:t.data.message},{block:"button2",mods:{theme:"action",type:"link",size:"s",role:"link"},text:BEM.I18N("w-notifier","go"),url:t.data.url,target:"_blank"}]},{elem:"closer",content:{block:"icon",mods:{type:"close"}}}]})),n("popup2").mod("target","anchor").def()(function(){return void 0===this.mods.hiding&&(this.mods.hiding="yes"),x()}),n("popup2").mod("target","anchor").mod("visible","yes").def()(function(){return this.mods.outside="yes",x()}),n("popup2").mod("hiding","yes").def()(function(){return"anchor"!==this.mods.target&&(this.mods.target="anchor"),x()}),n("button2")(c()(function(){return void 0===this.mods.view&&(this.mods.view="classic"),this.mods.progress&&(this.mods.disabled="yes"),void 0===this.ctx.tabindex&&(this.ctx.tabindex="0"),x()}),e(function(){return void 0===this.ctx.tag}).tag()("button"),("undefined"!=typeof addJs?addJs:u)()(function(){return{_tabindex:this.mods.disabled?this.ctx.tabindex:void 0}}),d()(function(){var t=this.ctx,e=Boolean(this.mods.disabled);return this.extend({type:"button",autocomplete:"off",id:t.id,title:t.title,name:t.name,value:t.val,tabindex:e?void 0:t.tabindex,disabled:e,"aria-disabled":e&&"true"},x())}),e(function(){return!this.ctx.content}).content()(function(){var t=this.ctx;return[t.icon&&{elem:"icon",icon:t.icon},t.iconLeft&&{elem:"icon",elemMods:{side:"left"},icon:t.iconLeft},t.iconRight&&{elem:"icon",elemMods:{side:"right"},icon:t.iconRight},void 0!==t.text&&(this.isSimple(t.text)?{elem:"text",content:{html:this.xmlEscape(t.text)}}:this.extend(t.text,{elem:"text"}))].filter(Boolean)})),n("sidebar").mod("full-height","yes").mix()(function(){return[{block:"mi-sticky",mods:{"full-height":"yes"},js:{placeholder:{width:""},offset:{top:0,bottom:0}}}].concat(this.ctx.mix)}),n("sidebar").elem("tab").elemMod("type","toc").def()(function(){return x({_label:BEM.I18N("sidebar","toc-label"),_icon:"list"})}),n("sidebar").elem("tab-content").elemMod("tab","toc").content()(function(){return{block:"b-toc",mods:{type:"sidebar"},data:this.ctx.preLoad}}),n("select2").mod("popup","yes")(f()(function(){var t=this.extend({},this.ctx),e=this.mods,i=t.items,n={elem:"popup",popup:this.extend({mods:{view:e.view,tone:e.tone}},t.popup),itemIconHidden:Boolean(e["item-icon-hidden"]),menu:this.util.merge({mods:{size:e.size,type:e.type,view:e.view,tone:e.tone},val:t.val,items:i},t.menu)};return[].concat(x({ctx:t})||[],n)})),n("select2").elem("popup").replace()(function(){return this.util.mergeBemjson({block:"popup2",mods:{theme:"normal",target:"anchor",hiding:"yes",autoclosable:"yes"},mix:{block:"select2",elem:"popup",elemMods:this.elemMods,js:E("js")},mainOffset:"default"===this.mods.view?2:void 0,directions:["bottom-left","bottom-right","top-left","top-right"],content:{block:"select2",elem:"menu",itemIconHidden:this.ctx.itemIconHidden,menu:this.ctx.menu}},this.ctx.popup)}),n("select2").elem("menu").replace()(function(){var t=this.extend(this.elemMods,{"item-icon-hidden":this.ctx.itemIconHidden?"yes":void 0});return this.util.mergeBemjson({block:"menu",mix:{block:"select2",elem:"menu",elemMods:t,js:E("js")},mods:{theme:"normal",width:"max"},val:this.ctx.val,tabindex:null},this.ctx.menu)}),n("menu").mod("type","radiocheck")(o("tabindex")("0"),d()(function(){return this.extend(x(),{role:"listbox"})})),n("select2").mod("text","vary")(("undefined"!=typeof addJs?addJs:u)()(function(){var t={};return(this.ctx.flattenItems||[]).forEach(function(e){t[e.val]=e.checkedText}),this.extend(x(),{text:this.ctx.text,checkedTexts:t})})),n("m-date")(l()("span"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t=this["mi-helpers"].getDateFromHumanString(this.ctx.timestamp),e=t.getMonth()+1;function i(t){return(t<10?"0":"")+t}return{title:[t.getDate(),i(e),t.getFullYear()].join(".")+" "+[t.getHours(),i(t.getMinutes())].join(":")}}),f()(function(){return[this.ctx.content?this.ctx.content+" ":"",{block:"mi-date",timestamp:this.ctx.timestamp,short:Boolean(this.ctx.short),alwaysShowYear:Boolean(this.ctx.alwaysShowYear),format:this.ctx.format}]})),n("link").mod("pseudo","yes")(f().match(function(){return!this.mods.inner})(function(){return{elem:"inner",content:x()}})),n("w-attach").elem("drag-hint").tag()("span"),n("m-notification").mod("theme","info").elem("icon").content()({block:"awesome-icon",mods:{icon:"info-circle",type:"theme-icon"}}),n("b-grid-table-code").mod("type","sidebar").js()(function(){return this.ctx.js||!0}),n("input").mod("type","textarea").elem("control")(l()("textarea"),d()(function(){var t=x({_value:null});return this.extend(t,{rows:10,cols:10})}),f()(function(){return{html:this.xmlEscape(this._value||this.ctx.content||"")}})),n("radio-button")(c()(function(){var t=this.ctx,e=this.mods;return void 0===this.mods.view&&(this.mods.view="classic"),x({_radioButton:{name:t.name,value:t.value,disabled:Boolean(e.disabled)}})}),l()("span"),("undefined"!=typeof addJs?addJs:u)()(function(){return this.extend({live:!1},this.ctx.js)}),f()(function(){var t=this.ctx.content;return Array.isArray(t)?t.filter(function(t){return!this.isSimple(t)&&t},this):t})),n("w-comment").mod("removed","yes").elem("content").content()(function(){return BEM.I18N("w-comment","comment_removed")}),n("m-popup")(_()(function(){var t=this.ctx;return{block:"popup2",mods:this.mods,mix:{block:"m-popup",mods:this.mods},directions:t.directions||E("directions"),attrs:t.attrs,content:E("content")}}),o("content")(function(){return[{block:"m-popup",elem:"data"},E("buttons")]}),o("directions")(function(){return["bottom-center","bottom-left","bottom-right"]}),o("buttons")(function(){return{block:"m-popup",elem:"buttons",mix:[{block:"clearfix"}],content:[{block:"button2",mix:{block:"m-popup",elem:"button"},mods:{theme:"normal",size:"s",action:"cancel"},text:BEM.I18N("m-popup","cancel")},{block:"button2",mix:{block:"m-popup",elem:"button"},mods:{size:"s",action:"add",theme:"action"},text:BEM.I18N("m-popup","add")}]}})),n("textinput").mod("has-clear","yes")(f()(function(){var t={elem:"clear",elemMods:{theme:this.mods.theme,visible:Boolean(this.ctx.text)&&"yes"}};return"number"===this.mods.type?[t].concat(x()):[].concat(x(),t)}),e(function(){return this.ctx.controlAttrs&&this.ctx.controlAttrs.readonly}).def()(function(){return this.mods["has-clear"]=!1,x()})),n("button").match(function(){return this._formSelect})(d()(function(){var t=x()||{};t.role="listbox",t.type="button",t["aria-haspopup"]="true",t["aria-expanded"]="false";var e=this._formSelect.tabindex;return void 0!==e&&(t.tabindex=e),t}),c()(function(){var t=this.ctx,e=this._formSelect.mods,i=this.mods;return i.arrow="down",e.theme&&(i.theme=e.theme),e.size&&(i.size=e.size),e.disabled&&(i.disabled="yes"),this._initText&&(t.content=this._initText),x({"ctx._theme":!0})}),("undefined"!=typeof addJs?addMix:p)()(function(){return[{block:this._formSelect.block,elem:"button"}]})),n("button").mod("disabled","yes").attrs()(function(){var t={};return this.ctx.url?t["aria-disabled"]="true":t.disabled=!0,this.extend(x(),t)}),n("m-editor-popup").mod("type","drafts")(("undefined"!=typeof addJs?addJs:u)()(function(){return{data:this.ctx.data}}),f()(function(){return[{elem:"header",tag:"h3",content:BEM.I18N("m-editor-popup","drafts")},{elem:"drafts",content:this.ctx.data.drafts.map(function(t,e){for(var i,n="",s=t.val;"\n"===s[s.length-1];)s=s.substr(0,s.length-1);return(i=s.slice(s.indexOf("\n")+1)).length&&(n="..."+i.slice(i.length-40)),{elem:"draft",index:e,content:[{block:"m-date",timestamp:this["mi-helpers"].getHumanStringFromDate({date:new Date(t.date),needHours:!0,needMinutes:!0,needSeconds:!0})}," — ("+s.length+") "+n]}},this)}]}),s("draft")["undefined"!=typeof addAttrs?"addAttrs":"attrs"]()(function(){return{"data-index":this.ctx.index}})),n("m-suggest-item").mod("type","staff")(("undefined"!=typeof addJs?addJs:u)()(function(){var t=this.ctx.data,e=x();return e.value=t.valueField?t[t.valueField]:t.title||t._text,e}),f()(function(){var t,e=this.ctx.data,i=e.department__name||e.department,n=e.phone||e.work_phone,s=e.login.indexOf(this.ctx.inputData.text);return t=-1!==s?[{html:this.xmlEscape(e.login.substr(0,s))},{elem:"selected",content:{html:this.xmlEscape(this.ctx.inputData.text)}},{html:this.xmlEscape(e.login.substr(s+this.ctx.inputData.text.length))}]:{html:this.xmlEscape(e.login)},[{elem:"info-wrapper",content:[{elem:"general-info",elemMods:{short:n?"yes":""},content:[{elem:"fullname",content:{html:this.xmlEscape((e.title||e._text)+", ")}},{elem:"brief",content:[t,"@"]}]},{elem:"phone",content:n?[{block:"awesome-icon",mods:{icon:"phone"}},{html:this.xmlEscape(" "+n)}]:""},{elem:"info",content:{html:this.xmlEscape(i)}}]},{block:"m-userpic",size:"50",login:e.login}]})),n("m-suggest-item").mod("labels","yes").content()(function(){return[{elem:"item-label",content:BEM.I18N("m-suggest-item",this.ctx.mods.type)},x()]}),n("m-suggest-item").mod("link","yes")(("undefined"!=typeof addJs?addJs:u)()(function(){var t=x();return t.href=this.ctx.data.href+"?from=suggest",t}),l()("a"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{href:this.ctx.data.href+"?from=suggest",target:this.ctx.data.target}})),n("m-suggest-item").mod("link","yes")(u()(function(){var t=x();return t.href=this.ctx.data.href+(this.ctx.data.withoutFrom?"":"?from=suggest"),t}),l()("a"),d()(function(){return{href:this.ctx.data.href+(this.ctx.data.withoutFrom?"":"?from=suggest"),target:this.ctx.data.target}})),n("w-old-page-mark")(u()(!0),_()({block:"link",mods:{theme:"normal",pseudo:"yes"},mix:{block:"w-old-page-mark",js:!0},content:[{block:"icon",mods:{type:"info"}},{elem:"text",tag:"span",content:BEM.I18N("w-old-page-mark","old_page")}]}),s("popup-content").replace()(function(t){var e=t.ctx.data,i=e.marked_at,n=e.user,s=e.comment,o=e.links,r=[];return i&&n&&r.push({block:"w-old-page-mark",elem:"user-date",content:[{block:"w-username",user:n},": "+BEM.I18N("w-old-page-mark","marked_obsolete")+" ",{block:"m-date",format:"full",timestamp:i}]}),s&&r.push({block:"w-old-page-mark",elem:"comment",content:s}),o&&o.length&&(r.push({block:"w-old-page-mark",elem:"links-title",content:BEM.I18N("w-old-page-mark","actual_pages")+":"}),o.forEach(function(t){r.push({block:"w-old-page-mark",elem:"link",content:{block:"link",mods:{theme:"normal"},url:t,text:t}})})),r.push({block:"w-old-page-mark",elem:"button",content:{block:"button2",mods:{size:"s",role:"unmark",theme:"normal"},mix:[{block:"w-action",mods:{type:"old-page"},js:{actuality:"obsolete"}}],text:BEM.I18N("w-old-page-mark","unmark")}}),r})),n("w-access-button")(_()(function(){return{block:"button2",mods:{theme:"normal",size:"s"},mix:[{block:"w-access-button",mods:this.mods,js:!0}].concat(this.ctx.mix),text:BEM.I18N("w-access-button","button_type_"+this.mods.type),iconLeft:{mods:{type:"lock"}}}})),n("dropdown2").mod("switcher","button2").elem("switcher").replace()(function(){var t,e=this.ctx.switcher;return Array.isArray(e)?e:(this.ctx.hasTick&&(t="default"===this.mods.view?{mix:{block:"dropdown2",elem:"arrow"},mods:{glyph:"carets-v"}}:{mix:{block:"dropdown2",elem:"arrow"},mods:{type:"arrow",direction:"bottom"}}),this.util.mergeBemjson({block:"button2",mods:{view:this.mods.view,tone:this.mods.tone,size:this.mods.size,theme:this.mods.theme,disabled:this.mods.disabled},iconRight:t},this.isSimple(e)?{text:e}:e))}),n("tumbler").elem("box")(l()("span"),f()(function(){return[{elem:"sticker",elemMods:{position:"left"},content:{elem:"sticker-label",content:BEM.I18N("tumbler","on")}},{elem:"sticker",elemMods:{position:"right"},content:{elem:"sticker-label",content:BEM.I18N("tumbler","off")}},{block:"button2",js:{prvntKeys:["ENTER"],clickKeys:["SPACE"]},mods:{view:"classic"===this._view&&"classic",theme:"normal",disabled:this._disabled?"yes":void 0},tabindex:this._tabindex,attrs:{"aria-labelledby":this._leftId||this._rightId,"aria-pressed":String(this._checked)},mix:{block:"tumbler",elem:"button"}}]})),n("button2").mod("type","submit").attrs()(function(){return this.extend(x(),{type:"submit"})}),n("b-form-input")(c().match(function(){return!this._inputId})(function(){var t=E("value",{ctx:this.ctx.value});return x({_inputId:this.ctx.id||this.generateId(),_name:this.ctx.name||"",_value:t})}),o("value")("",e(function(){return this.ctx})(function(){return this.reapply(this.ctx)}),e(function(){return this.isSimple(this.ctx)})(function(){return this.ctx})),("undefined"!=typeof addJs?addJs:u)()(function(){return"gradient"!==this.mods.popup||{popupMods:{gradient:"yes"}}}),l()("span")),n("b-form-input").elem("input")(l()("input"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){var t={id:this._inputId,name:this._name};return this._value&&(t.value=this._value),this.mods.disabled&&(t.disabled="disabled"),t}),i()(function(){return{elem:"box",tag:"span",content:[this.ctx,this.ctx.clear]}})),n("footer").elem("link").def()(function(){var t=this.extend(this.ctx,{block:"link",mods:{theme:"normal"},mix:[{block:this.block,elem:this.elem,elemMods:this.elemMods}]});return this.ctx.mix&&(t.mix=t.mix.concat(this.ctx.mix)),delete t.elem,M(t)}),n("scroll")(u()(!0),f().mod("tech","js")(function(){return[{elem:"native",content:{elem:"content",content:this.ctx.content}},{elem:"track",elemMods:{orientation:"vertical"},content:{elem:"thumb",elemMods:{orientation:"vertical"}}},{elem:"track",elemMods:{orientation:"horizontal"},content:{elem:"thumb",elemMods:{orientation:"horizontal"}}}]})),n("wiki-doc")(c().match(function(){return!this.ctx._wrap})(function(){var t=this.extend({},this.ctx);return t._wrap=!0,this.wiki={lang:this.ctx["wiki-attrs"].lang,mode:this.ctx["wiki-attrs"].mode,path:this.ctx["wiki-attrs"].page_path,anchors:this.ctx["wiki-attrs"].display_section_anchors,grid:this.ctx["wiki-attrs"].grid||!1,noDocviewer:!0,styles:{},page:"",env:this.ctx["wiki-attrs"].env||"production",magiclinks_url:this.ctx["wiki-attrs"].magiclinks_url,tracker_url:this.ctx["wiki-attrs"].tracker_url,render_html:this.ctx["wiki-attrs"].render_html||!1},this._helper=[],t.mods=this.extend({},this.ctx.mods),this.ctx["wiki-attrs"].magiclinks_url&&(t.mods.magiclinks="yes"),t.content=[{block:"wiki-helper-label"}].concat(this.ctx.content),M(t)}),u()(function(){return{user:{codeTheme:this.ctx["wiki-attrs"].code_theme},"wiki-attrs":this.ctx["wiki-attrs"]}})),n("wiki-doc").def()(function(){return this.wiki={hosts:this.ctx["wiki-attrs"].hosts||null,lang:this.ctx["wiki-attrs"].lang,mode:this.ctx["wiki-attrs"].mode,path:this["i-global"].page_data?"/"+this["i-global"].page_data.supertag:"",anchors:this.ctx["wiki-attrs"].display_section_anchors,grid:this.ctx["wiki-attrs"].grid||!1,render_html:this.ctx["wiki-attrs"].render_html||!1,noDocviewer:!0,styles:{},page:"",env:this.ctx["wiki-attrs"].env||"production",magiclinks_url:this.ctx["wiki-attrs"].magiclinks_url||"",tracker_url:this.ctx["wiki-attrs"].tracker_url||this["i-global"].hosts&&this["i-global"].hosts.startrek&&this["i-global"].hosts.startrek.url},this.ctx["wiki-attrs"].magiclinks_url&&(this.mods.magiclinks="yes"),this._helper=[],this.ctx.content=[{block:"wiki-helper-label"}].concat(this.ctx.content),x()}),n("wiki-doc").js()(function(){var t=x(),e=-1!==Object.prototype.toString.call(t).indexOf("Object")?t:{};return this.ctx["wiki-attrs"].document_uid&&(e.hemul_uid=this.ctx["wiki-attrs"].document_uid||"",e.hemul_collection=this.ctx["wiki-attrs"].document_collection||""),e}),n("wiki-doc").mix()({block:"old-wf"}),b(function(t,e){function i(t){var e={elem:t.type,tag:"span",content:t.value.toString()};return a(t,e),c(t,e),l(t,e),e}function n(t){var e=void 0===t.separator?" ":t.separator,i={elem:"list",tag:"span",content:function(t,e){for(var i=[],n=0;n<t.length;n++)0===n?i.push(t[n]):i.push(e,t[n]);return i}(t.value.map(r),e)};return a(t,i),c(t,i),l(t,i),i}function s(t){return{elem:"image",tag:"span",attrs:{style:["background-image: url(",t.src,")"]},content:" "}}function o(t){var e=t.login||t.value;return{elem:"user",tag:"object",content:{block:"wiki-username",login:e,mods:{style:"portal",staffCard:"yes"},content:t.title||e}}}function r(t){var e="",r={list:n,image:s,string:i,user:o};return r[t.type]&&(e=r[t.type](t)),e}function a(t,e){t.color&&(e.attrs=e.attrs||{},e.attrs.style=e.attrs.style||"",e.attrs.style+="color: "+t.color)}function c(t,e){t.strike&&(e.elemMods=e.elemMods||{},e.elemMods.strike="yes")}function l(t,e){t.action&&(e.mix=e.mix||[],e.mix.push({block:"wiki-magiclink-action",mods:{type:t.action.type},js:{type:t.action.type,url:t.action.url}}))}e.BEMContext.prototype.helpers=e.BEMContext.prototype.helpers||{},e.BEMContext.prototype.helpers["wiki-magiclink"]=e.BEMContext.prototype.helpers["wiki-magiclink"]||{},e.BEMContext.prototype.helpers["wiki-magiclink"].magiclinkToBemBlock=function(t){var i=r(t);if(void 0===t.url||"string"==typeof t.url&&""!==t.url){i.tag="a";var n={href:t.url||t._requestedUrl,target:"_blank",title:"Open in new window"};i.attrs=e.BEMContext.prototype.extend(i.attrs||{},n),i.mix=i.mix||[],i.mix.push({block:"b-link"})}return i}}),n("wiki-magiclink")(l()("span"),f()(function(){return this.helpers["wiki-magiclink"].magiclinkToBemBlock(this.ctx)})),n("b-widget").mod("type","request-access").elem("content").content()([{block:"b-request-access",mods:{type:"loading"},js:!0,content:[{elem:"content",content:[{block:"spin2",mods:{size:"xs",progress:"yes"}}]},{elem:"buttons",content:[]}]}]),n("tabs")(c()(function(){return x({_panesId:this.ctx.panes})}),("undefined"!=typeof addJs?addJs:u)()(!0),("undefined"!=typeof addJs?addMix:p)()(function(){return{block:"tabs-panes",js:{id:this._panesId}}})),n("tabs-menu").elem("tab")(e(function(){return this.isFirst()&&!this.elemMods.first}).def()(function(){return this.elemMods.first="yes",x()}),l()("li"),a("disabled","yes")(c()(function(){return x({_tabsMenuTabDisabled:!0})}),e(function(){return Boolean(this.elemMods.interactive)}).attrs()(function(){return this.extend(x(),{"aria-disabled":"true"})})),a("interactive","yes")(c()(function(){return x({_tabsMenuTabInteractive:!0})}),d()(function(){return this.extend({role:"menuitem"},x())}))),n("link")(e(function(){return this._tabsMenuTabDisabled}).def()(function(){return delete this._tabsMenuTabDisabled,this.mods.disabled="yes",x()}),e(function(){return this._tabsMenuTabInteractive}).attrs()(function(){var t=x();return t.tabindex=void 0,t.role=void 0,t})),n("tabs-menu").elem("tab").elemMod("active","yes").match(function(){return!this._tabsMenuTabDisabled}).match(function(){return this._tabsMenuTabInteractive}).attrs()(function(){return this.extend(x(),{tabindex:0})}),n("w-page-setting").mod("type","redirect")(d()(function(){return{title:BEM.I18N("w-page-setting","setup-redirect")}}),s("header").content()(function(){return BEM.I18N("w-page-setting","redirect")}),s("data-preview").content()(function(){return this.ctx.data||BEM.I18N("w-page-setting","no-redirect")}),s("form").content()(function(){return[{block:"m-suggest",mods:{type:"cluster",size:"s"},hint:BEM.I18N("w-page-setting","clusters-search"),value:this.ctx.data},{block:"button2",mods:{theme:"normal",size:"s",disabled:"yes",role:"save-redirect"},text:BEM.I18N("w-page-setting","save")}]})),n("multiple-suggest-item").mod("type","staff")(f()(function(){var t=this.ctx.data;return[{block:"w-username",user:t},(t.is_external_employee||"external"===t.affiliation)&&{block:"awesome-icon",mods:{icon:"warning"},attrs:{title:BEM.I18N("w-access-button","external_user")},mix:{block:this.block,elem:"external-warning"}},this.ctx.active&&{block:"awesome-icon",mods:{icon:"remove"},mix:{block:this.block,elem:"remove"}}]})),n("input").elem("hint")(l()("label"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{id:this._hintId,for:this._inputId,"aria-hidden":"true"}}),c()(function(){return this._iconLeft&&(this.elemMods.lpad="yes"),this._iconRight&&(this.elemMods.rpad="yes"),this._value||0===this._value||(this.elemMods.visibility="visible"),x()})),n("input").elem("control").match(function(){return this._placeholder}).wrap()(function(){return[{elem:"hint",content:this._placeholder},this.ctx]}),n("button2").mod("type","link")(c()(function(){var t=this.ctx.url;return this._url=this.isSimple(t)?t:this.reapply(t),void 0===this.ctx.tabindex&&(this.ctx.tabindex="0"),x()}),l()("a"),e(function(){return"_blank"===this.ctx.target}).attrs()(function(){var t=this.ctx.attrs,e=void 0!==Object(t).rel?String(t.rel):"";return e&&-1===e.indexOf("noopener")&&(t.rel=e+" noopener"),this.extend({rel:"noopener"},x())}),d()(function(){var t=void 0!==this._url,e=Boolean(this.mods.disabled)?t&&-1:this.ctx.tabindex;return this.extend(x(),{target:this.ctx.target,href:this.mods.disabled?void 0:this.ctx.url,autocomplete:void 0,type:void 0,disabled:void 0,tabindex:e})}),u()(function(){return this.extend(x(),{_url:this.mods.disabled?this.ctx.url:void 0})})),n("w-grid-preview").mod("great","yes")(u()(function(){return{data:this.ctx.data}}),f()(function(){var t=[],e=this.ctx.data,i=[{elem:"lines-headers",content:[{elem:"line-header",mix:{elem:"to-import"},content:BEM.I18N("w-grid-preview","importing")},{elem:"line-header",mix:{elem:"col-to-import"},content:BEM.I18N("w-grid-preview","in_column")},{elem:"line-header",mix:{elem:"data-type"},content:BEM.I18N("w-grid-preview","data_type")},{elem:"line-header",mix:{elem:"strings-example"},content:BEM.I18N("w-grid-preview","strings_example")}]},{elem:"table-wrapper",content:{elem:"table",content:t}}],n=0;e.column_data_types.forEach(function(t,e){"string"===t[0]&&(n=e)});var s="",o=e.column_data_types.map(function(t,e){return e===n&&(s=t[0]),{val:t[0],text:t[1]}},this);return t.push({elem:"head",content:{elem:"row",content:e.import_columns.map(function(t,e){return{elem:"col",elemMods:{index:e,head:"yes"},content:{block:"checkbox",mods:{theme:"normal",size:"s",index:e,checked:"yes"},text:t.title}}},this)}}),t.push({elem:"row",content:e.import_columns.map(function(t,i){return{elem:"col",elemMods:{index:i,body:"yes"},content:[{block:"select2",mods:{size:"s",theme:"normal",type:"radiocheck",role:"col-to-import",index:i,text:"vary"},val:"new",text:BEM.I18N("w-grid-preview","new"),items:[{val:"new",text:BEM.I18N("w-grid-preview","new")}].concat(e.existing_columns.map(function(t){return{val:t[0],text:t[1]}}))},{block:"select2",mods:{size:"s",theme:"normal",role:"data-type",type:"radiocheck",text:"vary"},text:e.column_data_types[n][1],val:s,items:o},{elem:"existing-rows",content:e.existing_rows.map(function(t){var e=t[i].value;return e?JSON.parse(e):{elem:"preview-item"}},this)},{elem:"imported-rows",content:e.imported_rows.map(function(t){var e=t[i].value;return e?JSON.parse(e):{elem:"preview-item"}},this)}]}},this)}),i})),n("b-wiki-tree-page").mod("expandable","yes").elem("expand").content()([{block:"awesome-icon",mods:{type:"expand",icon:"angle-right"}},{block:"awesome-icon",mods:{type:"unexpand",icon:"angle-down"}},{block:"spin2",mods:{size:"xxs",type:"expand"}}]),n("b-wiki-tree-page").mod("type","n").elem("type-icon").content()({block:"awesome-icon",mods:{icon:"plus-circle"}}),n("w-page-info").mod("important","yes").elem("right").content()(""),n("w-page-info").mod("type","dismissed-authors").elem("content").content()(function(){return[BEM.I18N("w-page-info",this.ctx.parentCtx.single?"dismissed_author_message":"dismissed_authors_message"),{block:"button2",mods:{theme:"normal",size:"xs",role:"get-authorship"},text:BEM.I18N("w-page-info","dismissed_authors_get_authorship")}]}),n("popup").mod("related","panel").match(function(){return!this.ctx.replaced}).replace()(function(){var t=this.ctx;return t.content=t.content[1]?t.content[1]:"",t.replaced=!0,t.js={directions:[{to:"bottom",axis:"left",offset:{top:11}}]},t}),n("popup").mod("has-close","yes").content()(function(){return[x(),{elem:"close"}]}),n("popup").elem("close").tag()("i"),n("popup").mod("wrapped","yes").content()(function(){return[x(),{elem:"wrapper",elemMods:this.ctx.wrapperMods}]}),n("m-head-user")(u()(!0),f()(function(){var t=this.ctx.customUserLinks,e=t&&t.my||!1,i=t&&t.settings||!1;return[{block:"m-userpic",mix:[{block:this.block,elem:"icon"}],login:this.ctx.user,size:100},{block:"popup2",mix:{block:this.block,elem:"popup"},mods:{hiding:"yes",target:"anchor",autoclosable:"yes",theme:"normal"},directions:["bottom-right"],mainOffset:0,secondaryOffset:0,content:[{block:"m-head-services",mods:{column:"mono",type:"user"},content:{elem:"list",content:[{block:"link",mods:{theme:"black"},mix:[{block:"awesome-icon",mods:{icon:"user"}}],url:e&&e.url||"//staff.yandex-team.ru/",content:e&&e.text||BEM.I18N("m-head-user","staff")},{block:"link",mods:{theme:"black"},mix:[{block:"awesome-icon",mods:{icon:"cog"}}],url:i&&i.url||"//staff.yandex-team.ru/settings/",content:i&&i.text||BEM.I18N("m-head-user","options")},{block:"link",mods:{theme:"black"},mix:[{block:"awesome-icon",mods:{icon:"sign-out"}},{block:this.block,elem:"logout"}],url:"//passport.yandex-team.ru/passport?mode=logout&yu={yandexuid}",content:BEM.I18N("m-head-user","logout")}]}}]}]})),n("services-table").mod("type","ru").def()(function(){return this.mods.size="l",this.ctx.items=["images","maps","news","mail","video","translate","browser","afisha","disk","market","tv","music","taxi","autoru","money"].map(function(t){return{service:t,serviceIconMods:{color:56}}}),this.ctx.all=!0,x()}),n("user2")(e(function(){return this.ctx.maxLength}).js()(function(){return this.extend(x(),{maxLength:this.ctx.maxLength})}),e(function(){return this._user2Mods["fetch-accounts"]}).elem("accounts").content()(function(){return[{block:"spin2",mods:{size:"xs"},mix:{block:"user2",elem:"accounts-spin"}},x()]})),n("user-account").match(function(){return void 0!==this.ctx.ticker}).def()(function(){return this.mods["has-ticker"]="yes",x()}),n("user-account").mod("has-ticker","yes").match(function(){return!this.ctx.content}).content()(function(){return[x(),{elem:"ticker",ticker:this.ctx.ticker}]}),n("user-account").mod("has-accent-letter","yes").elem("name")(e(function(){return this.ctx.text&&!this.ctx.content}).content()(function(){var t=String(this.ctx.text);return t=t.replace(/^([^@#]?)([@#])/,"$1​$2​"),[{html:this.xmlEscape(t)}]})),n("user-account").mod("has-logout","yes").content()(function(){return[{block:"icon",mods:{glyph:"x-sign",size:"xs"},mix:{block:"user-account",elem:"logout"}},x()]}),n("user2").mod("with-organizations","yes")(e(function(){return!(!this.ctx.contextSwitchUrl&&!this["i-services"].serviceUrl("connectApi"))||(this.mods["with-organizations"]="no",this.mods["fetch-organizations"]="no",!1)})(c()(function(){var t=this.ctx,e=this["i-services"],i="undefined"!=typeof window?window.location:{},n=t.hasOwnProperty("source")?t.source:i.href||"",s=t.hasOwnProperty("retpath")?t.retpath:i.href||"",o=t.hasOwnProperty("preset")?t.preset:[],r=t.hasOwnProperty("secretKey")?t.secretKey:"",a={source:n,preset:o,contextSwitchUrl:t.hasOwnProperty("contextSwitchUrl")&&t.contextSwitchUrl?t.contextSwitchUrl:e.serviceUrl("connectApi")+"/portal/context?mode=portal&origin=user2&retpath="+encodeURIComponent(s)+"&sk="+r,addOrganizationUrl:t.hasOwnProperty("addOrganizationUrl")&&t.addOrganizationUrl?t.addOrganizationUrl:e.serviceUrl("connectApi")+"/portal/registration?action=add&source="+n+"&preset="+o+"&retpath="+encodeURIComponent(s)},c=t.organizations||{},l=t.currentOrgId;return x({"ctx.organizations":c,"ctx.currentOrgId":l,_params:a})}))),n("user2")(e(function(){return this._user2Mods["fetch-organizations"]}).elem("organizations").content()(function(){return[{block:"spin2",mods:{size:"xs"},mix:{block:"user2",elem:"accounts-spin"}},x()]}),u()(function(){return this.extend({organizationsUrl:this["i-services"].serviceUrl("directoryApi")+"/v6/organizations-by-session",contextSwitchUrl:this._params.contextSwitchUrl},x())})),n("b-page")(s("root")(m()(!1),l()("html"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{lang:this["i-global"].lang||"ru"}}),h()("i-ua_js_no i-ua_css_standard")),o("js-params")(function(){var t=this["i-global"],e={},i={block:"i-global",js:e};return Object.keys(t).forEach(function(i){t.isPublic(i)&&(e[i]=t[i])}),i}),o("doctype")(function(){return this.ctx.doctype||"<!DOCTYPE html>"}),i()(function(){var t=this.ctx;return[{html:E("doctype")},{elem:"root",content:[{elem:"head",content:[t.csp&&this.extend(t.csp,{elem:"csp"}),!1!==t.title&&{tag:"meta",attrs:{charset:t.charset||"utf-8"}},!1!==t["x-ua-compatible"]&&E("xUACompatible"),void 0!==t.title&&{tag:"title",content:t.title},t.favicon&&{elem:"favicon",url:t.favicon},E("defaultMeta"),t.meta,{block:"i-ua",nonce:t.nonce},t.head]},t]}]}),l()("body"),s("head")(m()(!1),l()("head")),s("meta")(m()(!1),l()("meta")),s("favicon").replace()(function(){return{elem:"link",rel:"shortcut icon",url:this.ctx.url}}),f()(function(){return{elem:"body",content:this.ctx.content}}),s("body").tag()(""),p()(function(){return[].concat(x(),[{elem:"body"},E("js-params"),{block:"i-ua",js:!0}])})),n("b-page")(o("xUACompatible")(function(){return{tag:"meta",attrs:{"http-equiv":"X-UA-Compatible",content:this.ctx["x-ua-compatible"]||"IE=edge"}}})),n("button2").mod("has-control","yes")(l()("span"),d()(function(){return this.extend(x(),{type:void 0,name:void 0,value:void 0,id:void 0,disabled:void 0,"aria-disabled":void 0,autocomplete:void 0})}),f()(function(){var t=this.ctx,e=Boolean(this.mods.disabled),i=t.control||{},n=i.mix||[],s=i.attrs||{};return this._type=i.type,[x(),{elem:"control",mix:n,attrs:this.extend({name:t.name,id:t.id,value:t.val,disabled:e,"aria-disabled":e&&"true"},s)}]})),n("m-editor").content()(function(){return{block:"textarea",mix:[{block:"mi-editor-history",js:!0},{block:"m-editor",elem:"textarea",elemMods:{editor:"wiki"}}],text:!!this.ctx.value&&this.ctx.value,placeholder:this.ctx.placeholder,name:this.ctx.name?this.ctx.name:null,mods:{theme:"normal",size:this.mods.size||"s"}}}),n("m-editor-popup").mod("type","link").content()(function(){return[{elem:"header",tag:"h3",content:BEM.I18N("m-editor-popup","createLink")},{elem:"content",content:[{elem:"row",content:[{tag:"label",block:"textinput",elem:"label",content:[{tag:"span",block:"textinput",elem:"label-text",content:BEM.I18N("m-editor-popup","pathToLink")},{block:"textinput",mods:{theme:"normal","has-clear":"yes",size:"s"},name:"pathToLink",text:"",placeholder:BEM.I18N("m-editor-popup","pathToLink")}]}]},{elem:"row",content:[{tag:"label",block:"textinput",elem:"label",content:[{tag:"span",block:"textinput",elem:"label-text",content:BEM.I18N("m-editor-popup","linkText")},{block:"textinput",mods:{theme:"normal","has-clear":"yes",size:"s"},name:"linkText",text:Object(this.ctx.js.selection).text||"",placeholder:BEM.I18N("m-editor-popup","linkText")}]}]}]}]}),n("button2").mod("type","check")(d()(function(){return this.extend(x(),{"aria-pressed":String(Boolean(this.mods.checked))})}),s("control")(d()(function(){var t=this.mods;return this.extend(x(),{type:"checkbox",checked:Boolean(t.checked),"aria-checked":String(Boolean(t.checked))})}))),n("m-editor-popup").mod("type","user")(u()(!0),f()(function(){return[{elem:"header",tag:"h3",content:BEM.I18N("m-editor-popup","createUser")},{elem:"content",content:[{block:"select2",name:"prefix",val:"staff:",mix:{block:"m-editor-popup",elem:"select"},mods:{size:"s",type:"radio",theme:"normal",text:"vary"},control:!0,items:[{val:"staff:",selected:"selected",text:"staff",checkedText:"staff"},{val:"кто:",checkedText:"кто",text:"именительный, кто?"},{val:"укого:",checkedText:"у кого",text:"родительный, у кого?"},{val:"кому:",checkedText:"кому",text:"дательный, кому?"},{val:"кого:",checkedText:"кого",text:"винительный, кого?"},{val:"кем:",checkedText:"кем",text:"творительный, кем?"},{val:"оком:",checkedText:"о ком",text:"предложный, о ком?"}]},{block:"m-suggest",name:"user",mods:{type:"multicomplete",size:"s"},inputMods:{"has-clear":!1},hint:BEM.I18N("m-editor-popup","user"),types:[{name:"staff",maxCount:5,valueField:"login"}]},{block:"textinput",name:"link",mix:{block:"m-editor-popup",elem:"textinput",elemMods:{link:"yes"}},mods:{"has-clear":"yes",theme:"normal",size:"s"},placeholder:BEM.I18N("m-editor-popup","textForLink")}]}]})),b(function(t){t.BEMContext.prototype["w-page-main-info"]={getFirstAuthor:function(t){var e,i=t.sort(function(t,e){return t.uid>e.uid}),n=i[i.length-1];if(i.length>1)for(e=i.length-2;e>=0;e--)i[e].is_dismissed||(n=i[e]);return n}}}),n("w-page-main-info")(u()(!0),f()(function(t){var e=t.ctx.isOfficial,i=t["w-page-main-info"].getFirstAuthor(t.ctx.authors);return[{elem:"left",isOfficial:e,firstAuthor:i},{elem:"right",content:[{elem:"first-author",isOfficial:e,firstAuthor:i,authors:t.ctx.authors},{elem:"modified",isOld:t.ctx.isOld,modifiedAt:t.ctx.modifiedAt}]}]}),s("left").content()(function(t){var e=t.ctx.firstAuthor||t["w-page-main-info"].getFirstAuthor(t.ctx.authors);return t.ctx.isOfficial?{elem:"official-pic",mix:{elem:"avatar"}}:{block:"w-userpic",mix:{block:"w-page-main-info",elem:"avatar"},size:32,user:e}}),s("first-author").content()(function(t){return[{block:"w-page-main-info",elem:"first-author-link",isOfficial:t.ctx.isOfficial,firstAuthor:t.ctx.firstAuthor,authors:t.ctx.authors},{block:"link",mix:{block:"w-page-main-info",elem:"open-authors"},mods:{theme:"black",pseudo:"yes"},content:{block:"awesome-icon",mods:{icon:"angle-down",role:"show-authors"}}}]}),s("first-author-link").replace()(function(t){return t.ctx.isOfficial?{block:"link",mix:[{block:"w-page-main-info",elem:"first-author-link"},{block:"w-page-official",js:!0}],mods:{theme:"black",pseudo:"yes"},text:BEM.I18N("w-page-main-info","official_page")}:{block:"w-username",mix:{block:"w-page-main-info",elem:"first-author-link"},user:t.ctx.firstAuthor||t["w-page-main-info"].getFirstAuthor(t.ctx.authors)}}),s("modified").content()(function(t){return t.ctx.isOld?{block:"w-old-page-mark"}:{elem:"updated",modifiedAt:t.ctx.modifiedAt}}),s("updated").content()(function(t){return[BEM.I18N("w-page-main-info","updated")+" ",t["mi-helpers"].dateFormat(t.ctx.modifiedAt,"d mmmm, yyyy в HH:MM").toLowerCase()]})),n("w-fav-button")(u()(!0),o("button-text")(BEM.I18N("w-fav-button","to_fav")),o("icon-type")("bookmark-o"),_()(function(t){return{block:"button2",mods:{theme:"normal",size:"s","small-screen-shrink":"yes"},mix:[{block:"w-fav-button",mods:t.mods,js:!0},{block:"w-mixed-tooltip",js:{screenWidthToShow:1200,tooltip:{block:"tooltip",mods:{size:"s",theme:"normal"},js:{to:"bottom"},content:E("button-text")}}}].concat(t.ctx.mix),text:E("button-text"),iconLeft:{mods:{type:E("icon-type")}}}})),n("w-subscribe-button")(_()(function(t){var e=BEM.I18N("w-subscribe-button","button_type_"+t.mods.type);return{block:"dropdown2",mods:{switcher:"button2",theme:"normal",autoclosable:"yes",role:"subscribe"},mix:[{block:"w-subscribe-button",mods:t.mods,js:!0},{block:"w-mixed-tooltip",js:{screenWidthToShow:1200,tooltip:{block:"tooltip",mods:{size:"s",theme:"normal"},js:{to:"bottom"},content:e}}}].concat(t.ctx.mix),switcher:{block:"button2",mods:{theme:"normal",size:"s","small-screen-shrink":"yes"},text:e,iconLeft:{mods:{type:"eye-main"}}},popup:{block:"popup2",mods:{role:"subscribe"},directions:["bottom-right"],content:{block:"menu",mods:{type:"radio",theme:"normal",size:"m",view:"classic"},val:t.mods.type,items:[{icon:{mods:{type:"eye"}},text:BEM.I18N("w-subscribe-button","item_page"),val:"page"},{icon:{mods:{type:"eye"}},text:BEM.I18N("w-subscribe-button","item_cluster"),val:"cluster"},{icon:{mods:{type:"eye-slash"}},text:BEM.I18N("w-subscribe-button","item_none"),val:"none"}]}}}})),n("b-autocomplete-item").mod("type","nav")(c()(function(){var t=this.ctx.data,e=t[4],i=(e.match(/^\w[\w-]*:\/\//g)?"":"http://")+e,n=this.xmlEscape(t[3]),s=" — "+BEM.blocks["b-autocomplete-item"].highlight(t[2],this.ctx.hl);return x({_linkUrlContent:n,_linkInfoConten:s,_url:i})}),("undefined"!=typeof addJs?addJs:u)()(function(){return{val:this._url}}),f()(function(){return{elem:"link",tag:"a",attrs:{href:this._url,target:"_blank"},content:[{elem:"link-url",tag:"span",content:this._linkUrlContent},{elem:"link-info",tag:"span",content:this._linkInfoConten}]}})),n("m-editor").mod("split",!0).content()(function(){var t=x();return Object.assign({},t,{attrs:{id:"split-editor"},cls:"split"})}),n("tabs").mod("control","menu").content()(function(){var t=this.ctx,e=this.extend({},t.mods),i=-1,n=t.content.map(function(e){return"tab"!==e.elem?e:(i++,this.extend(e,{attrs:this.extend({role:"tab",id:this._panesId+"-tab-"+i,"aria-selected":String(Boolean(Object(e.elemMods).active))},e.attrs),elemMods:this.extend({interactive:"yes"},e.elemMods),mix:[{block:t.block,elem:e.elem}].concat(e.mix||[]),content:this.isSimple(e.content)||"link"!==Object(e.content).block?{block:"link",mods:{theme:"normal"},content:e.content}:e.content}))},this);return e.control=void 0,{block:"tabs-menu",mix:{block:this.block,elem:"control"},attrs:{role:"tablist"},mods:e,content:n}}),n("m-calendar").mod("toggler","input").content()(function(){return{elem:"toggler",content:{block:"textinput",mods:{theme:"normal",size:this.ctx.size,toggler:"datepicker",disabled:this.ctx.mods.disabled||""},placeholder:this.ctx.js.defaultText,controlAttrs:{readonly:"yes"}}}}),n("popup").mod("behaviour","scrollable").def()(function(){return this.mods.wrapped="yes",this.mods["body-scroll"]="no",this.ctx.wrapperMods={behaviour:"scrollable"},x()}),n("m-head-arrow").content()(function(){return[{block:"awesome-icon",mods:{icon:"reorder"}},{elem:"home",tag:"span",mix:[{block:"i-font",mods:{face:"textbook"}}],content:this.ctx.title},{block:"popup2",mods:{hiding:"yes",target:"anchor",theme:"normal",autoclosable:"yes"},mainOffset:0,mix:{block:"m-head-arrow",elem:"popup"},directions:["bottom-left"],content:""}]}),n("m-head-menu").mod("type","main")(l()("menu"),u()(!0),f()(function(){return[{elem:"list",menuItems:this.ctx.menuItems},{block:"popup2",mainOffset:-54,secondaryOffset:-17,mix:{block:this.block,elemMods:{type:this.ctx.headTypeMod},elem:"popup"},mods:{hiding:"yes",theme:"normal",target:"anchor",autoclosable:"yes"},directions:["bottom-left"],content:[{elem:"content",content:""}]}]})),n("m-head-menu").elem("list").content()(function(){return this.ctx.menuItems.map(function(t){var e;return e=t.more?{elem:"more",content:[{block:"link",mods:{theme:"normal",type:"more"},content:"…"},{block:"popup2",tailOffset:11,mainOffset:-10,secondaryOffset:-11,mix:{block:"m-head-menu",elem:"more-popup"},mods:{hiding:"yes",theme:"normal",target:"anchor",autoclosable:"yes"},directions:["bottom-left"],content:[{elem:"tail"},{elem:"content",content:{block:"m-head-menu",mods:{type:"open",mode:"more"},content:[{elem:"item",content:[{elem:"list",menuItems:t.subs}]}]}}]}]}:{elem:"item",elemMods:this.extend({},t.itemMods),content:[{block:"link",mods:this.extend({theme:"normal"},t.mods||{}),mix:t.mix||"",url:!t.subs&&t.url,content:t.name}]},t.subs&&!t.more&&(e.elemMods.hassub="yes",e.attrs={"data-content":JSON.stringify({block:"m-head-menu",mods:{type:"open"},content:[{elem:"item",elemMods:this.extend(t.itemMods,{hassub:"yes"}),content:[{block:"link",mods:{theme:"normal",menu:"title"},content:[t.name,{block:"awesome-icon",mods:{icon:"chevron-down"},mix:{block:"m-head-menu",elem:"icon"}}]},{elem:"list",menuItems:t.subs}]}]})},e.content[0].mods={theme:"pseudo",pseudo:"yes"},e.content[0].content=[e.content[0].content,{block:"awesome-icon",mods:{icon:"chevron-down"},mix:{block:"m-head-menu",elem:"icon"}}]),t.current&&(e.elemMods.current="yes"),t.customParams&&(e.customParams=t.customParams),e},this)}),n("m-head-menu").elem("item").match(function(){return this.ctx.customParams&&this.ctx.customParams.favs}).replace()(function(){return{elem:"item",mix:{block:"b-favs",js:!0},content:this.ctx.content[0]||this.ctx.content}}),n("m-head-action")(e(function(t,e){return e.action&&e.action.items}).def()(function(){return this.mods.with="popup",x()}),f()(function(){var t=this.ctx.action,e="object"==typeof t;return{block:"button2",mods:{theme:"normal",size:"m",type:e&&t.url?"link":void 0},mix:{block:"m-head-action",elem:"button"},url:!!e&&t.url,text:e?t.content:t}})),n("m-head-action").content()(function(){var t=x();return t.mix=t.mix||[],t.mix=Array.isArray(t.mix)?t.mix:[t.mix],t.mix.push({block:"b-readonly-item",js:!0}),t.mods=t.mods||{},t.mods.type="new-page",t.mods.pseudo="yes",t}),n("m-head-search")(f()(function(){return{elem:"search",attrs:{action:this.ctx.search&&this.ctx.search.action||"https://search.yandex-team.ru/search",autocomplete:"off"},content:[{block:"m-suggest",mods:{type:"intranet-suggest",size:"s"},mix:{block:this.block,elem:"field"},inputMods:{size:"m",pin:"round-brick"},hint:this.ctx.search.hint||BEM.I18N("m-head-search","hint"),inHeader:!0,types:["staff","nav"]},{block:"button2",mix:{block:this.block,elem:"button"},mods:{size:"m",theme:"normal",type:"submit",pin:"clear-round"},tabindex:2,text:BEM.I18N("m-head-search","find")},this.ctx.search&&this.ctx.search.formParams&&{elem:"form-params",params:this.ctx.search.formParams}]}}),s("search").tag()("form"),s("form-params").content()(function(){var t=this.ctx.params;return Object.keys(t).map(function(e){return{elem:"form-param",key:e,value:t[e]}})}),s("form-param")(l()("input"),("undefined"!=typeof addAttrs?addAttrs:d)()(function(){return{type:"hidden",name:this.ctx.key,value:this.ctx.value}}))),n("m-head-search").match(function(){return this.ctx.search&&this.ctx.search.supertag&&"/"!=this.ctx.search.pathname}).content()(function(){var t=x();return t.content.push({elem:"hidden",attrs:{type:"hidden",name:"from.cluster",value:this.ctx.search.supertag},tag:"input"}),t}),n("m-head-search")(u()(function(){return!0}),f()(function(){return{elem:"search",attrs:{action:this.ctx.search&&this.ctx.search.action||"https://search.yandex-team.ru/search",autocomplete:"off"},content:[{block:"m-suggest",js:this.ctx.search.clusterSearch?{pathname:this.ctx.search.pathname}:{},mods:{type:"intranet-suggest",size:"s"},mix:{block:this.block,elem:"field"},inputMods:{size:"m"},hint:this.ctx.search.hint||BEM.I18N("m-head-search","hint"),inHeader:!0,types:this.ctx.search.suggest&&this.ctx.search.suggest.types||["staff"],url:this.ctx.search.suggest&&this.ctx.search.suggest.url||null},{block:"button2",mix:{block:this.block,elem:"button"},mods:{size:"m",theme:"normal",type:"submit",pin:"clear-round"},tabindex:2,text:BEM.I18N("m-head-search","find")},this.ctx.search&&this.ctx.search.formParams&&{elem:"form-params",params:this.ctx.search.formParams}]}})),n("notifier")(c()(function(){return void 0===this.mods.size&&(this.mods.size="s"),x()}),u()(function(){return this.extend({live:!1},this.ctx.js)}),e(function(){return!this.ctx.content}).content()(function(){return{elem:"box",content:[{elem:"icon"},{elem:"ticker"},E("popup")]}}),o("popup")(function(){return{block:"popup2",mix:{block:"notifier",elem:"popup"},directions:["bottom-right","bottom-center"],zIndexGroupLevel:9,mods:{target:"anchor",tone:"default",view:"default",theme:"normal",autoclosable:"yes"},content:E("popup-content")}}),o("popup-content")(function(){return[{block:"popup2",elem:"tail"},{block:"notifier",elem:"content",content:{block:"spin2",mix:{block:"notifier",elem:"spin"},mods:{position:"center",size:"m"}}}]})),n("attach")(l()("span"),u()(function(){return this.extend({live:!1},x())}),c()(function(){var t=this.ctx;this.mods;return x({_id:t.id||this.generateId(),_name:t.name||"attachment",_tabindex:t.tabindex,_disabled:this.mods.disabled})}),o("attach-button")(function(){var t=this.ctx,e=t.text&&{html:this.xmlEscape(t.text)};return this.util.mergeBemjson({block:"button2",mods:{size:this.mods.size,theme:this.mods.theme,"has-control":"yes",disabled:this.mods.disabled},mix:{block:"attach",elem:"button"},js:{prvntKeys:[],pressKeys:["SPACE"]},id:this._id,name:this._name,tabindex:"-1",text:{attrs:{id:"text"+this._id,"aria-hidden":"true"},content:e||BEM.I18N("attach","button-text")},control:{mix:{block:"attach",elem:"control"},type:"file",attrs:{tabindex:this.mods.disabled?void 0:t.tabindex||"0","aria-labelledby":"text"+this._id}}},t.button||{})}),e(function(){return void 0!==this.ctx.holder}).mode("holder")(function(){var t=this.ctx;return"string"==typeof t.holder?{elem:"holder",content:{html:this.xmlEscape(t.holder)}}:this.extend(t.holder,{elem:"holder"})}),e(function(){return!this.ctx.content}).content()(function(){return[E("attach-button"),E("holder")]})),n("m-popup").mod("drafts","yes")(o("directions")(function(){}),o("buttons")(function(){return{block:"m-popup",elem:"buttons",mix:{block:"clearfix"},content:{block:"button2",mix:{block:"m-popup",elem:"button"},mods:{theme:"normal",size:"s",action:"cancel"},text:BEM.I18N("m-editor-popup","revert")}}})),n("m-popup").mod("drafts","yes")(o("buttons")(function(){})),n("m-editor-popup").mod("type","code")(f()(function(){return[{elem:"header",tag:"h3",content:BEM.I18N("m-editor-popup","createCode")},{elem:"content",content:[{elem:"select-label",content:BEM.I18N("m-editor-popup","codeStyle")},{block:"select2",name:"codeStyle",control:!0,mods:{size:"s",type:"radio",theme:"normal",text:"vary"},js:{optionsMaxHeight:150},popup:{mix:{block:"m-editor-popup",elem:"select-popup",elemMods:{width:"150"}}},items:[{val:"",text:" Plain Text"},{val:"1c",text:"1C"},{val:"apache",text:"Apache"},{val:"applescript",text:"AppleScript"},{val:"bash",text:"Bash"},{val:"cs",text:"C#"},{val:"cpp",text:"C++"},{val:"cmake",text:"CMake"},{val:"coffeescript",text:"CoffeeScript"},{val:"css",text:"CSS"},{val:"diff",text:"Diff"},{val:"django",text:"Django"},{val:"dos",text:"DOS .bat"},{val:"erlang",text:"Erlang"},{val:"erlang-repl",text:"Erlang REPL"},{val:"haskell",text:"Haskell"},{val:"xml",text:"HTML, XML"},{val:"http",text:"HTTP"},{val:"ini",text:"Ini"},{val:"java",text:"Java"},{val:"javascript",text:"JavaScript"},{val:"json",text:"JSON"},{val:"lisp",text:"Lisp"},{val:"markdown",text:"Markdown"},{val:"matlab",text:"Matlab"},{val:"nginx",text:"Nginx"},{val:"objectivec",text:"Objective C"},{val:"perl",text:"Perl"},{val:"php",text:"PHP"},{val:"python",text:"Python"},{val:"profile",text:"Python profile"},{val:"r",text:"R"},{val:"ruby",text:"Ruby"},{val:"scala",text:"Scala"},{val:"sql",text:"SQL"},{val:"tex",text:"TeX"}]},{block:"textarea",mods:{theme:"normal",size:"s"},name:"codeText",placeholder:"> "+BEM.I18N("m-editor-popup","codeText"),text:Object(this.ctx.js.selection).text||"",controlAttrs:{rows:"10"}}]}]}),s("select-label").tag()("span")),n("m-speller").content()(function(){return[{elem:"status",content:BEM.I18N("m-speller","not-checked")},{elem:"flex-container",elemMods:{"hide-in-finish":"yes"},content:[{elem:"flex-item",elemMods:{side:"left",role:"notfound"},content:BEM.I18N("m-speller","notfound")},{elem:"flex-item",elemMods:{side:"right"},content:{block:"island",mods:{type:"light",role:"input-text"}}}]},{elem:"flex-container",elemMods:{"hide-in-finish":"yes"},content:[{elem:"flex-item",elemMods:{side:"left"},content:BEM.I18N("m-speller","correction-title")},{elem:"items-wrapper",content:[{elem:"flex-item",elemMods:{side:"right",type:"error"},content:{block:"textinput",mods:{"has-clear":"yes",theme:"normal",size:"s",type:"error"},mix:[{block:"m-speller",elem:"text-input"}]}},{elem:"flex-item",elemMods:{side:"right"},content:{block:"island",mods:{type:"light",role:"correction-options"}}}]}]},{elem:"flex-container",elemMods:{"hide-in-finish":"yes"},content:[{elem:"flex-item",elemMods:{side:"left"}},{elem:"flex-item",elemMods:{side:"right"},content:{block:"button2",mods:{theme:"normal",size:"s",type:"params"},text:BEM.I18N("m-speller","params")}}]},{elem:"options",elemMods:{hidden:"yes"},content:[{elem:"flex-container",content:[{elem:"flex-item",elemMods:{side:"left"},content:BEM.I18N("m-speller","checking-language")},{elem:"flex-item",elemMods:{side:"right"},content:{block:"select2",control:!0,mods:{size:"s","has-control":"yes",theme:"normal",type:"radio"},mix:[{block:"m-speller",elem:"speller-select"}],items:["en","ru","uk"].map(function(t){return{val:t,text:BEM.I18N("m-speller",t)}})}}]},{elem:"flex-container",elemMods:{"hide-in-finish":"yes"},content:["ignore-uppercase","ignore-digits","ignore-urls","find-repeat"].map(function(t){return{block:"checkbox",mods:{theme:"normal",size:"s",type:t},text:BEM.I18N("m-speller",t)}}).concat([{block:"button2",mods:{theme:"normal",size:"s",type:"user-dict"},mix:[{block:"m-speller",elem:"info-block"}],text:BEM.I18N("m-speller","userDict")},{block:"userdict",mods:{hidden:"yes"},mix:[{block:"m-speller",elem:"info-block"}],content:[{block:"textarea",mods:{theme:"normal",size:"s",role:"dict"}}]}])}]},{elem:"flex-container",elemMods:{"hide-in-finish":"yes"},content:[{elem:"flex-item",elemMods:{side:"left"},content:{block:"button2",mods:{theme:"normal",type:"cancel",size:"s"},type:"button",text:BEM.I18N("m-speller","cancel")}},{elem:"flex-item",elemMods:{side:"right",align:"right"},content:[{block:"button2",mods:{theme:"normal",type:"ignore-once",size:"s"},type:"button",text:BEM.I18N("m-speller","ignore-once")},{block:"button2",mods:{theme:"normal",type:"replace",size:"s"},type:"button",text:BEM.I18N("m-speller","replace")}]}]}]}),n("m-speller").elem("text")(l()("span"),f()(function(){return[{tag:"span",content:this.ctx.before},{elem:"attention",tag:"b",content:this.ctx.word},{tag:"span",content:this.ctx.after}]})),n("m-speller").elem("main-text").tag()("span"),n("m-speller").elem("corrections-not-found")(l()("span"),f()(function(){return BEM.I18N("m-speller","corr-not-found")})),n("m-speller").elem("add-to-dict")(l()("i"),f()(function(){return"+ "+BEM.I18N("m-speller","add-to-dict")})),n("w-fav-button").mod("fav","yes")(o("button-text")(BEM.I18N("w-fav-button","in_fav")),o("icon-type")("bookmark")),n("m-calendar").mod("toggler","button").content()(function(){return{elem:"toggler",content:{block:"button2",mods:{theme:"normal",size:this.ctx.size,disabled:this.ctx.mods.disabled||"",toggler:"datepicker"},val:"",text:this.ctx.js.defaultText}}}),n("m-head-action").mod("with","popup")(("undefined"!=typeof addJs?addJs:u)()(function(){return{items:this.ctx.action.items}}),f()(function(){return[{block:"button2",mods:{theme:"normal",size:"m",pin:"round-brick",role:"main-action"},mix:{block:"m-head-action",elem:"button"},url:this.ctx.action.url||!1,text:this.ctx.action.content},{block:"button2",mix:{block:"m-head-action",elem:"popup-toggler"},mods:{theme:"normal",size:"m",pin:"brick-round",role:"list-toggler"},icon:{mix:[{block:"awesome-icon",mods:{icon:"chevron-down"}},{block:"m-head-action",elem:"icon"}]}}]}),s("popup-item").content()(function(){var t=this.ctx.item;return t.mods||(t.mods={}),void 0===t.mods.theme&&(t.mods.theme="normal"),{block:"link",mods:t.mods,mix:t.mix||!1,url:t.url||!1,content:t.name}})),n("m-editor-popup").mod("type","spell").content()({block:"m-speller",js:!0}),n("w-page-panel")(p()({block:"mi-sticky",js:{preventCollapse:!0,offset:{left:"auto"}}}),s("access").replace()(function(t){var e=t.ctx.data.type;return"inherited"===e&&(e=t.ctx.data.parent_access),t.ctx.data.opened_to_external_flag&&(e="restricted-with-external"),{block:"w-access-button",mods:{type:e},mix:{block:"w-page-panel",elem:"access"}}}),s("fav").replace()(function(t){return{block:"w-fav-button",mods:{fav:t.ctx.isFav?"yes":""},mix:{block:"w-page-panel",elem:"fav"}}}),s("edit").replace()(function(){return{block:"button2",mods:{theme:"normal",size:"s",disabled:this.ctx.canEdit?"":"yes",role:"edit-page"},js:{type:"edit"},mix:[{block:"w-page-panel",elem:"edit"},{block:"w-action",mods:{type:"edit",theme:"normal"},js:!0},{block:"w-getting-started",elem:"elem",elemMods:{"edit-button":"1"}}],text:BEM.I18N("w-page-panel",this.ctx.canEdit?"edit":"readonly"),iconLeft:{mods:{type:"pencil"}}}})),n("attach").mod("role","export-page")(f()(function(){return[x(),{elem:"desc",content:"Страница будет создана из документа"},{block:"tooltip",mods:{size:"s",theme:"error",type:"attach"}}]})),n("m-uploader").content()(function(){return[(!this.ctx.js.choosefile||"yes"===this.ctx.js.choosefile)&&{block:"attach",mods:{size:"s",theme:"normal"},name:this.ctx.name,holder:this.ctx.js.holder,button:{control:{attrs:{multiple:"yes"}}}},(!this.ctx.js.dropzone||"yes"===this.ctx.js.dropzone)&&{elem:"drop-zone",content:"Перетащите файлы сюда"}]}),n("m-head")(l()("header"),u()(!0),f()(function(){var t=null!==this.ctx.notifier&&"object"==typeof this.ctx.notifier;return[{block:"m-head-arrow",mix:[{block:"m-head",elem:"min"}],js:{type:this.ctx.service||"none",host:this.ctx.navigationApiHost},title:this.ctx.title||"Service Name"},{block:this.blockName,elem:"main",content:this.ctx.menuItems&&{block:"m-head-menu",mods:{type:"main"},headTypeMod:this.ctx.mods&&this.ctx.mods.type,menuItems:this.ctx.menuItems}},this.ctx.action&&{block:"m-head-action",mix:[{block:"m-head",elem:"min"}],action:this.ctx.action},this.ctx.search&&{block:"m-head-search",mix:[{block:"m-head",elem:"min"}],search:this.ctx.search},!1!==this.ctx.messenger&&{block:"m-head",elem:"min",content:{block:"messenger",mods:{internal:"yes"},js:this.ctx.messenger}},t&&{block:"m-head",elem:"min",content:{block:"notifier",mix:[{block:"m-head",elem:"notifier"}],mods:{"has-close":"yes",size:"m"},js:this.ctx.notifier}},{block:"m-head-user",user:this.ctx.user,customUserLinks:this.ctx.customUserLinks}]})),n("m-head")(l()("header"),u()(!0),f()(function(){var t=null!==this.ctx.notifier&&"object"==typeof this.ctx.notifier;return[{block:"m-head-arrow",mix:[{block:"m-head",elem:"min"}],js:{type:this.ctx.service||"none",host:this.ctx.navigationApiHost},title:this.ctx.title||"Service Name"},{block:this.blockName,elem:"main",content:this.ctx.menuItems&&{block:"m-head-menu",mods:{type:"main"},headTypeMod:this.ctx.mods&&this.ctx.mods.type,menuItems:this.ctx.menuItems}},this.ctx.action&&{block:"m-head-action",mix:[{block:"m-head",elem:"min"}],action:this.ctx.action},this.ctx.search&&{block:"m-head-search",mix:[{block:"m-head",elem:"min"}],search:this.ctx.search},{block:"m-head",elem:"right",content:[!1!==this.ctx.messenger&&{block:"m-head",elem:"min",content:{block:"messenger",js:this.ctx.messenger,mods:{internal:"yes"}}},t&&{block:"m-head",elem:"min",content:{block:"notifier",mix:[{block:"m-head",elem:"notifier"}],mods:{"has-close":"yes",size:"m"},js:this.ctx.notifier}},{block:"m-head-user",user:this.ctx.user,customUserLinks:this.ctx.customUserLinks}]}]})),n("m-editor-popup").mod("type","picture")(("undefined"!=typeof addJs?addJs:u)()(function(){return{uploadURLPath:this.ctx.uploadURLPath}}),f()(function(){return[{elem:"header",tag:"h3",content:BEM.I18N("m-editor-popup","createPicture")},{elem:"content",content:[{elem:"row",content:[{tag:"label",block:"textinput",elem:"label",content:[{tag:"span",block:"textinput",elem:"label-text",content:BEM.I18N("m-editor-popup","pictureLink")},{block:"textinput",mods:{"has-clear":"yes",theme:"normal",size:"s",picture:"link"},name:"pictureLink",text:"",placeholder:BEM.I18N("m-editor-popup","pictureLinkPlaceholder")}]}]},{elem:"row",mix:{block:"size"},content:[{tag:"label",block:"textinput",elem:"label",content:[{tag:"span",block:"textinput",elem:"label-text",content:BEM.I18N("m-editor-popup","pictureSize")},{tag:"span",block:"textinput",elem:"under-label",content:BEM.I18N("m-editor-popup","picturePixels")},{block:"textinput",mods:{type:"number","has-clear":"yes",theme:"normal",size:"s",picture:"width"},name:"pictureWidth",text:"",placeholder:BEM.I18N("m-editor-popup","pictureWidth")}]},{tag:"span",block:"divider",content:"x"},{block:"textinput",mods:{type:"number","has-clear":"yes",theme:"normal",size:"s",picture:"height"},name:"pictureHeight",text:"",placeholder:BEM.I18N("m-editor-popup","pictureHeight")}]},this.ctx.uploadReqParams&&[{block:"attach",mods:{size:"s",theme:"normal"},mix:{block:"mi-uploader",js:{ajaxExtend:this.ctx.uploadReqParams}},holder:!0},{block:"progress"}]]}]})),n("m-editor-popup").mod("type","file")(("undefined"!=typeof addJs?addJs:u)()(function(){return{uploadURLPath:this.ctx.uploadURLPath}}),f()(function(){return[{elem:"header",tag:"h3",content:BEM.I18N("m-editor-popup","loadFile")},{elem:"content",content:[this.ctx.uploadReqParams&&[{block:"attach",mods:{size:"s",theme:"normal"},mix:{block:"mi-uploader",js:{ajaxExtend:this.ctx.uploadReqParams}},holder:!0},{block:"progress"}]]}]})),n("b-widget").mod("type","new-page").elem("content").content()(function(){var t=x();return Array.isArray(t)||(t=[t]),t.push({elem:"label",content:BEM.I18N("b-widget","create_page")},{block:"radio-button",mix:[{block:"w-getting-started",elem:"elem",elemMods:{create:"1"}}],mods:{theme:"normal",size:"m",type:"new-page"},name:"new-page",value:"page",content:[{elem:"radio",controlAttrs:{value:"page"},content:BEM.I18N("b-widget","page")},{elem:"radio",controlAttrs:{value:"grid"},content:BEM.I18N("b-widget","grid")},{elem:"radio",controlAttrs:{value:"note"},content:BEM.I18N("b-widget","note")}]},{elem:"page-title",content:[{elem:"field-label",content:BEM.I18N("b-widget","page_title")},{block:"input",mix:[{block:"w-getting-started",elem:"elem",elemMods:{create:"2"}}],mods:{theme:"normal",size:"s",type:"new-page-title"},content:{elem:"control"}}]},{elem:"page-address",content:[{elem:"field-label",content:BEM.I18N("b-widget","page_address")},{elem:"field",content:[{block:"input",mods:{theme:"normal",size:"s",type:"new-page-url"},mix:[{block:"w-getting-started",elem:"elem",elemMods:{create:"3"}}],content:{elem:"control"}},{block:"select2",mods:{type:"radio",text:"vary",theme:"normal",size:"s",role:"cluster-type",width:"fixed"},text:BEM.I18N("b-widget","sub"),items:["sub","cluster","root"].map(function(t){return{val:t,text:BEM.I18N("b-widget",t)}})}]},{elem:"description"}]},{elem:"note",content:[{elem:"field-label",content:BEM.I18N("b-widget","note_text")},{block:"input",mods:{size:"s",type:"textarea",role:"note"},content:[{elem:"control",attrs:{placeholder:BEM.I18N("b-widget","note-placeholder")}}]}]},{elem:"attach",content:[{elem:"field-label",mix:{elem:"attach"},content:BEM.I18N("b-widget","create_page_from_doc")},{elem:"attach",content:[{block:"attach",mods:{theme:"normal",size:"s",use:"button2",role:"import-page"},text:BEM.I18N("b-widget","import"),controlAttrs:{accept:".docx,.txt"},button:{iconLeft:{mods:{type:"file",direction:"bottom"}}},holder:BEM.I18N("b-widget","only_supported_formats")}]}]},{elem:"buttons",content:[{block:"spin2",mods:{size:"xxs",type:"create-load"}},{block:"button2",mods:{size:"s",role:"new-page-cancel",theme:"normal"},tabindex:1,text:BEM.I18N("b-widget","cancel_new")},{block:"button2",mix:[{block:"w-getting-started",elem:"elem",elemMods:{create:"4"}}],mods:{size:"s",theme:"action",role:"new-page-save"},tabindex:0,text:BEM.I18N("b-widget","create")}]}),t}),n("b-wiki-grid").mod("render-html","yes")(f().match(function(){return this.ctx.totalData})(function(){var t=this.ctx.totalData,e={tag:"thead",content:{elem:"head",data:t.structure.fields}},i=t.rows.map(function(t){return{elem:"row",data:t}});return{elem:"table",content:[e].concat(i)}}),s("table").tag()("table"),s("head").tag()("tr"),s("head").content()(function(){return this.ctx.data.map(function(t){return{elem:"head-cell",content:t.title}})}),s("head-cell").tag()("td"),s("row").tag()("tr"),s("row").content()(function(){return this.ctx.data.map(function(t){return{elem:"cell",data:t}})}),s("cell").tag()("td"),s("cell").content()(function(){var t=this.ctx.data.raw,e=this.ctx.data.transformed;return e&&("{"===e[0]&&'"'===e[1]?(t=JSON.parse(e))["wiki-attrs"]&&(t["wiki-attrs"].render_html=!0):e[0]&&e[0].login&&(t=[e[0].last_name,e[0].first_name,e[0].login+"@"].join(" "))),t})),n("b-wiki-grid").replace().match(function(){return this.ctx.js&&this.ctx.js.data})(function(){var t=this.require("url"),e=function(t,e){return void 0===t?e:"boolean"==typeof t?t:Boolean(parseInt(t))},i=this["i-global"].page_data?this["i-global"].page_data.supertag:"",n=t.parse(this.ctx.js.data.page||"").pathname,s=this.ctx.newWF?function(e,i){return i=i||"",e=function(t){return t.startsWith("/")||".."===t||""===t?t:t.startsWith("!/")||"!"===t?t.replace("!","."):"../"+t}(e=e||""),i.startsWith("/")||(i="/"+i),i.endsWith("/")||(i+="/"),t.resolve(i,e)}(n,i):n;return"/"===s[0]&&(s=s.slice(1)),{block:"b-grid-table",js:{supertag:s,readonly:this.ctx.readonly||e(this.ctx.js.data.readonly,!1),sort:e(this.ctx.js.data.sort,!0),filter:this.ctx.js.data.filter,width:this.ctx.js.data.width,num:e(this.ctx.js.data.num,!0),columns:this.ctx.js.data.columns,gridData:this.ctx.js.totalData,isAction:!0,newWF:this.ctx.newWF},mix:[{block:"b-readonly-item",js:!0}]}}),b(function(e,i){(e.BEMContext||i.BEMContext).prototype.require=function(e){return t[e]}})}),i.exportApply(e),e}var i=function(){return function t(e,n,s){function o(a,c){if(!n[a]){if(!e[a]){var l="function"==typeof i&&i;if(!c&&l)return l(a,!0);if(r)return r(a,!0);var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var h=n[a]={exports:{}};e[a][0].call(h.exports,function(t){return o(e[a][1][t]||t)},h,h.exports,t,e,n,s)}return n[a].exports}for(var r="function"==typeof i&&i,a=0;a<s.length;a++)o(s[a]);return o}}()({1:[function(e,i,n){(function(t){!function(e){var s="object"==typeof n&&n&&!n.nodeType&&n,o="object"==typeof i&&i&&!i.nodeType&&i,r="object"==typeof t&&t;r.global!==r&&r.window!==r&&r.self!==r||(e=r);var a,c,l=2147483647,d=36,h=1,u=26,m=38,p=700,f=72,_=128,g="-",b=/^xn--/,v=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,k={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=d-h,M=Math.floor,x=String.fromCharCode;function E(t){throw new RangeError(k[t])}function B(t,e){for(var i=t.length,n=[];i--;)n[i]=e(t[i]);return n}function I(t,e){var i=t.split("@"),n="";return i.length>1&&(n=i[0]+"@",t=i[1]),n+B((t=t.replace(y,".")).split("."),e).join(".")}function S(t){for(var e,i,n=[],s=0,o=t.length;s<o;)(e=t.charCodeAt(s++))>=55296&&e<=56319&&s<o?56320==(64512&(i=t.charCodeAt(s++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),s--):n.push(e);return n}function C(t){return B(t,function(t){var e="";return t>65535&&(e+=x((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=x(t)}).join("")}function T(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function N(t,e,i){var n=0;for(t=i?M(t/p):t>>1,t+=M(t/e);t>w*u>>1;n+=d)t=M(t/w);return M(n+(w+1)*t/(t+m))}function D(t){var e,i,n,s,o,r,a,c,m,p,b,v=[],y=t.length,k=0,w=_,x=f;for((i=t.lastIndexOf(g))<0&&(i=0),n=0;n<i;++n)t.charCodeAt(n)>=128&&E("not-basic"),v.push(t.charCodeAt(n));for(s=i>0?i+1:0;s<y;){for(o=k,r=1,a=d;s>=y&&E("invalid-input"),((c=(b=t.charCodeAt(s++))-48<10?b-22:b-65<26?b-65:b-97<26?b-97:d)>=d||c>M((l-k)/r))&&E("overflow"),k+=c*r,!(c<(m=a<=x?h:a>=x+u?u:a-x));a+=d)r>M(l/(p=d-m))&&E("overflow"),r*=p;x=N(k-o,e=v.length+1,0==o),M(k/e)>l-w&&E("overflow"),w+=M(k/e),k%=e,v.splice(k++,0,w)}return C(v)}function O(t){var e,i,n,s,o,r,a,c,m,p,b,v,y,k,w,B=[];for(v=(t=S(t)).length,e=_,i=0,o=f,r=0;r<v;++r)(b=t[r])<128&&B.push(x(b));for(n=s=B.length,s&&B.push(g);n<v;){for(a=l,r=0;r<v;++r)(b=t[r])>=e&&b<a&&(a=b);for(a-e>M((l-i)/(y=n+1))&&E("overflow"),i+=(a-e)*y,e=a,r=0;r<v;++r)if((b=t[r])<e&&++i>l&&E("overflow"),b==e){for(c=i,m=d;!(c<(p=m<=o?h:m>=o+u?u:m-o));m+=d)w=c-p,k=d-p,B.push(x(T(p+w%k,0))),c=M(w/k);B.push(x(T(c,0))),o=N(i,y,n==s),i=0,++n}++i,++e}return B.join("")}if(a={version:"1.4.1",ucs2:{decode:S,encode:C},decode:D,encode:O,toASCII:function(t){return I(t,function(t){return v.test(t)?"xn--"+O(t):t})},toUnicode:function(t){return I(t,function(t){return b.test(t)?D(t.slice(4).toLowerCase()):t})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return a});else if(s&&o)if(i.exports==s)o.exports=a;else for(c in a)a.hasOwnProperty(c)&&(s[c]=a[c]);else e.punycode=a}(this)}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,i){var n=t("./default"),s=t("./parser");t("./util");function o(t){return void 0===t||null===t}function r(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).whiteList=t.whiteList||n.whiteList,t.onAttr=t.onAttr||n.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||n.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||n.safeAttrValue,this.options=t}r.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e=this.options,i=e.whiteList,n=e.onAttr,r=e.onIgnoreAttr,a=e.safeAttrValue;return s(t,function(t,e,s,c,l){var d=i[s],h=!1;if(!0===d?h=d:"function"==typeof d?h=d(c):d instanceof RegExp&&(h=d.test(c)),!0!==h&&(h=!1),c=a(s,c)){var u,m={position:e,sourcePosition:t,source:l,isWhite:h};return h?o(u=n(s,c,m))?s+":"+c:u:o(u=r(s,c,m))?void 0:u}})},e.exports=r},{"./default":3,"./parser":5,"./util":6}],3:[function(t,e,i){function n(){var t={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1};return t}var s=/javascript\s*\:/gim;i.whiteList=n(),i.getDefaultWhiteList=n,i.onAttr=function(t,e,i){},i.onIgnoreAttr=function(t,e,i){},i.safeAttrValue=function(t,e){return s.test(e)?"":e}},{}],4:[function(t,e,i){var n=t("./default"),s=t("./css");for(var o in(i=e.exports=function(t,e){return new s(e).process(t)}).FilterCSS=s,n)i[o]=n[o];"undefined"!=typeof window&&(window.filterCSS=e.exports)},{"./css":2,"./default":3}],5:[function(t,e,i){var n=t("./util");e.exports=function(t,e){";"!==(t=n.trimRight(t))[t.length-1]&&(t+=";");var i=t.length,s=!1,o=0,r=0,a="";function c(){if(!s){var i=n.trim(t.slice(o,r)),c=i.indexOf(":");if(-1!==c){var l=n.trim(i.slice(0,c)),d=n.trim(i.slice(c+1));if(l){var h=e(o,a.length,l,d,i);h&&(a+=h+"; ")}}}o=r+1}for(;r<i;r++){var l=t[r];if("/"===l&&"*"===t[r+1]){var d=t.indexOf("*/",r+2);if(-1===d)break;o=(r=d+1)+1,s=!1}else"("===l?s=!0:")"===l?s=!1:";"===l?s||c():"\n"===l&&c()}return n.trim(a)}},{"./util":6}],6:[function(t,e,i){e.exports={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var n,s;if(Array.prototype.forEach)return t.forEach(e,i);for(n=0,s=t.length;n<s;n++)e.call(i,t[n],n,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}}},{}],7:[function(t,e,i){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,i,o){e=e||"&",i=i||"=";var r={};if("string"!=typeof t||0===t.length)return r;var a=/\+/g;t=t.split(e);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var l=t.length;c>0&&l>c&&(l=c);for(var d=0;d<l;++d){var h,u,m,p,f=t[d].replace(a,"%20"),_=f.indexOf(i);_>=0?(h=f.substr(0,_),u=f.substr(_+1)):(h=f,u=""),m=decodeURIComponent(h),p=decodeURIComponent(u),n(r,m)?s(r[m])?r[m].push(p):r[m]=[r[m],p]:r[m]=p}return r};var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],8:[function(t,e,i){"use strict";var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,i,a){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?o(r(t),function(r){var a=encodeURIComponent(n(r))+i;return s(t[r])?o(t[r],function(t){return a+encodeURIComponent(n(t))}).join(e):a+encodeURIComponent(n(t[r]))}).join(e):a?encodeURIComponent(n(a))+i+encodeURIComponent(n(t)):""};var s=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var i=[],n=0;n<t.length;n++)i.push(e(t[n],n));return i}var r=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},{}],9:[function(t,e,i){"use strict";i.decode=i.parse=t("./decode"),i.encode=i.stringify=t("./encode")},{"./decode":7,"./encode":8}],10:[function(t,e,i){"use strict";e.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},{}],11:[function(t,e,i){var n=t("cssfilter").FilterCSS,s=t("cssfilter").getDefaultWhiteList,o=t("./util");function r(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]}}var a=new n;function c(t){return t.replace(l,"&lt;").replace(d,"&gt;")}var l=/</g,d=/>/g,h=/"/g,u=/&quot;/g,m=/&#([a-zA-Z0-9]*);?/gim,p=/&colon;?/gim,f=/&newline;?/gim,_=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,g=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,b=/u\s*r\s*l\s*\(.*/gi;function v(t){return t.replace(h,"&quot;")}function y(t){return t.replace(u,'"')}function k(t){return t.replace(m,function(t,e){return"x"===e[0]||"X"===e[0]?String.fromCharCode(parseInt(e.substr(1),16)):String.fromCharCode(parseInt(e,10))})}function w(t){return t.replace(p,":").replace(f," ")}function M(t){for(var e="",i=0,n=t.length;i<n;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return o.trim(e)}function x(t){return t=M(t=w(t=k(t=y(t))))}function E(t){return t=c(t=v(t))}var B=/<!--[\s\S]*?-->/g;i.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]},i.getDefaultWhiteList=r,i.onTag=function(t,e,i){},i.onIgnoreTag=function(t,e,i){},i.onTagAttr=function(t,e,i){},i.onIgnoreTagAttr=function(t,e,i){},i.safeAttrValue=function(t,e,i,n){if(i=x(i),"href"===e||"src"===e){if("#"===(i=o.trim(i)))return"#";if("http://"!==i.substr(0,7)&&"https://"!==i.substr(0,8)&&"mailto:"!==i.substr(0,7)&&"tel:"!==i.substr(0,4)&&"#"!==i[0]&&"/"!==i[0])return""}else if("background"===e){if(_.lastIndex=0,_.test(i))return""}else if("style"===e){if(g.lastIndex=0,g.test(i))return"";if(b.lastIndex=0,b.test(i)&&(_.lastIndex=0,_.test(i)))return"";!1!==n&&(i=(n=n||a).process(i))}return i=E(i)},i.escapeHtml=c,i.escapeQuote=v,i.unescapeQuote=y,i.escapeHtmlEntities=k,i.escapeDangerHtml5Entities=w,i.clearNonPrintableCharacter=M,i.friendlyAttrValue=x,i.escapeAttrValue=E,i.onIgnoreTagStripAll=function(){return""},i.StripTagBody=function(t,e){"function"!=typeof e&&(e=function(){});var i=!Array.isArray(t),n=[],s=!1;return{onIgnoreTag:function(r,a,c){if(function(e){return!!i||-1!==o.indexOf(t,e)}(r)){if(c.isClosing){var l="[/removed]",d=c.position+l.length;return n.push([!1!==s?s:c.position,d]),s=!1,l}return s||(s=c.position),"[removed]"}return e(r,a,c)},remove:function(t){var e="",i=0;return o.forEach(n,function(n){e+=t.slice(i,n[0]),i=n[1]}),e+=t.slice(i)}}},i.stripCommentTag=function(t){return t.replace(B,"")},i.stripBlankChar=function(t){var e=t.split("");return(e=e.filter(function(t){var e=t.charCodeAt(0);return!(127===e||e<=31&&10!==e&&13!==e)})).join("")},i.cssFilter=a,i.getDefaultCSSWhiteList=s},{"./util":13,cssfilter:4}],12:[function(t,e,i){var n=t("./util");function s(t){var e=n.spaceIndex(t);if(-1===e)var i=t.slice(1,-1);else i=t.slice(1,e+1);return"/"===(i=n.trim(i).toLowerCase()).slice(0,1)&&(i=i.slice(1)),"/"===i.slice(-1)&&(i=i.slice(0,-1)),i}function o(t){return"</"===t.slice(0,2)}var r=/[^a-zA-Z0-9_:\.\-]/gim;function a(t,e){for(;e<t.length;e++){var i=t[e];if(" "!==i)return"="===i?e:-1}}function c(t,e){for(;e>0;e--){var i=t[e];if(" "!==i)return"="===i?e:-1}}function l(t){return function(t){return'"'===t[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]}(t)?t.substr(1,t.length-2):t}i.parseTag=function(t,e,i){"user strict";var n="",r=0,a=!1,c=!1,l=0,d=t.length,h="",u="";for(l=0;l<d;l++){var m=t.charAt(l);if(!1===a){if("<"===m){a=l;continue}}else if(!1===c){if("<"===m){n+=i(t.slice(r,l)),a=l,r=l;continue}if(">"===m){n+=i(t.slice(r,a)),h=s(u=t.slice(a,l+1)),n+=e(a,n.length,h,u,o(u)),r=l+1,a=!1;continue}if(('"'===m||"'"===m)&&"="===t.charAt(l-1)){c=m;continue}}else if(m===c){c=!1;continue}}return r<t.length&&(n+=i(t.substr(r))),n},i.parseAttr=function(t,e){"user strict";var i=0,s=[],o=!1,d=t.length;function h(t,i){if(!((t=(t=n.trim(t)).replace(r,"").toLowerCase()).length<1)){var o=e(t,i||"");o&&s.push(o)}}for(var u=0;u<d;u++){var m,p=t.charAt(u);if(!1!==o||"="!==p)if(!1===o||u!==i||'"'!==p&&"'"!==p||"="!==t.charAt(u-1)){if(/\s|\n|\t/.test(p)){if(t=t.replace(/\s|\n|\t/g," "),!1===o){if(-1===(m=a(t,u))){h(n.trim(t.slice(i,u))),o=!1,i=u+1;continue}u=m-1;continue}if(-1===(m=c(t,u-1))){h(o,l(n.trim(t.slice(i,u)))),o=!1,i=u+1;continue}}}else{if(-1===(m=t.indexOf(p,u+1)))break;h(o,n.trim(t.slice(i+1,m))),o=!1,i=(u=m)+1}else o=t.slice(i,u),i=u+1}return i<t.length&&(!1===o?h(t.slice(i)):h(o,l(n.trim(t.slice(i))))),n.trim(s.join(" "))}},{"./util":13}],13:[function(t,e,i){e.exports={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var n,s;if(Array.prototype.forEach)return t.forEach(e,i);for(n=0,s=t.length;n<s;n++)e.call(i,t[n],n,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/.exec(t);return e?e.index:-1}}},{}],14:[function(t,e,i){var n=t("cssfilter").FilterCSS,s=t("./default"),o=t("./parser"),r=o.parseTag,a=o.parseAttr,c=t("./util");function l(t){return void 0===t||null===t}function d(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=s.onIgnoreTagStripAll),t.whiteList=t.whiteList||s.whiteList,t.onTag=t.onTag||s.onTag,t.onTagAttr=t.onTagAttr||s.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||s.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||s.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||s.safeAttrValue,t.escapeHtml=t.escapeHtml||s.escapeHtml,this.options=t,!1===t.css?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new n(t.css))}d.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e=this.options,i=e.whiteList,n=e.onTag,o=e.onIgnoreTag,d=e.onTagAttr,h=e.onIgnoreTagAttr,u=e.safeAttrValue,m=e.escapeHtml,p=this.cssFilter;e.stripBlankChar&&(t=s.stripBlankChar(t)),e.allowCommentTag||(t=s.stripCommentTag(t));var f=!1;if(e.stripIgnoreTagBody){f=s.StripTagBody(e.stripIgnoreTagBody,o);o=f.onIgnoreTag}var _=r(t,function(t,e,s,r,f){var _,g={sourcePosition:t,position:e,isClosing:f,isWhite:i.hasOwnProperty(s)};if(!l(_=n(s,r,g)))return _;if(g.isWhite){if(g.isClosing)return"</"+s+">";var b=function(t){var e=c.spaceIndex(t);if(-1===e)return{html:"",closing:"/"===t[t.length-2]};var i="/"===(t=c.trim(t.slice(e+1,-1)))[t.length-1];return i&&(t=c.trim(t.slice(0,-1))),{html:t,closing:i}}(r),v=i[s],y=a(b.html,function(t,e){var i,n=-1!==c.indexOf(v,t);return l(i=d(s,t,e,n))?n?(e=u(s,t,e,p))?t+'="'+e+'"':t:l(i=h(s,t,e,n))?void 0:i:i});r="<"+s;return y&&(r+=" "+y),b.closing&&(r+=" /"),r+=">"}return l(_=o(s,r,g))?m(r):_},m);return f&&(_=f.remove(_)),_},e.exports=d},{"./default":11,"./parser":12,"./util":13,cssfilter:4}],url:[function(t,e,i){"use strict";var n=t("punycode"),s=t("./util");function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}i.parse=v,i.resolve=function(t,e){return v(t,!1,!0).resolve(e)},i.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e},i.format=function(t){s.isString(t)&&(t=v(t));return t instanceof o?t.format():o.prototype.format.call(t)},i.Url=o;var r=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),d=["'"].concat(l),h=["%","/","?",";","#"].concat(d),u=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},_={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=t("querystring");function v(t,e,i){if(t&&s.isObject(t)&&t instanceof o)return t;var n=new o;return n.parse(t,e,i),n}o.prototype.parse=function(t,e,i){if(!s.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",l=t.split(a);l[0]=l[0].replace(/\\/g,"/");var v=t=l.join(a);if(v=v.trim(),!i&&1===t.split("#").length){var y=c.exec(v);if(y)return this.path=v,this.href=v,this.pathname=y[1],y[2]?(this.search=y[2],this.query=e?b.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var k=r.exec(v);if(k){var w=(k=k[0]).toLowerCase();this.protocol=w,v=v.substr(k.length)}if(i||k||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var M="//"===v.substr(0,2);!M||k&&_[k]||(v=v.substr(2),this.slashes=!0)}if(!_[k]&&(M||k&&!g[k])){for(var x,E,B=-1,I=0;I<u.length;I++){-1!==(S=v.indexOf(u[I]))&&(-1===B||S<B)&&(B=S)}-1!==(E=-1===B?v.lastIndexOf("@"):v.lastIndexOf("@",B))&&(x=v.slice(0,E),v=v.slice(E+1),this.auth=decodeURIComponent(x)),B=-1;for(I=0;I<h.length;I++){var S;-1!==(S=v.indexOf(h[I]))&&(-1===B||S<B)&&(B=S)}-1===B&&(B=v.length),this.host=v.slice(0,B),v=v.slice(B),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var T=this.hostname.split(/\./),N=(I=0,T.length);I<N;I++){var D=T[I];if(D&&!D.match(m)){for(var O="",P=0,A=D.length;P<A;P++)D.charCodeAt(P)>127?O+="x":O+=D[P];if(!O.match(m)){var L=T.slice(0,I),j=T.slice(I+1),R=D.match(p);R&&(L.push(R[1]),j.unshift(R[2])),j.length&&(v="/"+j.join(".")+v),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=n.toASCII(this.hostname));var z=this.port?":"+this.port:"",F=this.hostname||"";this.host=F+z,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!f[w])for(I=0,N=d.length;I<N;I++){var q=d[I];if(-1!==v.indexOf(q)){var H=encodeURIComponent(q);H===q&&(H=escape(q)),v=v.split(q).join(H)}}var U=v.indexOf("#");-1!==U&&(this.hash=v.substr(U),v=v.slice(0,U));var V=v.indexOf("?");if(-1!==V?(this.search=v.substr(V),this.query=v.substr(V+1),e&&(this.query=b.parse(this.query)),v=v.slice(0,V)):e&&(this.search="",this.query={}),v&&(this.pathname=v),g[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){z=this.pathname||"";var W=this.search||"";this.path=z+W}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",n=this.hash||"",o=!1,r="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&s.isObject(this.query)&&Object.keys(this.query).length&&(r=b.stringify(this.query));var a=this.search||r&&"?"+r||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||g[e])&&!1!==o?(o="//"+(o||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),e+o+(i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(a=a.replace("#","%23"))+n},o.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(s.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var i=new o,n=Object.keys(this),r=0;r<n.length;r++){var a=n[r];i[a]=this[a]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var c=Object.keys(t),l=0;l<c.length;l++){var d=c[l];"protocol"!==d&&(i[d]=t[d])}return g[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!g[t.protocol]){for(var h=Object.keys(t),u=0;u<h.length;u++){var m=h[u];i[m]=t[m]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||_[t.protocol])i.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),i.pathname=p.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var f=i.pathname||"",b=i.search||"";i.path=f+b}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var v=i.pathname&&"/"===i.pathname.charAt(0),y=t.host||t.pathname&&"/"===t.pathname.charAt(0),k=y||v||i.host&&t.pathname,w=k,M=i.pathname&&i.pathname.split("/")||[],x=(p=t.pathname&&t.pathname.split("/")||[],i.protocol&&!g[i.protocol]);if(x&&(i.hostname="",i.port=null,i.host&&(""===M[0]?M[0]=i.host:M.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),k=k&&(""===p[0]||""===M[0])),y)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,M=p;else if(p.length)M||(M=[]),M.pop(),M=M.concat(p),i.search=t.search,i.query=t.query;else if(!s.isNullOrUndefined(t.search)){if(x)i.hostname=i.host=M.shift(),(C=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=C.shift(),i.host=i.hostname=C.shift());return i.search=t.search,i.query=t.query,s.isNull(i.pathname)&&s.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!M.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var E=M.slice(-1)[0],B=(i.host||t.host||M.length>1)&&("."===E||".."===E)||""===E,I=0,S=M.length;S>=0;S--)"."===(E=M[S])?M.splice(S,1):".."===E?(M.splice(S,1),I++):I&&(M.splice(S,1),I--);if(!k&&!w)for(;I--;I)M.unshift("..");!k||""===M[0]||M[0]&&"/"===M[0].charAt(0)||M.unshift(""),B&&"/"!==M.join("/").substr(-1)&&M.push("");var C,T=""===M[0]||M[0]&&"/"===M[0].charAt(0);x&&(i.hostname=i.host=T?"":M.length?M.shift():"",(C=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=C.shift(),i.host=i.hostname=C.shift()));return(k=k||i.host&&M.length)&&!T&&M.unshift(""),M.length?i.pathname=M.join("/"):(i.pathname=null,i.path=null),s.isNull(i.pathname)&&s.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},o.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{"./util":10,punycode:1,querystring:9}],xss:[function(t,e,i){var n=t("./default"),s=t("./parser"),o=t("./xss");for(var r in(i=e.exports=function(t,e){return new o(e).process(t)}).FilterXSS=o,n)i[r]=n[r];for(var r in s)i[r]=s[r];"undefined"!=typeof window&&(window.filterXSS=e.exports)},{"./default":11,"./parser":12,"./xss":14}]},{},[]),n=!0;"object"==typeof module&&"object"==typeof module.exports&&(exports.BEMHTML=e({xss:i("xss"),url:i("url")}),n=!1),"object"==typeof modules&&(modules.define("BEMHTML",[],function(t){t(e({xss:i("xss"),url:i("url")}))}),n=!1),n&&(BEMHTML=e({xss:i("xss"),url:i("url")}),t.BEMHTML=BEMHTML)}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this),function(){var t=Array.prototype.slice;Function.prototype.bind||(Function.prototype.bind=function(e){var i=this,n=t.call(arguments,1);return function(){return i.apply(e,n.concat(t.call(arguments)))}})}(),function(t){var e=t(window),i=s(),n=o();function s(){return window.innerHeight|0+e.outerHeight()}function o(){return window.innerWidth|0+e.outerWidth()}(t.event.special.resize||(t.event.special.resize={})).preDispatch=function(t){var e=s(),r=o();if(n===r&&i===e)return!1;i=e,n=r}}(jQuery),jQuery.cookie=function(t,e,i){if(void 0===e){var n=null;if(document.cookie&&""!=document.cookie)for(var s=document.cookie.split(";"),o=0;o<s.length;o++){var r=jQuery.trim(s[o]);if(r.substring(0,t.length+1)==t+"="){n=decodeURIComponent(r.substring(t.length+1));break}}return n}i=i||{},null===e&&(e="",i.expires=-1);var a,c="";i.expires&&("number"==typeof i.expires||i.expires.toUTCString)&&("number"==typeof i.expires?(a=new Date).setTime(a.getTime()+24*i.expires*60*60*1e3):a=i.expires,c="; expires="+a.toUTCString());var l=i.path?"; path="+i.path:"",d=i.domain?"; domain="+i.domain:"",h=i.secure?"; secure":"";document.cookie=[t,"=",encodeURIComponent(e),c,l,d,h].join("")},function(t){var e={"%D0":"%D0%A0","%C0":"%D0%90","%C1":"%D0%91","%C2":"%D0%92","%C3":"%D0%93","%C4":"%D0%94","%C5":"%D0%95","%A8":"%D0%81","%C6":"%D0%96","%C7":"%D0%97","%C8":"%D0%98","%C9":"%D0%99","%CA":"%D0%9A","%CB":"%D0%9B","%CC":"%D0%9C","%CD":"%D0%9D","%CE":"%D0%9E","%CF":"%D0%9F","%D1":"%D0%A1","%D2":"%D0%A2","%D3":"%D0%A3","%D4":"%D0%A4","%D5":"%D0%A5","%D6":"%D0%A6","%D7":"%D0%A7","%D8":"%D0%A8","%D9":"%D0%A9","%DA":"%D0%AA","%DB":"%D0%AB","%DC":"%D0%AC","%DD":"%D0%AD","%DE":"%D0%AE","%DF":"%D0%AF","%E0":"%D0%B0","%E1":"%D0%B1","%E2":"%D0%B2","%E3":"%D0%B3","%E4":"%D0%B4","%E5":"%D0%B5","%B8":"%D1%91","%E6":"%D0%B6","%E7":"%D0%B7","%E8":"%D0%B8","%E9":"%D0%B9","%EA":"%D0%BA","%EB":"%D0%BB","%EC":"%D0%BC","%ED":"%D0%BD","%EE":"%D0%BE","%EF":"%D0%BF","%F0":"%D1%80","%F1":"%D1%81","%F2":"%D1%82","%F3":"%D1%83","%F4":"%D1%84","%F5":"%D1%85","%F6":"%D1%86","%F7":"%D1%87","%F8":"%D1%88","%F9":"%D1%89","%FA":"%D1%8A","%FB":"%D1%8B","%FC":"%D1%8C","%FD":"%D1%8D","%FE":"%D1%8E","%FF":"%D1%8F"};function i(t,i){var n="";try{n=t(i)}catch(s){try{n=t(function(t){return t.replace(/%.{2}/g,function(t){return e[t]||t})}(i))}catch(t){n=i}}return n}jQuery.extend({decodeURI:function(t){return i(decodeURI,t)},decodeURIComponent:function(t){return i(decodeURIComponent,t)}})}(),function(t){t||(t=window.Lego={}),t.getCookie=function(t){var e=document.cookie;if(e.length<1)return!1;var i=e.indexOf(t+"=");if(-1===i)return!1;i+=t.length+1;var n=e.indexOf(";",i);return decodeURIComponent(-1===n?e.substring(i):e.substring(i,n))}}(window.Lego),function(t,e,i){var n={bubbles:!1,cancelable:!1,view:null,detail:null,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null,buttons:0,pointerId:0,width:0,height:0,pressure:0,tiltX:0,tiltY:0,pointerType:"",hwTimestamp:0,isPrimary:!1,target:null,currentTarget:null,which:0,pageX:0,pageY:0,timeStamp:0},s=Object.keys(n),o=s.map(function(t){return n[t]}),r=s.length,a=!1,c=[0,1,4,2];try{a=1===new MouseEvent("test",{buttons:1}).buttons}catch(t){}function l(t,e){var i={},n=t.originalEvent||{};e||(e={});for(var l,d=0;d<r;d++)i[l=s[d]]=e[l]||t[l]||n[l]||o[d];return i.x=i.clientX,i.y=i.clientY,i.pressure=i.pressure||(i.buttons?.5:0),i.buttons||a||(i.buttons=c[i.which]||0),i.originalEvent=t.originalEvent||null,e.preventDefault?i.preventDefault=function(){e.preventDefault(),t.preventDefault()}:(i.preventDefault=function(){t.preventDefault()},i._preventScroll=function(){}),i}var d=t.Map&&t.Map.prototype.forEach?new t.Map:{array:[],size:0,set:function(t,e){if(void 0===e)return this.delete(t);this.has(t)||this.size++,this.array[t]=e},has:function(t){return void 0!==this.array[t]},delete:function(t){this.has(t)&&(delete this.array[t],this.size--)},get:function(t){return this.array[t]},clear:function(){this.array.length=0,this.size=0},forEach:function(t,e){return this.array.forEach(function(i,n){t.call(e,i,n,this)},this)}},h={eventMap:{},captureInfo:{},eventSourceList:[],registerSource:function(t,e){var i=e.events;i&&(i.forEach(function(t){e[t]&&(this.eventMap[t]=e[t].bind(e))},this),this.eventSourceList.push(e))},register:function(t){for(var e,i=this.eventSourceList.length,n=0;n<i&&(e=this.eventSourceList[n]);n++)e.register.call(e,t)},unregister:function(t){for(var e,i=this.eventSourceList.length,n=0;n<i&&(e=this.eventSourceList[n]);n++)e.unregister.call(e,t)},contains:function(t,e){return!!t.contains&&t.contains(e)},getCommonAncestor:function(t,i){for(;t&&t!==e.documentElement;){if(t.contains&&t.contains(i))return t;t=t.parentNode}return null},down:function(t){t.bubbles=!0,this.fireEvent("pointerdown",t)},move:function(t){t.bubbles=!0,this.fireEvent("pointermove",t)},up:function(t){t.bubbles=!0,this.fireEvent("pointerup",t)},enter:function(t){var e=[],i=t.target,n=this.getCommonAncestor(i,t.relatedTarget);for(t.bubbles=!1;i&&i!==n;)e.push(i),i=i.parentNode;for(;e.length;)t.target=e.pop(),this.fireEvent("pointerenter",t)},leave:function(t){var e=[],i=t.target,n=this.getCommonAncestor(i,t.relatedTarget);for(t.bubbles=!1;i&&i!==n;)e.push(i),i=i.parentNode;for(;e.length;)t.target=e.shift(),this.fireEvent("pointerleave",t)},over:function(t){t.bubbles=!0,this.fireEvent("pointerover",t)},out:function(t){t.bubbles=!0,this.fireEvent("pointerout",t)},cancel:function(t){t.bubbles=!0,this.fireEvent("pointercancel",t)},leaveOut:function(t){this.out(t),this.contains(t.target,t.relatedTarget)||this.leave(t)},enterOver:function(t){this.over(t),this.contains(t.target,t.relatedTarget)||this.enter(t)},listen:function(t,e){e.forEach(function(e){this.addEvent(t,e)},this)},unlisten:function(t,e){e.forEach(function(e){this.removeEvent(t,e)},this)},addEvent:function(t,e){i(t).on(e,this.boundHandler)},removeEvent:function(t,e){i(t).off(e,this.boundHandler)},eventHandler:function(t){var e=this.eventMap[t.type];e&&e(t,t.originalEvent)},makeEvent:function(t,e){this.captureInfo[e.pointerId]&&(e.relatedTarget=null);var n=function(t,e){var n=i.Event(t),s=e.preventDefault,o=n.preventDefault.bind(n);return jQuery.extend(n,e),n.preventDefault=function(){s(),o()},n}(t,e);return n._target=n._target||e.target,n},fireEvent:function(t,e){var i=this.makeEvent(t,e);return this.dispatchEvent(i)},getTarget:function(t){return this.captureInfo[t.pointerId]||t._target},setCapture:function(t,n){this.captureInfo[t]&&this.releaseCapture(t),this.captureInfo[t]=n,this.implicitRelease=this.releaseCapture.bind(this,t),i(e).on("pointerup pointercancel",this.implicitRelease),this.asyncDispatchEvent(i.Event("gotpointercapture",{bubbles:!0,cancelable:!1,pointerId:t,_target:n}))},releaseCapture:function(t){var n=this.captureInfo[t];n&&(this.captureInfo[t]=void 0,i(e).off("pointerup pointercancel",this.implicitRelease),this.asyncDispatchEvent(i.Event("lostpointercapture",{bubbles:!0,cancelable:!1,pointerId:t,_target:n})))},dispatchEvent:function(t){var e=this.getTarget(t);if(e)return i.event.trigger(t,null,e,!t.bubbles)},asyncDispatchEvent:function(e){(t.requestAnimationFrame||setTimeout)(this.dispatchEvent.bind(this,e))}};h.boundHandler=h.eventHandler.bind(h);var u,m,p={POINTER_ID:1,POINTER_TYPE:"mouse",DEDUP_DIST:25,events:["mousedown","mousemove","mouseup","mouseover","mouseout"],register:function(t){h.listen(t,this.events)},unregister:function(t){h.unlisten(t,this.events)},lastTouches:[],isEventSimulatedFromTouch:function(t){for(var e,i=this.lastTouches,n=t.clientX,s=t.clientY,o=0,r=i.length;o<r&&(e=i[o]);o++){var a=Math.abs(n-e.x),c=Math.abs(s-e.y);if(a<=this.DEDUP_DIST&&c<=this.DEDUP_DIST)return!0}},prepareEvent:function(t){return l(t,{pointerId:this.POINTER_ID,isPrimary:!0,pointerType:this.POINTER_TYPE})},mousedown:function(t){this.isEventSimulatedFromTouch(t)||(d.has(this.POINTER_ID)&&this.cancel(t),d.set(this.POINTER_ID,t),h.down(this.prepareEvent(t)))},mousemove:function(t){this.isEventSimulatedFromTouch(t)||h.move(this.prepareEvent(t))},mouseup:function(t){if(!this.isEventSimulatedFromTouch(t)){var e=d.get(this.POINTER_ID);e&&e.button===t.button&&(h.up(this.prepareEvent(t)),this.cleanupMouse())}},mouseover:function(t){this.isEventSimulatedFromTouch(t)||h.enterOver(this.prepareEvent(t))},mouseout:function(t){this.isEventSimulatedFromTouch(t)||h.leaveOut(this.prepareEvent(t))},cancel:function(t){h.cancel(this.prepareEvent(t)),this.cleanupMouse()},cleanupMouse:function(){d.delete(this.POINTER_ID)}},f={POINTER_TYPE:"touch",DEDUP_TIMEOUT:2500,CLICK_COUNT_TIMEOUT:200,events:["touchstart","touchmove","touchend","touchcancel"],register:function(t){h.listen(t,this.events)},unregister:function(t){h.unlisten(t,this.events)},firstTouch:null,isPrimaryTouch:function(t){return this.firstTouch===t.identifier},setPrimaryTouch:function(t){(0===d.size||1===d.size&&d.has(1))&&(this.firstTouch=t.identifier,this.firstTouchTarget=t.target,this.scrolling=!1,this.firstXY={X:t.clientX,Y:t.clientY},this.cancelResetClickCount())},removePrimaryPointer:function(t){t.isPrimary&&(this.firstTouch=null,this.firstTouchTarget=null,this.firstXY=null,this.shouldScrollCache=void 0,this.resetClickCount())},clickCount:0,resetId:null,resetClickCount:function(){var t=function(){this.clickCount=0,this.resetId=null}.bind(this);this.resetId=setTimeout(t,this.CLICK_COUNT_TIMEOUT)},cancelResetClickCount:function(){this.resetId&&clearTimeout(this.resetId)},typeToButtons:function(t){return"touchstart"===t||"touchmove"===t?1:0},findTarget:function(t){return e.elementFromPoint(t.clientX,t.clientY)},touchToPointer:function(t){var e=this,n=this.currentTouchEvent,s=t.identifier+2;return l(n,i.extend({},t,{pointerId:s,target:h.captureInfo[s]||this.findTarget(t),bubbles:!0,cancelable:!0,detail:this.clickCount,button:0,buttons:this.typeToButtons(n.type),width:t.webkitRadiusX||t.radiusX||0,height:t.webkitRadiusY||t.radiusY||0,pressure:t.webkitForce||t.force||.5,isPrimary:this.isPrimaryTouch(t),pointerType:this.POINTER_TYPE,preventDefault:function(){e.scrolling=!1,e.shouldScrollCache=!1,e.firstXY=null}}))},processTouches:function(t,e){var i=t.originalEvent.changedTouches;this.currentTouchEvent=t;for(var n,s=0;s<i.length;s++)n=i[s],e.call(this,this.touchToPointer(n))},scrollTypes:{EMITTER:"none",XSCROLLER:"pan-x",YSCROLLER:"pan-y",SCROLLER:/^(?:pan-x pan-y)|(?:pan-y pan-x)|auto$/},touchActionToScrollType:function(t){var e,i=this.scrollTypes;return t===i.EMITTER?e="none":t===i.XSCROLLER?e="X":t===i.YSCROLLER?e="Y":i.SCROLLER.exec(t)&&(e="XY"),e},shouldScroll:function(t){if(void 0!==this.shouldScrollCache)return this.shouldScrollCache;if(!this.firstXY)return!0;for(var e,i,n=this.firstTouchTarget;n&&1===n.nodeType&&null===(e=n.getAttribute("touch-action"));)n=n.parentNode;var s=this.touchActionToScrollType(e);if("none"===s)i=!1;else if("XY"===s||void 0===s)i=!0;else{var o=t.originalEvent.changedTouches[0],r=s,a="Y"===s?"X":"Y";i=Math.abs(o["client"+r]-this.firstXY[r])>=Math.abs(o["client"+a]-this.firstXY[a])}return this.shouldScrollCache=i,this.firstXY=null,this.firstTouchTarget=null,this.shouldScrollCache},findTouch:function(t,e){for(var i,n=0,s=t.length;n<s&&(i=t[n]);n++)if(i.identifier===e)return!0},vacuumTouches:function(t){var e=t.originalEvent.touches;if(d.size>=e.length){var i=[];d.forEach(function(t,n){if(1!==n&&!this.findTouch(e,n-2)){var s=t.out;i.push(s)}},this),i.forEach(this.cancelOut,this)}},touchstart:function(t){var e=t.originalEvent.changedTouches[0];this.vacuumTouches(t),this.setPrimaryTouch(e),this.dedupSynthMouse(e),this.scrolling||(this.clickCount++,this.processTouches(t,this.overDown))},overDown:function(t){d.set(t.pointerId,{target:t.target,out:t,outTarget:t.target}),h.over(t),h.enter(t),h.down(t)},touchmove:function(t){this.scrolling||(this.shouldScroll(t)?(this.scrolling=!0,this.touchcancel(t)):(t.preventDefault(),this.processTouches(t,this.moveOverOut)))},moveOverOut:function(t){var e=d.get(t.pointerId);if(e){var i=e.out,n=e.outTarget;h.move(t),i&&n!==t.target&&(i.relatedTarget=t.target,t.relatedTarget=n,i.target=n,t.target?(h.leaveOut(i),h.enterOver(t)):(t.target=n,t.relatedTarget=null,this.cancelOut(t))),e.out=t,e.outTarget=t.target}},touchend:function(t){this.dedupSynthMouse(t.originalEvent.changedTouches[0]),this.processTouches(t,this.upOut)},upOut:function(t){this.scrolling||(h.up(t),h.out(t),h.leave(t)),this.cleanUpPointer(t)},touchcancel:function(t){this.processTouches(t,this.cancelOut)},cancelOut:function(t){h.cancel(t),h.out(t),h.leave(t),this.cleanUpPointer(t)},cleanUpPointer:function(t){d.delete(t.pointerId),this.removePrimaryPointer(t)},dedupSynthMouse:function(t){var e=p.lastTouches;if(this.isPrimaryTouch(t)){var i={x:t.clientX,y:t.clientY};e.push(i);var n=function(t,e){var i=t.indexOf(e);i>-1&&t.splice(i,1)}.bind(null,e,i);setTimeout(n,this.DEDUP_TIMEOUT)}}},_={POINTER_TYPES:["","unavailable","touch","pen","mouse"],HAS_BITMAP_TYPE:t.MSPointerEvent&&"number"==typeof t.MSPointerEvent.MSPOINTER_TYPE_MOUSE,events:["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSGotPointerCapture","MSLostPointerCapture"],register:function(t){h.listen(t,this.events)},unregister:function(t){h.unlisten(t,this.events)},prepareEvent:function(t){var e=l(t);return this.HAS_BITMAP_TYPE&&(e.pointerType=this.POINTER_TYPES[e.pointerType]),e},cleanup:function(t){d.delete(t)},MSPointerDown:function(t){d.set(t.originalEvent.pointerId,t),h.down(this.prepareEvent(t))},MSPointerMove:function(t){h.move(this.prepareEvent(t))},MSPointerUp:function(t){h.up(this.prepareEvent(t)),this.cleanup(t.originalEvent.pointerId)},MSPointerOut:function(t){h.leaveOut(this.prepareEvent(t))},MSPointerOver:function(t){h.enterOver(this.prepareEvent(t))},MSPointerCancel:function(t){h.cancel(this.prepareEvent(t)),this.cleanup(t.originalEvent.pointerId)},MSGotPointerCapture:function(t){h.fireEvent("gotpointercapture",this.prepareEvent(t))},MSLostPointerCapture:function(t){h.fireEvent("lostpointercapture",this.prepareEvent(t))}},g=function(t){if(!d.has(t))throw new Error("InvalidPointerId")};t.Element&&Element.prototype.setPointerCapture?(u=function(t,e){t.setPointerCapture(e)},m=function(t,e){t.releasePointerCapture(e)}):t.navigator.msPointerEnabled?(u=function(t,e){g(e),t.msSetPointerCapture(e)},m=function(t,e){g(e),t.msReleasePointerCapture(e)}):(u=function(t,e){g(e),h.setCapture(e,t)},m=function(t,e){g(e),h.releaseCapture(e,t)}),i.fn.extend({setPointerCapture:function(t){u(this[0],t)},releasePointerCapture:function(t){m(this[0],t)}}),t._pointerPolyfillInited||(t._pointerPolyfillInited=!0,t.PointerEvent?["move","down","up","over","out","enter","leave","cancel"].forEach(function(t){var e=jQuery.event.fixHooks,i="pointer"+t;e[i]||(e[i]={}),e[i].props=s.concat(e[i].props||[])}):(delete i.event.special.pointerenter,delete i.event.special.pointerleave,t.navigator.msPointerEnabled?h.registerSource("ms",_):(h.registerSource("mouse",p),void 0!==t.ontouchstart&&h.registerSource("touch",f)),h.register(document)))}(window,document,jQuery),function(t,e){if(!e.event.special.pointerclick){var i,n=void 0!==t.ontouchstart||navigator.msMaxTouchPoints>0,s=10,o=25,r=900,a=[],c=[],l=null,d=null,h="touchAction"in document.documentElement.style?function(t){return function t(e){return!(!e||e===document.documentElement)&&("manipulation"===getComputedStyle(e)["touch-action"]||t(e.parentElement))}(t)}:function(){return!1};n?(i={click:function(t){var e=Object(t.originalEvent)._sourcePoint;if(!e)return u.apply(this,arguments);e.isDefaultPrevented()&&t.preventDefault()},"pointerdown pointermove pointerleave pointercancel pointerup":function(t){var e,i,n=t.type;if("mouse"!==t.pointerType&&("pointerdown"!==n&&"pointerup"!==n||!h(t.target)))if("pointerdown"===n)d=t;else if("pointermove"===n&&d&&(d.target!==t.target||(e=d,i=t,Math.abs(e.clientX-i.clientX)>s||Math.abs(e.clientY-i.clientY)>s)))d=null;else if("pointerleave"===n||"pointercancel"===n)d=null;else if("pointerup"===n){if(function(t){if(!t.isPrimary)return;a.push(t),setTimeout(Array.prototype.shift.bind(a),r)}(t),!d)return;if(!(t.timeStamp-d.timeStamp>250))return l||(l=setTimeout(function(){l=d=null})),u.apply(this,arguments);d=null}}},["mousedown","click"].forEach(function(e){t.addEventListener(e,function(t){!function(t){var e=t.clientX,i=t.clientY,n="_compat"+t.type;if(t._sourcePoint)return;for(var s=0;s<a.length;s++){var l=a[s],d=l.target===t.target;if(!l[n]&&((d||!(Math.abs(e-l.clientX)>o||Math.abs(i-l.clientY)>o))&&(d||document.elementFromPoint(l.clientX,l.clientY)!==l.target))){t._sourcePoint=l,l[n]=t;break}}c.push(t),setTimeout(Array.prototype.shift.bind(c),r)}(t),function(t){var e=function(t){for(var e=0;e<c.length;e++)if(c[e]===t)return c[e]._sourcePoint}(t);return Boolean(e)&&e.target!==t.target}(t)&&(t.preventDefault(),t.stopPropagation())},!0)})):i={click:function(t){return u.apply(this,arguments)}},e.event.special.pointerclick={setup:function(){e(this).on(i)},teardown:function(){e(this).off(i)}}}function u(t){var i,n=t.type;return t.button||(t.type="pointerclick",i=e.event.dispatch.apply(this,arguments),t.type=n),i}}(window,jQuery),$.extend({debounce:function(t,e,i,n){var s,o=function(){var o=arguments;n=n||this,i&&!s&&t.apply(n,o),clearTimeout(s),s=setTimeout(function(){i||t.apply(n,o),s=null},e)};return 3===arguments.length&&"boolean"!=typeof i&&(n=i,i=!1),o.stop=function(){clearTimeout(s),s=null},o},throttle:function(t,e,i){var n,s,o,r=function(){s=arguments,o=!0,i=i||this,n||function(){o?(t.apply(i,s),o=!1,n=setTimeout(arguments.callee,e)):n=null}()};return r.stop=function(){clearTimeout(n),n=null},r}}),function(t){t.event.special.pointerpress||t.each({pointerpress:"pointerdown",pointerrelease:"pointerup pointercancel"},function(e,i){function n(i){var n,s=i.type;return"mouse"===i.pointerType&&1!==i.which||(i.type=e,n=t.event.dispatch.apply(this,arguments),i.type=s),n}t.event.special[e]={setup:function(){t(this).on(i,n)},teardown:function(){t(this).off(i,n)}}})}(jQuery),function(t){t.dom={getActiveElement:function(){return t(document.activeElement)}},t.fn.isFocused=function(){return this.is(t.dom.getActiveElement())}}(jQuery),function(){var t=$(window),e=$(document.documentElement),i=0,n=!1;function s(){e.hasClass("pointerfocus")&&(n=!0,setTimeout(function(){n=!1}))}document.documentMode<=11?e.on("focusin",function(t){var e=t.originalEvent;!e||e.fromElement||e.relatedTarget||s()}):t.on("blur",function(){t.one("focus",s)}),e.addClass("utilityfocus").on({focusin:function(){e.toggleClass("pointerfocus",n).toggleClass("utilityfocus",!n)},keydown:function(){clearTimeout(i),n=!1},"pointerdown pointerup click":function(t){n=!0,clearTimeout(i),i=setTimeout(function(){n=!1},600)}})}(),$.extend({util:{}}),function(){function t(t,e){var r=t[0],a=t[1],c=t[2],l=t[3];a=o(a=o(a=o(a=o(a=s(a=s(a=s(a=s(a=n(a=n(a=n(a=n(a=i(a=i(a=i(a=i(a,c=i(c,l=i(l,r=i(r,a,c,l,e[0],7,-680876936),a,c,e[1],12,-389564586),r,a,e[2],17,606105819),l,r,e[3],22,-1044525330),c=i(c,l=i(l,r=i(r,a,c,l,e[4],7,-176418897),a,c,e[5],12,1200080426),r,a,e[6],17,-1473231341),l,r,e[7],22,-45705983),c=i(c,l=i(l,r=i(r,a,c,l,e[8],7,1770035416),a,c,e[9],12,-1958414417),r,a,e[10],17,-42063),l,r,e[11],22,-1990404162),c=i(c,l=i(l,r=i(r,a,c,l,e[12],7,1804603682),a,c,e[13],12,-40341101),r,a,e[14],17,-1502002290),l,r,e[15],22,1236535329),c=n(c,l=n(l,r=n(r,a,c,l,e[1],5,-165796510),a,c,e[6],9,-1069501632),r,a,e[11],14,643717713),l,r,e[0],20,-373897302),c=n(c,l=n(l,r=n(r,a,c,l,e[5],5,-701558691),a,c,e[10],9,38016083),r,a,e[15],14,-660478335),l,r,e[4],20,-405537848),c=n(c,l=n(l,r=n(r,a,c,l,e[9],5,568446438),a,c,e[14],9,-1019803690),r,a,e[3],14,-187363961),l,r,e[8],20,1163531501),c=n(c,l=n(l,r=n(r,a,c,l,e[13],5,-1444681467),a,c,e[2],9,-51403784),r,a,e[7],14,1735328473),l,r,e[12],20,-1926607734),c=s(c,l=s(l,r=s(r,a,c,l,e[5],4,-378558),a,c,e[8],11,-2022574463),r,a,e[11],16,1839030562),l,r,e[14],23,-35309556),c=s(c,l=s(l,r=s(r,a,c,l,e[1],4,-1530992060),a,c,e[4],11,1272893353),r,a,e[7],16,-155497632),l,r,e[10],23,-1094730640),c=s(c,l=s(l,r=s(r,a,c,l,e[13],4,681279174),a,c,e[0],11,-358537222),r,a,e[3],16,-722521979),l,r,e[6],23,76029189),c=s(c,l=s(l,r=s(r,a,c,l,e[9],4,-640364487),a,c,e[12],11,-421815835),r,a,e[15],16,530742520),l,r,e[2],23,-995338651),c=o(c,l=o(l,r=o(r,a,c,l,e[0],6,-198630844),a,c,e[7],10,1126891415),r,a,e[14],15,-1416354905),l,r,e[5],21,-57434055),c=o(c,l=o(l,r=o(r,a,c,l,e[12],6,1700485571),a,c,e[3],10,-1894986606),r,a,e[10],15,-1051523),l,r,e[1],21,-2054922799),c=o(c,l=o(l,r=o(r,a,c,l,e[8],6,1873313359),a,c,e[15],10,-30611744),r,a,e[6],15,-1560198380),l,r,e[13],21,1309151649),c=o(c,l=o(l,r=o(r,a,c,l,e[4],6,-145523070),a,c,e[11],10,-1120210379),r,a,e[2],15,718787259),l,r,e[9],21,-343485551),t[0]=d(r,t[0]),t[1]=d(a,t[1]),t[2]=d(c,t[2]),t[3]=d(l,t[3])}function e(t,e,i,n,s,o){return e=d(d(e,t),d(n,o)),d(e<<s|e>>>32-s,i)}function i(t,i,n,s,o,r,a){return e(i&n|~i&s,t,i,o,r,a)}function n(t,i,n,s,o,r,a){return e(i&s|n&~s,t,i,o,r,a)}function s(t,i,n,s,o,r,a){return e(i^n^s,t,i,o,r,a)}function o(t,i,n,s,o,r,a){return e(n^(i|~s),t,i,o,r,a)}function r(t){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return i}var a="0123456789abcdef".split("");function c(t){for(var e="",i=0;i<4;i++)e+=a[t>>8*i+4&15]+a[t>>8*i&15];return e}function l(e){return function(t){for(var e=0;e<t.length;e++)t[e]=c(t[e]);return t.join("")}(function(e){txt="";var i,n=e.length,s=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=e.length;i+=64)t(s,r(e.substring(i-64,i)));e=e.substring(i-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<e.length;i++)o[i>>2]|=e.charCodeAt(i)<<(i%4<<3);if(o[i>>2]|=128<<(i%4<<3),i>55)for(t(s,o),i=0;i<16;i++)o[i]=0;return o[14]=8*n,t(s,o),s}(e))}function d(t,e){return t+e&4294967295}if("5d41402abc4b2a76b9719d911017c592"!=l("hello"))function d(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}$.md5=$.md5||l}(window,$),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.moment=e()}(this,function(){"use strict";var t,e;function i(){return t.apply(null,arguments)}function n(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function s(t){return"[object Object]"===Object.prototype.toString.call(t)}function o(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function r(t,e){var i,n=[];for(i=0;i<t.length;++i)n.push(e(t[i],i));return n}function a(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function c(t,e){for(var i in e)a(e,i)&&(t[i]=e[i]);return a(e,"toString")&&(t.toString=e.toString),a(e,"valueOf")&&(t.valueOf=e.valueOf),t}function l(t,e,i,n){return ke(t,e,i,n,!0).utc()}function d(t){return null==t._pf&&(t._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}),t._pf}function h(t){if(null==t._isValid){var i=d(t),n=e.call(i.parsedDateParts,function(t){return null!=t});t._isValid=!isNaN(t._d.getTime())&&i.overflow<0&&!i.empty&&!i.invalidMonth&&!i.invalidWeekday&&!i.nullInput&&!i.invalidFormat&&!i.userInvalidated&&(!i.meridiem||i.meridiem&&n),t._strict&&(t._isValid=t._isValid&&0===i.charsLeftOver&&0===i.unusedTokens.length&&void 0===i.bigHour)}return t._isValid}function u(t){var e=l(NaN);return null!=t?c(d(e),t):d(e).userInvalidated=!0,e}function m(t){return void 0===t}e=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),i=e.length>>>0,n=0;n<i;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};var p=i.momentProperties=[];function f(t,e){var i,n,s;if(m(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),m(e._i)||(t._i=e._i),m(e._f)||(t._f=e._f),m(e._l)||(t._l=e._l),m(e._strict)||(t._strict=e._strict),m(e._tzm)||(t._tzm=e._tzm),m(e._isUTC)||(t._isUTC=e._isUTC),m(e._offset)||(t._offset=e._offset),m(e._pf)||(t._pf=d(e)),m(e._locale)||(t._locale=e._locale),p.length>0)for(i in p)m(s=e[n=p[i]])||(t[n]=s);return t}var _=!1;function g(t){f(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),!1===_&&(_=!0,i.updateOffset(this),_=!1)}function b(t){return t instanceof g||null!=t&&null!=t._isAMomentObject}function v(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function y(t){var e=+t,i=0;return 0!==e&&isFinite(e)&&(i=v(e)),i}function k(t,e,i){var n,s=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),r=0;for(n=0;n<s;n++)(i&&t[n]!==e[n]||!i&&y(t[n])!==y(e[n]))&&r++;return r+o}function w(t){!1===i.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function M(t,e){var n=!0;return c(function(){return null!=i.deprecationHandler&&i.deprecationHandler(null,t),n&&(w(t+"\nArguments: "+Array.prototype.slice.call(arguments).join(", ")+"\n"+(new Error).stack),n=!1),e.apply(this,arguments)},e)}var x,E={};function B(t,e){null!=i.deprecationHandler&&i.deprecationHandler(t,e),E[t]||(w(e),E[t]=!0)}function I(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function S(t,e){var i,n=c({},t);for(i in e)a(e,i)&&(s(t[i])&&s(e[i])?(n[i]={},c(n[i],t[i]),c(n[i],e[i])):null!=e[i]?n[i]=e[i]:delete n[i]);for(i in t)a(t,i)&&!a(e,i)&&s(t[i])&&(n[i]=c({},n[i]));return n}function C(t){null!=t&&this.set(t)}i.suppressDeprecationWarnings=!1,i.deprecationHandler=null,x=Object.keys?Object.keys:function(t){var e,i=[];for(e in t)a(t,e)&&i.push(e);return i};var T={};function N(t,e){var i=t.toLowerCase();T[i]=T[i+"s"]=T[e]=t}function D(t){return"string"==typeof t?T[t]||T[t.toLowerCase()]:void 0}function O(t){var e,i,n={};for(i in t)a(t,i)&&(e=D(i))&&(n[e]=t[i]);return n}var P={};function A(t,e){P[t]=e}function L(t,e){return function(n){return null!=n?(R(this,t,n),i.updateOffset(this,e),this):j(this,t)}}function j(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function R(t,e,i){t.isValid()&&t._d["set"+(t._isUTC?"UTC":"")+e](i)}function z(t,e,i){var n=""+Math.abs(t),s=e-n.length;return(t>=0?i?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+n}var F=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,q=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,H={},U={};function V(t,e,i,n){var s=n;"string"==typeof n&&(s=function(){return this[n]()}),t&&(U[t]=s),e&&(U[e[0]]=function(){return z(s.apply(this,arguments),e[1],e[2])}),i&&(U[i]=function(){return this.localeData().ordinal(s.apply(this,arguments),t)})}function W(t,e){return t.isValid()?(e=$(e,t.localeData()),H[e]=H[e]||function(t){var e,i,n,s=t.match(F);for(e=0,i=s.length;e<i;e++)U[s[e]]?s[e]=U[s[e]]:s[e]=(n=s[e]).match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"");return function(e){var n,o="";for(n=0;n<i;n++)o+=s[n]instanceof Function?s[n].call(e,t):s[n];return o}}(e),H[e](t)):t.localeData().invalidDate()}function $(t,e){var i=5;function n(t){return e.longDateFormat(t)||t}for(q.lastIndex=0;i>=0&&q.test(t);)t=t.replace(q,n),q.lastIndex=0,i-=1;return t}var G=/\d/,J=/\d\d/,Y=/\d{3}/,K=/\d{4}/,Z=/[+-]?\d{6}/,Q=/\d\d?/,X=/\d\d\d\d?/,tt=/\d\d\d\d\d\d?/,et=/\d{1,3}/,it=/\d{1,4}/,nt=/[+-]?\d{1,6}/,st=/\d+/,ot=/[+-]?\d+/,rt=/Z|[+-]\d\d:?\d\d/gi,at=/Z|[+-]\d\d(?::?\d\d)?/gi,ct=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,lt={};function dt(t,e,i){lt[t]=I(e)?e:function(t,n){return t&&i?i:e}}function ht(t,e){return a(lt,t)?lt[t](e._strict,e._locale):new RegExp(ut(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,i,n,s){return e||i||n||s})))}function ut(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var mt={};function pt(t,e){var i,n=e;for("string"==typeof t&&(t=[t]),"number"==typeof e&&(n=function(t,i){i[e]=y(t)}),i=0;i<t.length;i++)mt[t[i]]=n}function ft(t,e){pt(t,function(t,i,n,s){n._w=n._w||{},e(t,n._w,n,s)})}function _t(t,e,i){null!=e&&a(mt,t)&&mt[t](e,i._a,i,t)}var gt,bt=0,vt=1,yt=2,kt=3,wt=4,Mt=5,xt=6,Et=7,Bt=8;function It(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}gt=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},V("M",["MM",2],"Mo",function(){return this.month()+1}),V("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),V("MMMM",0,0,function(t){return this.localeData().months(this,t)}),N("month","M"),A("month",8),dt("M",Q),dt("MM",Q,J),dt("MMM",function(t,e){return e.monthsShortRegex(t)}),dt("MMMM",function(t,e){return e.monthsRegex(t)}),pt(["M","MM"],function(t,e){e[vt]=y(t)-1}),pt(["MMM","MMMM"],function(t,e,i,n){var s=i._locale.monthsParse(t,n,i._strict);null!=s?e[vt]=s:d(i).invalidMonth=t});var St=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/,Ct="January_February_March_April_May_June_July_August_September_October_November_December".split("_");var Tt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function Nt(t,e){var i;if(!t.isValid())return t;if("string"==typeof e)if(/^\d+$/.test(e))e=y(e);else if("number"!=typeof(e=t.localeData().monthsParse(e)))return t;return i=Math.min(t.date(),It(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,i),t}function Dt(t){return null!=t?(Nt(this,t),i.updateOffset(this,!0),this):j(this,"Month")}var Ot=ct;var Pt=ct;function At(){function t(t,e){return e.length-t.length}var e,i,n=[],s=[],o=[];for(e=0;e<12;e++)i=l([2e3,e]),n.push(this.monthsShort(i,"")),s.push(this.months(i,"")),o.push(this.months(i,"")),o.push(this.monthsShort(i,""));for(n.sort(t),s.sort(t),o.sort(t),e=0;e<12;e++)n[e]=ut(n[e]),s[e]=ut(s[e]);for(e=0;e<24;e++)o[e]=ut(o[e]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function Lt(t){return jt(t)?366:365}function jt(t){return t%4==0&&t%100!=0||t%400==0}V("Y",0,0,function(){var t=this.year();return t<=9999?""+t:"+"+t}),V(0,["YY",2],0,function(){return this.year()%100}),V(0,["YYYY",4],0,"year"),V(0,["YYYYY",5],0,"year"),V(0,["YYYYYY",6,!0],0,"year"),N("year","y"),A("year",1),dt("Y",ot),dt("YY",Q,J),dt("YYYY",it,K),dt("YYYYY",nt,Z),dt("YYYYYY",nt,Z),pt(["YYYYY","YYYYYY"],bt),pt("YYYY",function(t,e){e[bt]=2===t.length?i.parseTwoDigitYear(t):y(t)}),pt("YY",function(t,e){e[bt]=i.parseTwoDigitYear(t)}),pt("Y",function(t,e){e[bt]=parseInt(t,10)}),i.parseTwoDigitYear=function(t){return y(t)+(y(t)>68?1900:2e3)};var Rt=L("FullYear",!0);function zt(t){var e=new Date(Date.UTC.apply(null,arguments));return t<100&&t>=0&&isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t),e}function Ft(t,e,i){var n=7+e-i;return-((7+zt(t,0,n).getUTCDay()-e)%7)+n-1}function qt(t,e,i,n,s){var o,r,a=1+7*(e-1)+(7+i-n)%7+Ft(t,n,s);return a<=0?r=Lt(o=t-1)+a:a>Lt(t)?(o=t+1,r=a-Lt(t)):(o=t,r=a),{year:o,dayOfYear:r}}function Ht(t,e,i){var n,s,o=Ft(t.year(),e,i),r=Math.floor((t.dayOfYear()-o-1)/7)+1;return r<1?n=r+Ut(s=t.year()-1,e,i):r>Ut(t.year(),e,i)?(n=r-Ut(t.year(),e,i),s=t.year()+1):(s=t.year(),n=r),{week:n,year:s}}function Ut(t,e,i){var n=Ft(t,e,i),s=Ft(t+1,e,i);return(Lt(t)-n+s)/7}V("w",["ww",2],"wo","week"),V("W",["WW",2],"Wo","isoWeek"),N("week","w"),N("isoWeek","W"),A("week",5),A("isoWeek",5),dt("w",Q),dt("ww",Q,J),dt("W",Q),dt("WW",Q,J),ft(["w","ww","W","WW"],function(t,e,i,n){e[n.substr(0,1)]=y(t)});V("d",0,"do","day"),V("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),V("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),V("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),V("e",0,0,"weekday"),V("E",0,0,"isoWeekday"),N("day","d"),N("weekday","e"),N("isoWeekday","E"),A("day",11),A("weekday",11),A("isoWeekday",11),dt("d",Q),dt("e",Q),dt("E",Q),dt("dd",function(t,e){return e.weekdaysMinRegex(t)}),dt("ddd",function(t,e){return e.weekdaysShortRegex(t)}),dt("dddd",function(t,e){return e.weekdaysRegex(t)}),ft(["dd","ddd","dddd"],function(t,e,i,n){var s=i._locale.weekdaysParse(t,n,i._strict);null!=s?e.d=s:d(i).invalidWeekday=t}),ft(["d","e","E"],function(t,e,i,n){e[n]=y(t)});var Vt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");var Wt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");var $t="Su_Mo_Tu_We_Th_Fr_Sa".split("_");var Gt=ct;var Jt=ct;var Yt=ct;function Kt(){function t(t,e){return e.length-t.length}var e,i,n,s,o,r=[],a=[],c=[],d=[];for(e=0;e<7;e++)i=l([2e3,1]).day(e),n=this.weekdaysMin(i,""),s=this.weekdaysShort(i,""),o=this.weekdays(i,""),r.push(n),a.push(s),c.push(o),d.push(n),d.push(s),d.push(o);for(r.sort(t),a.sort(t),c.sort(t),d.sort(t),e=0;e<7;e++)a[e]=ut(a[e]),c[e]=ut(c[e]),d[e]=ut(d[e]);this._weekdaysRegex=new RegExp("^("+d.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+r.join("|")+")","i")}function Zt(){return this.hours()%12||12}function Qt(t,e){V(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function Xt(t,e){return e._meridiemParse}V("H",["HH",2],0,"hour"),V("h",["hh",2],0,Zt),V("k",["kk",2],0,function(){return this.hours()||24}),V("hmm",0,0,function(){return""+Zt.apply(this)+z(this.minutes(),2)}),V("hmmss",0,0,function(){return""+Zt.apply(this)+z(this.minutes(),2)+z(this.seconds(),2)}),V("Hmm",0,0,function(){return""+this.hours()+z(this.minutes(),2)}),V("Hmmss",0,0,function(){return""+this.hours()+z(this.minutes(),2)+z(this.seconds(),2)}),Qt("a",!0),Qt("A",!1),N("hour","h"),A("hour",13),dt("a",Xt),dt("A",Xt),dt("H",Q),dt("h",Q),dt("HH",Q,J),dt("hh",Q,J),dt("hmm",X),dt("hmmss",tt),dt("Hmm",X),dt("Hmmss",tt),pt(["H","HH"],kt),pt(["a","A"],function(t,e,i){i._isPm=i._locale.isPM(t),i._meridiem=t}),pt(["h","hh"],function(t,e,i){e[kt]=y(t),d(i).bigHour=!0}),pt("hmm",function(t,e,i){var n=t.length-2;e[kt]=y(t.substr(0,n)),e[wt]=y(t.substr(n)),d(i).bigHour=!0}),pt("hmmss",function(t,e,i){var n=t.length-4,s=t.length-2;e[kt]=y(t.substr(0,n)),e[wt]=y(t.substr(n,2)),e[Mt]=y(t.substr(s)),d(i).bigHour=!0}),pt("Hmm",function(t,e,i){var n=t.length-2;e[kt]=y(t.substr(0,n)),e[wt]=y(t.substr(n))}),pt("Hmmss",function(t,e,i){var n=t.length-4,s=t.length-2;e[kt]=y(t.substr(0,n)),e[wt]=y(t.substr(n,2)),e[Mt]=y(t.substr(s))});var te,ee=L("Hours",!0),ie={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",ordinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Ct,monthsShort:Tt,week:{dow:0,doy:6},weekdays:Vt,weekdaysMin:$t,weekdaysShort:Wt,meridiemParse:/[ap]\.?m?\.?/i},ne={};function se(t){return t?t.toLowerCase().replace("_","-"):t}function oe(t){var e=null;if(!ne[t]&&"undefined"!=typeof module&&module&&module.exports)try{e=te._abbr,require("./locale/"+t),re(e)}catch(t){}return ne[t]}function re(t,e){var i;return t&&(i=m(e)?ce(t):ae(t,e))&&(te=i),te._abbr}function ae(t,e){if(null!==e){var i=ie;return e.abbr=t,null!=ne[t]?(B("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=ne[t]._config):null!=e.parentLocale&&(null!=ne[e.parentLocale]?i=ne[e.parentLocale]._config:B("parentLocaleUndefined","specified parentLocale is not defined yet. See http://momentjs.com/guides/#/warnings/parent-locale/")),ne[t]=new C(S(i,e)),re(t),ne[t]}return delete ne[t],null}function ce(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return te;if(!n(t)){if(e=oe(t))return e;t=[t]}return function(t){for(var e,i,n,s,o=0;o<t.length;){for(e=(s=se(t[o]).split("-")).length,i=(i=se(t[o+1]))?i.split("-"):null;e>0;){if(n=oe(s.slice(0,e).join("-")))return n;if(i&&i.length>=e&&k(s,i,!0)>=e-1)break;e--}o++}return null}(t)}function le(t){var e,i=t._a;return i&&-2===d(t).overflow&&(e=i[vt]<0||i[vt]>11?vt:i[yt]<1||i[yt]>It(i[bt],i[vt])?yt:i[kt]<0||i[kt]>24||24===i[kt]&&(0!==i[wt]||0!==i[Mt]||0!==i[xt])?kt:i[wt]<0||i[wt]>59?wt:i[Mt]<0||i[Mt]>59?Mt:i[xt]<0||i[xt]>999?xt:-1,d(t)._overflowDayOfYear&&(e<bt||e>yt)&&(e=yt),d(t)._overflowWeeks&&-1===e&&(e=Et),d(t)._overflowWeekday&&-1===e&&(e=Bt),d(t).overflow=e),t}var de=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,he=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?/,ue=/Z|[+-]\d\d(?::?\d\d)?/,me=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],pe=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],fe=/^\/?Date\((\-?\d+)/i;function _e(t){var e,i,n,s,o,r,a=t._i,c=de.exec(a)||he.exec(a);if(c){for(d(t).iso=!0,e=0,i=me.length;e<i;e++)if(me[e][1].exec(c[1])){s=me[e][0],n=!1!==me[e][2];break}if(null==s)return void(t._isValid=!1);if(c[3]){for(e=0,i=pe.length;e<i;e++)if(pe[e][1].exec(c[3])){o=(c[2]||" ")+pe[e][0];break}if(null==o)return void(t._isValid=!1)}if(!n&&null!=o)return void(t._isValid=!1);if(c[4]){if(!ue.exec(c[4]))return void(t._isValid=!1);r="Z"}t._f=s+(o||"")+(r||""),ve(t)}else t._isValid=!1}function ge(t,e,i){return null!=t?t:null!=e?e:i}function be(t){var e,n,s,o,r=[];if(!t._d){for(s=function(t){var e=new Date(i.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}(t),t._w&&null==t._a[yt]&&null==t._a[vt]&&function(t){var e,i,n,s,o,r,a,c;null!=(e=t._w).GG||null!=e.W||null!=e.E?(o=1,r=4,i=ge(e.GG,t._a[bt],Ht(we(),1,4).year),n=ge(e.W,1),((s=ge(e.E,1))<1||s>7)&&(c=!0)):(o=t._locale._week.dow,r=t._locale._week.doy,i=ge(e.gg,t._a[bt],Ht(we(),o,r).year),n=ge(e.w,1),null!=e.d?((s=e.d)<0||s>6)&&(c=!0):null!=e.e?(s=e.e+o,(e.e<0||e.e>6)&&(c=!0)):s=o);n<1||n>Ut(i,o,r)?d(t)._overflowWeeks=!0:null!=c?d(t)._overflowWeekday=!0:(a=qt(i,n,s,o,r),t._a[bt]=a.year,t._dayOfYear=a.dayOfYear)}(t),t._dayOfYear&&(o=ge(t._a[bt],s[bt]),t._dayOfYear>Lt(o)&&(d(t)._overflowDayOfYear=!0),n=zt(o,0,t._dayOfYear),t._a[vt]=n.getUTCMonth(),t._a[yt]=n.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=r[e]=s[e];for(;e<7;e++)t._a[e]=r[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[kt]&&0===t._a[wt]&&0===t._a[Mt]&&0===t._a[xt]&&(t._nextDay=!0,t._a[kt]=0),t._d=(t._useUTC?zt:function(t,e,i,n,s,o,r){var a=new Date(t,e,i,n,s,o,r);return t<100&&t>=0&&isFinite(a.getFullYear())&&a.setFullYear(t),a}).apply(null,r),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[kt]=24)}}function ve(t){if(t._f!==i.ISO_8601){t._a=[],d(t).empty=!0;var e,n,s,o,r,a=""+t._i,c=a.length,l=0;for(s=$(t._f,t._locale).match(F)||[],e=0;e<s.length;e++)o=s[e],(n=(a.match(ht(o,t))||[])[0])&&((r=a.substr(0,a.indexOf(n))).length>0&&d(t).unusedInput.push(r),a=a.slice(a.indexOf(n)+n.length),l+=n.length),U[o]?(n?d(t).empty=!1:d(t).unusedTokens.push(o),_t(o,n,t)):t._strict&&!n&&d(t).unusedTokens.push(o);d(t).charsLeftOver=c-l,a.length>0&&d(t).unusedInput.push(a),t._a[kt]<=12&&!0===d(t).bigHour&&t._a[kt]>0&&(d(t).bigHour=void 0),d(t).parsedDateParts=t._a.slice(0),d(t).meridiem=t._meridiem,t._a[kt]=function(t,e,i){var n;if(null==i)return e;return null!=t.meridiemHour?t.meridiemHour(e,i):null!=t.isPM?((n=t.isPM(i))&&e<12&&(e+=12),n||12!==e||(e=0),e):e}(t._locale,t._a[kt],t._meridiem),be(t),le(t)}else _e(t)}function ye(t){var e=t._i,s=t._f;return t._locale=t._locale||ce(t._l),null===e||void 0===s&&""===e?u({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),b(e)?new g(le(e)):(n(s)?function(t){var e,i,n,s,o;if(0===t._f.length)return d(t).invalidFormat=!0,void(t._d=new Date(NaN));for(s=0;s<t._f.length;s++)o=0,e=f({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[s],ve(e),h(e)&&(o+=d(e).charsLeftOver,o+=10*d(e).unusedTokens.length,d(e).score=o,(null==n||o<n)&&(n=o,i=e));c(t,i||e)}(t):o(e)?t._d=e:s?ve(t):function(t){var e=t._i;void 0===e?t._d=new Date(i.now()):o(e)?t._d=new Date(e.valueOf()):"string"==typeof e?function(t){var e=fe.exec(t._i);null===e?(_e(t),!1===t._isValid&&(delete t._isValid,i.createFromInputFallback(t))):t._d=new Date(+e[1])}(t):n(e)?(t._a=r(e.slice(0),function(t){return parseInt(t,10)}),be(t)):"object"==typeof e?function(t){if(!t._d){var e=O(t._i);t._a=r([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),be(t)}}(t):"number"==typeof e?t._d=new Date(e):i.createFromInputFallback(t)}(t),h(t)||(t._d=null),t))}function ke(t,e,i,o,r){var a,c={};return"boolean"==typeof i&&(o=i,i=void 0),(s(t)&&function(t){var e;for(e in t)return!1;return!0}(t)||n(t)&&0===t.length)&&(t=void 0),c._isAMomentObject=!0,c._useUTC=c._isUTC=r,c._l=i,c._i=t,c._f=e,c._strict=o,(a=new g(le(ye(c))))._nextDay&&(a.add(1,"d"),a._nextDay=void 0),a}function we(t,e,i,n){return ke(t,e,i,n,!1)}i.createFromInputFallback=M("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),i.ISO_8601=function(){};var Me=M("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=we.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:u()}),xe=M("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=we.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:u()});function Ee(t,e){var i,s;if(1===e.length&&n(e[0])&&(e=e[0]),!e.length)return we();for(i=e[0],s=1;s<e.length;++s)e[s].isValid()&&!e[s][t](i)||(i=e[s]);return i}function Be(t){var e=O(t),i=e.year||0,n=e.quarter||0,s=e.month||0,o=e.week||0,r=e.day||0,a=e.hour||0,c=e.minute||0,l=e.second||0,d=e.millisecond||0;this._milliseconds=+d+1e3*l+6e4*c+1e3*a*60*60,this._days=+r+7*o,this._months=+s+3*n+12*i,this._data={},this._locale=ce(),this._bubble()}function Ie(t){return t instanceof Be}function Se(t,e){V(t,0,0,function(){var t=this.utcOffset(),i="+";return t<0&&(t=-t,i="-"),i+z(~~(t/60),2)+e+z(~~t%60,2)})}Se("Z",":"),Se("ZZ",""),dt("Z",at),dt("ZZ",at),pt(["Z","ZZ"],function(t,e,i){i._useUTC=!0,i._tzm=Te(at,t)});var Ce=/([\+\-]|\d\d)/gi;function Te(t,e){var i=(e||"").match(t)||[],n=((i[i.length-1]||[])+"").match(Ce)||["-",0,0],s=60*n[1]+y(n[2]);return"+"===n[0]?s:-s}function Ne(t,e){var n,s;return e._isUTC?(n=e.clone(),s=(b(t)||o(t)?t.valueOf():we(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+s),i.updateOffset(n,!1),n):we(t).local()}function De(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function Oe(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}i.updateOffset=function(){};var Pe=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?\d*)?$/,Ae=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;function Le(t,e){var i,n,s,o=t,r=null;return Ie(t)?o={ms:t._milliseconds,d:t._days,M:t._months}:"number"==typeof t?(o={},e?o[e]=t:o.milliseconds=t):(r=Pe.exec(t))?(i="-"===r[1]?-1:1,o={y:0,d:y(r[yt])*i,h:y(r[kt])*i,m:y(r[wt])*i,s:y(r[Mt])*i,ms:y(r[xt])*i}):(r=Ae.exec(t))?(i="-"===r[1]?-1:1,o={y:je(r[2],i),M:je(r[3],i),w:je(r[4],i),d:je(r[5],i),h:je(r[6],i),m:je(r[7],i),s:je(r[8],i)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(s=function(t,e){var i;if(!t.isValid()||!e.isValid())return{milliseconds:0,months:0};e=Ne(e,t),t.isBefore(e)?i=Re(t,e):((i=Re(e,t)).milliseconds=-i.milliseconds,i.months=-i.months);return i}(we(o.from),we(o.to)),(o={}).ms=s.milliseconds,o.M=s.months),n=new Be(o),Ie(t)&&a(t,"_locale")&&(n._locale=t._locale),n}function je(t,e){var i=t&&parseFloat(t.replace(",","."));return(isNaN(i)?0:i)*e}function Re(t,e){var i={milliseconds:0,months:0};return i.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(i.months,"M").isAfter(e)&&--i.months,i.milliseconds=+e-+t.clone().add(i.months,"M"),i}function ze(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function Fe(t,e){return function(i,n){var s;return null===n||isNaN(+n)||(B(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=i,i=n,n=s),qe(this,Le(i="string"==typeof i?+i:i,n),t),this}}function qe(t,e,n,s){var o=e._milliseconds,r=ze(e._days),a=ze(e._months);t.isValid()&&(s=null==s||s,o&&t._d.setTime(t._d.valueOf()+o*n),r&&R(t,"Date",j(t,"Date")+r*n),a&&Nt(t,j(t,"Month")+a*n),s&&i.updateOffset(t,r||a))}Le.fn=Be.prototype;var He=Fe(1,"add"),Ue=Fe(-1,"subtract");function Ve(t){var e;return void 0===t?this._locale._abbr:(null!=(e=ce(t))&&(this._locale=e),this)}i.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",i.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var We=M("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});function $e(){return this._locale}function Ge(t,e){V(0,[t,t.length],0,e)}function Je(t,e,i,n,s){var o;return null==t?Ht(this,n,s).year:(e>(o=Ut(t,n,s))&&(e=o),function(t,e,i,n,s){var o=qt(t,e,i,n,s),r=zt(o.year,0,o.dayOfYear);return this.year(r.getUTCFullYear()),this.month(r.getUTCMonth()),this.date(r.getUTCDate()),this}.call(this,t,e,i,n,s))}V(0,["gg",2],0,function(){return this.weekYear()%100}),V(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ge("gggg","weekYear"),Ge("ggggg","weekYear"),Ge("GGGG","isoWeekYear"),Ge("GGGGG","isoWeekYear"),N("weekYear","gg"),N("isoWeekYear","GG"),A("weekYear",1),A("isoWeekYear",1),dt("G",ot),dt("g",ot),dt("GG",Q,J),dt("gg",Q,J),dt("GGGG",it,K),dt("gggg",it,K),dt("GGGGG",nt,Z),dt("ggggg",nt,Z),ft(["gggg","ggggg","GGGG","GGGGG"],function(t,e,i,n){e[n.substr(0,2)]=y(t)}),ft(["gg","GG"],function(t,e,n,s){e[s]=i.parseTwoDigitYear(t)}),V("Q",0,"Qo","quarter"),N("quarter","Q"),A("quarter",7),dt("Q",G),pt("Q",function(t,e){e[vt]=3*(y(t)-1)}),V("D",["DD",2],"Do","date"),N("date","D"),A("date",9),dt("D",Q),dt("DD",Q,J),dt("Do",function(t,e){return t?e._ordinalParse:e._ordinalParseLenient}),pt(["D","DD"],yt),pt("Do",function(t,e){e[yt]=y(t.match(Q)[0])});var Ye=L("Date",!0);V("DDD",["DDDD",3],"DDDo","dayOfYear"),N("dayOfYear","DDD"),A("dayOfYear",4),dt("DDD",et),dt("DDDD",Y),pt(["DDD","DDDD"],function(t,e,i){i._dayOfYear=y(t)}),V("m",["mm",2],0,"minute"),N("minute","m"),A("minute",14),dt("m",Q),dt("mm",Q,J),pt(["m","mm"],wt);var Ke=L("Minutes",!1);V("s",["ss",2],0,"second"),N("second","s"),A("second",15),dt("s",Q),dt("ss",Q,J),pt(["s","ss"],Mt);var Ze,Qe=L("Seconds",!1);for(V("S",0,0,function(){return~~(this.millisecond()/100)}),V(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),V(0,["SSS",3],0,"millisecond"),V(0,["SSSS",4],0,function(){return 10*this.millisecond()}),V(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),V(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),V(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),V(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),V(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),N("millisecond","ms"),A("millisecond",16),dt("S",et,G),dt("SS",et,J),dt("SSS",et,Y),Ze="SSSS";Ze.length<=9;Ze+="S")dt(Ze,st);function Xe(t,e){e[xt]=y(1e3*("0."+t))}for(Ze="S";Ze.length<=9;Ze+="S")pt(Ze,Xe);var ti=L("Milliseconds",!1);V("z",0,0,"zoneAbbr"),V("zz",0,0,"zoneName");var ei=g.prototype;ei.add=He,ei.calendar=function(t,e){var n=t||we(),s=Ne(n,this).startOf("day"),o=i.calendarFormat(this,s)||"sameElse",r=e&&(I(e[o])?e[o].call(this,n):e[o]);return this.format(r||this.localeData().calendar(o,this,we(n)))},ei.clone=function(){return new g(this)},ei.diff=function(t,e,i){var n,s,o,r;return this.isValid()&&(n=Ne(t,this)).isValid()?(s=6e4*(n.utcOffset()-this.utcOffset()),"year"===(e=D(e))||"month"===e||"quarter"===e?(a=this,c=n,h=12*(c.year()-a.year())+(c.month()-a.month()),u=a.clone().add(h,"months"),c-u<0?(l=a.clone().add(h-1,"months"),d=(c-u)/(u-l)):(l=a.clone().add(h+1,"months"),d=(c-u)/(l-u)),r=-(h+d)||0,"quarter"===e?r/=3:"year"===e&&(r/=12)):(o=this-n,r="second"===e?o/1e3:"minute"===e?o/6e4:"hour"===e?o/36e5:"day"===e?(o-s)/864e5:"week"===e?(o-s)/6048e5:o),i?r:v(r)):NaN;var a,c,l,d,h,u},ei.endOf=function(t){return void 0===(t=D(t))||"millisecond"===t?this:("date"===t&&(t="day"),this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms"))},ei.format=function(t){t||(t=this.isUtc()?i.defaultFormatUtc:i.defaultFormat);var e=W(this,t);return this.localeData().postformat(e)},ei.from=function(t,e){return this.isValid()&&(b(t)&&t.isValid()||we(t).isValid())?Le({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},ei.fromNow=function(t){return this.from(we(),t)},ei.to=function(t,e){return this.isValid()&&(b(t)&&t.isValid()||we(t).isValid())?Le({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()},ei.toNow=function(t){return this.to(we(),t)},ei.get=function(t){return I(this[t=D(t)])?this[t]():this},ei.invalidAt=function(){return d(this).overflow},ei.isAfter=function(t,e){var i=b(t)?t:we(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=D(m(e)?"millisecond":e))?this.valueOf()>i.valueOf():i.valueOf()<this.clone().startOf(e).valueOf())},ei.isBefore=function(t,e){var i=b(t)?t:we(t);return!(!this.isValid()||!i.isValid())&&("millisecond"===(e=D(m(e)?"millisecond":e))?this.valueOf()<i.valueOf():this.clone().endOf(e).valueOf()<i.valueOf())},ei.isBetween=function(t,e,i,n){return("("===(n=n||"()")[0]?this.isAfter(t,i):!this.isBefore(t,i))&&(")"===n[1]?this.isBefore(e,i):!this.isAfter(e,i))},ei.isSame=function(t,e){var i,n=b(t)?t:we(t);return!(!this.isValid()||!n.isValid())&&("millisecond"===(e=D(e||"millisecond"))?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf()))},ei.isSameOrAfter=function(t,e){return this.isSame(t,e)||this.isAfter(t,e)},ei.isSameOrBefore=function(t,e){return this.isSame(t,e)||this.isBefore(t,e)},ei.isValid=function(){return h(this)},ei.lang=We,ei.locale=Ve,ei.localeData=$e,ei.max=xe,ei.min=Me,ei.parsingFlags=function(){return c({},d(this))},ei.set=function(t,e){if("object"==typeof t)for(var i=function(t){var e=[];for(var i in t)e.push({unit:i,priority:P[i]});return e.sort(function(t,e){return t.priority-e.priority}),e}(t=O(t)),n=0;n<i.length;n++)this[i[n].unit](t[i[n].unit]);else if(I(this[t=D(t)]))return this[t](e);return this},ei.startOf=function(t){switch(t=D(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t&&this.weekday(0),"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this},ei.subtract=Ue,ei.toArray=function(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]},ei.toObject=function(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}},ei.toDate=function(){return new Date(this.valueOf())},ei.toISOString=function(){var t=this.clone().utc();return 0<t.year()&&t.year()<=9999?I(Date.prototype.toISOString)?this.toDate().toISOString():W(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):W(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},ei.toJSON=function(){return this.isValid()?this.toISOString():null},ei.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},ei.unix=function(){return Math.floor(this.valueOf()/1e3)},ei.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},ei.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},ei.year=Rt,ei.isLeapYear=function(){return jt(this.year())},ei.weekYear=function(t){return Je.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},ei.isoWeekYear=function(t){return Je.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)},ei.quarter=ei.quarters=function(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)},ei.month=Dt,ei.daysInMonth=function(){return It(this.year(),this.month())},ei.week=ei.weeks=function(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")},ei.isoWeek=ei.isoWeeks=function(t){var e=Ht(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")},ei.weeksInYear=function(){var t=this.localeData()._week;return Ut(this.year(),t.dow,t.doy)},ei.isoWeeksInYear=function(){return Ut(this.year(),1,4)},ei.date=Ye,ei.day=ei.days=function(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=function(t,e){return"string"!=typeof t?t:isNaN(t)?"number"==typeof(t=e.weekdaysParse(t))?t:null:parseInt(t,10)}(t,this.localeData()),this.add(t-e,"d")):e},ei.weekday=function(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")},ei.isoWeekday=function(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=function(t,e){return"string"==typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7},ei.dayOfYear=function(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")},ei.hour=ei.hours=ee,ei.minute=ei.minutes=Ke,ei.second=ei.seconds=Qe,ei.millisecond=ei.milliseconds=ti,ei.utcOffset=function(t,e){var n,s=this._offset||0;return this.isValid()?null!=t?("string"==typeof t?t=Te(at,t):Math.abs(t)<16&&(t*=60),!this._isUTC&&e&&(n=De(this)),this._offset=t,this._isUTC=!0,null!=n&&this.add(n,"m"),s!==t&&(!e||this._changeInProgress?qe(this,Le(t-s,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,i.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?s:De(this):null!=t?this:NaN},ei.utc=function(t){return this.utcOffset(0,t)},ei.local=function(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(De(this),"m")),this},ei.parseZone=function(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Te(rt,this._i)),this},ei.hasAlignedHourOffset=function(t){return!!this.isValid()&&(t=t?we(t).utcOffset():0,(this.utcOffset()-t)%60==0)},ei.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},ei.isLocal=function(){return!!this.isValid()&&!this._isUTC},ei.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},ei.isUtc=Oe,ei.isUTC=Oe,ei.zoneAbbr=function(){return this._isUTC?"UTC":""},ei.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},ei.dates=M("dates accessor is deprecated. Use date instead.",Ye),ei.months=M("months accessor is deprecated. Use month instead",Dt),ei.years=M("years accessor is deprecated. Use year instead",Rt),ei.zone=M("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}),ei.isDSTShifted=M("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!m(this._isDSTShifted))return this._isDSTShifted;var t={};if(f(t,this),(t=ye(t))._a){var e=t._isUTC?l(t._a):we(t._a);this._isDSTShifted=this.isValid()&&k(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted});var ii=ei;function ni(t){return t}var si=C.prototype;function oi(t,e,i,n){var s=ce(),o=l().set(n,e);return s[i](o,t)}function ri(t,e,i){if("number"==typeof t&&(e=t,t=void 0),t=t||"",null!=e)return oi(t,e,i,"month");var n,s=[];for(n=0;n<12;n++)s[n]=oi(t,n,i,"month");return s}function ai(t,e,i,n){"boolean"==typeof t?("number"==typeof e&&(i=e,e=void 0),e=e||""):(i=e=t,t=!1,"number"==typeof e&&(i=e,e=void 0),e=e||"");var s,o=ce(),r=t?o._week.dow:0;if(null!=i)return oi(e,(i+r)%7,n,"day");var a=[];for(s=0;s<7;s++)a[s]=oi(e,(s+r)%7,n,"day");return a}si.calendar=function(t,e,i){var n=this._calendar[t]||this._calendar.sameElse;return I(n)?n.call(e,i):n},si.longDateFormat=function(t){var e=this._longDateFormat[t],i=this._longDateFormat[t.toUpperCase()];return e||!i?e:(this._longDateFormat[t]=i.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])},si.invalidDate=function(){return this._invalidDate},si.ordinal=function(t){return this._ordinal.replace("%d",t)},si.preparse=ni,si.postformat=ni,si.relativeTime=function(t,e,i,n){var s=this._relativeTime[i];return I(s)?s(t,e,i,n):s.replace(/%d/i,t)},si.pastFuture=function(t,e){var i=this._relativeTime[t>0?"future":"past"];return I(i)?i(e):i.replace(/%s/i,e)},si.set=function(t){var e,i;for(i in t)I(e=t[i])?this[i]=e:this["_"+i]=e;this._config=t,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},si.months=function(t,e){return n(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||St).test(e)?"format":"standalone"][t.month()]},si.monthsShort=function(t,e){return n(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[St.test(e)?"format":"standalone"][t.month()]},si.monthsParse=function(t,e,i){var n,s,o;if(this._monthsParseExact)return function(t,e,i){var n,s,o,r=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=l([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return i?"MMM"===e?-1!==(s=gt.call(this._shortMonthsParse,r))?s:null:-1!==(s=gt.call(this._longMonthsParse,r))?s:null:"MMM"===e?-1!==(s=gt.call(this._shortMonthsParse,r))?s:-1!==(s=gt.call(this._longMonthsParse,r))?s:null:-1!==(s=gt.call(this._longMonthsParse,r))?s:-1!==(s=gt.call(this._shortMonthsParse,r))?s:null}.call(this,t,e,i);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(s=l([2e3,n]),i&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),i||this._monthsParse[n]||(o="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),i&&"MMMM"===e&&this._longMonthsParse[n].test(t))return n;if(i&&"MMM"===e&&this._shortMonthsParse[n].test(t))return n;if(!i&&this._monthsParse[n].test(t))return n}},si.monthsRegex=function(t){return this._monthsParseExact?(a(this,"_monthsRegex")||At.call(this),t?this._monthsStrictRegex:this._monthsRegex):(a(this,"_monthsRegex")||(this._monthsRegex=Pt),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)},si.monthsShortRegex=function(t){return this._monthsParseExact?(a(this,"_monthsRegex")||At.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(a(this,"_monthsShortRegex")||(this._monthsShortRegex=Ot),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)},si.week=function(t){return Ht(t,this._week.dow,this._week.doy).week},si.firstDayOfYear=function(){return this._week.doy},si.firstDayOfWeek=function(){return this._week.dow},si.weekdays=function(t,e){return n(this._weekdays)?this._weekdays[t.day()]:this._weekdays[this._weekdays.isFormat.test(e)?"format":"standalone"][t.day()]},si.weekdaysMin=function(t){return this._weekdaysMin[t.day()]},si.weekdaysShort=function(t){return this._weekdaysShort[t.day()]},si.weekdaysParse=function(t,e,i){var n,s,o;if(this._weekdaysParseExact)return function(t,e,i){var n,s,o,r=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=l([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return i?"dddd"===e?-1!==(s=gt.call(this._weekdaysParse,r))?s:null:"ddd"===e?-1!==(s=gt.call(this._shortWeekdaysParse,r))?s:null:-1!==(s=gt.call(this._minWeekdaysParse,r))?s:null:"dddd"===e?-1!==(s=gt.call(this._weekdaysParse,r))?s:-1!==(s=gt.call(this._shortWeekdaysParse,r))?s:-1!==(s=gt.call(this._minWeekdaysParse,r))?s:null:"ddd"===e?-1!==(s=gt.call(this._shortWeekdaysParse,r))?s:-1!==(s=gt.call(this._weekdaysParse,r))?s:-1!==(s=gt.call(this._minWeekdaysParse,r))?s:null:-1!==(s=gt.call(this._minWeekdaysParse,r))?s:-1!==(s=gt.call(this._weekdaysParse,r))?s:-1!==(s=gt.call(this._shortWeekdaysParse,r))?s:null}.call(this,t,e,i);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(s=l([2e3,1]).day(n),i&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(s,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(s,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(s,"").replace(".",".?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),i&&"dddd"===e&&this._fullWeekdaysParse[n].test(t))return n;if(i&&"ddd"===e&&this._shortWeekdaysParse[n].test(t))return n;if(i&&"dd"===e&&this._minWeekdaysParse[n].test(t))return n;if(!i&&this._weekdaysParse[n].test(t))return n}},si.weekdaysRegex=function(t){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Kt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(a(this,"_weekdaysRegex")||(this._weekdaysRegex=Gt),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)},si.weekdaysShortRegex=function(t){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Kt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(a(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Jt),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},si.weekdaysMinRegex=function(t){return this._weekdaysParseExact?(a(this,"_weekdaysRegex")||Kt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(a(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Yt),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},si.isPM=function(t){return"p"===(t+"").toLowerCase().charAt(0)},si.meridiem=function(t,e,i){return t>11?i?"pm":"PM":i?"am":"AM"},re("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===y(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),i.lang=M("moment.lang is deprecated. Use moment.locale instead.",re),i.langData=M("moment.langData is deprecated. Use moment.localeData instead.",ce);var ci=Math.abs;function li(t,e,i,n){var s=Le(e,i);return t._milliseconds+=n*s._milliseconds,t._days+=n*s._days,t._months+=n*s._months,t._bubble()}function di(t){return t<0?Math.floor(t):Math.ceil(t)}function hi(t){return 4800*t/146097}function ui(t){return 146097*t/4800}function mi(t){return function(){return this.as(t)}}var pi=mi("ms"),fi=mi("s"),_i=mi("m"),gi=mi("h"),bi=mi("d"),vi=mi("w"),yi=mi("M"),ki=mi("y");function wi(t){return function(){return this._data[t]}}var Mi=wi("milliseconds"),xi=wi("seconds"),Ei=wi("minutes"),Bi=wi("hours"),Ii=wi("days"),Si=wi("months"),Ci=wi("years");var Ti=Math.round,Ni={s:45,m:45,h:22,d:26,M:11};var Di=Math.abs;function Oi(){var t,e,i=Di(this._milliseconds)/1e3,n=Di(this._days),s=Di(this._months);e=v((t=v(i/60))/60),i%=60,t%=60;var o=v(s/12),r=s%=12,a=n,c=e,l=t,d=i,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(o?o+"Y":"")+(r?r+"M":"")+(a?a+"D":"")+(c||l||d?"T":"")+(c?c+"H":"")+(l?l+"M":"")+(d?d+"S":""):"P0D"}var Pi=Be.prototype;return Pi.abs=function(){var t=this._data;return this._milliseconds=ci(this._milliseconds),this._days=ci(this._days),this._months=ci(this._months),t.milliseconds=ci(t.milliseconds),t.seconds=ci(t.seconds),t.minutes=ci(t.minutes),t.hours=ci(t.hours),t.months=ci(t.months),t.years=ci(t.years),this},Pi.add=function(t,e){return li(this,t,e,1)},Pi.subtract=function(t,e){return li(this,t,e,-1)},Pi.as=function(t){var e,i,n=this._milliseconds;if("month"===(t=D(t))||"year"===t)return e=this._days+n/864e5,i=this._months+hi(e),"month"===t?i:i/12;switch(e=this._days+Math.round(ui(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return 24*e+n/36e5;case"minute":return 1440*e+n/6e4;case"second":return 86400*e+n/1e3;case"millisecond":return Math.floor(864e5*e)+n;default:throw new Error("Unknown unit "+t)}},Pi.asMilliseconds=pi,Pi.asSeconds=fi,Pi.asMinutes=_i,Pi.asHours=gi,Pi.asDays=bi,Pi.asWeeks=vi,Pi.asMonths=yi,Pi.asYears=ki,Pi.valueOf=function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*y(this._months/12)},Pi._bubble=function(){var t,e,i,n,s,o=this._milliseconds,r=this._days,a=this._months,c=this._data;return o>=0&&r>=0&&a>=0||o<=0&&r<=0&&a<=0||(o+=864e5*di(ui(a)+r),r=0,a=0),c.milliseconds=o%1e3,t=v(o/1e3),c.seconds=t%60,e=v(t/60),c.minutes=e%60,i=v(e/60),c.hours=i%24,a+=s=v(hi(r+=v(i/24))),r-=di(ui(s)),n=v(a/12),a%=12,c.days=r,c.months=a,c.years=n,this},Pi.get=function(t){return this[(t=D(t))+"s"]()},Pi.milliseconds=Mi,Pi.seconds=xi,Pi.minutes=Ei,Pi.hours=Bi,Pi.days=Ii,Pi.weeks=function(){return v(this.days()/7)},Pi.months=Si,Pi.years=Ci,Pi.humanize=function(t){var e=this.localeData(),i=function(t,e,i){var n=Le(t).abs(),s=Ti(n.as("s")),o=Ti(n.as("m")),r=Ti(n.as("h")),a=Ti(n.as("d")),c=Ti(n.as("M")),l=Ti(n.as("y")),d=s<Ni.s&&["s",s]||o<=1&&["m"]||o<Ni.m&&["mm",o]||r<=1&&["h"]||r<Ni.h&&["hh",r]||a<=1&&["d"]||a<Ni.d&&["dd",a]||c<=1&&["M"]||c<Ni.M&&["MM",c]||l<=1&&["y"]||["yy",l];return d[2]=e,d[3]=+t>0,d[4]=i,function(t,e,i,n,s){return s.relativeTime(e||1,!!i,t,n)}.apply(null,d)}(this,!t,e);return t&&(i=e.pastFuture(+this,i)),e.postformat(i)},Pi.toISOString=Oi,Pi.toString=Oi,Pi.toJSON=Oi,Pi.locale=Ve,Pi.localeData=$e,Pi.toIsoString=M("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Oi),Pi.lang=We,V("X",0,0,"unix"),V("x",0,0,"valueOf"),dt("x",ot),dt("X",/[+-]?\d+(\.\d{1,3})?/),pt("X",function(t,e,i){i._d=new Date(1e3*parseFloat(t,10))}),pt("x",function(t,e,i){i._d=new Date(y(t))}),i.version="2.14.1",t=we,i.fn=ii,i.min=function(){return Ee("isBefore",[].slice.call(arguments,0))},i.max=function(){return Ee("isAfter",[].slice.call(arguments,0))},i.now=function(){return Date.now?Date.now():+new Date},i.utc=l,i.unix=function(t){return we(1e3*t)},i.months=function(t,e){return ri(t,e,"months")},i.isDate=o,i.locale=re,i.invalid=u,i.duration=Le,i.isMoment=b,i.weekdays=function(t,e,i){return ai(t,e,i,"weekdays")},i.parseZone=function(){return we.apply(null,arguments).parseZone()},i.localeData=ce,i.isDuration=Ie,i.monthsShort=function(t,e){return ri(t,e,"monthsShort")},i.weekdaysMin=function(t,e,i){return ai(t,e,i,"weekdaysMin")},i.defineLocale=ae,i.updateLocale=function(t,e){if(null!=e){var i,n=ie;null!=ne[t]&&(n=ne[t]._config),(i=new C(e=S(n,e))).parentLocale=ne[t],ne[t]=i,re(t)}else null!=ne[t]&&(null!=ne[t].parentLocale?ne[t]=ne[t].parentLocale:null!=ne[t]&&delete ne[t]);return ne[t]},i.locales=function(){return x(ne)},i.weekdaysShort=function(t,e,i){return ai(t,e,i,"weekdaysShort")},i.normalizeUnits=D,i.relativeTimeRounding=function(t){return void 0===t?Ti:"function"==typeof t&&(Ti=t,!0)},i.relativeTimeThreshold=function(t,e){return void 0!==Ni[t]&&(void 0===e?Ni[t]:(Ni[t]=e,!0))},i.calendarFormat=function(t,e){var i=t.diff(e,"days",!0);return i<-6?"sameElse":i<-1?"lastWeek":i<0?"lastDay":i<1?"sameDay":i<2?"nextDay":i<7?"nextWeek":"sameElse"},i.prototype=ii,i}),jQuery.fn.snicked=function(t){var e,i,n=this.snickedCore(),s={};return t&&(s=t.autocomplete,t.indentation),e={rule:null},i={next:function(t,i){var n=e.rule.points.shift(),s=t.val().length;return e.rule.offset+=s-e.rule.length,e.rule.length=s,i.start=n+e.rule.offset,i.end=i.start,t.setSelection(i),0!=e.rule.points.length||(e.rule=null,!0)},start:function(t,n,o,r,a){var c,l,d,h=a.snippet,u=null,m=t.getIndentation(),p=h.split("\n"),f=o.match(a.beforeToReplace||a.before).concat(r.match(a.after));if(a.increment&&(c=parseInt(f[a.increment]),f[a.increment]=f[a.increment].replace(c,c+1)),a.orderedListLevelDown){if(f[1]=f[1].substr(0,f[1].length-2),l=f[1].length,!(d=("\n"+o).match(new RegExp("(\\n {0,"+l+"})((([\\w]{1}|[0-9]{1,3})\\.)|\\*)(\\+(?= )| |\\#(?=[0-9]+ )).+\\n( {"+(l+2)+",}((\\*)|([\\w]+\\.))(\\+(?= )| |\\#(?=[0-9]+ )).*\\n*)+$"))))return{nextRule:s.rules["numbered"===a.orderedListLevelDown?22:17]};(c=parseInt(d[2]))?f[2]=f[2].replace(f[2],c+1+"."):c||(f[2]=d[2])}for(t.setBefore(n,o.replace(a.beforeToReplace||a.before,"")),t.setAfter(n,r.replace(a.after,"")),o=t.getBefore(n),r=t.getAfter(n),h=(p=jQuery(p).map(function(t,e){return t?m+e:e})).get().join("\n"),e.rule={length:0,offset:0,selection:n,points:[]};u=h.match(/\{#([0-9]+)\}/);){var _=parseInt(u[1]);h=f[_]?h.replace(u[0],f[_]):h.replace(u[0],"")}for(;u=h.match(/\{\$[0-9]+\}/);)e.rule.points.push(h.indexOf(u[0])+o.length),h=h.replace(u[0],"");return e.rule.points.length?(t.insertBefore(n,h),e.rule.length=t.val().length,e.rule.position=o.length,i.next(t,n),!0):(o+=h,e.rule=null,t.setBefore(n,o),!0)}},n.addKeyHandler(function(t,n,o){var r=t.getSelection(),a=t.getBefore(r);if(!e.rule&&s.keys[n]){var c=s.keys[n],l=t.getAfter(r),d=!1,h=function(e,n){return n.key!=c||(n.before||(n.before=/$/),n.after||(n.after=/^/),!n.before.test("\n"+a)||!n.after.test(l)||((d=i.start(t,r,a,l,n)).nextRule&&h(null,d.nextRule),!1))};return jQuery(s.rules).each(h),d}return!1}),n},jQuery.fn.snickedCore=function(){var t=this;return(t=t.map(function(){var t=jQuery(this);return t.getIndentation=function(){return t.selection.getPrecedingText().match(/(\t*).*$/).pop()},t.getSelection=function(){var e=t.get(0);return{start:e.selectionStart,end:e.selectionEnd}},t.setSelection=function(e){var i=t.get(0);i.selectionStart=e.start,i.selectionEnd=e.end},t.getAfter=function(e){t.get(0);return t.val().slice(e.end)},t.insertAfter=function(e,i){var n=t.getAfter(e);t.setAfter(e,i+n)},t.setAfter=function(e,i){var n=t.val().slice(0,e.end);t.val(n+i),t.setSelection(e)},t.getBefore=function(e){return t.val().slice(0,e.start)},t.insertBefore=function(e,i){var n=t.getBefore(e);t.setBefore(e,n+i)},t.setBefore=function(e,i){var n=t.val().slice(0,e.start),s=t.val().slice(e.start),o=n.length-i.length;e.start-=o,e.end-=o,t.val(i+s),t.setSelection(e)},t.selection={},t.selection.getRange=function(){var e=t.get(0);return{start:e.selectionStart,end:e.selectionEnd}},t.selection.setRange=function(e,i){var n=t.get(0);(!i||i<e)&&(i=e),n.selectionStart=e,n.selectionEnd=i},t.selection.getText=function(){var e=t.get(0);return t.val().slice(e.selectionStart,e.selectionEnd)},t.selection.setText=function(e){var i=t.selection.getPrecedingText(),n=t.selection.getFollowingText();t.val(i+e+n),t.selection.setRange(i.length,i.length+e.length)},t.selection.prependText=function(e){t.selection.setText(e+t.selection.getText())},t.selection.appendText=function(e){t.selection.setText(t.selection.getText()+e)},t.selection.getFollowingText=function(){var e=t.get(0);return t.val().slice(e.selectionEnd)},t.selection.setFollowingText=function(e){var i=t.selection.getRange(),n=t.val().slice(0,i.end);t.val(n+e),t.selection.setRange(i.start,i.end)},t.selection.getPrecedingText=function(){return t.val().slice(0,t.get(0).selectionStart)},t.selection.setPrecedingText=function(e){var i=t.selection.getRange(),n=t.val().slice(0,i.start),s=t.val().slice(i.end),o=n.length-e.length;t.val(e+s),t.selection.setRange(i.start-o,i.end-o)},t.selection.insertTextBefore=function(e){var i=t.selection.getPrecedingText();t.selection.setPrecedingText(i+e)},t.selection.insertTextAfter=function(e){var i=t.selection.getFollowingText();t.selection.setFollowingText(e+i)},t.changeHandlers=[],t.addChangeHandler=function(e){t.changeHandlers.push(e)},t.bind("change",function(e){var i=!1;return jQuery(t.changeHandlers).each(function(){return!this(t,e)||(i=!0,!1)}),!i}),t.keyHandlers=[],t.addKeyHandler=function(e){t.keyHandlers.push(e)},t.bind("keypress",function(e){var i=e.keyCode|e.charCode|e.which,n=!1;return jQuery(t.keyHandlers).each(function(){return!this(t,i,e)||(n=!0,!1)}),!n}),t.selectHandlers=[],t.addSelectHandler=function(e){t.selectHandlers.push(e)},t.bind("select",function(e){var i=!1;return jQuery(t.selectHandlers).each(function(){return!this(t,e)||(i=!0,!1)}),!i}),t})).addChangeHandler=function(e){t.each(function(){this.addChangeHandler(e)})},t.addKeyHandler=function(e){t.each(function(){this.addKeyHandler(e)})},t.addSelectHandler=function(e){t.each(function(){this.addSelectHandler(e)})},t},jQuery.fn.snickedWackowiki=function(){jQuery(this).snicked({autocomplete:{keys:{9:"tab",13:"enter",32:"space",16:"star"},rules:[{key:"tab",before:/(\*\*)\s*$/,snippet:"{#1}{$0}{#1} {$1}"},{key:"tab",before:/(\/\/)\s*$/,snippet:"{#1}{$0}{#1} {$1}"},{key:"tab",before:/(__)\s*$/,snippet:"{#1}{$0}{#1} {$1}"},{key:"tab",before:/(##)\s*$/,snippet:"{#1}{$0}{#1} {$1}"},{key:"tab",before:/(\+\+)\s*$/,snippet:"{#1}{$0}{#1} {$1}"},{key:"tab",before:/(\-\-)\s*$/,snippet:"{#1}{$0}{#1} {$1}"},{key:"tab",before:/(\!\!)\s*$/,snippet:"{#1}({$0}){$1}{#1} {$2}"},{key:"tab",before:/(%%)\s*$/,snippet:"{#1}({$0}){$1}{#1} {$2}"},{key:"tab",before:/(\(\?)\s*$/,snippet:"(?{$0}=={$1}?) {$2}"},{key:"tab",before:/<{\s*$/,snippet:"\n<{ {$0}\n>} {$1}"},{key:"tab",before:/<#\s*$/,snippet:"<# {$0} #> {$1}"},{key:"tab",before:/\^\^\s*$/,snippet:"^^{$0}^^ {$1}"},{key:"tab",before:/""""vv\s*$/,snippet:'""""vv{$0}vv"""" {$1}'},{key:"tab",before:/vv\s*$/,snippet:"vv{$0}vv {$1}"},{key:"tab",before:/\*$/,snippet:"{#1}\n  * {$0}"},{key:"tab",before:/( {2,}\*.*?)\s*$/,snippet:"  {#1} {$0}"},{key:"enter",orderedListLevelDown:"unnumbered",before:/( {2,})(\*) +$/,snippet:"{#1}{#2} {$0}"},{key:"enter",before:/\n+ *\* +$/,beforeToReplace:/ *\* +$/,snippet:"{$0}"},{key:"enter",before:/([\n\s]+)\*(\+(?= )| ).*$/,beforeToReplace:/( *)\*(\+(?= )| ).*$/,snippet:"{#0}\n{#1}* {$0}"},{key:"tab",before:/(\D*)([0-9]+)$/,snippet:"{#1}\n  {#2}. {$0}"},{key:"tab",before:/( {2,}([\w]{1}|[0-9]{1,3})\..*?)\s*$/,snippet:"  {#1} {$0}"},{key:"enter",orderedListLevelDown:"numbered",before:/( {2,})(([\w]{1}|[0-9]{1,3})\.) +$/,snippet:"{#1}{#2} {$0}"},{key:"enter",before:/\n+ *([\w]{1}|[0-9]{1,3})\. +$/,beforeToReplace:/ *([\w]{1}|[0-9]{1,3})\. +$/,snippet:"{$0}"},{key:"enter",before:/(?:^|\n)( *)(([\w]{1}|[0-9]{1,3})\.)(\+(?= )| |\#(?=[0-9]+ )).*$/,snippet:"{#0}\n{#1}{#2} {$0}",increment:2},{key:"tab",before:/( {2,}.*?)\s*$/,snippet:"  {#1}{$0}"},{key:"enter",before:/ {2}( {2,})$/,snippet:"{#1}{$0}"},{key:"enter",before:/ {2}$/,snippet:"{$0}"},{key:"enter",before:/(?:^|\n)( {2,}).*$/,snippet:"{#0}\n{#1}{$0}"}]}})},function(t){var e,i={},n={16:!1,18:!1,17:!1,91:!1},s="all",o={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},r={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},a=function(t){return r[t]||t.toUpperCase().charCodeAt(0)},c=[];for(e=1;e<20;e++)r["f"+e]=111+e;function l(t,e){for(var i=t.length;i--;)if(t[i]===e)return i;return-1}function d(t,e){if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}var h={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function u(t){for(e in n)n[e]=t[h[e]]}function m(t,e,n){var s,o;s=f(t),void 0===n&&(n=e,e="all");for(var r=0;r<s.length;r++)o=[],(t=s[r].split("+")).length>1&&(o=_(t),t=[t[t.length-1]]),t=t[0],(t=a(t))in i||(i[t]=[]),i[t].push({shortcut:s[r],scope:e,method:n,key:s[r],mods:o})}for(e in o)m[e]=!1;function p(){return s||"all"}function f(t){var e;return""==(e=(t=t.replace(/\s/g,"")).split(","))[e.length-1]&&(e[e.length-2]+=","),e}function _(t){for(var e=t.slice(0,t.length-1),i=0;i<e.length;i++)e[i]=o[e[i]];return e}function g(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,function(){i(window.event)})}g(document,"keydown",function(t){!function(t){var e,s,r,a,d,h;if(e=t.keyCode,-1==l(c,e)&&c.push(e),93!=e&&224!=e||(e=91),e in n)for(r in n[e]=!0,o)o[r]==e&&(m[r]=!0);else if(u(t),m.filter.call(this,t)&&e in i)for(h=p(),a=0;a<i[e].length;a++)if((s=i[e][a]).scope==h||"all"==s.scope){for(r in d=s.mods.length>0,n)(!n[r]&&l(s.mods,+r)>-1||n[r]&&-1==l(s.mods,+r))&&(d=!1);(0!=s.mods.length||n[16]||n[18]||n[17]||n[91])&&!d||!1===s.method(t,s)&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}(t)}),g(document,"keyup",function(t){var e,i=t.keyCode,s=l(c,i);if(s>=0&&c.splice(s,1),93!=i&&224!=i||(i=91),i in n)for(e in n[i]=!1,o)o[e]==i&&(m[e]=!1)}),g(window,"focus",function(){for(e in n)n[e]=!1;for(e in o)m[e]=!1});var b=t.keymaster;t.keymaster=m,t.keymaster.setScope=function(t){s=t||"all"},t.keymaster.getScope=p,t.keymaster.deleteScope=function(t){var e,n,s;for(e in i)for(n=i[e],s=0;s<n.length;)n[s].scope===t?n.splice(s,1):s++},t.keymaster.filter=function(t){var e=(t.target||t.srcElement).tagName;return!("INPUT"==e||"SELECT"==e||"TEXTAREA"==e)},t.keymaster.isPressed=function(t){return"string"==typeof t&&(t=a(t)),-1!=l(c,t)},t.keymaster.getPressedKeyCodes=function(){return c.slice(0)},t.keymaster.noConflict=function(){var e=t.keymaster;return t.keymaster=b,e},t.keymaster.unbind=function(t,e){var n,s,o,r,c,l=[];for(n=f(t),r=0;r<n.length;r++){if((s=n[r].split("+")).length>1&&(l=_(s),t=s[s.length-1]),t=a(t),void 0===e&&(e=p()),!i[t])return;for(o=0;o<i[t].length;o++)(c=i[t][o]).scope===e&&d(c.mods,l)&&(i[t][o]={})}},"undefined"!=typeof module&&(module.exports=m)}(window),keymaster.filter=function(){return!0},function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof module&&"object"==typeof module.exports?module.exports=e():t.Bag=e()}(this,function(){"use strict";var t=document.head||document.getElementsByTagName("head")[0];function e(){}var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function n(t){return"[object Function]"===Object.prototype.toString.call(t)}function s(t,e){if(i(t)){if(t.forEach)return t.forEach(e);for(var n=0;n<t.length;n++)e(t[n],n,t)}else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e(t[s],s)}function o(t,e){s(e,function(i,n){t[n]||(t[n]=e[n])})}var r=function(t){var i=this,o=t+"__",r=localStorage;this.init=function(t){t()},this.remove=function(t,i){i=i||e,r.removeItem(o+t),i()},this.set=function(t,e,n,a){var c,l={value:e,expire:n};try{r.setItem(o+t,JSON.stringify(l))}catch(e){if(e.name.toUpperCase().indexOf("QUOTA")>=0)try{s(r,function(t,e){var n=e.split(o)[1];n&&i.remove(n)}),r.setItem(o+t,JSON.stringify(l))}catch(t){c=t}else c=e}a(c)},this.get=function(t,e,i){var s,a;n(e)&&(i=e,e=!1);try{a=JSON.parse(r.getItem(o+t)),a=e?a:a.value}catch(e){s=new Error("Can't read key: "+t)}i(s,a)},this.clear=function(t,e){var n=+new Date;s(r,function(e,s){var r,a=s.split(o)[1];a&&(t?(i.get(a,!0,function(t,e){r=e}),r&&r.expire>0&&r.expire-n<0&&i.remove(a)):i.remove(a))}),e()}};r.prototype.exists=function(){try{return localStorage.setItem("__ls_test__","__ls_test__"),localStorage.removeItem("__ls_test__"),!0}catch(t){return!1}};var a=function(t){var i;this.init=function(e){if(!(i=window.openDatabase(t,"1.0","bag.js db",2e5)))return e("Can't open webdql database");i.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS kv (key TEXT PRIMARY KEY, value TEXT, expire INTEGER KEY)",[],function(){return e()},function(t,i){return e(i)})})},this.remove=function(t,n){n=n||e,i.transaction(function(e){e.executeSql("DELETE FROM kv WHERE key = ?",[t],function(){return n()},function(t,e){return n(e)})})},this.set=function(t,e,n,s){i.transaction(function(i){i.executeSql("INSERT OR REPLACE INTO kv (key, value, expire) VALUES (?, ?, ?)",[t,JSON.stringify(e),n],function(){return s()},function(t,e){return s(e)})})},this.get=function(t,e){i.readTransaction(function(i){i.executeSql("SELECT value FROM kv WHERE key = ?",[t],function(i,n){if(0===n.rows.length)return e(new Error("key not found: "+t));var s,o,r=n.rows.item(0).value;try{o=JSON.parse(r)}catch(t){s=new Error("Can't unserialise data: "+r)}e(s,o)},function(t,i){return e(i)})})},this.clear=function(t,e){i.transaction(function(n){t?n.executeSql("DELETE FROM kv WHERE expire > 0 AND expire < ?",[+new Date],function(){return e()},function(t,i){return e(i)}):i.transaction(function(t){t.executeSql("DELETE FROM kv",[],function(){return e()},function(t,i){return e(i)})})})}};a.prototype.exists=function(){return!!window.openDatabase};var c=function(t){var e;this.init=function(i){var n=(this.idb=window.indexedDB).open(t,2);n.onsuccess=function(t){e=t.target.result,i()},n.onblocked=function(t){i(new Error("IndexedDB blocked. "+t.target.errorCode))},n.onerror=function(t){i(new Error("IndexedDB opening error. "+t.target.errorCode))},n.onupgradeneeded=function(t){(e=t.target.result).objectStoreNames.contains("kv")&&e.deleteObjectStore("kv"),e.createObjectStore("kv",{keyPath:"key"}).createIndex("expire","expire",{unique:!1})}},this.remove=function(t,i){var n=e.transaction("kv","readwrite");n.oncomplete=function(){i()},n.onerror=n.onabort=function(t){i(new Error("Key remove error: ",t.target))},n.objectStore("kv").delete(t).onerror=function(){n.abort()}},this.set=function(t,i,n,s){var o=e.transaction("kv","readwrite");o.oncomplete=function(){s()},o.onerror=o.onabort=function(t){s(new Error("Key set error: ",t.target))},o.objectStore("kv").put({key:t,value:i,expire:n}).onerror=function(){o.abort()}},this.get=function(t,i){var n,s,o=e.transaction("kv");o.oncomplete=function(){i(n,s)},o.onerror=o.onabort=function(t){i(new Error("Key get error: ",t.target))},o.objectStore("kv").get(t).onsuccess=function(e){e.target.result?s=e.target.result.value:n=new Error("key not found: "+t)}},this.clear=function(t,i){var n,s,o=window.IDBKeyRange;(n=e.transaction("kv","readwrite"),s=n.objectStore("kv"),n.oncomplete=function(){i()},n.onerror=n.onabort=function(t){i(new Error("Clear error: ",t.target))},t)?s.index("expire").openCursor(o.bound(1,+new Date)).onsuccess=function(t){var e=t.target.result;e&&(s.delete(e.primaryKey).onerror=function(){n.abort()},e.continue())}:n.objectStore("kv").clear().onerror=function(){n.abort()}}};c.prototype.exists=function(){return!!window.indexedDB};var l={indexeddb:c,websql:a,localstorage:r},d=function(t,i){var o,r=this,a=null,c=[];s(i,function(e){if(e=e.toLowerCase(),!l[e])throw new Error("Wrong storage adapter name: "+e,i);if(l[e].prototype.exists()&&!a)return a=new l[e](t),!1}),a||"undefined"!=typeof console&&console.log,this.init=function(t){a?"done"!==o?"progress"!==o?(c.push(t),o="progress",a.init(function(t){o=t?"failed":"done",s(c,function(e){e(t)}),c=[],t||r.clear(!0)})):c.push(t):t():t(new Error("No available db"))},this.set=function(t,i,s,o){n(s)&&(o=s,s=null),o=o||e,s=s?+new Date+1e3*s:0,this.init(function(e){if(e)return o(e);a.set(t,i,s,o)})},this.get=function(t,e){this.init(function(i){if(i)return e(i);a.get(t,e)})},this.remove=function(t,i){i=i||e,this.init(function(e){if(e)return i(e);a.remove(t,i)})},this.clear=function(t,i){n(t)&&(i=t,t=!1),i=i||e,this.init(function(e){if(e)return i(e);a.clear(t,i)})}};return function r(a){if(!(this instanceof r))return new r(a);var c=this;a=a||{},this.prefix=a.prefix||"bag",this.timeout=a.timeout||20,this.expire=a.expire||720,this.isValidItem=a.isValidItem||null,this.stores=i(a.stores)?a.stores:["indexeddb","websql","localstorage"];var l=null;function h(t,i){!function(t,i){var n=new XMLHttpRequest;n.open("GET",t),n.onreadystatechange=function(){4===n.readyState&&(200===n.status?(i(null,{content:n.responseText,type:n.getResponseHeader("content-type")}),i=e):(i(new Error("Can't open url "+t+(n.status?n.statusText+" ("+n.status+")":""))),i=e))},setTimeout(function(){n.readyState<4&&(n.abort(),i(new Error("Timeout")),i=e)},1e3*c.timeout),n.send()}(t.url_real,function(e,n){if(e)return i(e);var r=60*(t.expire||c.expire)*60,a=function(t,e){var i={};s(["url","key","unique"],function(e){t[e]&&(i[e]=t[e])});var n=+new Date;return i.data=e.content,i.originalType=e.type,i.type=t.type||e.type,i.stamp=n,i}(t,n);c.set(t.key,a,r,function(){o(t,a),i(null,t)})})}function u(t,e){if(!t.url)return e();t.key=t.key||t.url,c.get(t.key,function(i,n){if(i&&t.cached)e(i);else{t.execute=!1!==t.execute;var s=!!i||function(t,e){return!t||t.expire-+new Date<0||e.unique!==t.unique||e.url!==t.url||c.isValidItem&&!c.isValidItem(t,e)}(n,t);if(!t.live&&!s)return t.type=t.type||n.originalType,o(t,n),void e(null,t);t.url_real=t.url,t.unique&&(t.url_real=t.url+(t.url.indexOf("?")>0?"&":"?")+"bag-unique="+t.unique),h(t,function(s){if(!i||!s)return s?(t.type=t.type||n.originalType,o(t,n),void e(null,t)):void e(null,t);e(s)})}})}this._queue=[],this._chained=!1,this._createStorage=function(){l||(l=new d(c.prefix,c.stores))};var m=/(?:^([ \t]*\/\/[@|#][ \t]+sourceMappingURL=)(.+?)([ \t]*)$)|(?:^([ \t]*\/\*[@#][ \t]+sourceMappingURL=)(.+?)([ \t]*\*\/[ \t])*$)/gm;function p(t){var e=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),i=t.match(e);return{scheme:i[2],authority:i[4],path:i[5],query:i[7],fragment:i[9]}}function f(t){var e=p(t.url),i=!1,n=t.data.replace(m,function(t,n,s,o,r,a,c){if(!t)return null;i=!0,n||(n=r,s=a,o=c);var l=p(s);return n+(((l.scheme?l.scheme:e.scheme)||window.location.protocol.slice(0,-1))+"://")+((l.authority?l.authority:e.authority)||window.location.host)+("/"===l.path[0]?l.path:e.path.split("/").slice(0,-1).join("/")+"/"+l.path)+o});return i?n:""}var _={"application/javascript":function(e){var i,n=document.createElement("script");(i=f(e))||(i=e.data+"\n//# sourceURL="+e.url),n.text=i,t.appendChild(n)},"text/css":function(e){var i,n=document.createElement("style");(i=f(e))||(i=e.data+"\n/*# sourceURL="+e.url+" */"),n.styleSheet?n.styleSheet.cssText=i:n.appendChild(document.createTextNode(i)),t.appendChild(n)}};this.require=function(t,o){var r=c._queue;if(n(t)&&(o=t,t=null),t){var a=i(t)?t:[t];s(a,function(t,e){var i;i=t,"[object String]"===Object.prototype.toString.call(i)&&(a[e]={url:t}),r.push(a[e])})}if(c._createStorage(),!o)return c._chained=!0,c;!function(t,i,n){if(n=n||e,!t.length)return n();var o=0;s(t,function(s){i(s,function(i){i?(n(i),n=e):(o+=1)>=t.length&&n()})})}(r,u,function(e){if(e)return c._chained=!1,c._queue=[],void o(e);s(r,function(t){t.execute&&function(t){if(t.type){var e=t.type.split(";")[0];["application/x-javascript","text/javascript"].indexOf(e)>=0&&(e="application/javascript"),_[e]&&_[e](t)}}(t)});var n=[];s(r,function(t){n.push(t.data)});var a=i(t)||c._chained?n:n[0];c._chained=!1,c._queue=[],o(null,a)})},s(["remove","get","set","clear"],function(t){c[t]=function(){c._createStorage(),l[t].apply(l,arguments)}}),this.addHandler=function(t,e){s(t=i(t)?t:[t],function(t){_[t]=e})},this.removeHandler=function(t){c.addHandler(t)}}}),function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(i){return t.returnExportsGlobal=e(i)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(this,function(t){"use strict";var e,i,n,s,o,r,a,c;e=function(){function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}return e.prototype.setPos=function(t){var e,i,n,s;return(s=a.getSelection())&&(n=0,i=!1,(e=function(t,o){var a,c,l,d,h,u;for(u=[],l=0,d=(h=o.childNodes).length;l<d&&(a=h[l],!i);l++)if(3===a.nodeType){if(n+a.length>=t){i=!0,(c=r.createRange()).setStart(a,t-n),s.removeAllRanges(),s.addRange(c);break}u.push(n+=a.length)}else u.push(e(t,a));return u})(t,this.domInputor)),this.domInputor},e.prototype.getIEPosition=function(){return this.getPosition()},e.prototype.getPosition=function(){var t,e;return e=this.getOffset(),t=this.$inputor.offset(),e.left-=t.left,e.top-=t.top,e},e.prototype.getOldIEPos=function(){var t,e;return e=r.selection.createRange(),(t=r.body.createTextRange()).moveToElementText(this.domInputor),t.setEndPoint("EndToEnd",e),t.text.length},e.prototype.getPos=function(){var t,e,i;return(i=this.range())?((t=i.cloneRange()).selectNodeContents(this.domInputor),t.setEnd(i.endContainer,i.endOffset),e=t.toString().length,t.detach(),e):r.selection?this.getOldIEPos():void 0},e.prototype.getOldIEOffset=function(){var t,e;return(t=r.selection.createRange().duplicate()).moveStart("character",-1),{height:(e=t.getBoundingClientRect()).bottom-e.top,left:e.left,top:e.top}},e.prototype.getOffset=function(e){var i,n,s,o,c;return a.getSelection&&(s=this.range())?(s.endOffset-1>0&&s.endContainer!==this.domInputor&&((i=s.cloneRange()).setStart(s.endContainer,s.endOffset-1),i.setEnd(s.endContainer,s.endOffset),n={height:(o=i.getBoundingClientRect()).height,left:o.left+o.width,top:o.top},i.detach()),n&&0!==(null!=n?n.height:void 0)||(i=s.cloneRange(),c=t(r.createTextNode("|")),i.insertNode(c[0]),i.selectNode(c[0]),n={height:(o=i.getBoundingClientRect()).height,left:o.left,top:o.top},c.remove(),i.detach())):r.selection&&(n=this.getOldIEOffset()),n&&(n.top+=t(a).scrollTop(),n.left+=t(a).scrollLeft()),n},e.prototype.range=function(){var t;if(a.getSelection)return(t=a.getSelection()).rangeCount>0?t.getRangeAt(0):null},e}(),i=function(){function e(t){this.$inputor=t,this.domInputor=this.$inputor[0]}return e.prototype.getIEPos=function(){var t,e,i,n,s,o;return e=this.domInputor,n=0,(s=r.selection.createRange())&&s.parentElement()===e&&(i=e.value.replace(/\r\n/g,"\n").length,(o=e.createTextRange()).moveToBookmark(s.getBookmark()),(t=e.createTextRange()).collapse(!1),n=o.compareEndPoints("StartToEnd",t)>-1?i:-o.moveStart("character",-i)),n},e.prototype.getPos=function(){return r.selection?this.getIEPos():this.domInputor.selectionStart},e.prototype.setPos=function(t){var e,i;return e=this.domInputor,r.selection?((i=e.createTextRange()).move("character",t),i.select()):e.setSelectionRange&&e.setSelectionRange(t,t),e},e.prototype.getIEOffset=function(t){var e;return e=this.domInputor.createTextRange(),t||(t=this.getPos()),e.move("character",t),{left:e.boundingLeft,top:e.boundingTop,height:e.boundingHeight}},e.prototype.getOffset=function(e){var i,n,s;return i=this.$inputor,r.selection?((n=this.getIEOffset(e)).top+=t(a).scrollTop()+i.scrollTop(),n.left+=t(a).scrollLeft()+i.scrollLeft(),n):(n=i.offset(),s=this.getPosition(e),{left:n.left+s.left-i.scrollLeft(),top:n.top+s.top-i.scrollTop(),height:s.height})},e.prototype.getPosition=function(t){var e,i,s,o,r;return e=this.$inputor,s=function(t){return t=t.replace(/<|>|`|"|&/g,"?").replace(/\r\n|\r|\n/g,"<br/>"),/firefox/i.test(navigator.userAgent)&&(t=t.replace(/\s/g,"&nbsp;")),t},void 0===t&&(t=this.getPos()),r=e.val().slice(0,t),i=e.val().slice(t)||".",o="<span style='position: relative; display: inline;'>"+s(r)+"</span>",o+="<span id='caret' style='position: relative; display: inline;'>"+s(i)+"</span>",new n(e).create(o).rect()},e.prototype.getIEPosition=function(t){var e,i;return i=this.getIEOffset(t),e=this.$inputor.offset(),{left:i.left-e.left,top:i.top-e.top,height:i.height}},e}(),n=function(){function e(t){this.$inputor=t}return e.prototype.css_attr=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopStyle","borderRightStyle","borderBottomStyle","borderLeftStyle","borderTopWidth","boxSizing","fontFamily","fontSize","fontWeight","height","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","outlineWidth","overflow","overflowX","overflowY","paddingBottom","paddingLeft","paddingRight","paddingTop","textAlign","textOverflow","textTransform","whiteSpace","wordBreak","wordWrap"],e.prototype.mirrorCss=function(){var e,i=this;return e={position:"absolute",left:-9999,top:0,zIndex:-2e4},"TEXTAREA"===this.$inputor.prop("tagName")&&this.css_attr.push("width"),t.each(this.css_attr,function(t,n){return e[n]=i.$inputor.css(n)}),e},e.prototype.create=function(e){return this.$mirror=t("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(e),this.$inputor.after(this.$mirror),this},e.prototype.rect=function(){var t,e,i;return t=this.$mirror[0].getBoundingClientRect(),i={left:(e=this.$mirror.find("#caret")[0].getClientRects()[0]).left-t.left,top:e.top-t.top,height:e.height},this.$mirror.remove(),i},e}(),s={contentEditable:function(t){return!(!t[0].contentEditable||"true"!==t[0].contentEditable)}},o={pos:function(t){return t||0===t?this.setPos(t):this.getPos()},position:function(t){return r.selection?this.getIEPosition(t):this.getPosition(t)},offset:function(t){return this.getOffset(t)}},r=null,a=null,c=function(t){var e;return(e=null!=t?t.iframe:void 0)?(e,a=e.contentWindow,r=e.contentDocument||a.document):(void 0,a=window,r=document)},t.fn.caret=function(n,r,a){var l;return o[n]?(t.isPlainObject(r)?(c(r),r=void 0):c(a),l=s.contentEditable(this)?new e(this):new i(this),o[n].apply(l,[r])):t.error("Method "+n+" does not exist on jQuery.caret")},t.fn.caret.EditableCaret=e,t.fn.caret.InputCaret=i,t.fn.caret.Utils=s,t.fn.caret.apis=o});var GRID_BEMJSON_DUMMY={data:{tag:"grid",supertag:"grid",title:"grid",grid:{rows:[[{wf_version:"5.0",raw:"НЕ УДАЛЯТЬ!",transformed:{block:"wiki-doc","wiki-attrs":{lang:"ru",path:"",mode:""},content:[{block:"wiki-txt","wiki-attrs":{txt:"НЕ УДАЛЯТЬ!"}}]}},{raw:1},{raw:!0},{raw:!1},{raw:"2013-08-07"},{raw:["пункт 1"]},{raw:["пункт 1"]},{sort:"Филатов Дмитрий",raw:["dfilatov"],transformed:[{login:"dfilatov",first_name:"Дмитрий",last_name:"Филатов"}]},{raw:["bacek","sams"],transformed:[{login:"bacek",first_name:"Василий",last_name:"Чекалкин"},{login:"sams",first_name:"Александр",last_name:"Амилющенко"}]},{raw:"WIKI-1234",transformed:{block:"wiki-doc","wiki-attrs":{lang:"ru",path:"",mode:""},content:[{block:"wiki-jira","wiki-attrs":{status:"Closed",description:"вот здесь: https://wiki.test.tools.yandex-team.ru/WackoWiki почему то раскрыты комменты, хотя я не просил (в урле нет параметра, в настройках показ комментов отключен) https://jing.yandex-team.ru/files/sorgoz/2009-09-11_1646.png",ticket_type:"startrek",assignee_link:"http://staff.yandex-team.ru/thasonic",summary:"На Вики в Тесте всегда показаываются комментарии",project:"WIKI",assignee_login:"thasonic",link_view:"http://st.yandex-team.ru/WIKI-1234",ticket:"1234"}}]}}],[{raw:null,transformed:{}},{raw:null},{raw:!1},{raw:!1},{raw:null},{raw:[]},{raw:[]},{raw:[],transformed:[]},{raw:[],transformed:[]},{raw:null,transformed:{}}],[{wf_version:"5.0",raw:"НЕ УДАЛЯТЬ!",transformed:{block:"wiki-doc","wiki-attrs":{lang:"ru",path:"",mode:""},content:[{block:"wiki-txt","wiki-attrs":{txt:"НЕ УДАЛЯТЬ!"}}]}},{raw:1},{raw:!1},{raw:!1},{raw:"2013-08-07"},{raw:["пункт 1"]},{raw:["пункт 1","пункт 2"]},{sort:"Филатов Дмитрий",raw:["dfilatov"],transformed:[{login:"dfilatov",first_name:"Дмитрий",last_name:"Филатов"}]},{raw:["bacek","sams"],transformed:[{login:"bacek",first_name:"Василий",last_name:"Чекалкин"},{login:"sams",first_name:"Александр",last_name:"Амилющенко"}]},{raw:"WIKI-1234",transformed:{block:"wiki-doc","wiki-attrs":{lang:"ru",path:"",mode:""},content:[{block:"wiki-jira","wiki-attrs":{status:"Closed",description:"вот здесь: https://wiki.test.tools.yandex-team.ru/WackoWiki почему то раскрыты комменты, хотя я не просил (в урле нет параметра, в настройках показ комментов отключен) https://jing.yandex-team.ru/files/sorgoz/2009-09-11_1646.png",ticket_type:"startrek",assignee_link:"http://staff.yandex-team.ru/thasonic",summary:"На Вики в Тесте всегда показаываются комментарии",project:"WIKI",assignee_login:"thasonic",link_view:"http://st.yandex-team.ru/WIKI-1234",ticket:"1234"}}]}}],[{wf_version:"5.0",raw:"НЕ УДАЛЯТЬ!",transformed:{block:"wiki-doc","wiki-attrs":{lang:"ru",path:"",mode:""},content:[{block:"wiki-txt","wiki-attrs":{txt:"НЕ УДАЛЯТЬ!"}}]}},{raw:1},{raw:!0},{raw:!1},{raw:"2013-08-07"},{raw:["пункт 1"]},{raw:["пункт 1"]},{sort:"Филатов Дмитрий",raw:["dfilatov"],transformed:[{login:"dfilatov",first_name:"Дмитрий",last_name:"Филатов"}]},{raw:["bacek","sams"],transformed:[{login:"bacek",first_name:"Василий",last_name:"Чекалкин"},{login:"sams",first_name:"Александр",last_name:"Амилющенко"}]},{raw:"WIKI-1234",transformed:{block:"wiki-doc","wiki-attrs":{lang:"ru",path:"",mode:""},content:[{block:"wiki-jira","wiki-attrs":{status:"Closed",description:"вот здесь: https://wiki.test.tools.yandex-team.ru/WackoWiki почему то раскрыты комменты, хотя я не просил (в урле нет параметра, в настройках показ комментов отключен) https://jing.yandex-team.ru/files/sorgoz/2009-09-11_1646.png",ticket_type:"startrek",assignee_link:"http://staff.yandex-team.ru/thasonic",summary:"На Вики в Тесте всегда показаываются комментарии",project:"WIKI",assignee_login:"thasonic",link_view:"http://st.yandex-team.ru/WIKI-1234",ticket:"1234"}}]}}],[{wf_version:"5.0",raw:"НЕ УДАЛЯТЬ!",transformed:{block:"wiki-doc","wiki-attrs":{lang:"ru",path:"",mode:""},content:[{block:"wiki-txt","wiki-attrs":{txt:"НЕ УДАЛЯТЬ!"}}]}},{raw:1},{raw:!1},{raw:!1},{raw:"2013-08-07"},{raw:["пункт 1"]},{raw:["пункт 1","пункт 2"]},{sort:"Филатов Дмитрий",raw:["dfilatov"],transformed:[{login:"dfilatov",first_name:"Дмитрий",last_name:"Филатов"}]},{raw:["bacek","sams"],transformed:[{login:"bacek",first_name:"Василий",last_name:"Чекалкин"},{login:"sams",first_name:"Александр",last_name:"Амилющенко"}]},{raw:"WIKI-1234",transformed:{block:"wiki-doc","wiki-attrs":{lang:"ru",path:"",mode:""},content:[{block:"wiki-jira","wiki-attrs":{status:"Closed",description:"вот здесь: https://wiki.test.tools.yandex-team.ru/WackoWiki почему то раскрыты комменты, хотя я не просил (в урле нет параметра, в настройках показ комментов отключен) https://jing.yandex-team.ru/files/sorgoz/2009-09-11_1646.png",ticket_type:"startrek",assignee_link:"http://staff.yandex-team.ru/thasonic",summary:"На Вики в Тесте всегда показаываются комментарии",project:"WIKI",assignee_login:"thasonic",link_view:"http://st.yandex-team.ru/WIKI-1234",ticket:"1234"}}]}}]],meta:{autoincrement:4},structure:{fields:[{required:!1,type:"string",sorting:!0,name:"0",title:"Тестовое поле"},{sorting:!0,name:"1",format:"%.2f",required:!1,title:"Число",type:"number"},{markdone:!0,sorting:!0,name:"2",title:"Чекбокс x",required:!1,type:"checkbox"},{markdone:!1,sorting:!0,name:"3",title:"Чекбокс",required:!1,type:"checkbox"},{sorting:!0,name:"4",format:"d.m.Y",required:!1,title:"Дата",type:"date"},{sorting:!0,multiple:!1,name:"5",title:"Список",required:!1,type:"select",options:["пункт 1","пункт 2","пункт 3","пункт 4"]},{sorting:!1,multiple:!0,name:"6",title:"Список мн.",required:!1,type:"select",options:["пункт 1","пункт 2","пункт 3","пункт 4"]},{sorting:!0,multiple:!1,name:"7",title:"Сотрудник",format:"i_first_name i_last_name",required:!1,type:"staff"},{sorting:!1,multiple:!0,name:"8",title:"Сотрудник мн",format:"i_first_name i_last_name",required:!1,type:"staff"},{required:!1,type:"ticket",sorting:!0,name:"9",title:"Jira"}],sorting:[],width:"100%"}}}};!function(t,e,i){"$:nomunge";function n(n,s){s=s||n+i;var o=t(),r=n+"."+s+"-special-event";function a(e){t(o).each(function(){var i=t(this);this===e.target||i.has(e.target).length||i.triggerHandler(s,[e.target])})}t.event.special[s]={setup:function(){1===(o=o.add(this)).length&&t(e).bind(r,a)},teardown:function(){0===(o=o.not(this)).length&&t(e).unbind(r)},add:function(t){var e=t.handler;t.handler=function(t,i){t.target=i,e.apply(this,arguments)}}}}t.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),function(t){n(t)}),n("focusin","focus"+i),n("focusout","blur"+i),t.addOutsideEvent=n}(jQuery,document,"outside"),function(t,e){"use strict";var i="model",n="name",s="type",o="vendor",r="version",a="mobile",c="tablet",l={extend:function(t,e){var i={};for(var n in t)e[n]&&e[n].length%2==0?i[n]=e[n].concat(t[n]):i[n]=t[n];return i},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},d={rgx:function(t,e){for(var i,n,s,o,r,a,c=0;c<e.length&&!r;){var l=e[c],d=e[c+1];for(i=n=0;i<l.length&&!r;)if(r=l[i++].exec(t))for(s=0;s<d.length;s++)a=r[++n],"object"==typeof(o=d[s])&&o.length>0?2==o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,a):this[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=a?a.replace(o[1],o[2]):void 0:this[o[0]]=a?o[1].call(this,a,o[2]):void 0:4==o.length&&(this[o[0]]=a?o[3].call(this,a.replace(o[1],o[2])):void 0):this[o]=a||void 0;c+=2}},str:function(t,e){for(var i in e)if("object"==typeof e[i]&&e[i].length>0){for(var n=0;n<e[i].length;n++)if(l.has(e[i][n],t))return"?"===i?void 0:i}else if(l.has(e[i],t))return"?"===i?void 0:i;return t}},h={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2000:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},u={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[n,r],[/(opios)[\/\s]+([\w\.]+)/i],[[n,"Opera Mini"],r],[/\s(opr)\/([\w\.]+)/i],[[n,"Opera"],r],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark)\/([\w\.-]+)/i],[n,r],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[n,"IE"],r],[/(edge|edgios|edgea)\/((\d+)?[\w\.]+)/i],[[n,"Edge"],r],[/(yabrowser)\/([\w\.]+)/i],[[n,"Yandex"],r],[/(puffin)\/([\w\.]+)/i],[[n,"Puffin"],r],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[n,"UCBrowser"],r],[/(comodo_dragon)\/([\w\.]+)/i],[[n,/_/g," "],r],[/(micromessenger)\/([\w\.]+)/i],[[n,"WeChat"],r],[/(qqbrowserlite)\/([\w\.]+)/i],[n,r],[/(QQ)\/([\d\.]+)/i],[n,r],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[n,r],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[n,r],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[n,r],[/(MetaSr)[\/\s]?([\w\.]+)/i],[n],[/(LBBROWSER)/i],[n],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[r,[n,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[r,[n,"Facebook"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[r,[n,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[n,/(.+)/,"$1 WebView"],r],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[n,/(.+(?:g|us))(.+)/,"$1 $2"],r],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[r,[n,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[n,r],[/(dolfin)\/([\w\.]+)/i],[[n,"Dolphin"],r],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[n,"Chrome"],r],[/(coast)\/([\w\.]+)/i],[[n,"Opera Coast"],r],[/fxios\/([\w\.-]+)/i],[r,[n,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[r,[n,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[r,n],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[n,"GSA"],r],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[n,[r,d.str,h.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[n,r],[/(navigator|netscape)\/([\w\.-]+)/i],[[n,"Netscape"],r],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[n,r]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",l.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",l.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",l.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[i,o,[s,c]],[/applecoremedia\/[\w\.]+ \((ipad)/],[i,[o,"Apple"],[s,c]],[/(apple\s{0,1}tv)/i],[[i,"Apple TV"],[o,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[o,i,[s,c]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[i,[o,"Amazon"],[s,c]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[i,d.str,h.device.amazon.model],[o,"Amazon"],[s,a]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[i,o,[s,a]],[/\((ip[honed|\s\w*]+);/i],[i,[o,"Apple"],[s,a]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[o,i,[s,a]],[/\(bb10;\s(\w+)/i],[i,[o,"BlackBerry"],[s,a]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[i,[o,"Asus"],[s,c]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[o,"Sony"],[i,"Xperia Tablet"],[s,c]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[i,[o,"Sony"],[s,a]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[o,i,[s,"console"]],[/android.+;\s(shield)\sbuild/i],[i,[o,"Nvidia"],[s,"console"]],[/(playstation\s[34portablevi]+)/i],[i,[o,"Sony"],[s,"console"]],[/(sprint\s(\w+))/i],[[o,d.str,h.device.sprint.vendor],[i,d.str,h.device.sprint.model],[s,a]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[o,i,[s,c]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[o,[i,/_/g," "],[s,a]],[/(nexus\s9)/i],[i,[o,"HTC"],[s,c]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[i,[o,"Huawei"],[s,a]],[/(microsoft);\s(lumia[\s\w]+)/i],[o,i,[s,a]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[i,[o,"Microsoft"],[s,"console"]],[/(kin\.[onetw]{3})/i],[[i,/\./g," "],[o,"Microsoft"],[s,a]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[i,[o,"Motorola"],[s,a]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[i,[o,"Motorola"],[s,c]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[o,l.trim],[i,l.trim],[s,"smarttv"]],[/hbbtv.+maple;(\d+)/i],[[i,/^/,"SmartTV"],[o,"Samsung"],[s,"smarttv"]],[/\(dtv[\);].+(aquos)/i],[i,[o,"Sharp"],[s,"smarttv"]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[o,"Samsung"],i,[s,c]],[/smart-tv.+(samsung)/i],[o,[s,"smarttv"],i],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[o,"Samsung"],i,[s,a]],[/sie-(\w*)/i],[i,[o,"Siemens"],[s,a]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[o,"Nokia"],i,[s,a]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[i,[o,"Acer"],[s,c]],[/android.+([vl]k\-?\d{3})\s+build/i],[i,[o,"LG"],[s,c]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[o,"LG"],i,[s,c]],[/(lg) netcast\.tv/i],[o,i,[s,"smarttv"]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[i,[o,"LG"],[s,a]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[i,[o,"Lenovo"],[s,c]],[/linux;.+((jolla));/i],[o,i,[s,a]],[/((pebble))app\/[\d\.]+\s/i],[o,i,[s,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[o,i,[s,a]],[/crkey/i],[[i,"Chromecast"],[o,"Google"]],[/android.+;\s(glass)\s\d/i],[i,[o,"Google"],[s,"wearable"]],[/android.+;\s(pixel c)\s/i],[i,[o,"Google"],[s,c]],[/android.+;\s(pixel xl|pixel)\s/i],[i,[o,"Google"],[s,a]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[i,/_/g," "],[o,"Xiaomi"],[s,a]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[i,/_/g," "],[o,"Xiaomi"],[s,c]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[i,[o,"Meizu"],[s,c]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[i,[o,"OnePlus"],[s,a]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[i,[o,"RCA"],[s,c]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[i,[o,"Dell"],[s,c]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[i,[o,"Verizon"],[s,c]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[o,"Barnes & Noble"],i,[s,c]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[i,[o,"NuVision"],[s,c]],[/android.+;\s(k88)\sbuild/i],[i,[o,"ZTE"],[s,c]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[i,[o,"Swiss"],[s,a]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[i,[o,"Swiss"],[s,c]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[i,[o,"Zeki"],[s,c]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[o,"Dragon Touch"],i,[s,c]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[i,[o,"Insignia"],[s,c]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[i,[o,"NextBook"],[s,c]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[o,"Voice"],i,[s,a]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[o,"LvTel"],i,[s,a]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[i,[o,"Envizen"],[s,c]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[o,i,[s,c]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[i,[o,"MachSpeed"],[s,c]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[o,i,[s,c]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[i,[o,"Rotor"],[s,c]],[/android.+(KS(.+))\s+build/i],[i,[o,"Amazon"],[s,c]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[o,i,[s,c]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[s,l.lowerize],o,i],[/(android[\w\.\s\-]{0,9});.+build/i],[i,[o,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[r,[n,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[n,r],[/rv\:([\w\.]{1,9}).+(gecko)/i],[r,n]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[n,r],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[n,[r,d.str,h.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[n,"Windows"],[r,d.str,h.os.windows.version]],[/\((bb)(10);/i],[[n,"BlackBerry"],r],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[n,r],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[n,"Symbian"],r],[/\((series40);/i],[n],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[n,"Firefox OS"],r],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[n,r],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[n,"Chromium OS"],r],[/(sunos)\s?([\w\.\d]*)/i],[[n,"Solaris"],r],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[n,r],[/(haiku)\s(\w+)/i],[n,r],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[r,/_/g,"."],[n,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[n,"Mac OS"],[r,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]*)/i],[n,r]]},m=function(e,i){if("object"==typeof e&&(i=e,e=void 0),!(this instanceof m))return new m(e,i).getResult();var n=e||(t&&t.navigator&&t.navigator.userAgent?t.navigator.userAgent:""),s=i?l.extend(u,i):u;return this.getBrowser=function(){var t={name:void 0,version:void 0};return d.rgx.call(t,n,s.browser),t.major=l.major(t.version),t},this.getCPU=function(){var t={architecture:void 0};return d.rgx.call(t,n,s.cpu),t},this.getDevice=function(){var t={vendor:void 0,model:void 0,type:void 0};return d.rgx.call(t,n,s.device),t},this.getEngine=function(){var t={name:void 0,version:void 0};return d.rgx.call(t,n,s.engine),t},this.getOS=function(){var t={name:void 0,version:void 0};return d.rgx.call(t,n,s.os),t},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(t){return n=t,this},this};m.VERSION="0.7.18",m.BROWSER={NAME:n,MAJOR:"major",VERSION:r},m.CPU={ARCHITECTURE:"architecture"},m.DEVICE={MODEL:i,VENDOR:o,TYPE:s,CONSOLE:"console",MOBILE:a,SMARTTV:"smarttv",TABLET:c,WEARABLE:"wearable",EMBEDDED:"embedded"},m.ENGINE={NAME:n,VERSION:r},m.OS={NAME:n,VERSION:r},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports.UAParser=m):"function"==typeof define&&define.amd?define(function(){return m}):t&&(t.UAParser=m);var p=t&&(t.jQuery||t.Zepto);if(void 0!==p){var f=new m;p.ua=f.getResult(),p.ua.get=function(){return f.getUA()},p.ua.set=function(t){f.setUA(t);var e=f.getResult();for(var i in e)p.ua[i]=e[i]}}}("object"==typeof window?window:this),function t(e,i,n){function s(r,a){if(!i[r]){if(!e[r]){var c="function"==typeof require&&require;if(!a&&c)return c(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var d=i[r]={exports:{}};e[r][0].call(d.exports,function(t){var i=e[r][1][t];return s(i||t)},d,d.exports,t,e,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(t,e,i){var n=t("cssfilter").FilterCSS,s=t("cssfilter").getDefaultWhiteList,o=t("./util");function r(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]}}var a=new n;function c(t){return t.replace(l,"&lt;").replace(d,"&gt;")}var l=/</g,d=/>/g,h=/"/g,u=/&quot;/g,m=/&#([a-zA-Z0-9]*);?/gim,p=/&colon;?/gim,f=/&newline;?/gim,_=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,g=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,b=/u\s*r\s*l\s*\(.*/gi;function v(t){return t.replace(h,"&quot;")}function y(t){return t.replace(u,'"')}function k(t){return t.replace(m,function(t,e){return"x"===e[0]||"X"===e[0]?String.fromCharCode(parseInt(e.substr(1),16)):String.fromCharCode(parseInt(e,10))})}function w(t){return t.replace(p,":").replace(f," ")}function M(t){for(var e="",i=0,n=t.length;i<n;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return o.trim(e)}function x(t){return t=M(t=w(t=k(t=y(t))))}function E(t){return t=c(t=v(t))}var B=/<!--[\s\S]*?-->/g;i.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]},i.getDefaultWhiteList=r,i.onTag=function(t,e,i){},i.onIgnoreTag=function(t,e,i){},i.onTagAttr=function(t,e,i){},i.onIgnoreTagAttr=function(t,e,i){},i.safeAttrValue=function(t,e,i,n){if(i=x(i),"href"===e||"src"===e){if("#"===(i=o.trim(i)))return"#";if("http://"!==i.substr(0,7)&&"https://"!==i.substr(0,8)&&"mailto:"!==i.substr(0,7)&&"tel:"!==i.substr(0,4)&&"#"!==i[0]&&"/"!==i[0])return""}else if("background"===e){if(_.lastIndex=0,_.test(i))return""}else if("style"===e){if(g.lastIndex=0,g.test(i))return"";if(b.lastIndex=0,b.test(i)&&(_.lastIndex=0,_.test(i)))return"";!1!==n&&(i=(n=n||a).process(i))}return i=E(i)},i.escapeHtml=c,i.escapeQuote=v,i.unescapeQuote=y,i.escapeHtmlEntities=k,i.escapeDangerHtml5Entities=w,i.clearNonPrintableCharacter=M,i.friendlyAttrValue=x,i.escapeAttrValue=E,i.onIgnoreTagStripAll=function(){return""},i.StripTagBody=function(t,e){"function"!=typeof e&&(e=function(){});var i=!Array.isArray(t),n=[],s=!1;return{onIgnoreTag:function(r,a,c){if(function(e){return!!i||-1!==o.indexOf(t,e)}(r)){if(c.isClosing){var l="[/removed]",d=c.position+l.length;return n.push([!1!==s?s:c.position,d]),s=!1,l}return s||(s=c.position),"[removed]"}return e(r,a,c)},remove:function(t){var e="",i=0;return o.forEach(n,function(n){e+=t.slice(i,n[0]),i=n[1]}),e+=t.slice(i)}}},i.stripCommentTag=function(t){return t.replace(B,"")},i.stripBlankChar=function(t){var e=t.split("");return(e=e.filter(function(t){var e=t.charCodeAt(0);return!(127===e||e<=31&&10!==e&&13!==e)})).join("")},i.cssFilter=a,i.getDefaultCSSWhiteList=s},{"./util":4,cssfilter:8}],2:[function(t,e,i){var n=t("./default"),s=t("./parser"),o=t("./xss");for(var r in(i=e.exports=function(t,e){return new o(e).process(t)}).FilterXSS=o,n)i[r]=n[r];for(var r in s)i[r]=s[r];"undefined"!=typeof window&&(window.filterXSS=e.exports)},{"./default":1,"./parser":3,"./xss":5}],3:[function(t,e,i){var n=t("./util");function s(t){var e=n.spaceIndex(t);if(-1===e)var i=t.slice(1,-1);else i=t.slice(1,e+1);return"/"===(i=n.trim(i).toLowerCase()).slice(0,1)&&(i=i.slice(1)),"/"===i.slice(-1)&&(i=i.slice(0,-1)),i}function o(t){return"</"===t.slice(0,2)}var r=/[^a-zA-Z0-9_:\.\-]/gim;function a(t,e){for(;e<t.length;e++){var i=t[e];if(" "!==i)return"="===i?e:-1}}function c(t,e){for(;e>0;e--){var i=t[e];if(" "!==i)return"="===i?e:-1}}function l(t){return function(t){return'"'===t[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]}(t)?t.substr(1,t.length-2):t}i.parseTag=function(t,e,i){"user strict";var n="",r=0,a=!1,c=!1,l=0,d=t.length,h="",u="";for(l=0;l<d;l++){var m=t.charAt(l);if(!1===a){if("<"===m){a=l;continue}}else if(!1===c){if("<"===m){n+=i(t.slice(r,l)),a=l,r=l;continue}if(">"===m){n+=i(t.slice(r,a)),h=s(u=t.slice(a,l+1)),n+=e(a,n.length,h,u,o(u)),r=l+1,a=!1;continue}if(('"'===m||"'"===m)&&"="===t.charAt(l-1)){c=m;continue}}else if(m===c){c=!1;continue}}return r<t.length&&(n+=i(t.substr(r))),n},i.parseAttr=function(t,e){"user strict";var i=0,s=[],o=!1,d=t.length;function h(t,i){if(!((t=(t=n.trim(t)).replace(r,"").toLowerCase()).length<1)){var o=e(t,i||"");o&&s.push(o)}}for(var u=0;u<d;u++){var m,p=t.charAt(u);if(!1!==o||"="!==p)if(!1===o||u!==i||'"'!==p&&"'"!==p||"="!==t.charAt(u-1)){if(/\s|\n|\t/.test(p)){if(t=t.replace(/\s|\n|\t/g," "),!1===o){if(-1===(m=a(t,u))){h(n.trim(t.slice(i,u))),o=!1,i=u+1;continue}u=m-1;continue}if(-1===(m=c(t,u-1))){h(o,l(n.trim(t.slice(i,u)))),o=!1,i=u+1;continue}}}else{if(-1===(m=t.indexOf(p,u+1)))break;h(o,n.trim(t.slice(i+1,m))),o=!1,i=(u=m)+1}else o=t.slice(i,u),i=u+1}return i<t.length&&(!1===o?h(t.slice(i)):h(o,l(n.trim(t.slice(i))))),n.trim(s.join(" "))}},{"./util":4}],4:[function(t,e,i){e.exports={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var n,s;if(Array.prototype.forEach)return t.forEach(e,i);for(n=0,s=t.length;n<s;n++)e.call(i,t[n],n,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/.exec(t);return e?e.index:-1}}},{}],5:[function(t,e,i){var n=t("cssfilter").FilterCSS,s=t("./default"),o=t("./parser"),r=o.parseTag,a=o.parseAttr,c=t("./util");function l(t){return void 0===t||null===t}function d(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=s.onIgnoreTagStripAll),t.whiteList=t.whiteList||s.whiteList,t.onTag=t.onTag||s.onTag,t.onTagAttr=t.onTagAttr||s.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||s.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||s.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||s.safeAttrValue,t.escapeHtml=t.escapeHtml||s.escapeHtml,this.options=t,!1===t.css?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new n(t.css))}d.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e=this.options,i=e.whiteList,n=e.onTag,o=e.onIgnoreTag,d=e.onTagAttr,h=e.onIgnoreTagAttr,u=e.safeAttrValue,m=e.escapeHtml,p=this.cssFilter;e.stripBlankChar&&(t=s.stripBlankChar(t)),e.allowCommentTag||(t=s.stripCommentTag(t));var f=!1;if(e.stripIgnoreTagBody){f=s.StripTagBody(e.stripIgnoreTagBody,o);o=f.onIgnoreTag}var _=r(t,function(t,e,s,r,f){var _,g={sourcePosition:t,position:e,isClosing:f,isWhite:i.hasOwnProperty(s)};if(!l(_=n(s,r,g)))return _;if(g.isWhite){if(g.isClosing)return"</"+s+">";var b=function(t){var e=c.spaceIndex(t);if(-1===e)return{html:"",closing:"/"===t[t.length-2]};var i="/"===(t=c.trim(t.slice(e+1,-1)))[t.length-1];return i&&(t=c.trim(t.slice(0,-1))),{html:t,closing:i}}(r),v=i[s],y=a(b.html,function(t,e){var i,n=-1!==c.indexOf(v,t);return l(i=d(s,t,e,n))?n?(e=u(s,t,e,p))?t+'="'+e+'"':t:l(i=h(s,t,e,n))?void 0:i:i});r="<"+s;return y&&(r+=" "+y),b.closing&&(r+=" /"),r+=">"}return l(_=o(s,r,g))?m(r):_},m);return f&&(_=f.remove(_)),_},e.exports=d},{"./default":1,"./parser":3,"./util":4,cssfilter:8}],6:[function(t,e,i){var n=t("./default"),s=t("./parser");t("./util");function o(t){return void 0===t||null===t}function r(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).whiteList=t.whiteList||n.whiteList,t.onAttr=t.onAttr||n.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||n.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||n.safeAttrValue,this.options=t}r.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e=this.options,i=e.whiteList,n=e.onAttr,r=e.onIgnoreAttr,a=e.safeAttrValue;return s(t,function(t,e,s,c,l){var d=i[s],h=!1;if(!0===d?h=d:"function"==typeof d?h=d(c):d instanceof RegExp&&(h=d.test(c)),!0!==h&&(h=!1),c=a(s,c)){var u,m={position:e,sourcePosition:t,source:l,isWhite:h};return h?o(u=n(s,c,m))?s+":"+c:u:o(u=r(s,c,m))?void 0:u}})},e.exports=r},{"./default":7,"./parser":9,"./util":10}],7:[function(t,e,i){function n(){var t={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1};return t}var s=/javascript\s*\:/gim;i.whiteList=n(),i.getDefaultWhiteList=n,i.onAttr=function(t,e,i){},i.onIgnoreAttr=function(t,e,i){},i.safeAttrValue=function(t,e){return s.test(e)?"":e}},{}],8:[function(t,e,i){var n=t("./default"),s=t("./css");for(var o in(i=e.exports=function(t,e){return new s(e).process(t)}).FilterCSS=s,n)i[o]=n[o];"undefined"!=typeof window&&(window.filterCSS=e.exports)},{"./css":6,"./default":7}],9:[function(t,e,i){var n=t("./util");e.exports=function(t,e){";"!==(t=n.trimRight(t))[t.length-1]&&(t+=";");var i=t.length,s=!1,o=0,r=0,a="";function c(){if(!s){var i=n.trim(t.slice(o,r)),c=i.indexOf(":");if(-1!==c){var l=n.trim(i.slice(0,c)),d=n.trim(i.slice(c+1));if(l){var h=e(o,a.length,l,d,i);h&&(a+=h+"; ")}}}o=r+1}for(;r<i;r++){var l=t[r];if("/"===l&&"*"===t[r+1]){var d=t.indexOf("*/",r+2);if(-1===d)break;o=(r=d+1)+1,s=!1}else"("===l?s=!0:")"===l?s=!1:";"===l?s||c():"\n"===l&&c()}return n.trim(a)}},{"./util":10}],10:[function(t,e,i){e.exports={indexOf:function(t,e){var i,n;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var n,s;if(Array.prototype.forEach)return t.forEach(e,i);for(n=0,s=t.length;n<s;n++)e.call(i,t[n],n,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}}},{}]},{},[2]),function(t){"use strict";var e=-1,i={onVisible:function(t){var e=i.isSupported();if(!e||!i.hidden())return t(),e;var n=i.change(function(e,s){i.hidden()||(i.unbind(n),t())});return n},change:function(t){if(!i.isSupported())return!1;var n=e+=1;return i._callbacks[n]=t,i._listen(),n},unbind:function(t){delete i._callbacks[t]},afterPrerendering:function(t){var e=i.isSupported();if(!e||"prerender"!=i.state())return t(),e;var n=i.change(function(e,s){"prerender"!=s&&(i.unbind(n),t())});return n},hidden:function(){return!(!i._doc.hidden&&!i._doc.webkitHidden)},state:function(){return i._doc.visibilityState||i._doc.webkitVisibilityState||"visible"},isSupported:function(){return!(!i._doc.visibilityState&&!i._doc.webkitVisibilityState)},_doc:document||{},_callbacks:{},_change:function(t){var e=i.state();for(var n in i._callbacks)i._callbacks[n].call(i._doc,t,e)},_listen:function(){if(!i._init){var t="visibilitychange";i._doc.webkitVisibilityState&&(t="webkit"+t);var e=function(){i._change.apply(i,arguments)};i._doc.addEventListener?i._doc.addEventListener(t,e):i._doc.attachEvent(t,e),i._init=!0}}};"undefined"!=typeof module&&module.exports?module.exports=i:t.Visibility=i}(this),function(t){"use strict";var e=-1,i=function(i){return i.every=function(t,n,s){i._time(),s||(s=n,n=null);var o=e+=1;return i._timers[o]={visible:t,hidden:n,callback:s},i._run(o,!1),i.isSupported()&&i._listen(),o},i.stop=function(t){return!!i._timers[t]&&(i._stop(t),delete i._timers[t],!0)},i._timers={},i._time=function(){i._timed||(i._timed=!0,i._wasHidden=i.hidden(),i.change(function(){i._stopRun(),i._wasHidden=i.hidden()}))},i._run=function(e,n){var s,o=i._timers[e];if(i.hidden()){if(null===o.hidden)return;s=o.hidden}else s=o.visible;var r=function(){o.last=new Date,o.callback.call(t)};if(n){var a=new Date-o.last;s>a?o.delay=setTimeout(function(){o.id=setInterval(r,s),r()},s-a):(o.id=setInterval(r,s),r())}else o.id=setInterval(r,s)},i._stop=function(t){var e=i._timers[t];clearInterval(e.id),clearTimeout(e.delay),delete e.id,delete e.delay},i._stopRun=function(t){var e=i.hidden(),n=i._wasHidden;if(e&&!n||!e&&n)for(var s in i._timers)i._stop(s),i._run(s,!e)},i};"undefined"!=typeof module&&module.exports?module.exports=i(require("./visibility.core")):i(t.Visibility)}(window),function(t){var e,i={},n={16:!1,18:!1,17:!1,91:!1},s="all",o={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},r={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},a=function(t){return r[t]||t.toUpperCase().charCodeAt(0)},c=[];for(e=1;e<20;e++)r["f"+e]=111+e;function l(t,e){for(var i=t.length;i--;)if(t[i]===e)return i;return-1}function d(t,e){if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}var h={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function u(t){for(e in n)n[e]=t[h[e]]}function m(t,e,n){var s,o;s=f(t),void 0===n&&(n=e,e="all");for(var r=0;r<s.length;r++)o=[],(t=s[r].split("+")).length>1&&(o=_(t),t=[t[t.length-1]]),t=t[0],(t=a(t))in i||(i[t]=[]),i[t].push({shortcut:s[r],scope:e,method:n,key:s[r],mods:o})}for(e in o)m[e]=!1;function p(){return s||"all"}function f(t){var e;return""==(e=(t=t.replace(/\s/g,"")).split(","))[e.length-1]&&(e[e.length-2]+=","),e}function _(t){for(var e=t.slice(0,t.length-1),i=0;i<e.length;i++)e[i]=o[e[i]];return e}function g(t,e,i){t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent&&t.attachEvent("on"+e,function(){i(window.event)})}g(document,"keydown",function(t){!function(t){var e,s,r,a,d,h;if(e=t.keyCode,-1==l(c,e)&&c.push(e),93!=e&&224!=e||(e=91),e in n)for(r in n[e]=!0,o)o[r]==e&&(m[r]=!0);else if(u(t),m.filter.call(this,t)&&e in i)for(h=p(),a=0;a<i[e].length;a++)if((s=i[e][a]).scope==h||"all"==s.scope){for(r in d=s.mods.length>0,n)(!n[r]&&l(s.mods,Number(r))>-1||n[r]&&-1==l(s.mods,Number(r)))&&(d=!1);(0!=s.mods.length||n[16]||n[18]||n[17]||n[91])&&!d||!1===s.method(t,s)&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0))}}(t)}),g(document,"keyup",function(t){var e,i=t.keyCode,s=l(c,i);if(s>=0&&c.splice(s,1),93!=i&&224!=i||(i=91),i in n)for(e in n[i]=!1,o)o[e]==i&&(m[e]=!1)}),g(window,"focus",function(){for(e in n)n[e]=!1;for(e in o)m[e]=!1});var b=t.keymaster;t.keymaster=m,t.keymaster.setScope=function(t){s=t||"all"},t.keymaster.getScope=p,t.keymaster.deleteScope=function(t){var e,n,s;for(e in i)for(n=i[e],s=0;s<n.length;)n[s].scope===t?n.splice(s,1):s++},t.keymaster.filter=function(t){var e=(t.target||t.srcElement).tagName;return!("INPUT"==e||"SELECT"==e||"TEXTAREA"==e)},t.keymaster.isPressed=function(t){return"string"==typeof t&&(t=a(t)),-1!=l(c,t)},t.keymaster.getPressedKeyCodes=function(){return c.slice(0)},t.keymaster.noConflict=function(){var e=t.keymaster;return t.keymaster=b,e},t.keymaster.unbind=function(t,e){var n,s,o,r,c,l=[];for(n=f(t),r=0;r<n.length;r++){if((s=n[r].split("+")).length>1&&(l=_(s),t=s[s.length-1]),t=a(t),void 0===e&&(e=p()),!i[t])return;for(o=0;o<i[t].length;o++)(c=i[t][o]).scope===e&&d(c.mods,l)&&(i[t][o]={})}},"undefined"!=typeof module&&(module.exports=m)}(this),keymaster.filter=function(){return!0};var saveAs=saveAs||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=function(){return t.URL||t.webkitURL||t},i=t.document.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in i,s=/constructor/i.test(t.HTMLElement)||t.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent),r=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},a=function(t){setTimeout(function(){"string"==typeof t?e().revokeObjectURL(t):t.remove()},4e4)},c=function(t,e,i){for(var n=(e=[].concat(e)).length;n--;){var s=t["on"+e[n]];if("function"==typeof s)try{s.call(t,i||t)}catch(t){r(t)}}},l=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},d=function(r,d,h){h||(r=l(r));var u,m=this,p="application/octet-stream"===r.type,f=function(){c(m,"writestart progress write writeend".split(" "))};if(m.readyState=m.INIT,n)return u=e().createObjectURL(r),void setTimeout(function(){var t,e;i.href=u,i.download=d,t=i,e=new MouseEvent("click"),t.dispatchEvent(e),f(),a(u),m.readyState=m.DONE});!function(){if((o||p&&s)&&t.FileReader){var i=new FileReader;return i.onloadend=function(){var e=o?i.result:i.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,m.readyState=m.DONE,f()},i.readAsDataURL(r),void(m.readyState=m.INIT)}u||(u=e().createObjectURL(r)),p?t.location.href=u:t.open(u,"_blank")||(t.location.href=u);m.readyState=m.DONE,f(),a(u)}()},h=d.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,i){return e=e||t.name||"download",i||(t=l(t)),navigator.msSaveOrOpenBlob(t,e)}:(h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,function(t,e,i){return new d(t,e||t.name||"download",i)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);if("undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define("FileSaver.js",function(){return saveAs}),function(t){"undefined"!=typeof exports?t(exports):(window.hljs=t({}),"function"==typeof define&&define.amd&&define([],function(){return window.hljs}))}(function(t){function e(t){return t.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;")}function i(t){return t.nodeName.toLowerCase()}function n(t,e){var i=t&&t.exec(e);return i&&0==i.index}function s(t,e){var i={};for(var n in t)i[n]=t[n];if(e)for(var n in e)i[n]=e[n];return i}function o(t){var e=[];return function t(n,s){for(var o=n.firstChild;o;o=o.nextSibling)3==o.nodeType?s+=o.nodeValue.length:1==o.nodeType&&(e.push({event:"start",offset:s,node:o}),s=t(o,s),i(o).match(/br|hr|img|input/)||e.push({event:"stop",offset:s,node:o}));return s}(t,0),e}function r(t,n,s){function o(){return t.length&&n.length?t[0].offset!=n[0].offset?t[0].offset<n[0].offset?t:n:"start"==n[0].event?t:n:t.length?t:n}function r(t){d+="<"+i(t)+Array.prototype.map.call(t.attributes,function(t){return" "+t.nodeName+'="'+e(t.value)+'"'}).join("")+">"}function a(t){d+="</"+i(t)+">"}function c(t){("start"==t.event?r:a)(t.node)}for(var l=0,d="",h=[];t.length||n.length;){var u=o();if(d+=e(s.substr(l,u[0].offset-l)),l=u[0].offset,u==t){h.reverse().forEach(a);do{c(u.splice(0,1)[0]),u=o()}while(u==t&&u.length&&u[0].offset==l);h.reverse().forEach(r)}else"start"==u[0].event?h.push(u[0].node):h.pop(),c(u.splice(0,1)[0])}return d+e(s.substr(l))}function a(t){function e(t){return t&&t.source||t}function i(i,n){return RegExp(e(i),"m"+(t.cI?"i":"")+(n?"g":""))}!function n(o,r){if(!o.compiled){if(o.compiled=!0,o.k=o.k||o.bK,o.k){var a={},c=function(e,i){t.cI&&(i=i.toLowerCase()),i.split(" ").forEach(function(t){var i=t.split("|");a[i[0]]=[e,i[1]?Number(i[1]):1]})};"string"==typeof o.k?c("keyword",o.k):Object.keys(o.k).forEach(function(t){c(t,o.k[t])}),o.k=a}o.lR=i(o.l||/\b[A-Za-z0-9_]+\b/,!0),r&&(o.bK&&(o.b="\\b("+o.bK.split(" ").join("|")+")\\b"),o.b||(o.b=/\B|\b/),o.bR=i(o.b),o.e||o.eW||(o.e=/\B|\b/),o.e&&(o.eR=i(o.e)),o.tE=e(o.e)||"",o.eW&&r.tE&&(o.tE+=(o.e?"|":"")+r.tE)),o.i&&(o.iR=i(o.i)),void 0===o.r&&(o.r=1),o.c||(o.c=[]);var l=[];o.c.forEach(function(t){t.v?t.v.forEach(function(e){l.push(s(t,e))}):l.push("self"==t?o:t)}),o.c=l,o.c.forEach(function(t){n(t,o)}),o.starts&&n(o.starts,r);var d=o.c.map(function(t){return t.bK?"\\.?("+t.b+")\\.?":t.b}).concat([o.tE,o.i]).map(e).filter(Boolean);o.t=d.length?i(d.join("|"),!0):{exec:function(){return null}}}}(t)}function c(t,i,s,o){function r(t,e){for(var i=0;i<e.c.length;i++)if(n(e.c[i].bR,t))return e.c[i]}function d(t,e){return n(t.eR,e)?t:t.eW?d(t.parent,e):void 0}function h(t,e){return!s&&n(e.iR,t)}function u(t,e){var i=y.cI?e[0].toLowerCase():e[0];return t.k.hasOwnProperty(i)&&t.k[i]}function _(t,e,i,n){var s='<span class="'+(n?"":p.classPrefix);return(s+=t+'">')+e+(i?"":"</span>")}function g(){return void 0!==k.sL?function(){if(k.sL&&!f[k.sL])return e(E);var t=k.sL?c(k.sL,E,!0,w[k.sL]):l(E);return k.r>0&&(B+=t.r),"continuous"==k.subLanguageMode&&(w[k.sL]=t.top),_(t.language,t.value,!1,!0)}():function(){if(!k.k)return e(E);var t="",i=0;k.lR.lastIndex=0;for(var n=k.lR.exec(E);n;){t+=e(E.substr(i,n.index-i));var s=u(k,n);s?(B+=s[1],t+=_(s[0],e(n[0]))):t+=e(n[0]),i=k.lR.lastIndex,n=k.lR.exec(E)}return t+e(E.substr(i))}()}function b(t,i){var n=t.cN?_(t.cN,"",!0):"";t.rB?(M+=n,E=""):t.eB?(M+=e(i)+n,E=""):(M+=n,E=i),k=Object.create(t,{parent:{value:k}})}function v(t,i){if(E+=t,void 0===i)return M+=g(),0;var n=r(i,k);if(n)return M+=g(),b(n,i),n.rB?0:i.length;var s=d(k,i);if(s){var o=k;o.rE||o.eE||(E+=i),M+=g();do{k.cN&&(M+="</span>"),B+=k.r,k=k.parent}while(k!=s.parent);return o.eE&&(M+=e(i)),E="",s.starts&&b(s.starts,""),o.rE?0:i.length}if(h(i,k))throw new Error('Illegal lexeme "'+i+'" for mode "'+(k.cN||"<unnamed>")+'"');return E+=i,i.length||1}var y=m(t);if(!y)throw new Error('Unknown language: "'+t+'"');a(y);for(var k=o||y,w={},M="",x=k;x!=y;x=x.parent)x.cN&&(M=_(x.cN,"",!0)+M);var E="",B=0;try{for(var I,S,C=0;k.t.lastIndex=C,I=k.t.exec(i);)S=v(i.substr(C,I.index-C),I[0]),C=I.index+S;v(i.substr(C));for(x=k;x.parent;x=x.parent)x.cN&&(M+="</span>");return{r:B,value:M,language:t,top:k}}catch(t){if(-1!=t.message.indexOf("Illegal"))return{r:0,value:e(i)};throw t}}function l(t,i){i=i||p.languages||Object.keys(f);var n={r:0,value:e(t)},s=n;return i.forEach(function(e){if(m(e)){var i=c(e,t,!1);i.language=e,i.r>s.r&&(s=i),i.r>n.r&&(s=n,n=i)}}),s.language&&(n.second_best=s),n}function d(t){return p.tabReplace&&(t=t.replace(/^((<[^>]+>|\t)+)/gm,function(t,e){return e.replace(/\t/g,p.tabReplace)})),p.useBR&&(t=t.replace(/\n/g,"<br>")),t}function h(t){var e=function(t){var e=(t.className+" "+(t.parentNode?t.parentNode.className:"")).split(/\s+/);return(e=e.map(function(t){return t.replace(/^lang(uage)?-/,"")})).filter(function(t){return m(t)||/no(-?)highlight/.test(t)})[0]}(t);if(!/no(-?)highlight/.test(e)){var i;p.useBR?(i=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=t.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n"):i=t;var n=i.textContent,s=e?c(e,n,!0):l(n),a=o(i);if(a.length){var h=document.createElementNS("http://www.w3.org/1999/xhtml","div");h.innerHTML=s.value,s.value=r(a,o(h),n)}s.value=d(s.value),t.innerHTML=s.value,t.className=function(t,e,i){var n=e?_[e]:i,s=[t.trim()];return t.match(/(\s|^)hljs(\s|$)/)||s.push("hljs"),n&&s.push(n),s.join(" ").trim()}(t.className,e,s.language),t.result={language:s.language,re:s.r},s.second_best&&(t.second_best={language:s.second_best.language,re:s.second_best.r})}}function u(){if(!u.called){u.called=!0;var t=document.querySelectorAll("pre code");Array.prototype.forEach.call(t,h)}}function m(t){return f[t]||f[_[t]]}var p={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},f={},_={};return t.highlight=c,t.highlightAuto=l,t.fixMarkup=d,t.highlightBlock=h,t.configure=function(t){p=s(p,t)},t.initHighlighting=u,t.initHighlightingOnLoad=function(){addEventListener("DOMContentLoaded",u,!1),addEventListener("load",u,!1)},t.registerLanguage=function(e,i){var n=f[e]=i(t);n.aliases&&n.aliases.forEach(function(t){_[t]=e})},t.listLanguages=function(){return Object.keys(f)},t.getLanguage=m,t.inherit=s,t.IR="[a-zA-Z][a-zA-Z0-9_]*",t.UIR="[a-zA-Z_][a-zA-Z0-9_]*",t.NR="\\b\\d+(\\.\\d+)?",t.CNR="(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",t.BNR="\\b(0b[01]+)",t.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",t.BE={b:"\\\\[\\s\\S]",r:0},t.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[t.BE]},t.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[t.BE]},t.PWM={b:/\b(a|an|the|are|I|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such)\b/},t.CLCM={cN:"comment",b:"//",e:"$",c:[t.PWM]},t.CBCM={cN:"comment",b:"/\\*",e:"\\*/",c:[t.PWM]},t.HCM={cN:"comment",b:"#",e:"$",c:[t.PWM]},t.NM={cN:"number",b:t.NR,r:0},t.CNM={cN:"number",b:t.CNR,r:0},t.BNM={cN:"number",b:t.BNR,r:0},t.CSSNM={cN:"number",b:t.NR+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",r:0},t.RM={cN:"regexp",b:/\//,e:/\/[gimuy]*/,i:/\n/,c:[t.BE,{b:/\[/,e:/\]/,r:0,c:[t.BE]}]},t.TM={cN:"title",b:t.IR,r:0},t.UTM={cN:"title",b:t.UIR,r:0},t}),hljs.registerLanguage("clojure",function(t){var e="a-zA-Z_\\-!.?+*=<>&#'",i="["+e+"]["+e+"0-9/;:]*",n={b:i,r:0},s={cN:"number",b:"[-+]?\\d+(\\.\\d+)?",r:0},o=t.inherit(t.QSM,{i:null}),r={cN:"comment",b:";",e:"$",r:0},a={cN:"literal",b:/\b(true|false|nil)\b/},c={cN:"collection",b:"[\\[\\{]",e:"[\\]\\}]"},l={cN:"comment",b:"\\^"+i},d={cN:"comment",b:"\\^\\{",e:"\\}"},h={cN:"attribute",b:"[:]"+i},u={cN:"list",b:"\\(",e:"\\)"},m={eW:!0,r:0},p={k:{built_in:"def cond apply if-not if-let if not not= = < > <= >= == + / * - rem quot neg? pos? delay? symbol? keyword? true? false? integer? empty? coll? list? set? ifn? fn? associative? sequential? sorted? counted? reversible? number? decimal? class? distinct? isa? float? rational? reduced? ratio? odd? even? char? seq? vector? string? map? nil? contains? zero? instance? not-every? not-any? libspec? -> ->> .. . inc compare do dotimes mapcat take remove take-while drop letfn drop-last take-last drop-while while intern condp case reduced cycle split-at split-with repeat replicate iterate range merge zipmap declare line-seq sort comparator sort-by dorun doall nthnext nthrest partition eval doseq await await-for let agent atom send send-off release-pending-sends add-watch mapv filterv remove-watch agent-error restart-agent set-error-handler error-handler set-error-mode! error-mode shutdown-agents quote var fn loop recur throw try monitor-enter monitor-exit defmacro defn defn- macroexpand macroexpand-1 for dosync and or when when-not when-let comp juxt partial sequence memoize constantly complement identity assert peek pop doto proxy defstruct first rest cons defprotocol cast coll deftype defrecord last butlast sigs reify second ffirst fnext nfirst nnext defmulti defmethod meta with-meta ns in-ns create-ns import refer keys select-keys vals key val rseq name namespace promise into transient persistent! conj! assoc! dissoc! pop! disj! use class type num float double short byte boolean bigint biginteger bigdec print-method print-dup throw-if printf format load compile get-in update-in pr pr-on newline flush read slurp read-line subvec with-open memfn time re-find re-groups rand-int rand mod locking assert-valid-fdecl alias resolve ref deref refset swap! reset! set-validator! compare-and-set! alter-meta! reset-meta! commute get-validator alter ref-set ref-history-count ref-min-history ref-max-history ensure sync io! new next conj set! to-array future future-call into-array aset gen-class reduce map filter find empty hash-map hash-set sorted-map sorted-map-by sorted-set sorted-set-by vec vector seq flatten reverse assoc dissoc list disj get union difference intersection extend extend-type extend-protocol int nth delay count concat chunk chunk-buffer chunk-append chunk-first chunk-rest max min dec unchecked-inc-int unchecked-inc unchecked-dec-inc unchecked-dec unchecked-negate unchecked-add-int unchecked-add unchecked-subtract-int unchecked-subtract chunk-next chunk-cons chunked-seq? prn vary-meta lazy-seq spread list* str find-keyword keyword symbol gensym force rationalize"},l:i,cN:"keyword",b:i,starts:m},f=[u,o,l,d,r,h,c,s,a,n];return u.c=[{cN:"comment",b:"comment"},p,m],m.c=f,c.c=f,{aliases:["clj"],i:/\S/,c:[u,o,l,d,r,h,c,s,a]}}),hljs.registerLanguage("cpp",function(t){var e={keyword:"false int float while private char catch export virtual operator sizeof dynamic_cast|10 typedef const_cast|10 const struct for static_cast|10 union namespace unsigned long volatile static protected bool template mutable if public friend do goto auto void enum else break extern using true class asm case typeid short reinterpret_cast|10 default double register explicit signed typename try this switch continue wchar_t inline delete alignof char16_t char32_t constexpr decltype noexcept nullptr static_assert thread_local restrict _Bool complex _Complex _Imaginaryintmax_t uintmax_t int8_t uint8_t int16_t uint16_t int32_t uint32_t  int64_t uint64_tint_least8_t uint_least8_t int_least16_t uint_least16_t int_least32_t uint_least32_tint_least64_t uint_least64_t int_fast8_t uint_fast8_t int_fast16_t uint_fast16_t int_fast32_tuint_fast32_t int_fast64_t uint_fast64_t intptr_t uintptr_t atomic_bool atomic_char atomic_scharatomic_uchar atomic_short atomic_ushort atomic_int atomic_uint atomic_long atomic_ulong atomic_llongatomic_ullong atomic_wchar_t atomic_char16_t atomic_char32_t atomic_intmax_t atomic_uintmax_tatomic_intptr_t atomic_uintptr_t atomic_size_t atomic_ptrdiff_t atomic_int_least8_t atomic_int_least16_tatomic_int_least32_t atomic_int_least64_t atomic_uint_least8_t atomic_uint_least16_t atomic_uint_least32_tatomic_uint_least64_t atomic_int_fast8_t atomic_int_fast16_t atomic_int_fast32_t atomic_int_fast64_tatomic_uint_fast8_t atomic_uint_fast16_t atomic_uint_fast32_t atomic_uint_fast64_t",built_in:"std string cin cout cerr clog stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap array shared_ptr abort abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf"};return{aliases:["c","h","c++","h++"],k:e,i:"</",c:[t.CLCM,t.CBCM,t.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},t.CNM,{cN:"preprocessor",b:"#",e:"$",k:"if else elif endif define undef warning error line pragma",c:[{b:'include\\s*[<"]',e:'[>"]',k:"include",i:"\\n"},t.CLCM]},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:e,c:["self"]},{b:t.IR+"::"},{bK:"new throw return",r:0},{cN:"function",b:"("+t.IR+"\\s+)+"+t.IR+"\\s*\\(",rB:!0,e:/[{;=]/,eE:!0,k:e,c:[{b:t.IR+"\\s*\\(",rB:!0,c:[t.TM],r:0},{cN:"params",b:/\(/,e:/\)/,k:e,r:0,c:[t.CBCM]},t.CLCM,t.CBCM]}]}}),hljs.registerLanguage("ruby",function(t){var e="[a-zA-Z_]\\w*[!?=]?|[-+~]\\@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?",i="and false then defined module in return redo if BEGIN retry end for true self when next until do begin unless END rescue nil else break undef not super class case require yield alias while ensure elsif or include attr_reader attr_writer attr_accessor",n={cN:"yardoctag",b:"@[A-Za-z]+"},s={cN:"value",b:"#<",e:">"},o={cN:"comment",v:[{b:"#",e:"$",c:[n]},{b:"^\\=begin",e:"^\\=end",c:[n],r:10},{b:"^__END__",e:"\\n$"}]},r={cN:"subst",b:"#\\{",e:"}",k:i},a={cN:"string",c:[t.BE,r],v:[{b:/'/,e:/'/},{b:/"/,e:/"/},{b:/`/,e:/`/},{b:"%[qQwWx]?\\(",e:"\\)"},{b:"%[qQwWx]?\\[",e:"\\]"},{b:"%[qQwWx]?{",e:"}"},{b:"%[qQwWx]?<",e:">"},{b:"%[qQwWx]?/",e:"/"},{b:"%[qQwWx]?%",e:"%"},{b:"%[qQwWx]?-",e:"-"},{b:"%[qQwWx]?\\|",e:"\\|"},{b:/\B\?(\\\d{1,3}|\\x[A-Fa-f0-9]{1,2}|\\u[A-Fa-f0-9]{4}|\\?\S)\b/}]},c={cN:"params",b:"\\(",e:"\\)",k:i},l=[a,s,o,{cN:"class",bK:"class module",e:"$|;",i:/=/,c:[t.inherit(t.TM,{b:"[A-Za-z_]\\w*(::\\w+)*(\\?|\\!)?"}),{cN:"inheritance",b:"<\\s*",c:[{cN:"parent",b:"("+t.IR+"::)?"+t.IR}]},o]},{cN:"function",bK:"def",e:" |$|;",r:0,c:[t.inherit(t.TM,{b:e}),c,o]},{cN:"constant",b:"(::)?(\\b[A-Z]\\w*(::)?)+",r:0},{cN:"symbol",b:t.UIR+"(\\!|\\?)?:",r:0},{cN:"symbol",b:":",c:[a,{b:e}],r:0},{cN:"number",b:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",r:0},{cN:"variable",b:"(\\$\\W)|((\\$|\\@\\@?)(\\w+))"},{b:"("+t.RSR+")\\s*",c:[s,o,{cN:"regexp",c:[t.BE,r],i:/\n/,v:[{b:"/",e:"/[a-z]*"},{b:"%r{",e:"}[a-z]*"},{b:"%r\\(",e:"\\)[a-z]*"},{b:"%r!",e:"![a-z]*"},{b:"%r\\[",e:"\\][a-z]*"}]}],r:0}];r.c=l,c.c=l;return{aliases:["rb","gemspec","podspec","thor","irb"],k:i,c:[o].concat([{b:/^\s*=>/,cN:"status",starts:{e:"$",c:l}},{cN:"prompt",b:"^([>?]>|[\\w#]+\\(\\w+\\):\\d+:\\d+>|(\\w+-)?\\d+\\.\\d+\\.\\d(p\\d+)?[^>]+>)",starts:{e:"$",c:l}}]).concat(l)}}),hljs.registerLanguage("apache",function(t){var e={cN:"number",b:"[\\$%]\\d+"};return{aliases:["apacheconf"],cI:!0,c:[t.HCM,{cN:"tag",b:"</?",e:">"},{cN:"keyword",b:/\w+/,r:0,k:{common:"order deny allow setenv rewriterule rewriteengine rewritecond documentroot sethandler errordocument loadmodule options header listen serverroot servername"},starts:{e:/$/,r:0,k:{literal:"on off all"},c:[{cN:"sqbracket",b:"\\s\\[",e:"\\]$"},{cN:"cbracket",b:"[\\$%]\\{",e:"\\}",c:["self",e]},e,t.QSM]}}],i:/\S/}}),hljs.registerLanguage("python",function(t){var e={cN:"prompt",b:/^(>>>|\.\.\.) /},i={cN:"string",c:[t.BE],v:[{b:/(u|b)?r?'''/,e:/'''/,c:[e],r:10},{b:/(u|b)?r?"""/,e:/"""/,c:[e],r:10},{b:/(u|r|ur)'/,e:/'/,r:10},{b:/(u|r|ur)"/,e:/"/,r:10},{b:/(b|br)'/,e:/'/},{b:/(b|br)"/,e:/"/},t.ASM,t.QSM]},n={cN:"number",r:0,v:[{b:t.BNR+"[lLjJ]?"},{b:"\\b(0o[0-7]+)[lLjJ]?"},{b:t.CNR+"[lLjJ]?"}]},s={cN:"params",b:/\(/,e:/\)/,c:["self",e,n,i]};return{aliases:["py","gyp"],k:{keyword:"and elif is global as in if from raise for except finally print import pass return exec else break not with class assert yield try while continue del or def lambda nonlocal|10 None True False",built_in:"Ellipsis NotImplemented"},i:/(<\/|->|\?)/,c:[e,n,i,t.HCM,{v:[{cN:"function",bK:"def",r:10},{cN:"class",bK:"class"}],e:/:/,i:/[${=;\n]/,c:[t.UTM,s]},{cN:"decorator",b:/@/,e:/$/},{b:/\b(print|exec)\(/}]}}),hljs.registerLanguage("erlang-repl",function(t){return{k:{special_functions:"spawn spawn_link self",reserved:"after and andalso|10 band begin bnot bor bsl bsr bxor case catch cond div end fun if let not of or orelse|10 query receive rem try when xor"},c:[{cN:"prompt",b:"^[0-9]+> ",r:10},{cN:"comment",b:"%",e:"$"},{cN:"number",b:"\\b(\\d+#[a-fA-F0-9]+|\\d+(\\.\\d+)?([eE][-+]?\\d+)?)",r:0},t.ASM,t.QSM,{cN:"constant",b:"\\?(::)?([A-Z]\\w*(::)?)+"},{cN:"arrow",b:"->"},{cN:"ok",b:"ok"},{cN:"exclamation_mark",b:"!"},{cN:"function_or_atom",b:"(\\b[a-z'][a-zA-Z0-9_']*:[a-z'][a-zA-Z0-9_']*)|(\\b[a-z'][a-zA-Z0-9_']*)",r:0},{cN:"variable",b:"[A-Z][a-zA-Z0-9_']*",r:0}]}}),hljs.registerLanguage("applescript",function(t){var e=t.inherit(t.QSM,{i:""}),i={cN:"params",b:"\\(",e:"\\)",c:["self",t.CNM,e]},n=[{cN:"comment",b:"--",e:"$"},{cN:"comment",b:"\\(\\*",e:"\\*\\)",c:["self",{b:"--",e:"$"}]},t.HCM];return{aliases:["osascript"],k:{keyword:"about above after against and around as at back before beginning behind below beneath beside between but by considering contain contains continue copy div does eighth else end equal equals error every exit fifth first for fourth from front get given global if ignoring in into is it its last local me middle mod my ninth not of on onto or over prop property put ref reference repeat returning script second set seventh since sixth some tell tenth that the|0 then third through thru timeout times to transaction try until where while whose with without",constant:"AppleScript false linefeed return pi quote result space tab true",type:"alias application boolean class constant date file integer list number real record string text",command:"activate beep count delay launch log offset read round run say summarize write",property:"character characters contents day frontmost id item length month name paragraph paragraphs rest reverse running time version weekday word words year"},c:[e,t.CNM,{cN:"type",b:"\\bPOSIX file\\b"},{cN:"command",b:"\\b(clipboard info|the clipboard|info for|list (disks|folder)|mount volume|path to|(close|open for) access|(get|set) eof|current date|do shell script|get volume settings|random number|set volume|system attribute|system info|time to GMT|(load|run|store) script|scripting components|ASCII (character|number)|localized string|choose (application|color|file|file name|folder|from list|remote application|URL)|display (alert|dialog))\\b|^\\s*return\\b"},{cN:"constant",b:"\\b(text item delimiters|current application|missing value)\\b"},{cN:"keyword",b:"\\b(apart from|aside from|instead of|out of|greater than|isn't|(doesn't|does not) (equal|come before|come after|contain)|(greater|less) than( or equal)?|(starts?|ends|begins?) with|contained by|comes (before|after)|a (ref|reference))\\b"},{cN:"property",b:"\\b(POSIX path|(date|time) string|quoted form)\\b"},{cN:"function_start",bK:"on",i:"[${=;\\n]",c:[t.UTM,i]}].concat(n),i:"//|->|=>"}}),hljs.registerLanguage("javascript",function(t){return{aliases:["js"],k:{keyword:"in if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const class",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document"},c:[{cN:"pi",r:10,v:[{b:/^\s*('|")use strict('|")/},{b:/^\s*('|")use asm('|")/}]},t.ASM,t.QSM,t.CLCM,t.CBCM,t.CNM,{b:"("+t.RSR+"|\\b(case|return|throw)\\b)\\s*",k:"return throw case",c:[t.CLCM,t.CBCM,t.RM,{b:/</,e:/>;/,r:0,sL:"xml"}],r:0},{cN:"function",bK:"function",e:/\{/,eE:!0,c:[t.inherit(t.TM,{b:/[A-Za-z$_][0-9A-Za-z$_]*/}),{cN:"params",b:/\(/,e:/\)/,c:[t.CLCM,t.CBCM],i:/["'\(]/}],i:/\[|%/},{b:/\$[(.]/},{b:"\\."+t.IR,r:0}]}}),hljs.registerLanguage("vbscript",function(t){return{aliases:["vbs"],cI:!0,k:{keyword:"call class const dim do loop erase execute executeglobal exit for each next function if then else on error option explicit new private property let get public randomize redim rem select case set stop sub while wend with end to elseif is or xor and not class_initialize class_terminate default preserve in me byval byref step resume goto",built_in:"lcase month vartype instrrev ubound setlocale getobject rgb getref string weekdayname rnd dateadd monthname now day minute isarray cbool round formatcurrency conversions csng timevalue second year space abs clng timeserial fixs len asc isempty maths dateserial atn timer isobject filter weekday datevalue ccur isdate instr datediff formatdatetime replace isnull right sgn array snumeric log cdbl hex chr lbound msgbox ucase getlocale cos cdate cbyte rtrim join hour oct typename trim strcomp int createobject loadpicture tan formatnumber mid scriptenginebuildversion scriptengine split scriptengineminorversion cint sin datepart ltrim sqr scriptenginemajorversion time derived eval date formatpercent exp inputbox left ascw chrw regexp server response request cstr err",literal:"true false null nothing empty"},i:"//",c:[t.inherit(t.QSM,{c:[{b:'""'}]}),{cN:"comment",b:/'/,e:/$/,r:0},t.CNM]}}),hljs.registerLanguage("coffeescript",function(t){var e={keyword:"in if for while finally new do return else break catch instanceof throw try this switch continue typeof delete debugger super then unless until loop of by when and or is isnt not",literal:"true false null undefined yes no on off",reserved:"case default function var void with const let enum export import native __hasProp __extends __slice __bind __indexOf",built_in:"npm require console print module global window document"},i="[A-Za-z$_][0-9A-Za-z$_]*",n={cN:"subst",b:/#\{/,e:/}/,k:e},s=[t.BNM,t.inherit(t.CNM,{starts:{e:"(\\s*/)?",r:0}}),{cN:"string",v:[{b:/'''/,e:/'''/,c:[t.BE]},{b:/'/,e:/'/,c:[t.BE]},{b:/"""/,e:/"""/,c:[t.BE,n]},{b:/"/,e:/"/,c:[t.BE,n]}]},{cN:"regexp",v:[{b:"///",e:"///",c:[n,t.HCM]},{b:"//[gim]*",r:0},{b:/\/(?![ *])(\\\/|.)*?\/[gim]*(?=\W|$)/}]},{cN:"property",b:"@"+i},{b:"`",e:"`",eB:!0,eE:!0,sL:"javascript"}];n.c=s;var o=t.inherit(t.TM,{b:i}),r="(\\(.*\\))?\\s*\\B[-=]>",a={cN:"params",b:"\\([^\\(]",rB:!0,c:[{b:/\(/,e:/\)/,k:e,c:["self"].concat(s)}]};return{aliases:["coffee","cson","iced"],k:e,i:/\/\*/,c:s.concat([{cN:"comment",b:"###",e:"###",c:[t.PWM]},t.HCM,{cN:"function",b:"^\\s*"+i+"\\s*=\\s*"+r,e:"[-=]>",rB:!0,c:[o,a]},{b:/[:\(,=]\s*/,r:0,c:[{cN:"function",b:r,e:"[-=]>",rB:!0,c:[a]}]},{cN:"class",bK:"class",e:"$",i:/[:="\[\]]/,c:[{bK:"extends",eW:!0,i:/[:="\[\]]/,c:[o]},o]},{cN:"attribute",b:i+":",e:":",rB:!0,rE:!0,r:0}])}}),hljs.registerLanguage("http",function(){return{i:"\\S",c:[{cN:"status",b:"^HTTP/[0-9\\.]+",e:"$",c:[{cN:"number",b:"\\b\\d{3}\\b"}]},{cN:"request",b:"^[A-Z]+ (.*?) HTTP/[0-9\\.]+$",rB:!0,e:"$",c:[{cN:"string",b:" ",e:" ",eB:!0,eE:!0}]},{cN:"attribute",b:"^\\w",e:": ",eE:!0,i:"\\n|\\s|=",starts:{cN:"string",e:"$"}},{b:"\\n\\n",starts:{sL:"",eW:!0}}]}}),hljs.registerLanguage("actionscript",function(t){var e={cN:"rest_arg",b:"[.]{3}",e:"[a-zA-Z_$][a-zA-Z0-9_$]*",r:10};return{aliases:["as"],k:{keyword:"as break case catch class const continue default delete do dynamic each else extends final finally for function get if implements import in include instanceof interface internal is namespace native new override package private protected public return set static super switch this throw try typeof use var void while with",literal:"true false null undefined"},c:[t.ASM,t.QSM,t.CLCM,t.CBCM,t.CNM,{cN:"package",bK:"package",e:"{",c:[t.TM]},{cN:"class",bK:"class interface",e:"{",eE:!0,c:[{bK:"extends implements"},t.TM]},{cN:"preprocessor",bK:"import include",e:";"},{cN:"function",bK:"function",e:"[{;]",eE:!0,i:"\\S",c:[t.TM,{cN:"params",b:"\\(",e:"\\)",c:[t.ASM,t.QSM,t.CLCM,t.CBCM,e]},{cN:"type",b:":",e:"([*]|[a-zA-Z_$][a-zA-Z0-9_$]*)",r:10}]}]}}),hljs.registerLanguage("haskell",function(t){var e={cN:"comment",v:[{b:"--",e:"$"},{b:"{-",e:"-}",c:["self"]}]},i={cN:"pragma",b:"{-#",e:"#-}"},n={cN:"preprocessor",b:"^#",e:"$"},s={cN:"type",b:"\\b[A-Z][\\w']*",r:0},o={cN:"container",b:"\\(",e:"\\)",i:'"',c:[i,e,n,{cN:"type",b:"\\b[A-Z][\\w]*(\\((\\.\\.|,|\\w+)\\))?"},t.inherit(t.TM,{b:"[_a-z][\\w']*"})]};return{aliases:["hs"],k:"let in if then else case of where do module import hiding qualified type data newtype deriving class instance as default infix infixl infixr foreign export ccall stdcall cplusplus jvm dotnet safe unsafe family forall mdo proc rec",c:[{cN:"module",b:"\\bmodule\\b",e:"where",k:"module where",c:[o,e],i:"\\W\\.|;"},{cN:"import",b:"\\bimport\\b",e:"$",k:"import|0 qualified as hiding",c:[o,e],i:"\\W\\.|;"},{cN:"class",b:"^(\\s*)?(class|instance)\\b",e:"where",k:"class family instance where",c:[s,o,e]},{cN:"typedef",b:"\\b(data|(new)?type)\\b",e:"$",k:"data family type newtype deriving",c:[i,e,s,o,{cN:"container",b:"{",e:"}",c:o.c}]},{cN:"default",bK:"default",e:"$",c:[s,o,e]},{cN:"infix",bK:"infix infixl infixr",e:"$",c:[t.CNM,e]},{cN:"foreign",b:"\\bforeign\\b",e:"$",k:"foreign import export ccall stdcall cplusplus jvm dotnet safe unsafe",c:[s,t.QSM,e]},{cN:"shebang",b:"#!\\/usr\\/bin\\/env runhaskell",e:"$"},i,e,n,t.QSM,t.CNM,s,t.inherit(t.TM,{b:"^[_a-z][\\w']*"}),{b:"->|<-"}]}}),hljs.registerLanguage("dos",function(t){var e={cN:"comment",b:/@?rem\b/,e:/$/,r:10};return{aliases:["bat","cmd"],cI:!0,k:{flow:"if else goto for in do call exit not exist errorlevel defined",operator:"equ neq lss leq gtr geq",keyword:"shift cd dir echo setlocal endlocal set pause copy",stream:"prn nul lpt3 lpt2 lpt1 con com4 com3 com2 com1 aux",winutils:"ping net ipconfig taskkill xcopy ren del",built_in:"append assoc at attrib break cacls cd chcp chdir chkdsk chkntfs cls cmd color comp compact convert date dir diskcomp diskcopy doskey erase fs find findstr format ftype graftabl help keyb label md mkdir mode more move path pause print popd pushd promt rd recover rem rename replace restore rmdir shiftsort start subst time title tree type ver verify vol"},c:[{cN:"envvar",b:/%%[^ ]|%[^ ]+?%|![^ ]+?!/},{cN:"function",b:"^\\s*[A-Za-z._?][A-Za-z0-9_$#@~.?]*(:|\\s+label)",e:"goto:eof",c:[t.inherit(t.TM,{b:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),e]},{cN:"number",b:"\\b\\d+",r:0},e]}}),hljs.registerLanguage("css",function(t){var e="[a-zA-Z-][a-zA-Z0-9_-]*",i={cN:"function",b:e+"\\(",rB:!0,eE:!0,e:"\\("};return{cI:!0,i:"[=/|']",c:[t.CBCM,{cN:"id",b:"\\#[A-Za-z0-9_-]+"},{cN:"class",b:"\\.[A-Za-z0-9_-]+",r:0},{cN:"attr_selector",b:"\\[",e:"\\]",i:"$"},{cN:"pseudo",b:":(:)?[a-zA-Z0-9\\_\\-\\+\\(\\)\\\"\\']+"},{cN:"at_rule",b:"@(font-face|page)",l:"[a-z-]+",k:"font-face page"},{cN:"at_rule",b:"@",e:"[{;]",c:[{cN:"keyword",b:/\S+/},{b:/\s/,eW:!0,eE:!0,r:0,c:[i,t.ASM,t.QSM,t.CSSNM]}]},{cN:"tag",b:e,r:0},{cN:"rules",b:"{",e:"}",i:"[^\\s]",r:0,c:[t.CBCM,{cN:"rule",b:"[^\\s]",rB:!0,e:";",eW:!0,c:[{cN:"attribute",b:"[A-Z\\_\\.\\-]+",e:":",eE:!0,i:"[^\\s]",starts:{cN:"value",eW:!0,eE:!0,c:[i,t.CSSNM,t.QSM,t.ASM,t.CBCM,{cN:"hexcolor",b:"#[0-9A-Fa-f]+"},{cN:"important",b:"!important"}]}}]}]}]}}),hljs.registerLanguage("tex",function(){var t={cN:"command",b:"\\\\[a-zA-Zа-яА-я]+[\\*]?"},e={cN:"command",b:"\\\\[^a-zA-Zа-яА-я0-9]"},i={cN:"special",b:"[{}\\[\\]\\&#~]",r:0};return{c:[{b:"\\\\[a-zA-Zа-яА-я]+[\\*]? *= *-?\\d*\\.?\\d+(pt|pc|mm|cm|in|dd|cc|ex|em)?",rB:!0,c:[t,e,{cN:"number",b:" *=",e:"-?\\d*\\.?\\d+(pt|pc|mm|cm|in|dd|cc|ex|em)?",eB:!0}],r:10},t,e,i,{cN:"formula",b:"\\$\\$",e:"\\$\\$",c:[t,e,i],r:0},{cN:"formula",b:"\\$",e:"\\$",c:[t,e,i],r:0},{cN:"comment",b:"%",e:"$",r:0}]}}),hljs.registerLanguage("ini",function(t){return{cI:!0,i:/\S/,c:[{cN:"comment",b:";",e:"$"},{cN:"title",b:"^\\[",e:"\\]"},{cN:"setting",b:"^[a-z0-9\\[\\]_-]+[ \\t]*=[ \\t]*",e:"$",c:[{cN:"value",eW:!0,k:"on off true false yes no",c:[t.QSM,t.NM],r:0}]}]}}),hljs.registerLanguage("objectivec",function(t){var e=/[a-zA-Z@][a-zA-Z0-9_]*/,i="@interface @class @protocol @implementation";return{aliases:["m","mm","objc","obj-c"],k:{keyword:"int float while char export sizeof typedef const struct for union unsigned long volatile static bool mutable if do return goto void enum else break extern asm case short default double register explicit signed typename this switch continue wchar_t inline readonly assign readwrite self @synchronized id typeof nonatomic super unichar IBOutlet IBAction strong weak copy in out inout bycopy byref oneway __strong __weak __block __autoreleasing @private @protected @public @try @property @end @throw @catch @finally @autoreleasepool @synthesize @dynamic @selector @optional @required",literal:"false true FALSE TRUE nil YES NO NULL",built_in:"NSString NSData NSDictionary CGRect CGPoint UIButton UILabel UITextView UIWebView MKMapView NSView NSViewController NSWindow NSWindowController NSSet NSUUID NSIndexSet UISegmentedControl NSObject UITableViewDelegate UITableViewDataSource NSThread UIActivityIndicator UITabbar UIToolBar UIBarButtonItem UIImageView NSAutoreleasePool UITableView BOOL NSInteger CGFloat NSException NSLog NSMutableString NSMutableArray NSMutableDictionary NSURL NSIndexPath CGSize UITableViewCell UIView UIViewController UINavigationBar UINavigationController UITabBarController UIPopoverController UIPopoverControllerDelegate UIImage NSNumber UISearchBar NSFetchedResultsController NSFetchedResultsChangeType UIScrollView UIScrollViewDelegate UIEdgeInsets UIColor UIFont UIApplication NSNotFound NSNotificationCenter NSNotification UILocalNotification NSBundle NSFileManager NSTimeInterval NSDate NSCalendar NSUserDefaults UIWindow NSRange NSArray NSError NSURLRequest NSURLConnection NSURLSession NSURLSessionDataTask NSURLSessionDownloadTask NSURLSessionUploadTask NSURLResponseUIInterfaceOrientation MPMoviePlayerController dispatch_once_t dispatch_queue_t dispatch_sync dispatch_async dispatch_once"},l:e,i:"</",c:[t.CLCM,t.CBCM,t.CNM,t.QSM,{cN:"string",v:[{b:'@"',e:'"',i:"\\n",c:[t.BE]},{b:"'",e:"[^\\\\]'",i:"[^\\\\][^']"}]},{cN:"preprocessor",b:"#",e:"$",c:[{cN:"title",v:[{b:'"',e:'"'},{b:"<",e:">"}]}]},{cN:"class",b:"("+i.split(" ").join("|")+")\\b",e:"({|$)",eE:!0,k:i,l:e,c:[t.UTM]},{cN:"variable",b:"\\."+t.UIR,r:0}]}}),hljs.registerLanguage("r",function(t){var e="([a-zA-Z]|\\.[a-zA-Z.])[a-zA-Z0-9._]*";return{c:[t.HCM,{b:e,l:e,k:{keyword:"function if in break next repeat else for return switch while try tryCatch|10 stop warning require library attach detach source setMethod setGeneric setGroupGeneric setClass ...|10",literal:"NULL NA TRUE FALSE T F Inf NaN NA_integer_|10 NA_real_|10 NA_character_|10 NA_complex_|10"},r:0},{cN:"number",b:"0[xX][0-9a-fA-F]+[Li]?\\b",r:0},{cN:"number",b:"\\d+(?:[eE][+\\-]?\\d*)?L\\b",r:0},{cN:"number",b:"\\d+\\.(?!\\d)(?:i\\b)?",r:0},{cN:"number",b:"\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",r:0},{b:"`",e:"`",r:0},{cN:"string",c:[t.BE],v:[{b:'"',e:'"'},{b:"'",e:"'"}]}]}}),hljs.registerLanguage("delphi",function(t){var e="exports register file shl array record property for mod while set ally label uses raise not stored class safecall var interface or private static exit index inherited to else stdcall override shr asm far resourcestring finalization packed virtual out and protected library do xorwrite goto near function end div overload object unit begin string on inline repeat until destructor write message program with read initialization except default nil if case cdecl in downto threadvar of try pascal const external constructor type public then implementation finally published procedure",i={cN:"comment",v:[{b:/\{/,e:/\}/,r:0},{b:/\(\*/,e:/\*\)/,r:10}]},n={cN:"string",b:/'/,e:/'/,c:[{b:/''/}]},s={cN:"string",b:/(#\d+)+/},o={b:t.IR+"\\s*=\\s*class\\s*\\(",rB:!0,c:[t.TM]},r={cN:"function",bK:"function constructor destructor procedure",e:/[:;]/,k:"function constructor|10 destructor|10 procedure|10",c:[t.TM,{cN:"params",b:/\(/,e:/\)/,k:e,c:[n,s]},i]};return{cI:!0,k:e,i:/"|\$[G-Zg-z]|\/\*|<\/|\|/,c:[i,t.CLCM,n,s,t.NM,o,r]}}),hljs.registerLanguage("bash",function(t){var e={cN:"variable",v:[{b:/\$[\w\d#@][\w\d_]*/},{b:/\$\{(.*?)\}/}]},i={cN:"string",b:/"/,e:/"/,c:[t.BE,e,{cN:"variable",b:/\$\(/,e:/\)/,c:[t.BE]}]};return{aliases:["sh","zsh"],l:/-?[a-z\.]+/,k:{keyword:"if then else elif fi for while in do done case esac function",literal:"true false",built_in:"break cd continue eval exec exit export getopts hash pwd readonly return shift test times trap umask unset alias bind builtin caller command declare echo enable help let local logout mapfile printf read readarray source type typeset ulimit unalias set shopt autoload bg bindkey bye cap chdir clone comparguments compcall compctl compdescribe compfiles compgroups compquote comptags comptry compvalues dirs disable disown echotc echoti emulate fc fg float functions getcap getln history integer jobs kill limit log noglob popd print pushd pushln rehash sched setcap setopt stat suspend ttyctl unfunction unhash unlimit unsetopt vared wait whence where which zcompile zformat zftp zle zmodload zparseopts zprof zpty zregexparse zsocket zstyle ztcp",operator:"-ne -eq -lt -gt -f -d -e -s -l -a"},c:[{cN:"shebang",b:/^#![^\n]+sh\s*$/,r:10},{cN:"function",b:/\w[\w\d_]*\s*\(\s*\)\s*\{/,rB:!0,c:[t.inherit(t.TM,{b:/\w[\w\d_]*/})],r:0},t.HCM,t.NM,i,{cN:"string",b:/'/,e:/'/},e]}}),hljs.registerLanguage("matlab",function(t){var e=[t.CNM,{cN:"string",b:"'",e:"'",c:[t.BE,{b:"''"}]}],i={r:0,c:[{cN:"operator",b:/'['\.]*/}]};return{k:{keyword:"break case catch classdef continue else elseif end enumerated events for function global if methods otherwise parfor persistent properties return spmd switch try while",built_in:"sin sind sinh asin asind asinh cos cosd cosh acos acosd acosh tan tand tanh atan atand atan2 atanh sec secd sech asec asecd asech csc cscd csch acsc acscd acsch cot cotd coth acot acotd acoth hypot exp expm1 log log1p log10 log2 pow2 realpow reallog realsqrt sqrt nthroot nextpow2 abs angle complex conj imag real unwrap isreal cplxpair fix floor ceil round mod rem sign airy besselj bessely besselh besseli besselk beta betainc betaln ellipj ellipke erf erfc erfcx erfinv expint gamma gammainc gammaln psi legendre cross dot factor isprime primes gcd lcm rat rats perms nchoosek factorial cart2sph cart2pol pol2cart sph2cart hsv2rgb rgb2hsv zeros ones eye repmat rand randn linspace logspace freqspace meshgrid accumarray size length ndims numel disp isempty isequal isequalwithequalnans cat reshape diag blkdiag tril triu fliplr flipud flipdim rot90 find sub2ind ind2sub bsxfun ndgrid permute ipermute shiftdim circshift squeeze isscalar isvector ans eps realmax realmin pi i inf nan isnan isinf isfinite j why compan gallery hadamard hankel hilb invhilb magic pascal rosser toeplitz vander wilkinson"},i:'(//|"|#|/\\*|\\s+/\\w+)',c:[{cN:"function",bK:"function",e:"$",c:[t.UTM,{cN:"params",b:"\\(",e:"\\)"},{cN:"params",b:"\\[",e:"\\]"}]},{b:/[a-zA-Z_][a-zA-Z_0-9]*'['\.]*/,rB:!0,r:0,c:[{b:/[a-zA-Z_][a-zA-Z_0-9]*/,r:0},i.c[0]]},{cN:"matrix",b:"\\[",e:"\\]",c:e,r:0,starts:i},{cN:"cell",b:"\\{",e:/\}/,c:e,r:0,i:/:/,starts:i},{b:/\)/,r:0,starts:i},{cN:"comment",b:"\\%",e:"$"}].concat(e)}}),hljs.registerLanguage("markdown",function(){return{aliases:["md","mkdown","mkd"],c:[{cN:"header",v:[{b:"^#{1,6}",e:"$"},{b:"^.+?\\n[=-]{2,}$"}]},{b:"<",e:">",sL:"xml",r:0},{cN:"bullet",b:"^([*+-]|(\\d+\\.))\\s+"},{cN:"strong",b:"[*_]{2}.+?[*_]{2}"},{cN:"emphasis",v:[{b:"\\*.+?\\*"},{b:"_.+?_",r:0}]},{cN:"blockquote",b:"^>\\s+",e:"$"},{cN:"code",v:[{b:"`.+?`"},{b:"^( {4}|\t)",e:"$",r:0}]},{cN:"horizontal_rule",b:"^[-\\*]{3,}",e:"$"},{b:"\\[.+?\\][\\(\\[].*?[\\)\\]]",rB:!0,c:[{cN:"link_label",b:"\\[",e:"\\]",eB:!0,rE:!0,r:0},{cN:"link_url",b:"\\]\\(",e:"\\)",eB:!0,eE:!0},{cN:"link_reference",b:"\\]\\[",e:"\\]",eB:!0,eE:!0}],r:10},{b:"^\\[.+\\]:",rB:!0,c:[{cN:"link_reference",b:"\\[",e:"\\]:",eB:!0,eE:!0,starts:{cN:"link_url",e:"$"}}]}]}}),hljs.registerLanguage("django",function(){var t={cN:"filter",b:/\|[A-Za-z]+\:?/,k:"truncatewords removetags linebreaksbr yesno get_digit timesince random striptags filesizeformat escape linebreaks length_is ljust rjust cut urlize fix_ampersands title floatformat capfirst pprint divisibleby add make_list unordered_list urlencode timeuntil urlizetrunc wordcount stringformat linenumbers slice date dictsort dictsortreversed default_if_none pluralize lower join center default truncatewords_html upper length phone2numeric wordwrap time addslashes slugify first escapejs force_escape iriencode last safe safeseq truncatechars localize unlocalize localtime utc timezone",c:[{cN:"argument",b:/"/,e:/"/},{cN:"argument",b:/'/,e:/'/}]};return{aliases:["jinja"],cI:!0,sL:"xml",subLanguageMode:"continuous",c:[{cN:"comment",b:/\{%\s*comment\s*%}/,e:/\{%\s*endcomment\s*%}/},{cN:"comment",b:/\{#/,e:/#}/},{cN:"template_tag",b:/\{%/,e:/%}/,k:"comment endcomment load templatetag ifchanged endifchanged if endif firstof for endfor in ifnotequal endifnotequal widthratio extends include spaceless endspaceless regroup by as ifequal endifequal ssi now with cycle url filter endfilter debug block endblock else autoescape endautoescape csrf_token empty elif endwith static trans blocktrans endblocktrans get_static_prefix get_media_prefix plural get_current_language language get_available_languages get_current_language_bidi get_language_info get_language_info_list localize endlocalize localtime endlocaltime timezone endtimezone get_current_timezone verbatim",c:[t]},{cN:"variable",b:/\{\{/,e:/}}/,c:[t]}]}}),hljs.registerLanguage("java",function(t){var e=t.UIR+"(<"+t.UIR+">)?",i="false synchronized int abstract float private char boolean static null if const for true while long strictfp finally protected import native final void enum else break transient catch instanceof byte super volatile case assert short package default double public try this switch continue throws protected public private",n={cN:"number",b:"(\\b(0b[01_]+)|\\b0[xX][a-fA-F0-9_]+|(\\b[\\d_]+(\\.[\\d_]*)?|\\.[\\d_]+)([eE][-+]?\\d+)?)[lLfF]?",r:0};return{aliases:["jsp"],k:i,i:/<\//,c:[{cN:"javadoc",b:"/\\*\\*",e:"\\*/",r:0,c:[{cN:"javadoctag",b:"(^|\\s)@[A-Za-z]+"}]},t.CLCM,t.CBCM,t.ASM,t.QSM,{cN:"class",bK:"class interface",e:/[{;=]/,eE:!0,k:"class interface",i:/[:"\[\]]/,c:[{bK:"extends implements"},t.UTM]},{bK:"new throw return",r:0},{cN:"function",b:"("+e+"\\s+)+"+t.UIR+"\\s*\\(",rB:!0,e:/[{;=]/,eE:!0,k:i,c:[{b:t.UIR+"\\s*\\(",rB:!0,r:0,c:[t.UTM]},{cN:"params",b:/\(/,e:/\)/,k:i,r:0,c:[t.ASM,t.QSM,t.CNM,t.CBCM]},t.CLCM,t.CBCM]},n,{cN:"annotation",b:"@[A-Za-z]+"}]}}),hljs.registerLanguage("diff",function(){return{aliases:["patch"],c:[{cN:"chunk",r:10,v:[{b:/^\@\@ +\-\d+,\d+ +\+\d+,\d+ +\@\@$/},{b:/^\*\*\* +\d+,\d+ +\*\*\*\*$/},{b:/^\-\-\- +\d+,\d+ +\-\-\-\-$/}]},{cN:"header",v:[{b:/Index: /,e:/$/},{b:/=====/,e:/=====$/},{b:/^\-\-\-/,e:/$/},{b:/^\*{3} /,e:/$/},{b:/^\+\+\+/,e:/$/},{b:/\*{5}/,e:/\*{5}$/}]},{cN:"addition",b:"^\\+",e:"$"},{cN:"deletion",b:"^\\-",e:"$"},{cN:"change",b:"^\\!",e:"$"}]}}),hljs.registerLanguage("rust",function(t){var e=t.inherit(t.CBCM);return e.c.push("self"),{aliases:["rs"],k:{keyword:"alignof as be box break const continue crate do else enum extern false fn for if impl in let loop match mod mut offsetof once priv proc pub pure ref return self sizeof static struct super trait true type typeof unsafe unsized use virtual while yield int i8 i16 i32 i64 uint u8 u32 u64 float f32 f64 str char bool",built_in:"assert! assert_eq! bitflags! bytes! cfg! col! concat! concat_idents! debug_assert! debug_assert_eq! env! panic! file! format! format_args! include_bin! include_str! line! local_data_key! module_path! option_env! print! println! select! stringify! try! unimplemented! unreachable! vec! write! writeln!"},l:t.IR+"!?",i:"</",c:[t.CLCM,e,t.inherit(t.QSM,{i:null}),{cN:"string",b:/r(#*)".*?"\1(?!#)/},{cN:"string",b:/'\\?(x\w{2}|u\w{4}|U\w{8}|.)'/},{b:/'[a-zA-Z_][a-zA-Z0-9_]*/},{cN:"number",b:/\b(0[xb][A-Za-z0-9_]+|[0-9_]+(\.[0-9_]+)?([eE][+-]?[0-9_]+)?)([uif](8|16|32|64)?)?/,r:0},{cN:"function",bK:"fn",e:"(\\(|<)",eE:!0,c:[t.UTM]},{cN:"preprocessor",b:"#\\[",e:"\\]"},{bK:"type",e:"(=|<)",c:[t.UTM],i:"\\S"},{bK:"trait enum",e:"({|<)",c:[t.UTM],i:"\\S"},{b:t.IR+"::"},{b:"->"}]}}),hljs.registerLanguage("perl",function(t){var e="getpwent getservent quotemeta msgrcv scalar kill dbmclose undef lc ma syswrite tr send umask sysopen shmwrite vec qx utime local oct semctl localtime readpipe do return format read sprintf dbmopen pop getpgrp not getpwnam rewinddir qqfileno qw endprotoent wait sethostent bless s|0 opendir continue each sleep endgrent shutdown dump chomp connect getsockname die socketpair close flock exists index shmgetsub for endpwent redo lstat msgctl setpgrp abs exit select print ref gethostbyaddr unshift fcntl syscall goto getnetbyaddr join gmtime symlink semget splice x|0 getpeername recv log setsockopt cos last reverse gethostbyname getgrnam study formline endhostent times chop length gethostent getnetent pack getprotoent getservbyname rand mkdir pos chmod y|0 substr endnetent printf next open msgsnd readdir use unlink getsockopt getpriority rindex wantarray hex system getservbyport endservent int chr untie rmdir prototype tell listen fork shmread ucfirst setprotoent else sysseek link getgrgid shmctl waitpid unpack getnetbyname reset chdir grep split require caller lcfirst until warn while values shift telldir getpwuid my getprotobynumber delete and sort uc defined srand accept package seekdir getprotobyname semop our rename seek if q|0 chroot sysread setpwent no crypt getc chown sqrt write setnetent setpriority foreach tie sin msgget map stat getlogin unless elsif truncate exec keys glob tied closedirioctl socket readlink eval xor readline binmode setservent eof ord bind alarm pipe atan2 getgrent exp time push setgrent gt lt or ne m|0 break given say state when",i={cN:"subst",b:"[$@]\\{",e:"\\}",k:e},n={b:"->{",e:"}"},s={cN:"variable",v:[{b:/\$\d/},{b:/[\$\%\@](\^\w\b|#\w+(\:\:\w+)*|{\w+}|\w+(\:\:\w*)*)/},{b:/[\$\%\@][^\s\w{]/,r:0}]},o={cN:"comment",b:"^(__END__|__DATA__)",e:"\\n$",r:5},r=[t.BE,i,s],a=[s,t.HCM,o,{cN:"comment",b:"^\\=\\w",e:"\\=cut",eW:!0},n,{cN:"string",c:r,v:[{b:"q[qwxr]?\\s*\\(",e:"\\)",r:5},{b:"q[qwxr]?\\s*\\[",e:"\\]",r:5},{b:"q[qwxr]?\\s*\\{",e:"\\}",r:5},{b:"q[qwxr]?\\s*\\|",e:"\\|",r:5},{b:"q[qwxr]?\\s*\\<",e:"\\>",r:5},{b:"qw\\s+q",e:"q",r:5},{b:"'",e:"'",c:[t.BE]},{b:'"',e:'"'},{b:"`",e:"`",c:[t.BE]},{b:"{\\w+}",c:[],r:0},{b:"-?\\w+\\s*\\=\\>",c:[],r:0}]},{cN:"number",b:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",r:0},{b:"(\\/\\/|"+t.RSR+"|\\b(split|return|print|reverse|grep)\\b)\\s*",k:"split return print reverse grep",r:0,c:[t.HCM,o,{cN:"regexp",b:"(s|tr|y)/(\\\\.|[^/])*/(\\\\.|[^/])*/[a-z]*",r:10},{cN:"regexp",b:"(m|qr)?/",e:"/[a-z]*",c:[t.BE],r:0}]},{cN:"sub",bK:"sub",e:"(\\s*\\(.*?\\))?[;{]",r:5},{cN:"operator",b:"-\\w\\b",r:0}];return i.c=a,n.c=a,{aliases:["pl"],k:e,c:a}}),hljs.registerLanguage("haml",function(){return{cI:!0,c:[{cN:"doctype",b:"^!!!( (5|1\\.1|Strict|Frameset|Basic|Mobile|RDFa|XML\\b.*))?$",r:10},{cN:"comment",b:"^\\s*(!=#|=#|-#|/).*$",r:0},{b:"^\\s*(-|=|!=)(?!#)",starts:{e:"\\n",sL:"ruby"}},{cN:"tag",b:"^\\s*%",c:[{cN:"title",b:"\\w+"},{cN:"value",b:"[#\\.]\\w+"},{b:"{\\s*",e:"\\s*}",eE:!0,c:[{b:":\\w+\\s*=>",e:",\\s+",rB:!0,eW:!0,c:[{cN:"symbol",b:":\\w+"},{cN:"string",b:'"',e:'"'},{cN:"string",b:"'",e:"'"},{b:"\\w+",r:0}]}]},{b:"\\(\\s*",e:"\\s*\\)",eE:!0,c:[{b:"\\w+\\s*=",e:"\\s+",rB:!0,eW:!0,c:[{cN:"attribute",b:"\\w+",r:0},{cN:"string",b:'"',e:'"'},{cN:"string",b:"'",e:"'"},{b:"\\w+",r:0}]}]}]},{cN:"bullet",b:"^\\s*[=~]\\s*",r:0},{b:"#{",starts:{e:"}",sL:"ruby"}}]}}),hljs.registerLanguage("erlang",function(t){var e="[a-z'][a-zA-Z0-9_']*",i="("+e+":"+e+"|"+e+")",n={keyword:"after and andalso|10 band begin bnot bor bsl bzr bxor case catch cond div end fun if let not of orelse|10 query receive rem try when xor",literal:"false true"},s={cN:"comment",b:"%",e:"$"},o={cN:"number",b:"\\b(\\d+#[a-fA-F0-9]+|\\d+(\\.\\d+)?([eE][-+]?\\d+)?)",r:0},r={b:"fun\\s+"+e+"/\\d+"},a={b:i+"\\(",e:"\\)",rB:!0,r:0,c:[{cN:"function_name",b:i,r:0},{b:"\\(",e:"\\)",eW:!0,rE:!0,r:0}]},c={cN:"tuple",b:"{",e:"}",r:0},l={cN:"variable",b:"\\b_([A-Z][A-Za-z0-9_]*)?",r:0},d={cN:"variable",b:"[A-Z][a-zA-Z0-9_]*",r:0},h={b:"#"+t.UIR,r:0,rB:!0,c:[{cN:"record_name",b:"#"+t.UIR,r:0},{b:"{",e:"}",r:0}]},u={bK:"fun receive if try case",e:"end",k:n};u.c=[s,r,t.inherit(t.ASM,{cN:""}),u,a,t.QSM,o,c,l,d,h];var m=[s,r,u,a,t.QSM,o,c,l,d,h];a.c[1].c=m,c.c=m,h.c[1].c=m;var p={cN:"params",b:"\\(",e:"\\)",c:m};return{aliases:["erl"],k:n,i:"(</|\\*=|\\+=|-=|/\\*|\\*/|\\(\\*|\\*\\))",c:[{cN:"function",b:"^"+e+"\\s*\\(",e:"->",rB:!0,i:"\\(|#|//|/\\*|\\\\|:|;",c:[p,t.inherit(t.TM,{b:e})],starts:{e:";|\\.",k:n,c:m}},s,{cN:"pp",b:"^-",e:"\\.",r:0,eE:!0,rB:!0,l:"-"+t.IR,k:"-module -record -undef -export -ifdef -ifndef -author -copyright -doc -vsn -import -include -include_lib -compile -define -else -endif -file -behaviour -behavior -spec",c:[p]},o,t.QSM,h,l,d,c,{b:/\.$/}]}}),hljs.registerLanguage("1c",function(t){var e="[a-zA-Zа-яА-Я][a-zA-Z0-9_а-яА-Я]*",i={cN:"dquote",b:'""'},n={cN:"string",b:'"',e:'"|$',c:[i]},s={cN:"string",b:"\\|",e:'"|$',c:[i]};return{cI:!0,l:e,k:{keyword:"возврат дата для если и или иначе иначеесли исключение конецесли конецпопытки конецпроцедуры конецфункции конеццикла константа не перейти перем перечисление по пока попытка прервать продолжить процедура строка тогда фс функция цикл число экспорт",built_in:"ansitooem oemtoansi ввестивидсубконто ввестидату ввестизначение ввестиперечисление ввестипериод ввестиплансчетов ввестистроку ввестичисло вопрос восстановитьзначение врег выбранныйплансчетов вызватьисключение датагод датамесяц датачисло добавитьмесяц завершитьработусистемы заголовоксистемы записьжурналарегистрации запуститьприложение зафиксироватьтранзакцию значениевстроку значениевстрокувнутр значениевфайл значениеизстроки значениеизстрокивнутр значениеизфайла имякомпьютера имяпользователя каталогвременныхфайлов каталогиб каталогпользователя каталогпрограммы кодсимв командасистемы конгода конецпериодаби конецрассчитанногопериодаби конецстандартногоинтервала конквартала конмесяца коннедели лев лог лог10 макс максимальноеколичествосубконто мин монопольныйрежим названиеинтерфейса названиенабораправ назначитьвид назначитьсчет найти найтипомеченныенаудаление найтиссылки началопериодаби началостандартногоинтервала начатьтранзакцию начгода начквартала начмесяца начнедели номерднягода номерднянедели номернеделигода нрег обработкаожидания окр описаниеошибки основнойжурналрасчетов основнойплансчетов основнойязык открытьформу открытьформумодально отменитьтранзакцию очиститьокносообщений периодстр полноеимяпользователя получитьвремята получитьдатута получитьдокументта получитьзначенияотбора получитьпозициюта получитьпустоезначение получитьта прав праводоступа предупреждение префиксавтонумерации пустаястрока пустоезначение рабочаядаттьпустоезначение рабочаядата разделительстраниц разделительстрок разм разобратьпозициюдокумента рассчитатьрегистрына рассчитатьрегистрыпо сигнал симв символтабуляции создатьобъект сокрл сокрлп сокрп сообщить состояние сохранитьзначение сред статусвозврата стрдлина стрзаменить стрколичествострок стрполучитьстроку  стрчисловхождений сформироватьпозициюдокумента счетпокоду текущаядата текущеевремя типзначения типзначениястр удалитьобъекты установитьтана установитьтапо фиксшаблон формат цел шаблон"},c:[t.CLCM,t.NM,n,s,{cN:"function",b:"(процедура|функция)",e:"$",l:e,k:"процедура функция",c:[t.inherit(t.TM,{b:e}),{cN:"tail",eW:!0,c:[{cN:"params",b:"\\(",e:"\\)",l:e,k:"знач",c:[n,s]},{cN:"export",b:"экспорт",eW:!0,l:e,k:"экспорт",c:[t.CLCM]}]},t.CLCM]},{cN:"preprocessor",b:"#",e:"$"},{cN:"date",b:"'\\d{2}\\.\\d{2}\\.(\\d{2}|\\d{4})'"}]}}),hljs.registerLanguage("makefile",function(t){var e={cN:"variable",b:/\$\(/,e:/\)/,c:[t.BE]};return{aliases:["mk","mak"],c:[t.HCM,{b:/^\w+\s*\W*=/,rB:!0,r:0,starts:{cN:"constant",e:/\s*\W*=/,eE:!0,starts:{e:/$/,r:0,c:[e]}}},{cN:"title",b:/^[\w]+:\s*$/},{cN:"phony",b:/^\.PHONY:/,e:/$/,k:".PHONY",l:/[\.\w]+/},{b:/^\t+/,e:/$/,r:0,c:[t.QSM,e]}]}}),hljs.registerLanguage("cs",function(t){var e="abstract as base bool break byte case catch char checked const continue decimal default delegate do double else enum event explicit extern false finally fixed float for foreach goto if implicit in int interface internal is lock long null object operator out override params private protected public readonly ref sbyte sealed short sizeof stackalloc static string struct switch this true try typeof uint ulong unchecked unsafe ushort using virtual volatile void while async protected public private internal ascending descending from get group into join let orderby partial select set value var where yield",i=t.IR+"(<"+t.IR+">)?";return{aliases:["csharp"],k:e,i:/::/,c:[{cN:"comment",b:"///",e:"$",rB:!0,c:[{cN:"xmlDocTag",v:[{b:"///",r:0},{b:"\x3c!--|--\x3e"},{b:"</?",e:">"}]}]},t.CLCM,t.CBCM,{cN:"preprocessor",b:"#",e:"$",k:"if else elif endif define undef warning error line region endregion pragma checksum"},{cN:"string",b:'@"',e:'"',c:[{b:'""'}]},t.ASM,t.QSM,t.CNM,{bK:"class namespace interface",e:/[{;=]/,i:/[^\s:]/,c:[t.TM,t.CLCM,t.CBCM]},{bK:"new return throw await",r:0},{cN:"function",b:"("+i+"\\s+)+"+t.IR+"\\s*\\(",rB:!0,e:/[{;=]/,eE:!0,k:e,c:[{b:t.IR+"\\s*\\(",rB:!0,c:[t.TM],r:0},{cN:"params",b:/\(/,e:/\)/,k:e,r:0,c:[t.ASM,t.QSM,t.CNM,t.CBCM]},t.CLCM,t.CBCM]}]}}),hljs.registerLanguage("json",function(t){var e={literal:"true false null"},i=[t.QSM,t.CNM],n={cN:"value",e:",",eW:!0,eE:!0,c:i,k:e},s={b:"{",e:"}",c:[{cN:"attribute",b:'\\s*"',e:'"\\s*:\\s*',eB:!0,eE:!0,c:[t.BE],i:"\\n",starts:n}],i:"\\S"},o={b:"\\[",e:"\\]",c:[t.inherit(n,{cN:null})],i:"\\S"};return i.splice(i.length,0,s,o),{c:i,k:e,i:"\\S"}}),hljs.registerLanguage("lua",function(t){var e="\\[=*\\[",i="\\]=*\\]",n={b:e,e:i,c:["self"]},s=[{cN:"comment",b:"--(?!"+e+")",e:"$"},{cN:"comment",b:"--"+e,e:i,c:[n],r:10}];return{l:t.UIR,k:{keyword:"and break do else elseif end false for if in local nil not or repeat return then true until while",built_in:"_G _VERSION assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall coroutine debug io math os package string table"},c:s.concat([{cN:"function",bK:"function",e:"\\)",c:[t.inherit(t.TM,{b:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),{cN:"params",b:"\\(",eW:!0,c:s}].concat(s)},t.CNM,t.ASM,t.QSM,{cN:"string",b:e,e:i,c:[n],r:5}])}}),hljs.registerLanguage("go",function(t){return{aliases:["golang"],k:{keyword:"break default func interface select case map struct chan else goto package switch const fallthrough if range type continue for import return var go defer",constant:"true false iota nil",typename:"bool byte complex64 complex128 float32 float64 int8 int16 int32 int64 string uint8 uint16 uint32 uint64 int uint uintptr rune",built_in:"append cap close complex copy imag len make new panic print println real recover delete"},i:"</",c:[t.CLCM,t.CBCM,t.QSM,{cN:"string",b:"'",e:"[^\\\\]'"},{cN:"string",b:"`",e:"`"},{cN:"number",b:t.CNR+"[dflsi]?",r:0},t.CNM]}}),hljs.registerLanguage("nginx",function(t){var e={cN:"variable",v:[{b:/\$\d+/},{b:/\$\{/,e:/}/},{b:"[\\$\\@]"+t.UIR}]},i={eW:!0,l:"[a-z/_]+",k:{built_in:"on off yes no true false none blocked debug info notice warn error crit select break last permanent redirect kqueue rtsig epoll poll /dev/poll"},r:0,i:"=>",c:[t.HCM,{cN:"string",c:[t.BE,e],v:[{b:/"/,e:/"/},{b:/'/,e:/'/}]},{cN:"url",b:"([a-z]+):/",e:"\\s",eW:!0,eE:!0,c:[e]},{cN:"regexp",c:[t.BE,e],v:[{b:"\\s\\^",e:"\\s|{|;",rE:!0},{b:"~\\*?\\s+",e:"\\s|{|;",rE:!0},{b:"\\*(\\.[a-z\\-]+)+"},{b:"([a-z\\-]+\\.)+\\*"}]},{cN:"number",b:"\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}(:\\d{1,5})?\\b"},{cN:"number",b:"\\b\\d+[kKmMgGdshdwy]*\\b",r:0},e]};return{aliases:["nginxconf"],c:[t.HCM,{b:t.UIR+"\\s",e:";|{",rB:!0,c:[{cN:"title",b:t.UIR,starts:i}],r:0}],i:"[^\\s\\}]"}}),hljs.registerLanguage("d",function(t){var e="(0|[1-9][\\d_]*)",i="("+e+"|0[bB][01_]+|0[xX]([\\da-fA-F][\\da-fA-F_]*|_[\\da-fA-F][\\da-fA-F_]*))",n="\\\\(['\"\\?\\\\abfnrtv]|u[\\dA-Fa-f]{4}|[0-7]{1,3}|x[\\dA-Fa-f]{2}|U[\\dA-Fa-f]{8})|&[a-zA-Z\\d]{2,};",s={cN:"number",b:"\\b"+i+"(L|u|U|Lu|LU|uL|UL)?",r:0},o={cN:"number",b:"\\b(((0[xX](([\\da-fA-F][\\da-fA-F_]*|_[\\da-fA-F][\\da-fA-F_]*)\\.([\\da-fA-F][\\da-fA-F_]*|_[\\da-fA-F][\\da-fA-F_]*)|\\.?([\\da-fA-F][\\da-fA-F_]*|_[\\da-fA-F][\\da-fA-F_]*))[pP][+-]?(0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d))|((0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d)(\\.\\d*|([eE][+-]?(0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d)))|\\d+\\.(0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d)(0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d)|\\.(0|[1-9][\\d_]*)([eE][+-]?(0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d))?))([fF]|L|i|[fF]i|Li)?|"+i+"(i|[fF]i|Li))",r:0},r={cN:"string",b:"'("+n+"|.)",e:"'",i:"."},a={cN:"string",b:'"',c:[{b:n,r:0}],e:'"[cwd]?'};return{l:t.UIR,k:{keyword:"abstract alias align asm assert auto body break byte case cast catch class const continue debug default delete deprecated do else enum export extern final finally for foreach foreach_reverse|10 goto if immutable import in inout int interface invariant is lazy macro mixin module new nothrow out override package pragma private protected public pure ref return scope shared static struct super switch synchronized template this throw try typedef typeid typeof union unittest version void volatile while with __FILE__ __LINE__ __gshared|10 __thread __traits __DATE__ __EOF__ __TIME__ __TIMESTAMP__ __VENDOR__ __VERSION__",built_in:"bool cdouble cent cfloat char creal dchar delegate double dstring float function idouble ifloat ireal long real short string ubyte ucent uint ulong ushort wchar wstring",literal:"false null true"},c:[t.CLCM,t.CBCM,{cN:"comment",b:"\\/\\+",c:["self"],e:"\\+\\/",r:10},{cN:"string",b:'x"[\\da-fA-F\\s\\n\\r]*"[cwd]?',r:10},a,{cN:"string",b:'[rq]"',e:'"[cwd]?',r:5},{cN:"string",b:"`",e:"`[cwd]?"},{cN:"string",b:'q"\\{',e:'\\}"'},o,s,r,{cN:"shebang",b:"^#!",e:"$",r:5},{cN:"preprocessor",b:"#(line)",e:"$",r:5},{cN:"keyword",b:"@[a-zA-Z_][a-zA-Z_\\d]*"}]}}),hljs.registerLanguage("sql",function(t){var e={cN:"comment",b:"--",e:"$"};return{cI:!0,i:/[<>]/,c:[{cN:"operator",bK:"begin end start commit rollback savepoint lock alter create drop rename call delete do handler insert load replace select truncate update set show pragma grant merge describe use explain help declare prepare execute deallocate savepoint release unlock purge reset change stop analyze cache flush optimize repair kill install uninstall checksum restore check backup",e:/;/,eW:!0,k:{keyword:"abs absolute acos action add adddate addtime aes_decrypt aes_encrypt after aggregate all allocate alter analyze and any are as asc ascii asin assertion at atan atan2 atn2 authorization authors avg backup before begin benchmark between bin binlog bit_and bit_count bit_length bit_or bit_xor both by cache call cascade cascaded case cast catalog ceil ceiling chain change changed char_length character_length charindex charset check checksum checksum_agg choose close coalesce coercibility collate collation collationproperty column columns columns_updated commit compress concat concat_ws concurrent connect connection connection_id consistent constraint constraints continue contributors conv convert convert_tz corresponding cos cot count count_big crc32 create cross cume_dist curdate current current_date current_time current_timestamp current_user cursor curtime data database databases datalength date_add date_format date_sub dateadd datediff datefromparts datename datepart datetime2fromparts datetimeoffsetfromparts day dayname dayofmonth dayofweek dayofyear deallocate declare decode default deferrable deferred degrees delayed delete des_decrypt des_encrypt des_key_file desc describe descriptor diagnostics difference disconnect distinct distinctrow div do domain double drop dumpfile each else elt enclosed encode encrypt end end-exec engine engines eomonth errors escape escaped event eventdata events except exception exec execute exists exp explain export_set extended external extract fast fetch field fields find_in_set first first_value floor flush for force foreign format found found_rows from from_base64 from_days from_unixtime full function get get_format get_lock getdate getutcdate global go goto grant grants greatest group group_concat grouping grouping_id gtid_subset gtid_subtract handler having help hex high_priority hosts hour ident_current ident_incr ident_seed identified identity if ifnull ignore iif ilike immediate in index indicator inet6_aton inet6_ntoa inet_aton inet_ntoa infile initially inner innodb input insert install instr intersect into is is_free_lock is_ipv4 is_ipv4_compat is_ipv4_mapped is_not is_not_null is_used_lock isdate isnull isolation join key kill language last last_day last_insert_id last_value lcase lead leading least leaves left len lenght level like limit lines ln load load_file local localtime localtimestamp locate lock log log10 log2 logfile logs low_priority lower lpad ltrim make_set makedate maketime master master_pos_wait match matched max md5 medium merge microsecond mid min minute mod mode module month monthname mutex name_const names national natural nchar next no no_write_to_binlog not now nullif nvarchar oct octet_length of old_password on only open optimize option optionally or ord order outer outfile output pad parse partial partition password patindex percent_rank percentile_cont percentile_disc period_add period_diff pi plugin position pow power pragma precision prepare preserve primary prior privileges procedure procedure_analyze processlist profile profiles public publishingservername purge quarter query quick quote quotename radians rand read references regexp relative relaylog release release_lock rename repair repeat replace replicate reset restore restrict return returns reverse revoke right rlike rollback rollup round row row_count rows rpad rtrim savepoint schema scroll sec_to_time second section select serializable server session session_user set sha sha1 sha2 share show sign sin size slave sleep smalldatetimefromparts snapshot some soname soundex sounds_like space sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sql_variant_property sqlstate sqrt square start starting status std stddev stddev_pop stddev_samp stdev stdevp stop str str_to_date straight_join strcmp string stuff subdate substr substring subtime subtring_index sum switchoffset sysdate sysdatetime sysdatetimeoffset system_user sysutcdatetime table tables tablespace tan temporary terminated tertiary_weights then time time_format time_to_sec timediff timefromparts timestamp timestampadd timestampdiff timezone_hour timezone_minute to to_base64 to_days to_seconds todatetimeoffset trailing transaction translation trigger trigger_nestlevel triggers trim truncate try_cast try_convert try_parse ucase uncompress uncompressed_length unhex unicode uninstall union unique unix_timestamp unknown unlock update upgrade upped upper usage use user user_resources using utc_date utc_time utc_timestamp uuid uuid_short validate_password_strength value values var var_pop var_samp variables variance varp version view warnings week weekday weekofyear weight_string when whenever where with work write xml xor year yearweek zon",literal:"true false null",built_in:"array bigint binary bit blob boolean char character date dec decimal float int integer interval number numeric real serial smallint varchar varying int8 serial8 text"},c:[{cN:"string",b:"'",e:"'",c:[t.BE,{b:"''"}]},{cN:"string",b:'"',e:'"',c:[t.BE,{b:'""'}]},{cN:"string",b:"`",e:"`",c:[t.BE]},t.CNM,t.CBCM,e]},t.CBCM,e]}}),hljs.registerLanguage("xml",function(){var t={b:/<\?(php)?(?!\w)/,e:/\?>/,sL:"php",subLanguageMode:"continuous"},e={eW:!0,i:/</,r:0,c:[t,{cN:"attribute",b:"[A-Za-z0-9\\._:-]+",r:0},{b:"=",r:0,c:[{cN:"value",c:[t],v:[{b:/"/,e:/"/},{b:/'/,e:/'/},{b:/[^\s\/>]+/}]}]}]};return{aliases:["html","xhtml","rss","atom","xsl","plist"],cI:!0,c:[{cN:"doctype",b:"<!DOCTYPE",e:">",r:10,c:[{b:"\\[",e:"\\]"}]},{cN:"comment",b:"\x3c!--",e:"--\x3e",r:10},{cN:"cdata",b:"<\\!\\[CDATA\\[",e:"\\]\\]>",r:10},{cN:"tag",b:"<style(?=\\s|>|$)",e:">",k:{title:"style"},c:[e],starts:{e:"</style>",rE:!0,sL:"css"}},{cN:"tag",b:"<script(?=\\s|>|$)",e:">",k:{title:"script"},c:[e],starts:{e:"<\/script>",rE:!0,sL:"javascript"}},t,{cN:"pi",b:/<\?\w+/,e:/\?>/,r:10},{cN:"tag",b:"</?",e:"/?>",c:[{cN:"title",b:/[^ \/><\n\t]+/,r:0},e]}]}}),hljs.registerLanguage("profile",function(t){return{c:[t.CNM,{cN:"built_in",b:"{",e:"}$",eB:!0,eE:!0,c:[t.ASM,t.QSM],r:0},{cN:"filename",b:"[a-zA-Z_][\\da-zA-Z_]+\\.[\\da-zA-Z_]{1,3}",e:":",eE:!0},{cN:"header",b:"(ncalls|tottime|cumtime)",e:"$",k:"ncalls tottime|10 cumtime|10 filename",r:10},{cN:"summary",b:"function calls",e:"$",c:[t.CNM],r:10},t.ASM,t.QSM,{cN:"function",b:"\\(",e:"\\)$",c:[t.UTM],r:0}]}}),hljs.registerLanguage("php",function(t){var e={cN:"variable",b:"\\$+[a-zA-Z_-ÿ][a-zA-Z0-9_-ÿ]*"},i={cN:"preprocessor",b:/<\?(php)?|\?>/},n={cN:"string",c:[t.BE,i],v:[{b:'b"',e:'"'},{b:"b'",e:"'"},t.inherit(t.ASM,{i:null}),t.inherit(t.QSM,{i:null})]},s={v:[t.BNM,t.CNM]};return{aliases:["php3","php4","php5","php6"],cI:!0,k:"and include_once list abstract global private echo interface as static endswitch array null if endwhile or const for endforeach self var while isset public protected exit foreach throw elseif include __FILE__ empty require_once do xor return parent clone use __CLASS__ __LINE__ else break print eval new catch __METHOD__ case exception default die require __FUNCTION__ enddeclare final try switch continue endfor endif declare unset true false trait goto instanceof insteadof __DIR__ __NAMESPACE__ yield finally",c:[t.CLCM,t.HCM,{cN:"comment",b:"/\\*",e:"\\*/",c:[{cN:"phpdoc",b:"\\s@[A-Za-z]+"},i]},{cN:"comment",b:"__halt_compiler.+?;",eW:!0,k:"__halt_compiler",l:t.UIR},{cN:"string",b:"<<<['\"]?\\w+['\"]?$",e:"^\\w+;",c:[t.BE]},i,e,{b:/->+[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/},{cN:"function",bK:"function",e:/[;{]/,eE:!0,i:"\\$|\\[|%",c:[t.UTM,{cN:"params",b:"\\(",e:"\\)",c:["self",e,t.CBCM,n,s]}]},{cN:"class",bK:"class interface",e:"{",eE:!0,i:/[:\(\$"]/,c:[{bK:"extends implements"},t.UTM]},{bK:"namespace",e:";",i:/[\.']/,c:[t.UTM]},{bK:"use",e:";",c:[t.UTM]},{b:"=>"},n,s]}}),hljs.registerLanguage("cmake",function(t){return{aliases:["cmake.in"],cI:!0,k:{keyword:"add_custom_command add_custom_target add_definitions add_dependencies add_executable add_library add_subdirectory add_test aux_source_directory break build_command cmake_minimum_required cmake_policy configure_file create_test_sourcelist define_property else elseif enable_language enable_testing endforeach endfunction endif endmacro endwhile execute_process export find_file find_library find_package find_path find_program fltk_wrap_ui foreach function get_cmake_property get_directory_property get_filename_component get_property get_source_file_property get_target_property get_test_property if include include_directories include_external_msproject include_regular_expression install link_directories load_cache load_command macro mark_as_advanced message option output_required_files project qt_wrap_cpp qt_wrap_ui remove_definitions return separate_arguments set set_directory_properties set_property set_source_files_properties set_target_properties set_tests_properties site_name source_group string target_link_libraries try_compile try_run unset variable_watch while build_name exec_program export_library_dependencies install_files install_programs install_targets link_libraries make_directory remove subdir_depends subdirs use_mangled_mesa utility_source variable_requires write_file qt5_use_modules qt5_use_package qt5_wrap_cpp on off true false and or",operator:"equal less greater strless strgreater strequal matches"},c:[{cN:"envvar",b:"\\${",e:"}"},t.HCM,t.QSM,t.NM]}}),hljs.registerLanguage("lisp",function(t){var e="[a-zA-Z_\\-\\+\\*\\/\\<\\=\\>\\&\\#][a-zA-Z0-9_\\-\\+\\*\\/\\<\\=\\>\\&\\#!]*",i="\\|[^]*?\\|",n="(\\-|\\+)?\\d+(\\.\\d+|\\/\\d+)?((d|e|f|l|s)(\\+|\\-)?\\d+)?",s={cN:"literal",b:"\\b(t{1}|nil)\\b"},o={cN:"number",v:[{b:n,r:0},{b:"#b[0-1]+(/[0-1]+)?"},{b:"#o[0-7]+(/[0-7]+)?"},{b:"#x[0-9a-f]+(/[0-9a-f]+)?"},{b:"#c\\("+n+" +"+n,e:"\\)"}]},r=t.inherit(t.QSM,{i:null}),a={cN:"comment",b:";",e:"$",r:0},c={cN:"variable",b:"\\*",e:"\\*"},l={cN:"keyword",b:"[:&]"+e},d={b:i},h={cN:"quoted",c:[o,r,c,l,{b:"\\(",e:"\\)",c:["self",s,r,o]}],v:[{b:"['`]\\(",e:"\\)"},{b:"\\(quote ",e:"\\)",k:"quote"},{b:"'"+i}]},u={cN:"quoted",b:"'"+e},m={cN:"list",b:"\\(",e:"\\)"},p={eW:!0,r:0};return m.c=[{cN:"keyword",v:[{b:e},{b:i}]},p],p.c=[h,u,m,s,o,r,a,c,l,d],{i:/\S/,c:[o,{cN:"shebang",b:"^#!",e:"$"},s,r,a,h,u,m]}}),hljs.registerLanguage("scala",function(t){var e={cN:"title",b:/[^0-9\n\t "'(),.`{}\[\]:;][^\n\t "'(),.`{}\[\]:;]+|[^0-9\n\t "'(),.`{}\[\]:;=]/,r:0},i={cN:"class",bK:"class object trait type",e:/[:={\[(\n;]/,c:[{cN:"keyword",bK:"extends with",r:10},e]},n={cN:"function",bK:"def val",e:/[:={\[(\n;]/,c:[e]};return{k:{literal:"true false null",keyword:"type yield lazy override def with val var sealed abstract private trait object if forSome for while throw finally protected extends import final return else break new catch super class case package default try this match continue throws implicit"},c:[t.CLCM,t.CBCM,{cN:"string",b:'u?r?"""',e:'"""',r:10},t.QSM,{cN:"symbol",b:"'\\w[\\w\\d_]*(?!')"},{cN:"type",b:"\\b[A-Z][A-Za-z0-9_]*",r:0},n,i,t.CNM,{cN:"annotation",b:"@[A-Za-z]+"}]}}),hljs.registerLanguage("smalltalk",function(t){var e="[a-z][a-zA-Z0-9_]*",i={cN:"char",b:"\\$.{1}"},n={cN:"symbol",b:"#"+t.UIR};return{aliases:["st"],k:"self super nil true false thisContext",c:[{cN:"comment",b:'"',e:'"'},t.ASM,{cN:"class",b:"\\b[A-Z][A-Za-z0-9_]*",r:0},{cN:"method",b:e+":",r:0},t.CNM,n,i,{cN:"localvars",b:"\\|[ ]*"+e+"([ ]+"+e+")*[ ]*\\|",rB:!0,e:/\|/,i:/\S/,c:[{b:"(\\|[ ]*)?"+e}]},{cN:"array",b:"\\#\\(",e:"\\)",c:[t.ASM,i,t.CNM,n]}]}}),function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("long-task-requester",[],e):"object"==typeof exports?exports["long-task-requester"]=e():t["long-task-requester"]=e()}(window,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/dist/",i(i.s=0)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=i(1),r=(n=o)&&n.__esModule?n:{default:n};var a={create:function(t,e,i,n,s,o,a){return new r.default(t,e,i,n,s,o,a)},TimedOutError:i(2).TimedOutError};void 0!==("undefined"==typeof window?"undefined":s(window))&&(window.longTaskRequester=a),e.default=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(2);var o=function(){function t(e,i,n,s){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2e4,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1e3;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._totalTimeout=o,this._softTimeout=r,this._progressBarCallback=e,this._hideProgressBarCallback=i,this._mainRequestFunc=n,this.taskStatusFunc=s,this._pollTimeout=a}return n(t,[{key:"run",value:function(){var t=this;return this._isDone=!1,this._totalTimeoutTimer=setTimeout(this._onTotalTimeoutIsOver.bind(this),this._totalTimeout),this._softTimeoutTimer=setTimeout(this._onSoftTimeoutIsOver.bind(this),this._softTimeout),this._promise=new Promise(function(e,i){t._resolve=e,t._reject=i,t._mainRequestFunc().then(function(e){200===e.statusCode?e.data?t._makeResolve(e.data):e.error&&t._makeReject(e.error):201===e.statusCode&&e.data.task_id?(t._progressBarCallback&&t._progressBarCallback(0),t.taskStatusFunc&&(t._taskStatusCall=t.taskStatusFunc(e.data.task_id)),setTimeout(t._poll.bind(t),self._pollTimeout)):t._makeReject(e)})}),this._promise}},{key:"_poll",value:function(){var t=this;t._taskStatusCall().then(function(e){200===e.statusCode?t._makeResolve(e.data):102===e.statusCode?(t._progressBarCallback&&t._progressBarCallback(Number(e.data)),setTimeout(t._poll.bind(t),self._pollTimeout)):t._makeReject(e)})}},{key:"_onTotalTimeoutIsOver",value:function(){this._makeReject(new s.TimedOutError)}},{key:"_onSoftTimeoutIsOver",value:function(){this._progressBarCallback&&this._progressBarCallback(0)}},{key:"_makeReject",value:function(t){this._isDone||(this._hideProgressBarCallback&&this._hideProgressBarCallback(),this._reject(t),this._isDone=!0)}},{key:"_makeResolve",value:function(t){this._isDone||(this._hideProgressBarCallback&&this._hideProgressBarCallback(),this._resolve(t),this._isDone=!0)}}]),t}();e.default=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.TimedOutError=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Error),n(e,[{key:"toString",value:function(){return"TimedOutError"}}]),e}()}])}),function(t){var e=0,i="__"+Number(new Date),n=function(){return"uniq"+ ++e};t.identify=function(t,e){if(!t)return n();var s="uniqueID"in t?"uniqueID":i;return e||s in t?t[s]:t[s]=n()}}(jQuery),function(){var t=Object.prototype.toString;function e(e){return"[object Object]"===t.call(e)}function i(t,n,s){var o,r;for(o in t=Object(t),n=Object(n))"__proto__"!==o&&"prototype"!==o&&"constructor"!==o&&(void 0!==(r=s&&s(t[o],n[o],o))?t[o]=r:e(t[o])&&e(n[o])?t[o]=i(t[o],n[o],s):t[o]=n[o]);return t}$.extend($.util,{merge:i,mergeBemjson:function(t,e){return i(t,e,function(t,e,i){if("mix"===i)return[].concat(t,e)})}})}(),function(){var t={_hashBangRegEx:/\#!\//,_filter:[],_safeUnescapeParams:[],_validUrlRegEx:/^(([\w]+:)?\/\/)?(([\d\w]|%[a-fA-f\d]{2,2})+(:([\d\w]|%[a-fA-f\d]{2,2})+)?@)?([\d\w][-\d\w]{0,253}[\d\w]\.)+[\w]{2,4}(:[\d]+)?(\/([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)*(\?(&?([-+_~.\d\w]|%[a-fA-f\d]{2,2})=?)*)?(#([-+_~.\d\w]|%[a-fA-f\d]{2,2})*)?$/,isValid:function(t){return this._validUrlRegEx.test(t)},isAbsolute:function(t){var e=(t||location.href).trim().toLowerCase();return/[a-z:]*\/\//.test(e)},getRoot:function(){return location.protocol+"//"+(location.hostname||location.host)+"/"},getPage:function(t){return t||(t=location.href),t+t.charAt(t.length-1)==="/"?"":"/"},getBasePage:function(t){return t||(t=location.href),this.clearHashSymbol(t).replace(/[^\/]+$/,"").replace(/\/+$/,"")+"/"},getFull:function(e){var i=e,n=e.charAt(0);if(!this.isAbsolute(e))switch(n){case"/":i=t.getRoot()+e.replace(/^\/+/,"");break;case"#":i=t.getPage().replace(/#.*/,"")+e;break;case"?":i=t.getPage().replace(/[\?#].*/,"")+e;break;default:i=t.getBasePage()+e.replace(/^(\.\/)+/,"")}return i.replace(/\#$/,"")},getShort:function(e){if(!e)return"/";if(!this.isAbsolute(e))return e;var i=e,n=(t.getBasePage(),t.getRoot());return i=i.replace(n,"/"),this.isTraditionalAnchor(i)&&(i="/"+i),i=i.replace(/^(\.\/)+/g,"./").replace(/\#$/,"").replace(t._hashBangRegEx,"").replace("//","/")},isTraditionalAnchor:function(t){return!/[\/\?\.]/.test(t)},setSafeUnescapeParams:function(t){t&&(this._safeUnescapeParams=t)},safeUnescape:function(t){t=t||location.href;var e=this.getParams(t,this._safeUnescapeParams);return t=this.unescape(this.delParams(t,this._safeUnescapeParams)),this.setParams(t,e)},unescape:function(t){for(var e,i=t;(e=$.decodeURI(i))!==i;)i=e;return i},unescapeHash:function(e){return t.unescape(t.normalizeHash(e))},normalizeHash:function(t){return t.replace(/[^#]*#!?/,"").replace(/#.*/,"")},getHash:function(e){return e||(e=location.href),/#/.test(e)||(e=""),t.unescapeHash(e)},setHash:function(t){location.hash=t.replace("#","")},escapeHash:function(e){var i=encodeURI(t.normalizeHash(e));return i=i.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")},clearHashSymbol:function(t){return(t||location.href).replace(this._hashBangRegEx,"")},parseParams:function(t){t||(t=location.href);var e={};return(t=this.clearHashSymbol(t)).indexOf("?&")>-1&&(t=t.replace(/\?&/g,"?")),(t=t.replace(/[^?]*\??/,""))&&t.replace(/(?:^|&|;)([^&=;]*)=?([^&;]*)/g,function(t,i,n){i&&(e[i]=n.replace(/\+/g," ")),~this._safeUnescapeParams.indexOf(i)||(e[i]=$.decodeURIComponent(e[i]))}.bind(this)),e},normalize:function(t){return(t||location.href).replace(/\+/g,"%20")},mergeFilters:function(t){return $.merge($.url._filter,t)},filter:function(t,e){void 0===e&&t instanceof Array&&(e=t,t=location.href);var i=this.parseParams(t);return $.merge($.merge([],this._filter),e||[]).forEach(function(t){i[t]&&delete i[t]}),this.build(this.getPath(t),i)},build:function(t,e){if(void 0===e&&"object"==typeof t&&(e=t,t=location.href),!e||!Object.keys(e).length)return t;if(e=e instanceof Array?[].concat(e):$.extend({},e),this._safeUnescapeParams.length){var i="";this._safeUnescapeParams.forEach(function(t){e[t]&&(i+="&"+t+"="+e[t],delete e[t])}),e=$.param(e)+i}else e=$.param(e);return this.normalize(t+"?"+e)},getPath:function(t){return this.clearHashSymbol(t).match(/([^\?&]*)/)[0]},setParam:function(t,e,i){void 0===e&&(e=t,t=location.href);var n=this.parseParams(t);return void 0===i||""===i?delete n[e]:n[e]=i,this.build(this.getPath(t),n)},setParams:function(t,e){"object"==typeof t&&(e=t,t=location.href);var i=$.extend({},this.parseParams(t));return $.each(e,function(t,e){void 0===e||""===e?delete i[t]:i[t]=e}),this.build(this.getPath(t),i)},delParam:function(t,e){return this.setParam(t,e)},delParams:function(t,e){void 0===e&&"string"!=typeof t&&(e=t,t=location.href);var i={};return e.forEach(function(t){i[t]=""}),this.setParams(t,i)},clearFromParams:function(t){return this.getPath(t)},getParam:function(t,e){return void 0===e&&"string"==typeof t&&(e=t,t=location.href),this.parseParams(t)[e]},getParams:function(t,e){"undefined"==typeof withoutDecoding&&"boolean"==typeof e&&t instanceof Array&&(withoutDecoding=e,e=t,t=location.href),e||(e=[]);var i=this.parseParams(t),n={};return e.forEach(function(t){n[t]=i[t]}),n},getAllParams:function(t){return this.parseParams(t)}};$.extend({url:t})}(),function(){"use strict";String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var i=this.toString();(void 0===e||e>i.length)&&(e=i.length),e-=t.length;var n=i.indexOf(t,e);return-1!==n&&n===e})}(window),function(t){var e=function(){return"_"}.toString().indexOf("_")>-1,i=function(){},n=Object.create||function(t){var e=function(){};return e.prototype=t,new e},s=Object.keys,o=t.extend,r=Array.isArray,a=t.isFunction,c=!0,l={toString:""};for(var d in l)l.hasOwnProperty(d)&&(c=!1);var h=c?["toString","valueOf"]:null;function u(i,n,o){for(var r,l,d=function(t){var e=s(t);if(c)for(var i,n=0;i=h[n++];)t.hasOwnProperty(i)&&e.push(i);return e}(o),u=0,m=d.length;u<m;)"__self"!==(r=d[u++])&&(l=o[r],a(l)&&(!e||l.toString().indexOf(".__base")>-1)?n[r]=function(e,s){var o=function(){var t=this.__base;this.__base=o.__base;var e=s.apply(this,arguments);return this.__base=t,e};return o.__base=i[e]||("__constructor"===e?n.__self.__parent:t.noop),o}(r,l):n[r]=l)}function m(e,i){for(var n,s=1;n=e[s++];)i?a(n)?t.inheritSelf(i,n.prototype,n):t.inheritSelf(i,n):i=a(n)?t.inherit(e[0],n.prototype,n):t.inherit(e[0],n);return i||e[0]}t.inherit=function(){var t=arguments,e=r(t[0]),s=e||a(t[0]),c=s?e?m(t[0]):t[0]:i,l=t[s?1:0]||{},d=t[s?2:1],h=l.__constructor||s&&c.prototype.__constructor?function(){return this.__constructor.apply(this,arguments)}:s?function(){return c.apply(this,arguments)}:function(){};if(!s)return h.prototype=l,h.prototype.__self=h.prototype.constructor=h,o(h,d);o(h,c),h.__parent=c;var p=c.prototype,f=h.prototype=n(p);return f.__self=f.constructor=h,l&&u(p,f,l),d&&u(c,h,d),h},t.inheritSelf=function(){var t=arguments,e=r(t[0])?m(t[0],t[0][0]):t[0],i=t[1],n=t[2],s=e.prototype;return i&&u(s,s,i),n&&u(e,e,n),e},t.inherit.self=t.inheritSelf}(jQuery),function(t){var e="__"+Number(new Date)+"storage",i=function(e,i){return t.identify(e)+(i?t.identify(i):"")},n={buildEventName:function(t){return t},on:function(n,s,o,r,a){if("string"==typeof n){t.isFunction(s)&&(r=o,o=s,s=void 0);for(var c,l=i(o,r),d=this[e]||(this[e]={}),h=n.split(" "),u=0;n=h[u++];)if(!(l in(c=d[n=this.buildEventName(n)]||(d[n]={ids:{},list:{}})).ids)){var m=c.list,p={fn:o,data:s,ctx:r,special:a};m.last?(m.last.next=p,p.prev=m.last):m.first=p,c.ids[l]=m.last=p}}else{var f=this;t.each(n,function(t,e){f.on(t,e,s,a)})}return this},onFirst:function(t,e,i,n){return this.on(t,e,i,n,{one:!0})},un:function(n,s,o){if("string"==typeof n||void 0===n){var r=this[e];if(r)if(n){for(var a,c=n.split(" "),l=0;n=c[l++];)if(a=r[n=this.buildEventName(n)])if(s){var d=i(s,o),h=a.ids;if(d in h){var u=a.list,m=h[d],p=m.prev,f=m.next;p?p.next=f:m===u.first&&(u.first=f),f?f.prev=p:m===u.last&&(u.last=p),delete h[d]}}else delete this[e][n]}else delete this[e]}else{var _=this;o=s,t.each(n,function(t,e){_.un(t,e,o)})}return this},trigger:function(i,n){var s=this[e],o="string"==typeof i,r=o?i:i.type,a=this.buildEventName(r);if(o||(i.type=a,i.target||(i.target=this)),s&&(s=s[a])){var c,l=s.list.first;for(l&&o&&((i=t.Event(a)).target=this);l;)i.data=l.data,void 0!==(c=l.fn.call(l.ctx||this,i,n))&&(i.result=c,!1===c&&(i.preventDefault(),i.stopPropagation())),l.special&&l.special.one&&this.un(r,l.fn,l.ctx),l=l.next}return this}};t.observable=t.inherit(n,n)}(jQuery),function(t,e){var i=[],n=t.inherit,s=t.isFunction,o=Function.prototype.call.bind(Object.prototype.hasOwnProperty),r={},a={};function c(t,e,i){return(t?"__elem_"+t:"")+"__mod"+(e?"_"+e:"")+(i?"_"+i:"")}function l(t,e,i){var n,r,a;if(s(t))e[c(i,"*","*")]=t;else for(n in t)if(o(t,n))if(a=t[n],s(a))e[c(i,n,"*")]=a;else for(r in a)o(a,r)&&(e[c(i,n,r)]=a[r])}function d(t){var e;if(t.onSetMod&&(l(t.onSetMod,t),delete t.onSetMod),t.onElemSetMod){for(e in t.onElemSetMod)o(t.onElemSetMod,e)&&l(t.onElemSetMod[e],t,e);delete t.onElemSetMod}}this.BEM=n(t.observable,{__constructor:function(t,e,i){var n=this;n._modCache=t||{},n._processingMods={},n._params=e,n.params=null,!1!==i?n._init():n.afterCurrentEvent(function(){n._init()})},_init:function(){return this._initing||this.hasMod("js","inited")||(this._initing=!0,this.params||(this.params=t.extend(this.getDefaultParams(),this._params),delete this._params),this.setMod("js","inited"),delete this._initing,this.hasMod("js","inited")&&this.trigger("init")),this},changeThis:function(t,e){return t.bind(e||this)},afterCurrentEvent:function(t,e){this.__self.afterCurrentEvent(t.bind(e||this))},on:function(e,i,n,s){return"object"==typeof e&&(t.isFunction(i)||t.isFunction(n))&&(e=this.__self._buildModEventName(e)),this.__base.apply(this,arguments)},un:function(e,i,n){return"object"==typeof e&&t.isFunction(i)&&(e=this.__self._buildModEventName(e)),this.__base.apply(this,arguments)},trigger:function(e,i){var n=!0;return"object"!=typeof e||e instanceof t.Event||(n="js"===e.modName||this.hasMod("js"),e=this.__self._buildModEventName(e)),n&&(this.__base(e=this.buildEvent(e),i),this._trigger(e,i)),this},_trigger:function(t,e){this.__self.trigger(t,e)},buildEvent:function(e){return"string"==typeof e&&(e=t.Event(e)),e.block=this,e},hasMod:function(t,e,i){var n=arguments.length,s=!1;1==n?(i="",e=t,t=void 0,s=!0):2==n&&("string"==typeof t?(i=e,e=t,t=void 0):(i="",s=!0));var o=this.getMod(t,e)===i;return s?!o:o},getMod:function(t,e){var i=typeof t;if("string"===i||"undefined"===i){e=t||e;var n=this._modCache;return e in n?n[e]:n[e]=this._extractModVal(e)}return this._getElemMod(e,t)},_getElemMod:function(t,e,i){return this._extractModVal(t,e,i)},getMods:function(t){var e=t&&"string"!=typeof t,i=this._modCache,n=[].slice.call(arguments,e?1:0);return n.length?n.reduce(function(t,e){return e in i&&(t[e]=i[e]),t},{}):i},setMod:function(e,i,n){void 0===n&&("string"==typeof e?(n=void 0===i||i,i=e,e=void 0):n=!0);var s=this;if(!e||e[0]){!1===n||null===n?n="":!0!==n&&(n=n.toString());var o=(e&&e[0]?t.identify(e[0]):"")+"_"+i;if(this._processingMods[o])return s;var r,a=e?s._getElemMod(i,e,r=s.__self._extractElemNameFrom(e)):s.getMod(i);if(a===n)return s;this._processingMods[o]=!0;var c=!0,l=[i,n,a];e&&l.unshift(e),[["*","*"],[i,"*"],[i,n]].forEach(function(t){c=!1!==s._callModFn(r,t[0],t[1],l)&&c}),!e&&c&&(s._modCache[i]=n),c&&s._afterSetMod(i,n,a,e,r),delete this._processingMods[o]}return s},_afterSetMod:function(t,e,i,n,s){var o={modName:t,modVal:e,oldModVal:i};n&&(o.elem=n),this.trigger({modName:t,modVal:"*",elem:s},o).trigger({modName:t,modVal:e,elem:s},o)},toggleMod:function(t,e,i,n,s){"string"==typeof t&&(s=n,n=i,i=e,e=t,t=void 0),void 0===n?n="":"boolean"==typeof n&&(s=n,n="");var o=this.getMod(t,e);return(o==i||o==n)&&this.setMod(t,e,"boolean"==typeof s?s?i:n:this.hasMod(t,e,i)?n:i),this},delMod:function(t,e){return e||(e=t,t=void 0),this.setMod(t,e,"")},_callModFn:function(t,e,i,n){var s=c(t,e,i);return this[s]?this[s].apply(this,n):void 0},_extractModVal:function(t,e){return""},channel:function(t,e){return this.__self.channel(t,e)},getDefaultParams:function(){return{}},del:function(t){var e=[].slice.call(arguments);return"string"==typeof t&&e.unshift(this),this.__self.del.apply(this.__self,e),this},destruct:function(){var t={modName:"js",modVal:"",oldModVal:"inited"};this.trigger({modName:t.modName,modVal:t.modVal},t)}},t.extend(this.BEM,{_name:"i-bem",blocks:r,decl:function(e,i,o){"string"==typeof e?e={block:e}:e.name&&(e.block=e.name),d(i||(i={}));var a,c,l=r[e.baseBlock||e.block]||this;if(e.modName){var h=(a=e.modName,(c=e.modVal)?Array.isArray(c)?function(t){for(var e=0,i=c.length;e<i;)if(t.hasMod(a,c[e++]))return!0;return!1}:function(t){return t.hasMod(a,c)}:function(t){return t.hasMod(a)});t.each(i,function(t,e){s(e)&&(i[t]=function(){var n;if(h(this))n=e;else{var s=l.prototype[t];s&&s!==i[t]&&(n=this.__base)}return n?n.apply(this,arguments):void 0})})}if(o&&"boolean"==typeof o.live){var u=o.live;o.live=function(){return u}}var m,p=l;return e.baseMix&&(p=[p],e.baseMix.forEach(function(t){p.push(r[t])})),e.block==l._name?(m=n.self(p,i,o))._processLive(!0):((m=r[e.block]=n(p,i,o))._name=e.block,delete m._liveInitable),m},declMix:function(t,e,i){return d(e||(e={})),t=r[t]=n(e,i)},_processLive:function(t){return!1},create:function(t,e){return"string"==typeof t&&(t={block:t}),new r[t.block](t.mods,e)},getName:function(){return this._name},on:function(e,i,n,s){return"object"==typeof e&&(t.isFunction(i)||t.isFunction(n))&&(e=this._buildModEventName(e)),this.__base.apply(this,arguments)},un:function(e,i,n){return"object"==typeof e&&t.isFunction(i)&&(e=this._buildModEventName(e)),this.__base.apply(this,arguments)},_buildModEventName:function(t){var e="_"+t.modName+"_"+(!1===t.modVal?"":t.modVal);return t.elem&&(e="__"+t.elem+e),e},_extractElemNameFrom:function(t){},afterCurrentEvent:function(t,e){1==i.push({fn:t,ctx:e})&&setTimeout(this._runAfterCurrentEventFns,0)},_runAfterCurrentEventFns:function(){var t=i.length;t&&i.splice(0,t).forEach(function(t){t.fn.call(t.ctx||this)},this)},changeThis:function(t,e){return t.bind(e||this)},del:function(t){var e="string"==typeof t,i=e?0:1,n=arguments.length;for(e&&(t=this);i<n;)delete t[arguments[i++]];return this},channel:function(e,i){if("boolean"==typeof e&&(i=e,e=void 0),e||(e="default"),!i)return a[e]||(a[e]=new t.observable);a[e]&&(a[e].un(),delete a[e])}}))}(jQuery),function(t,e,i){var n,s="_",o="__";function r(t){var e=typeof t;return"string"===e||"number"===e||"boolean"===e}function a(t,e,i){null!=e&&!1!==e&&(i.push(s,t),!0!==e&&i.push(s,e))}function c(t,e,i,n){n.push(t),a(e,i,n)}function l(t,e,i,s,r){c(t,n,n,r),r.push(o,e),a(i,s,r)}t.INTERNAL={NAME_PATTERN:"[a-zA-Z0-9-]+",MOD_DELIM:s,ELEM_DELIM:o,buildModPostfix:function(t,e,i){var n=i||[];return a(t,e,n),i?n:n.join("")},buildClass:function(t,e,i,s,o){if(r(i)?r(s)||(o=s,s=i,i=e,e=n):void 0!==i?(o=i,i=n):e&&"string"!=typeof e&&(o=e,e=n),!e&&void 0===i&&!o)return t;var a=o||[];return e?l(t,e,i,s,a):c(t,i,s,a),o?a:a.join("")},buildClasses:function(t,i,n,s){i&&"string"!=typeof i&&(s=n,n=i,i=void 0);var o=s||[];return i?l(t,i,void 0,void 0,o):c(t,void 0,void 0,o),n&&e.each(n,function(e,n){n&&(o.push(" "),i?l(t,i,e,n,o):c(t,e,n,o))}),s?o:o.join("")}}}(BEM,jQuery),function(t,e,i){var n=e(window),s=e(document),o={},r={},a={},c={},l={},d=t.blocks,h=t.INTERNAL,u=h.NAME_PATTERN,m=h.MOD_DELIM,p=h.ELEM_DELIM,f=RegExp("[^"+m+"]"+m+"("+u+")(?:"+m+"("+u+"))?$"),_=h.buildModPostfix,g=h.buildClass,b=Array.prototype.slice,v=Array.prototype.reverse;function y(t,n,s,a,c){"boolean"==typeof s&&(c=a,a=s,s=i);var l=n[0];if(!l||l.dataset===i||"react"!==l.dataset.lego){var h=(s=k(s||M(l)[t],l,t)).uniqId;if(r[h])return r[h]._init();o[h]=o[h]?o[h].add(n):n;var u=l.parentNode;u&&11!==u.nodeType||e.unique(o[h]);var m=d[t]||I.decl(t,{},{live:!0});if(!(m._liveInitable=Boolean(m._processLive()))||a||!1===s.live){a&&n.addClass("i-bem");var p=new m(o[h],s,Boolean(a));return delete o[h],c&&c.apply(p,b.call(arguments,4)),p}}}function k(t,i,n,s){(t||(t={})).uniqId||(t.uniqId=(t.id?n+"-id-"+t.id:e.identify())+(s||e.identify()));var o=e.identify(i),r=a[o]||(a[o]={});return r[n]||(r[n]=t),t}function w(t,e,i){var n=t.find(e);return i?n:n.add(t.filter(e))}function M(t){var i=e.identify(t);return a[i]||(a[i]=x(t))}function x(t){var e,i=t.getAttribute("data-bem");return i?JSON.parse(i):e?e():{}}function E(t){delete a[e.identify(t)]}function B(t,e){1===t.domElem.length?t.destruct(!0):t.domElem=t.domElem.not(e)}e.fn.bem=function(t,e){return y(t,this,e,!0)};var I=t.DOM=t.decl("i-bem__dom",{__constructor:function(t,i,n){this.domElem=t,this._eventNameCache={},this._elemCache={},this._blockInsideCache={},r[this._uniqId=i.uniqId||e.identify(this)]=this,this._needSpecialUnbind=!1,this.__base(null,i,n)},findBlocksInside:function(t,e){return this._findBlocks("find",t,e)},findBlockInside:function(t,e){var i=this._buildBlockCacheKey(t,e),n=this._findBlocks("find",t,e,!0);return this._blockInsideCache[i]=n,n},blockInside:function(t,e){var i=this._buildBlockCacheKey(t,e),n=this._blockInsideCache[i];return n||(n=this.findBlockInside(t,e)),n},dropBlockInsideCache:function(t,e){t||e?this._blockInsideCache[this._buildBlockCacheKey(t,e)]=null:this._blockInsideCache={}},_buildBlockCacheKey:function(t,e){e||(e=t,t="");var i="string"==typeof e?e:g(e.block,e.modName,e.modVal);return("string"==typeof t?t:t.__bemElemName)+":"+i},findBlocksOutside:function(t,e){return this._findBlocks("parents",t,e)},findBlockOutside:function(t,e){return this._findBlocks("closest",t,e)[0]||null},findBlocksOn:function(t,e){return this._findBlocks("",t,e)},findBlockOn:function(t,e){return this._findBlocks("",t,e,!0)},_findBlocks:function(t,n,s,o){if(!this.domElem)return o?null:[];s||(s=n,n=i);var r=n?"string"==typeof n?this.findElem(n):n:this.domElem,a="string"==typeof s,c=a?s:s.block||s.blockName,l="."+(a?c:g(c,s.modName,s.modVal))+(o?":first":""),d=r.filter(l);if(t&&(d=d.add(r[t](l))),o)return d[0]?y(c,d.eq(0),!0):null;var h=[],u={};return e.each(d,function(t,i){var n=y(c,e(i),!0);u[n._uniqId]||(u[n._uniqId]=!0,h.push(n))}),h},bindToDomElem:function(t,n,s,o){e.isFunction(s)&&(o=s,s=i);var r=this,a=function(t){return(t.data||(t.data={})).domElem=e(this),o.apply(r,arguments)};return o?t.bind(r._buildEventName(n),s,(a.guid=o.guid=o.guid||e.guid++,a)):e.each(n,function(e,i){r.bindToDomElem(t,e,s,i)}),r},bindToDoc:function(t,e,i){return this._needSpecialUnbind=!0,this.bindToDomElem(s,t,e,i)},bindToWin:function(t,s,o){return e.isFunction(s)&&(o=s,s=i),this._needSpecialUnbind=!0,this.bindToDomElem(n,t,s,o)},bindTo:function(t,i,n,s){switch(arguments.length){case 3:e.isFunction(n)&&(s=n,"object"==typeof i&&(n=i,i=t,t=this.domElem));break;case 2:e.isFunction(i)?(s=i,i=t,t=this.domElem):"string"==typeof t||t instanceof e||(n=i,i=t,t=this.domElem);break;case 1:i=t,t=this.domElem}return"string"==typeof t&&(t=this.elem(t)),this.bindToDomElem(t,i,n,s)},unbindFromDomElem:function(t,e,i){return t.unbind(this._buildEventName(e),i),this},unbindFromDoc:function(t,e){return this.unbindFromDomElem(s,t,e)},unbindFromWin:function(t,e){return this.unbindFromDomElem(n,t,e)},unbindFrom:function(t,i,n){var s=arguments.length;return 1===s?(i=t,t=this.domElem):2===s&&e.isFunction(i)?(n=i,i=t,t=this.domElem):"string"==typeof t&&(t=this.elem(t)),this.unbindFromDomElem(t,i,n)},_buildEventName:function(t){var e=this;return t.indexOf(" ")>1?t.split(" ").map(function(t){return e._buildOneEventName(t)}).join(" "):e._buildOneEventName(t)},_buildOneEventName:function(t){var e=this._eventNameCache;if(t in e)return e[t];var i="."+this._uniqId;if(-1===t.indexOf("."))return e[t]=t+i,e[t];var n=".bem_"+this.__self._name;return e[t]=t.split(".").map(function(t,e){return 0===e?t+n:n+"_"+t}).join("")+i,e[t]},_trigger:function(t,e){this.__base.apply(this,arguments),this._ctxTrigger(t,e)},_ctxTrigger:function(t,i){var n=this,s=c[n.__self._buildCtxEventName(t.type)],o={};s&&n.domElem.each(function(){for(var r=this,a=s.counter;r&&a;){var c=e.identify(r,!0);if(c){if(o[c])break;var l=s.ctxs[c];l&&(e.each(l,function(e,s){s.fn.call(s.ctx||n,t,i)}),a--),o[c]=!0}r=r.parentNode}})},getMods:function(t){var e=t&&"string"!=typeof t,n=this._modCache,s=[].slice.call(arguments,e?1:0),o=this._extractMods(s,e?t:i);return e||(s.length?s.forEach(function(t){n[t]=o[t]}):n=o),o},setMod:function(t,i,n){if(t&&void 0!==n&&t.length>1){var s=this;return t.each(function(){var o=e(this);o.__bemElemName=t.__bemElemName,s.setMod(o,i,n)}),s}return this.__base(t,i,n)},_extractModVal:function(t,e,i){var n,s=(e||this.domElem)[0];return s&&(n=s.getAttribute("class").match(this.__self._buildModValRE(t,i||e))),n?n[2]||!0:""},_extractMods:function(t,e){var i={},n=!t.length,s=0;return((e||this.domElem).eq(0).attr("class").match(this.__self._buildModValRE("("+(n?u:t.join("|"))+")",e,"g"))||[]).forEach(function(t){var e=t.match(f);i[e[1]]=e[2]||!0,++s}),s<t.length&&t.forEach(function(t){t in i||(i[t]="")}),i},_afterSetMod:function(t,i,n,s,o){if(this._isDestructing)return this.__base.apply(this,arguments);var r=this.__self,a=r._buildModClassPrefix(t,o),c=r._buildModValRE(t,o,"g"),l=""===i||!1===i;(s||this.domElem).each(function(){var t=e(this),s=t.attr("class"),o=a;!0!==i&&(o+=m+i),(!0===n?c.test(s):(" "+s).indexOf(" "+a+m)>-1)?t.attr("class",s.replace(c,l?"":"$1"+o)):l||t.addClass(o)}),o&&this.dropElemCache(o,t,n).dropElemCache(o,t,i),this.__base.apply(this,arguments)},findElem:function(t,e,i,n){arguments.length%2?(n=i,i=e,e=t,t=this.domElem):"string"==typeof t&&(t=this.findElem(t)),e=e.split(" ");var s=this.__self.getName(),o=_(i,n),r=[],a=e.map(function(t){return r.push("."+g(s,t,i,n)),t+o}),c=1===a.length,l=w(t,r.join(","));return t===this.domElem&&r.forEach(function(t,i){(this._elemCache[a[i]]=c?l:l.filter(t)).__bemElemName=e[i]},this),l},_elem:function(t,e,i){return this._elemCache[t+_(e,i)]||this.findElem(t,e,i)},elem:function(t,i,n){if(2===arguments.length&&(n=!0),i&&"string"!=typeof i)return i.__bemElemName=t,i;if(t.indexOf(" ")<0)return this._elem(t,i,n);var s=e([]);return t.split(" ").forEach(function(t){s=s.add(this._elem(t,i,n))},this),s},dropElemCache:function(t,e,i){if(t){var n=_(e,i);t.indexOf(" ")<0?delete this._elemCache[t+n]:t.split(" ").forEach(function(t){delete this._elemCache[t+n]},this)}else this._elemCache={};return this},elemParams:function(t){var e;return"string"==typeof t?(e=t,t=this.elem(t)):e=this.__self._extractElemNameFrom(t),x(t[0])[g(this.__self.getName(),e)]||{}},elemify:function(t,i){return(t=e(t)).__bemElemName=i,t},containsDomElem:function(t){var e=!1;return this.domElem.each(function(){return!(e=t.parents().andSelf().index(this)>-1)}),e},buildSelector:function(t,e,i){return this.__self.buildSelector(t,e,i)},destruct:function(t){var i=this.__self;this._isDestructing||(this._isDestructing=!0,this._needSpecialUnbind&&i.doc.add(i.win).unbind("."+this._uniqId),this.dropElemCache().domElem.each(function(t,i){var n=M(i);e.each(n,function(t,e){var n=r[e.uniqId];n?n._isDestructing||B(n,i):delete o[e.uniqId]}),E(i)}),t||this.domElem.remove(),this.__base(),delete r[this.un()._uniqId],delete this.domElem,delete this._elemCache)}},{scope:null,doc:s,win:n,html:e(document.documentElement),_processLive:function(t){var e=this._liveInitable;if("live"in this&&void 0===e^t){e=!1!==this.live();var i=this.getName(),n=this.live;this.live=function(){return this.getName()===i?e:n.apply(this,arguments)}}return e},init:function(t,i,n){!t||e.isFunction(t)?(n=i,i=t,t=s):"string"==typeof t&&(t=e(t));var o=e.identify();return w(t,".i-bem").each(function(){!function(t,i){var n=t[0];e.each(M(n),function(s,o){k(o,n,s,i);var a=r[o.uniqId];a?a.domElem.index(n)<0&&(a.domElem=a.domElem.add(t),e.extend(a._params,o)):y(s,t,o)})}(e(this),o)}),i&&this.afterCurrentEvent(function(){i.call(n||this,t)}),this._runAfterCurrentEventFns(),t},destruct:function(t,n,s){"boolean"!=typeof t&&(s=n,n=t,t=i),n&&(v.call(w(n,".i-bem",s)).each(function(t,i){var n=M(this);e.each(n,function(t,e){if(e.uniqId){var n=r[e.uniqId];n?B(n,i):delete o[e.uniqId]}}),E(this)}),t||(s?n.empty():n.remove()))},update:function(t,e,i,n){return this.destruct(t,!0),this.init(t.html(e),i,n)},replace:function(t,i){return this.destruct(!0,t),this.init(e(i).replaceAll(t))},append:function(t,i){return this.init(e(i).appendTo(t))},prepend:function(t,i){return this.init(e(i).prependTo(t))},before:function(t,i){return this.init(e(i).insertBefore(t))},after:function(t,i){return this.init(e(i).insertAfter(t))},_buildCtxEventName:function(t){return this._name+":"+t},_liveClassBind:function(t,i,n,o){var r=this;if(i.indexOf(" ")>-1)i.split(" ").forEach(function(e){r._liveClassBind(t,e,n,o)});else{var a=l[i],c=e.identify(n);a||(a=l[i]={},s.bind(i,r._liveClassTrigger.bind(r))),c in(a=a[t]||(a[t]={uniqIds:{},fns:[]})).uniqIds||(a.fns.push({uniqId:c,fn:r._buildLiveEventFn(n,o)}),a.uniqIds[c]=a.fns.length-1)}return this},_liveClassUnbind:function(t,i,n){var s=l[i];if(s)if(n){if(s=s[t]){var o=e.identify(n);if(o in s.uniqIds){var r=s.uniqIds[o],a=s.fns.length-1;for(s.fns.splice(r,1);r<a;)s.uniqIds[s.fns[r++].uniqId]=r-1;delete s.uniqIds[o]}}}else delete s[t];return this},_liveClassTrigger:function(t){var i=l[t.type];if(i){var n=t.target,s=Object.keys(i);do{for(var o,r=" "+n.className+" ",a=0;o=s[a++];)if(-1!==r.indexOf(" "+o+" ")){for(var c=!1,d=i[o].fns,h=0;h<d.length;h++)!1===d[h].fn.apply(e(n),arguments)&&(c=!0);if(c&&t.preventDefault(),c||t.isPropagationStopped())return;s.splice(--a,1)}}while(s.length&&(n=n.parentNode))}},_buildLiveEventFn:function(t,i){var n=this;return function(s){var o=[n._name,((s.data||(s.data={})).domElem=e(this)).closest(n.buildSelector()),!0],r=y.apply(null,i?o.concat([t,s]):o);if(r&&!i&&t)return t.apply(r,arguments)}},liveInitOnEvent:function(t,e,i){return this.liveBindTo(t,e,i,!0)},liveBindTo:function(t,n,s,o){n&&!e.isFunction(n)||(s=n,n=t,t=i),t&&"string"!=typeof t||(t={elem:t}),t.elemName&&(t.elem=t.elemName);var r=this;return t.elem&&t.elem.indexOf(" ")>0?(t.elem.split(" ").forEach(function(e){r._liveClassBind(g(r._name,e,t.modName,t.modVal),n,s,o)}),r):r._liveClassBind(g(r._name,t.elem,t.modName,t.modVal),n,s,o)},liveUnbindFrom:function(t,n,s){n&&!e.isFunction(n)||(s=n,n=t,t=i);var o=this;return t&&t.indexOf(" ")>1?(t.split(" ").forEach(function(t){o._liveClassUnbind(g(o._name,t),n,s)}),o):o._liveClassUnbind(g(o._name,t),n,s)},_liveInitOnBlockEvent:function(t,e,i,n){var s=this._name;return d[e].on(t,function(t){if(t.block.domElem){var e=arguments,o=t.block[n](s);i&&o.forEach(function(t){i.apply(t,e)})}}),this},liveInitOnBlockEvent:function(t,e,i){return this._liveInitOnBlockEvent(t,e,i,"findBlocksOn")},liveInitOnBlockInsideEvent:function(t,e,i){return this._liveInitOnBlockEvent(t,e,i,"findBlocksOutside")},on:function(t,e,i,n,s){return t.jquery?this._liveCtxBind(t,e,i,n,s):this.__base(t,e,i,n,s)},un:function(t,e,i,n){return t.jquery?this._liveCtxUnbind(t,e,i,n):this.__base(t,e,i)},liveCtxBind:function(t,e,i,n,s){return this._liveCtxBind(t,e,i,n,s)},_liveCtxBind:function(t,n,s,o,r){var a=this;if("object"==typeof n&&(e.isFunction(s)||e.isFunction(o))&&(n=this._buildModEventName(n)),"string"==typeof n)if(e.isFunction(s)&&(r=o,o=s,s=i),n.indexOf(" ")>-1)n.split(" ").forEach(function(e){a._liveCtxBind(t,e,s,o,r)});else{var l=a._buildCtxEventName(n),d=c[l]||(c[l]={counter:0,ctxs:{}});t.each(function(){var t=e.identify(this),i=d.ctxs[t];i||(i=d.ctxs[t]={},++d.counter),i[e.identify(o)+(r?e.identify(r):"")]={fn:o,data:s,ctx:r}})}else e.each(n,function(e,i){a._liveCtxBind(t,e,i,s)});return a},liveCtxUnbind:function(t,e,i,n){return this._liveCtxUnbind(t,e,i,n)},_liveCtxUnbind:function(t,i,n,s){"object"==typeof i&&e.isFunction(n)&&(i=this._buildModEventName(i));var o=c[i=this._buildCtxEventName(i)];return o&&(t.each(function(){var t,i=e.identify(this,!0);i&&(t=o.ctxs[i])&&(n&&delete t[e.identify(n)+(s?e.identify(s):"")],n&&!e.isEmptyObject(t)||(o.counter--,delete o.ctxs[i]))}),o.counter||delete c[i]),this},_extractElemNameFrom:function(t){if(t.__bemElemName)return t.__bemElemName;var e=t.eq(0).attr("class").match(this._buildElemNameRE());return e?e[1]:i},extractParams:x,_buildModClassPrefix:function(t,e){return this._name+(e?p+("string"==typeof e?e:this._extractElemNameFrom(e)):"")+m+t},_buildModValRE:function(t,e,i){return new RegExp("(\\s|^)"+this._buildModClassPrefix(t,e)+"(?:"+m+"("+u+"))?(?=\\s|$)",i)},_buildElemNameRE:function(){return new RegExp(this._name+p+"("+u+")(?:\\s|$)")},buildSelector:function(t,e,i){return"."+g(this._name,t,e,i)},getBlockByUniqId:function(t){return r[t]},getWindowSize:function(){return{width:n.width(),height:n.height()}}});e(function(){t.DOM.scope=e("body")})}(BEM,jQuery),BEM.decl("i-bem__dom",{},{liveInitOnBlockInit:function(t,e){return this.liveInitOnBlockEvent("init",t,e)},liveInitOnBlockOutsideEvent:function(t,e,i){return this._liveInitOnBlockEvent(t,e,i,"findBlocksInside")},liveInitOnChannelEvent:function(t,e,i){return this._liveInitOnEmitterEvent(BEM.channel(t),e,i)},liveInitOnStoreEvent:function(t,e,i){return this._liveInitOnEmitterEvent(BEM.WISTORE.get(t),e,i)},liveInitOnDomlessBlockEvent:function(t,e,i){return this._liveInitOnEmitterEvent(BEM.blocks[t],e,i)},liveInitOnReactBusEvent:function(t,e){return Ya&&Ya.reactBus&&this._liveInitOnEmitterEvent(Ya.reactBus,t,e),this},_liveInitOnEmitterEvent:function(t,e,i){var n=this.buildSelector(),s=this.getName();return t.on(e,function(){var t=$(n);if(t.length){var e=arguments;t.each(function(t,n){var o=$(n).bem(s);"function"==typeof i&&i.apply(o,e)})}}),this},liveInitOnBlockInsideElemEvent:function(t,e,i,n){var s=this.buildSelector(t);return this.liveInitOnBlockInsideEvent(e,i,function(t){"function"==typeof n&&t.target.domElem.parents(s).length>0&&n.apply(this,arguments)})},liveInitOnBlockElemEvent:function(t,e,i,n){var s=this.buildSelector(t);return this.liveInitOnBlockInsideEvent(e,i,function(t){"function"==typeof n&&t.target.domElem.is(s)&&n.apply(this,arguments)})},liveBindToWin:function(t,e){return this._liveInitOnEmitterEvent(this.win,t,e)},liveBindToDoc:function(t,e){return this._liveInitOnEmitterEvent(this.doc,t,e)}}),$.inheritSelf(BEM.DOM,{},{init:function(){var t=$(".wi-store");return t.length&&t.each(function(t,e){$(e).bem("wi-store")}),this.__base.apply(this,arguments)}}),BEM.DOM.decl("i-global",{onSetMod:{js:{inited:function(){this.del(this.__self._params=$.extend({},this.params),"uniqId","name");var t=this.__self._params;t["passport-msg"]||(t["passport-msg"]=t.id),void 0===t["show-counters"]&&(t["show-counters"]=Math.round(100*Math.random())<=t["show-counters-percent"]),t.locale=t.lang,window.BEMHTML&&BEMHTML.apply({block:"i-global",params:t})}}},getDefaultParams:function(){return{id:"",login:this.__self.getCookie("yandex_login")&&$.cookie("yandex_login")||"",yandexuid:$.cookie("yandexuid"),lang:"ru",tld:"ru",retpath:encodeURI($.decodeURI(location.href)),"passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","social-host":"https://social.yandex.ru","lego-path":"/lego","show-counters-percent":100}}},{param:function(t,e){if(void 0===e)return(this._params||{})[t];this._params&&(this._params[t]=e)},getCookie:function(t){var e=document.cookie;if(e.length<1)return!1;var i=e.indexOf(t+"=");if(-1===i)return!1;i+=t.length+1;var n=e.indexOf(";",i);return decodeURIComponent(-1===n?e.substring(i):e.substring(i,n))}}),BEM.decl("i-global",{},{getbPage:function(){return this._bPage=this._bPage||$(".b-page_service_wiki").bem("b-page")}}),function(t,e){var i={};/msie|trident/i.test(e)?i.ie=parseInt(e.split(/msie|rv:/i)[1],10):-1!==e.indexOf("Opera")?i.opera=parseInt(e.split(/Version\//i)[1],10):"undefined"!=typeof InstallTrigger&&-1!==e.indexOf("Firefox")&&(i.firefox=parseInt(e.split(/Firefox\//)[1],10));var n,s={},o={};(n=e.match(/Windows\sPhone[^\d]*\s([\d.]+)/))?s.wp=n[1]:(n=e.match(/Android\s+([\d.]+)/))?s.android=n[1]:e.match(/\sHTC[\s_].*AppleWebKit/)?s.android="2.3":(n=e.match(/iPhone\sOS\s([\d_]+)/))?(s.ios=n[1].replace(/_/g,"."),o.iphone=!0):(n=e.match(/iPad.*OS\s([\d_]+)/))?(s.ios=n[1].replace(/_/g,"."),o.ipad=!0):(n=e.match(/Bada\/([\d.]+)/))?s.bada=n[1]:(n=e.match(/MSIE\s9/))?s.wp="7.5":s.other=!0,BEM.DOM.decl("i-ua",{onSetMod:{js:{inited:function(){var t=this.__self,e="other";["ios","android","bada","wp","opera"].some(function(i){return t[i]&&(e=i)}),this.setMod("platform",e)}}},setVersion:function(){var t=this.parseVersion();t&&(this.setMod(t.platform,t.major),this.setMod(t.platform+"-subversion",t.subversion))},parseVersion:function(){if(this.__self.ios||this.__self.android){var t=(this.__self.ios||this.__self.android).split("."),e=t.shift(),i=t.join("-");return{platform:this.getMod("platform"),major:e,subversion:i}}}},{ios:s.ios,iphone:o.iphone,ipad:o.ipad,android:s.android,bada:s.bada,wp:s.wp,other:s.other,ua:e,ie:i.ie,opera:i.opera,firefox:i.firefox})}(window,navigator.userAgent||""),function(t,e){e||(e=window.Lego={}),e.init||(e.init=function(i){return(i=e.params=t.extend({id:"",login:e.isSessionValid()&&e.getCookie("yandex_login")||"",yandexuid:e.getCookie("yandexuid"),locale:"ru",retpath:window.location.toString(),"passport-host":"https://passport.yandex.ru","pass-host":"https://pass.yandex.ru","passport-msg":i.id,"social-host":"https://social.yandex.ru","lego-path":"/lego","show-counters-percent":100},i,e.params))["show-counters"]=Math.round(100*Math.random())<=i["show-counters-percent"],BEM.blocks["i-global"]._params||t.extend(BEM.blocks["i-global"]._params={},i),i}),e.block||(e.block={}),e.blockInit||(e.blockInit=function(i,n){i=i||document,n=n||".g-js",t(i).find(n).each(function(){var i=t(this),n=i.data("bem")||(this.onclick?this.onclick():{}),s=n.name||"",o=e.block[s];o&&!i.data(s)&&(o.call(i,n),i.data(s,!0).addClass(s+"_js_inited"))})}),e.blockInitBinded||(e.blockInitBinded=Boolean(t(document).ready(function(){e.blockInit()})))}(jQuery,window.Lego),BEM.DOM.decl("i-metrica",{onSetMod:{js:function(){this.__self._initCouter(this._getId(),this.params.visitParams||{},this.params.userParams||{})}},_getId:function(){return 153432}},{_initCouter:function(t,e,i){var n="undefined"!=typeof Ya;window.yaCounter=n&&Ya.Metrika?new Ya.Metrika({id:t,webvisor:!0,clickmap:!0,trackLinks:!0,trackHash:!0,ut:"noindex",params:e,userParams:i}):null}}),BEM.DOM.decl("i-metrica",{_getId:function(){return 42770554}}),$(function(){BEM.afterCurrentEvent(function(){BEM.channel("i-bem").trigger("start-init"),BEM.DOM.init(function(){BEM.channel("i-bem").trigger("init")})})}),BEM.DOM.decl("w-getting-started",{onSetMod:{js:function(){if(!this.__self._isCompleted()&&(this._tryRun(BEM.WISTORE.get("app").get("action")),BEM.WISTORE.get("app").on("change:action",this._onActionChange,this),"grid"===BEM.WISTORE.get("page").get("type"))){var t=this.findBlockInside(BEM.DOM.scope,"b-grid-table");t&&t.on("start-edit",this._onGridStartEdit,this)}}},_onActionChange:function(t,e){this._tryRun(e)},_tryRun:function(t){this.__self._isNotNewGrid()&&-1!==this.__self.allowedModes.indexOf(t)&&this.__self._isValidMode(t)&&this._getStage(t)},_onGridStartEdit:function(){this._getStage("edit")},_getStage:function(t){BEM.create("wi-api-request",{apiPath:".tutorial",urlParams:["entry_point="+t],path:"/"+this.params.supertag}).run().then(this._onSuccessGetStage.bind(this),this._onErrorGetStage.bind(this))},_onSuccessGetStage:function(t){var e=t.data,i=e.status;"display_stage"===i?"promo"===e.stage?this._showPromo():this._showStage(e.stage):"tutorial_completed"===i&&BEM.blocks["mi-storage"].setItem("getting-started",JSON.stringify({completed:!0,timestamp:(new Date).getTime()}))},_onErrorGetStage:function(t){console.error(t)},_showPromo:function(){var t=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"w-promo-slider",js:!0})).bem("w-promo-slider");this._currentStage={code:"promo"},t.show(),t.on("hide last-shown",this._markCurrentCompleted,this)},_showStage:function(t){var e=this.__self.stages[t];e&&(!e.waitContent||BEM.WISTORE.get("app").get("contentLoaded")?this._showPhase(t,1):BEM.WISTORE.get("app").on("change:contentLoaded",this._showStage.bind(this,t)))},_showPhase:function(t,e){var i=this.__self.stages[t],n=i.phases[e-1];n.event&&BEM.channel("getting-started").trigger(n.event),setTimeout(function(){var s=this.findElem(BEM.DOM.scope,"elem",t,e),o=this._buildPopupWithDirections(n.directions),r=i.phases.length===e;if(s.length&&s.is(":visible")){(s.offset().top+this.__self.popupHeight>BEM.DOM.win.scrollTop()+BEM.DOM.win.height()||BEM.DOM.win.scrollTop()>s.offset().top-this.__self.popupHeight)&&!i.disableScroll&&BEM.DOM.scope.animate({scrollTop:s.offset().top-this.__self.popupHeight},500),o.setContent(BEMHTML.apply([{block:"popup2",elem:"tail"},[{block:"w-getting-started",elem:"popup-string",content:BEM.I18N("w-getting-started",t+"-"+e)},i.phases.length>1&&{block:"w-getting-started",elem:"popup-button",content:{block:"button2",mods:{theme:r?"action":"normal",size:"m",role:r?"complete":"continue"},text:r?BEM.I18N("w-getting-started","complete"):BEM.I18N("w-getting-started","continue")}}],{block:"awesome-icon",mods:{icon:"close"},mix:{block:"popup2",elem:"close"}}])),o.bindTo("close","click",function(){o.delMod("visible")}),o.setAnchor(s).setMod("visible","yes");var a=o.findBlockInside("button2");a&&a.on("click",this._onPopupButtonClick,this),this._currentStage={code:t,stageData:i,phase:e},e===i.phases.length&&this._markCurrentCompleted()}else i.continueIfElemNotFound&&(this._currentStage={code:t,stageData:i,phase:e},e===i.phases.length&&this._markCurrentCompleted(),this._showNextPhase())}.bind(this),n.timeout||0)},_onPopupButtonClick:function(){this._popup.delMod("visible")},_buildPopupWithDirections:function(t){return this._popup&&(this._popup.un("afterClose"),this._popup.destruct()),this._popup=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply(this.__self._getPopupBEMJSON(t||null))).bem("popup2").on("afterClose",this._onPopupHide,this),this._popup},_onPopupHide:function(){this._showNextPhase()},_showNextPhase:function(){this._currentStage&&!this._currentStage.completed&&setTimeout(function(){this._showPhase(this._currentStage.code,this._currentStage.phase+1)}.bind(this),this.__self.phasesTimeout)},_markCurrentCompleted:function(){var t=this._currentStage.code;this._currentStage.completed||(BEM.create("wi-api-request",{apiPath:".tutorial",method:"POST",data:{stage:t},urlParams:!1,path:"/"+this.params.supertag}).run().then(this._onSuccessMarkCompleted.bind(this),this._onErrorMarkCompleted.bind(this)),this._currentStage.completed=!0)},_onSuccessMarkCompleted:function(){},_onErrorMarkCompleted:function(t){console.error(t)}},{_isNotNewGrid:function(){return!window.localStorage["wiki-new-grid"]},_getPopupBEMJSON:function(t){var e={block:"popup2",hasTail:"yes",tailSize:25,mods:{target:"anchor",autoclosable:"yes",theme:"normal","getting-started":"yes"},mix:{block:"w-getting-started",elem:"popup"}};return t&&(e.directions=t),e},_isCompleted:function(){var t=(new Date).getTime(),e=JSON.parse(BEM.blocks["mi-storage"].getItem("getting-started"));return e&&e.completed&&t-e.timestamp<this.completedTimeout},_isValidMode:function(t){var e=BEM.blocks["wi-history"].getRoute();return"view"===t&&!e||e&&e.route&&e.route.slice(1)===t},completedTimeout:432e6,phasesTimeout:300,popupHeight:170,allowedModes:["view","edit","access","create","move","settings","subscribe"],stages:{favorites:{phases:[{},{}]},"subscribe-button":{phases:[{}]},comments:{waitContent:!0,phases:[{directions:["top-left"]}]},"user-cluster":{phases:[{}]},"sidebar-revisions":{continueIfElemNotFound:!0,phases:[{event:"showrevisions",directions:["bottom-left"],timeout:500},{}]},"page-menu":{waitContent:!0,phases:[{directions:["bottom-right"]},{event:"open-user-menu",timeout:500,directions:["bottom-right"]}]},"access-button":{phases:[{}]},"edit-button":{disableScroll:!0,phases:[{directions:["bottom-right"]}]},"edit-formatting":{phases:[{directions:[{to:"top-center",offset:100}]},{},{}]},"edit-attaching":{phases:[{},{event:"showattaches",timeout:500},{directions:["left-bottom"]}]},"edit-basics":{phases:[{directions:["bottom-left"]},{directions:["bottom-left"]},{directions:["left-bottom"]},{directions:["bottom-right"]}]},access:{phases:[{directions:["right-center"]},{directions:["right-center"]},{directions:["right-center"]}]},create:{continueIfElemNotFound:!0,phases:[{directions:["right-center"]},{directions:["bottom-center"]},{directions:["bottom-center"]},{directions:["bottom-center"]}]},move:{continueIfElemNotFound:!0,phases:[{directions:["bottom-center"]},{directions:["bottom-center"]},{directions:["right-center"]}]},settings:{phases:[{},{},{}]},subscribe:{phases:[{directions:["bottom-center"]},{directions:["bottom-center"]},{directions:["bottom-center"]}]},"edit-grid":{waitContent:!0,phases:[{directions:["top-left","top-right"]}]},"edit-grid-sidebar":{phases:[{directions:["right-top"],event:"showgridcode",timeout:500}]},"edit-grid-add-row":{phases:[{directions:["top-center"]}]},"edit-grid-add-col":{phases:[{event:"showaddcolpopup",timeout:500,directions:["bottom-left"]},{directions:["bottom-left"]},{directions:["bottom-left"]}]}}}),BEM.DOM.decl("popup2",{onSetMod:{js:{inited:function(){this._parentPopup=void 0,this._zIndex=null,this._zIndexGroupLevel=null,this._scope=BEM.DOM.scope,this._isAttachedToScope=!1}},visible:{yes:function(){this.trigger("beforeOpen"),this._makeEventOnAnimationEnd("Open"),this._isAttachedToScope||(this._scope.append(this.domElem),this._isAttachedToScope=!0),this._captureZIndex()._bindToParentPopup().bindTo("pointerdown pointerclick",this._setPreventHideByClick)},"":function(){this.trigger("beforeClose")._releaseZIndex()._unbindFromParentPopup().unbindFrom("pointerdown pointerclick"),this._makeEventOnAnimationEnd("Close")}}},destruct:function(){this.delMod("visible"),this.__base.apply(this,arguments)},setScope:function(t){return this._scope=t,this._isAttachedToScope=!1,this},setContent:function(t){return BEM.DOM.update(this.domElem,t),this},_calcZIndexGroupLevel:function(){var t=this.params.zIndexGroupLevel,e=this._getParentPopup();return e&&(t+=e._zIndexGroupLevel),t},_setPreventHideByClick:function(){var t=this;do{t._preventHideByClick=!0,t=t._getParentPopup()}while(t)},_bindToParentPopup:function(){var t=this._getParentPopup();return t&&t.on("beforeClose",this._onParentPopupClose,this),this},_unbindFromParentPopup:function(){return this._parentPopup&&this._parentPopup.un("beforeClose",this._onParentPopupClose,this),this._parentPopup=void 0,this},_onParentPopupClose:function(){this.delMod("visible")},_getParentPopup:function(){return this._parentPopup},_captureZIndex:function(){null===this._zIndexGroupLevel&&(this._zIndexGroupLevel=this._calcZIndexGroupLevel());var t=this.__self._visiblePopupsZIndexes,e=this._zIndexGroupLevel,i=t[e],n=this._zIndex;return i||(i=t[e]=[(e+1)*this.__self.ZINDEX_FACTOR]),this._zIndex=i[i.length-1]+1,i.push(this._zIndex),this._zIndex!==n&&this.domElem.css("z-index",this._zIndex),this},_releaseZIndex:function(){var t=this.__self._visiblePopupsZIndexes[this._zIndexGroupLevel];return t&&t.splice(t.indexOf(this._zIndex),1),this},_recaptureZIndex:function(){return this._releaseZIndex(),this._zIndexGroupLevel=null,this._captureZIndex()},getDefaultParams:function(){return{zIndexGroupLevel:0}},_makeEventOnAnimationEnd:function(t){var e=this.domElem,i=window.getComputedStyle?window.getComputedStyle(e[0]):e[0].currentStyle,n=parseFloat(i.animationDuration)>0?"animationend":parseFloat(i.webkitAnimationDuration)>0?"webkitAnimationEnd":"",s=function(){this.trigger("after"+t)};n?e.one(n,s.bind(this)):this.afterCurrentEvent(s)}},{live:!0,_visiblePopupsZIndexes:{},ZINDEX_FACTOR:1e3}),BEM.DOM.decl("popup2",{attachToScope:function(t){return t&&(this._scope=t),this._scope.append(this.domElem),this._isAttachedToScope=!0,this}}),BEM.decl("keycodes",{},{BACKSPACE:8,TAB:9,ENTER:13,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,is:function(t,e){return(Array.isArray(e)?e:Array.prototype.slice.call(arguments,1)).some(function(e){return this[e]===t},this)}}),BEM.DOM.decl({block:"popup2",modName:"target"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._lastPopupDrawingCss={left:void 0,top:void 0,zIndex:void 0,display:void 0},this._lastTailDrawingCss={left:void 0,top:void 0},this._initialVisible=this.hasMod("visible")}},visible:{yes:function(){this.__base.apply(this,arguments),this.bindToWin("scroll resize",this._onWinScrollAndResize).redraw(!0)},"":function(){this.__base.apply(this,arguments),this.unbindFromWin("scroll resize")}}},setContent:function(){return this.__base.apply(this,arguments).redraw()},_draw:function(){var t=this._calcBestDrawingParams();return this.setMod("direction",t.direction),e(this._lastPopupDrawingCss,this._calcDrawingCss(t))&&this.domElem.css(this._lastPopupDrawingCss),e(this._lastTailDrawingCss,this._calcTailDrawingCss(t))&&this.elem("tail").css(this._lastTailDrawingCss),this;function e(t,e){var i=!1;return Object.keys(e).forEach(function(n){var s=e[n];t[n]!==s&&(t[n]=s,i=!0)}),i}},redraw:function(t){return this.hasMod("visible","yes")||t?(this.setMod("outside","yes")._draw().delMod("outside"),this):this},_calcDrawingCss:function(t){var e,i=this._scope;return i.is(BEM.DOM.scope)||(e=i.offset(),t.top-=e.top,t.left-=e.left),{left:t.left,top:t.top}},_calcTailDrawingCss:function(t){return t.tail},calcPossibleDrawingParams:function(){var t=this._calcTargetDimensions(),e=this._calcViewportDimensions(),i=this._calcOffsets();return this.params.directions.map(function(n){var s={direction:n,width:0,height:0,left:0,top:0};return this._checkMainDirection(n,"bottom")?(s.top=t.top+t.height+i.main,s.height=e.bottom-s.top-i.viewport):this._checkMainDirection(n,"top")?(s.height=t.top-e.top-i.main-i.viewport,s.top=t.top-s.height-i.main):(this._checkSecondaryDirection(n,"center")?(s.height=e.bottom-e.top-2*i.viewport,s.top=t.top+(t.height-s.height)/2):this._checkSecondaryDirection(n,"bottom")?(s.height=t.top+t.height-e.top-i.secondary-i.viewport,s.top=t.top+t.height-s.height-i.secondary):this._checkSecondaryDirection(n,"top")&&(s.top=t.top+i.secondary,s.height=e.bottom-s.top-i.viewport),this._checkMainDirection(n,"left")?(s.width=t.left-e.left-i.main-i.viewport,s.left=t.left-s.width-i.main):(s.left=t.left+t.width+i.main,s.width=e.right-s.left-i.viewport)),this._checkSecondaryDirection(n,"right")?(s.width=t.left+t.width-e.left-i.secondary-i.viewport,s.left=t.left+t.width-s.width-i.secondary):this._checkSecondaryDirection(n,"left")?(s.left=t.left+i.secondary,s.width=e.right-s.left-i.viewport):this._checkSecondaryDirection(n,"center")&&this._checkMainDirection(n,"top","bottom")&&(s.width=e.right-e.left-2*i.viewport,s.left=t.left+t.width/2-s.width/2),s},this)},_calcBestDrawingParams:function(){for(var t,e,i,n,s,o,r=this._calcPopupDimensions(),a=this._calcTargetDimensions(),c=this._calcViewportDimensions(),l=this.params.directions,d=l.length,h=0;h<d&&(t=l[h],e=this._calcPos(t,a,r),i=this._calcViewportFactor(e,c,r),(0===h||i>o||!o&&this.hasMod("direction",t))&&(n=t,o=i,s=e),!(o>this.__self.VIEWPORT_ACCURACY_FACTOR));h++);return{direction:n,left:s.left,top:s.top,tail:this._calcTailPos(n,a,r,s)}},_calcPopupDimensions:function(){var t=this.domElem.outerWidth(),e=this.domElem.outerHeight();return{width:t,height:e,innerWidth:this.domElem.innerWidth(),innerHeight:this.domElem.innerHeight(),area:t*e}},_calcTailDimension:function(){var t=this.elem("tail"),e=this.params.tailSize||t.outerWidth();return t.length>0?e:0},_calcTargetDimensions:function(){},_calcViewportDimensions:function(){var t=BEM.DOM.win,e=t.scrollTop(),i=t.scrollLeft(),n=t.width();return{top:e,left:i,bottom:e+t.height(),right:i+n}},_calcPos:function(t,e,i){var n={},s=this._calcOffsets();return this._checkMainDirection(t,"bottom")?n.top=e.top+e.height+s.main:this._checkMainDirection(t,"top")?n.top=e.top-i.height-s.main:this._checkMainDirection(t,"left")?n.left=e.left-i.width-s.main:this._checkMainDirection(t,"right")&&(n.left=e.left+e.width+s.main),this._checkSecondaryDirection(t,"right")?n.left=e.left+e.width-i.width-s.secondary:this._checkSecondaryDirection(t,"left")?n.left=e.left+s.secondary:this._checkSecondaryDirection(t,"bottom")?n.top=e.top+e.height-i.height-s.secondary:this._checkSecondaryDirection(t,"top")?n.top=e.top+s.secondary:this._checkSecondaryDirection(t,"center")&&(this._checkMainDirection(t,"top","bottom")?n.left=e.left+e.width/2-i.width/2:this._checkMainDirection(t,"left","right")&&(n.top=e.top+e.height/2-i.height/2)),n},_calcTailPos:function(t,e,i,n){var s={},o=this._calcTailDimension()/2,r=this.params.tailOffset,a=this.params.tailSize;return this._checkMainDirection(t,"bottom")?s.top=-o:this._checkMainDirection(t,"top")?s.top=Math.floor(i.innerHeight-o):this._checkMainDirection(t,"left")?s.left=Math.floor(i.innerWidth-o):this._checkMainDirection(t,"right")&&(s.left=-o),this._checkSecondaryDirection(t,"right")?s.left=i.innerWidth-Math.ceil(Math.min(i.innerWidth,e.width)/2)-o-r:this._checkSecondaryDirection(t,"left")?s.left=Math.ceil(Math.min(i.innerWidth,e.width)/2)-o+r:this._checkSecondaryDirection(t,"bottom")?s.top=i.innerHeight-Math.ceil(Math.min(i.innerHeight,e.height)/2)-o-r:this._checkSecondaryDirection(t,"top")?s.top=Math.ceil(Math.min(i.innerHeight,e.height)/2)-o+r:this._checkSecondaryDirection(t,"center")&&(this._checkMainDirection(t,"top","bottom")?s.left=Math.ceil(i.innerWidth/2)-o+r:s.top=Math.ceil(i.innerHeight/2)-o+r),{top:s.top,left:s.left,width:a,height:a}},_calcViewportFactor:function(t,e,i){var n=this.params.viewportOffset,s=Math.max(t.left,e.left+n),o=Math.min(t.left+i.width,e.right-n),r=Math.max(t.top,e.top+n),a=Math.min(t.top+i.height,e.bottom-n);return s<o&&r<a?(o-s)*(a-r)/i.area:0},_calcOffsets:function(){var t=this.params,e=this._calcTailDimension();return{main:t.mainOffset>=0&&e>0?Math.max(t.mainOffset,Math.round(e*Math.SQRT1_2)):t.mainOffset,secondary:t.secondaryOffset,viewport:t.viewportOffset}},_checkMainDirection:function(t,e,i){return 0===t.indexOf(e)||i&&0===t.indexOf(i)},_checkSecondaryDirection:function(t,e){return t.indexOf("-"+e)>0},_checkDirection:function(t,e){return t.indexOf(e)>=0},_onWinScollAndResize:function(t){this._onWinScrollAndResize(t)},_onWinScrollAndResize:function(t){this.hasMod("visible","yes")&&this._draw()},getDefaultParams:function(){return $.extend(this.__base.apply(this,arguments),{mainOffset:0,secondaryOffset:0,viewportOffset:0,tailOffset:0,directions:this.__self.AVAILABLE_DIRECTIONS})},_setVisible:function(){this._initialVisible&&(this._initialVisible=!1,this.delMod("visible").setMod("visible","yes"))}},{VIEWPORT_ACCURACY_FACTOR:.99,AVAILABLE_DIRECTIONS:["bottom-left","bottom-center","bottom-right","top-left","top-center","top-right","right-top","right-center","right-bottom","left-top","left-center","left-bottom"]}),BEM.DOM.decl("control",{onSetMod:{focused:{yes:function(){if(this.hasMod("disabled"))return!1;this._focused||(this._focus(),this.trigger("focus"))},"":function(){this._focused&&(this._blur(),this.trigger("blur"))}},disabled:{"*":function(t,e){var i=this._getControl();i.prop("disabled",Boolean(e)).attr("aria-disabled",Boolean(e)),i.attr("tabindex",e?null:this.params._tabindex)},yes:function(){this.delMod("focused")}}},_focus:function(){this._getControl().focus()},_blur:function(){this._getControl().blur()},_getControl:function(){var t=this.elem("control");return t.length>0?t:this.domElem},_onFocusin:function(){this._focused=!0,this.trigger("focus").setMod("focused","yes").bindTo("focusout",this._onFocusout)},_onFocusout:function(){this._focused=!1,this.trigger("blur").delMod("focused").unbindFrom("focusout")},getDefaultParams:function(){return{_tabindex:this._getControl().attr("tabindex")}}},{live:function(){this.liveBindTo("focusin",function(t){this._onFocusin(t)}),parseInt(BEM.blocks["i-ua"].ios,10)>=8&&this.liveBindTo("control","focusin",function(t){t.preventDefault()})}}),BEM.blocks["mi-storage"]=function(){var t=null;try{t=window.localStorage}catch(t){}return{setItem:function(e,i){try{return t.setItem(e,i),!0}catch(n){if(this.removeItem(e))try{return t.setItem(e,i),!0}catch(t){this._errorHandler(t)}this._errorHandler(n)}return!1},getItem:function(e){try{return t.getItem(e)}catch(t){this._errorHandler(t)}},clear:function(){try{return t.clear(),!0}catch(t){this._errorHandler(t)}return!1},removeItem:function(e){try{return t.removeItem(e),!0}catch(t){this._errorHandler(t)}return!1},length:function(){try{return t.length}catch(t){this._errorHandler(t)}return 0},key:function(e){try{return t.key(e)}catch(t){this._errorHandler(t)}return""},_errorHandler:function(t){},use:function(e){t=e}}}(),BEM.blocks["mi-storage"]._errorHandler=function(t){throw t},BEM.DOM.decl("w-promo-slider",{show:function(){this._popup=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply(this.__self._getPopupBEMJSON())).bem("modal"),this._popup.on("afterCose",this._onPopupHide,this),this.bindTo(this.findElem(this._popup.domElem,"move-chevron","to","left"),"click",this._goLeft.bind(this)),this.bindTo(this.findElem(this._popup.domElem,"move-chevron","to","right"),"click",this._goRight.bind(this)),this.bindTo(this.findElem(this._popup.domElem,"nav-oval"),"click",this._onOvalClick.bind(this)),this._currentSlide=1,this._popup.setMod("visible","yes")},_goLeft:function(){this._goToSlide(this._currentSlide-1>0?this._currentSlide-1:this.__self._slidesCount)},_goRight:function(){this._currentSlide===this.__self._slidesCount?this._popup.delMod("visible"):this._goToSlide(this._currentSlide+1)},_onOvalClick:function(t){var e=$(t.target).index()+1;this._currentSlide!==e&&this._goToSlide(e)},_goToSlide:function(t){this.delMod(this.findElem(this._popup.domElem,"slide","active","yes"),"active"),this.delMod(this.findElem(this._popup.domElem,"nav-oval","active","yes"),"active"),this.setMod(this.findElem(this._popup.domElem,"nav-oval","index",t),"active","yes"),this.setMod(this.findElem(this._popup.domElem,"slide","index",t),"active","yes"),this.setMod(this.findElem(this._popup.domElem,"move-chevron","to","right"),"final",t===this.__self._slidesCount?"yes":""),this._currentSlide=t,t===this.__self._slidesCount&&this.trigger("last-shown")},_onPopupHide:function(){this.trigger("hide")}},{_slidesCount:4,_getPopupBEMJSON:function(){for(var t=[],e=[],i=1;i<=this._slidesCount;i++)t.push({block:"w-promo-slider",elem:"slide",elemMods:{active:1===i?"yes":"",index:i},index:i}),e.push({block:"w-promo-slider",elem:"nav-oval",elemMods:{active:1===i?"yes":"",index:i}});return{block:"modal",mods:{theme:"normal",autoclosable:"yes",visible:"yes","getting-started":"yes"},mix:{block:"w-promo-slider",elem:"popup"},content:[{block:"w-promo-slider",elem:"slides",content:t},{block:"w-promo-slider",elem:"move-chevron",elemMods:{to:"left"}},{block:"w-promo-slider",elem:"move-chevron",elemMods:{to:"right"}},{block:"w-promo-slider",elem:"nav-ovals",content:e}]}}}),BEM.DOM.decl("modal",{onSetMod:{js:{inited:function(){this._popup=this.findBlockOn("popup2")}},visible:function(t,e){var i=e?"Open":"Close",n=this.elem("content"),s=window.getComputedStyle?window.getComputedStyle(n[0]):n[0].currentStyle,o=parseFloat(s.animationDuration)>0?"animationend":parseFloat(s.webkitAnimationDuration)>0?"webkitAnimationEnd":"",r=function(){this.trigger("after"+i)};this.trigger("before"+i)._popup.setMod(t,e),o?n.one(o,r.bind(this)):this.afterCurrentEvent(r)}},destruct:function(){this.delMod("visible").__base.apply(this,arguments)},setContent:function(t){return BEM.DOM.update(this.elem("content"),t),this}},{live:!0}),BEM.DOM.decl("modal",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._enforceRepaint=this._enforceRepaint.bind(this)}},visible:{yes:function(){this.__base.apply(this,arguments),window.attachEvent&&this.elem("content")[0].attachEvent("onresize",this._enforceRepaint)},"":function(){this.__base.apply(this,arguments),window.detachEvent&&this.elem("content")[0].detachEvent("onresize",this._enforceRepaint)}}},_enforceRepaint:function(){this.domElem[0].className+=""}}),BEM.DOM.decl("modal",{attachToScope:function(t){return this._popup.attachToScope(t)}}),BEM.DOM.decl("mi-sticky",{placeHolder:null,currentStyleAttr:null,lastScroll:0,winHeight:0,elemHeight:0,onSetMod:{js:function(){var t,e,i=this;this.userOffsetTop=this.params.offset&&this.params.offset.top?parseInt(this.params.offset.top,10):0,this.offset=this.domElem.offset(),this.position=void 0!==this.params.position?this.params.position:"auto",this.winHeight=BEM.DOM.win.height(),this.elemHeight=this.domElem.outerHeight(!0),"manual"!==this.params.position&&(setTimeout(function(){i._checkScroll()},0),t=this.params.throttleTimeout?$.throttle(this._checkScroll,this.params.throttleTimeout):this._checkScroll,this.bindToDoc("scroll.sticky",t)),e=this.params.throttleTimeout?$.throttle(this._checkResize,this.params.throttleTimeout):this._checkResize,this.bindToWin("resize.sticky",e)},undocked:{yes:function(){var t=this.params.preventCollapse||this.params.placeholder,e=this.params.offset||{},i={top:e.top?parseInt(e.top,10):0,right:void 0!==e.right?parseInt(e.right,10):"auto",bottom:void 0!==e.bottom?parseInt(e.bottom,10):"auto",left:void 0!==e.left?parseInt(e.left,10):"auto"};"auto"===i.bottom&&this.hasMod("full-height")&&(i.bottom=""),"auto"===i.right&&"auto"===i.left&&(i.left=this.domElem.offset().left),this.currentStyleAttr=this.domElem.attr("style"),this.domElem.css({position:"",top:i.top,right:i.right,bottom:i.bottom,left:i.left}),t&&(this.placeHolder=this._getPlaceholder(),this.domElem.after(this.placeHolder)),this._checkHeight(),this.trigger("undocked")},"":function(){this.placeHolder&&(this.placeHolder.remove(),this.placeHolder=null),this.domElem.attr("style",this.currentStyleAttr),this.trigger("docked")}},biggerThanWindow:{yes:function(){},"":function(){var t=this.params.offset||{};this.domElem.css({top:t.top?parseInt(t.top,10):0,bottom:void 0!==t.bottom?parseInt(t.bottom,10):"auto"})}}},destruct:function(){this.placeHolder&&(this.placeHolder.remove(),this.placeHolder=null),this.__base.apply(this,arguments)},_getPlaceholder:function(){var t=this.params.placeholder||{};return t.offset=t.offset||{},$(BEMHTML.apply({block:"mi-sticky",elem:"placeholder"})).css({position:this.__self._getProperty("position",t,this.domElem),top:this.__self._getProperty("top",t.offset,this.domElem),right:this.__self._getProperty("right",t.offset,this.domElem),bottom:this.__self._getProperty("bottom",t.offset,this.domElem),left:this.__self._getProperty("left",t.offset,this.domElem),visibility:this.__self._getProperty("visibility",t,this.domElem),float:this.__self._getProperty("float",t,this.domElem),width:t.hasOwnProperty("width")?t.width:this.domElem.outerWidth(!0),height:t.hasOwnProperty("height")?t.height:this.domElem.outerHeight(!0)})},_checkScroll:function(){var t,e=BEM.DOM.win.scrollTop(),i=this.lastScroll-e,n="auto"===this.position?this.offset.top:parseInt(this.position,10);this.lastScroll=e,e>n-this.userOffsetTop?(this.setMod("undocked","yes"),this.hasMod("biggerThanWindow","yes")&&(t=this.winHeight-this.elemHeight,i>0||t>0?this.domElem.css({top:"auto",bottom:0}):this.domElem.css({top:0,bottom:"auto"}))):this.delMod("undocked")},_checkResize:function(){this.winHeight=BEM.DOM.win.height(),this.elemHeight=this.domElem.outerHeight(),this.placeHolder&&this.placeHolder.css({width:this.domElem.outerWidth(),height:this.elemHeight}),this.hasMod("undocked","yes")&&this._checkHeight(),this._checkScroll()},_checkHeight:function(){if(this.hasMod("full-height"))this.delMod("biggerThanWindow");else{var t=this.elemHeight+this.userOffsetTop>this.winHeight;this.setMod("biggerThanWindow",t?"yes":"")}}},{_getProperty:function(t,e,i){return e.hasOwnProperty(t)?e[t]:i.css(t)}}),BEM.DOM.decl("mi-sticky",{onSetMod:{js:function(){"complete"===BEM.DOM.doc[0].readyState?this.__base.apply(this,arguments):this.bindToWin("load",this.__base.bind(this))}}}),BEM.DOM.decl("wiki-sidebar",{_lastAccessedTab:{},_currentView:null,onSetMod:{js:function(){this._tabs=this.params.tabs,this._currentView=this.params.view||"view",this._lastAccessedTab[this._currentView]=this.params.selected,this._sidebar=this.findBlockOn("sidebar"),this._filesDropper=this.findBlockOn("wi-files-dropper"),this._appStore=BEM.WISTORE.get("app"),this._pageStore=BEM.WISTORE.get("page"),this._sessionStore=BEM.WISTORE.get("session"),this._bindEvents()}},_bindEvents:function(){this._appStore.on("change:view",this._onPageStateChange,this),this._sidebar.on("toggle",this._onSidebarToggle,this),this._sidebar.on("tab-change",this._onSidebarTabChange,this),this._filesDropper.on("drop",this._onFilesDrop,this)},_onPageStateChange:function(t,e){var i=e;"grid"===this._pageStore.get("type")&&(i="grid"),this._currentView=i,this._sidebar.setTabs(this._tabs[i],null,this._lastAccessedTab[this._currentView])},_onSidebarToggle:function(t,e){var i={sidebarState:"open"===e?"open":""};i.sidebarState||(i.sidebarTab=""),this._sessionStore.set(i)},_onSidebarTabChange:function(t,e){this._lastAccessedTab[this._currentView]=e,this._sessionStore.set("sidebarTab",e)},_onFilesDrop:function(t,e){this._sidebar.open("files"),this.channel("attachments").trigger("add",e)}},{}),BEM.DOM.decl("sidebar",{_readyTabs:[],onSetMod:{js:function(){if(this._container=this.elem("content-container"),this._tabs=Array.prototype.map.call(this.findElem("tab"),function(t){return this.getMod($(t),"type")},this),this.hasMod("state","open")){var t=this.getMod("selected");-1===this._tabs.indexOf(t)?this.open():this._readyTabs.push(t)}this._bindEvents()},state:{open:function(){this.trigger("toggle","open"),BEM.WISTORE.get("app").set("sidebar","opening"),this._animateTimeout=setTimeout(function(){BEM.WISTORE.get("app").set("sidebar","opened")},250)},close:function(){this._unSelectTabs(),this.setMod("selected",""),this.setMod("ready",""),this.delMod("hovered"),this.trigger("toggle","close"),BEM.WISTORE.get("app").set("sidebar","closing"),this._animateTimeout=setTimeout(function(){BEM.WISTORE.get("app").set("sidebar","closed")},250)},"*":function(){this.bindTo("transitionend",this._onTransitionEnd.bind(this))}},selected:function(t,e){if(-1!==this._readyTabs.indexOf(e))this.setMod("ready","yes");else{var i=$(BEMHTML.apply({block:"sidebar",elem:"tab-content",elemMods:{tab:e},redirect:BEM.WISTORE.get("page").get("redirect")}));this.setMod("ready",""),this._readyTabs.push(e),BEM.DOM.append(this._container,i)}this.trigger("tab-change",e)},hovered:{yes:function(){this.trigger("hovered")},"":function(){this.trigger("blur")}}},destruct(){this.__base.apply(this,arguments),clearTimeout(this._animateTimeout)},open:function(t){t===this.getMod("selected")&&this.hasMod("state","open")||(t&&-1!==this._tabs.indexOf(t)||(t=this._getFirstTab()),this._selectTab(t),this._openTabContent(t),this.hasMod("state","open")||this.setMod("state","open"))},close:function(){this.setMod("state","close")},toggle:function(){this.hasMod("state","open")?this.close():this.open()},setTabs:function(t,e,i){var n=this.getMod("selected"),s=BEMHTML.apply({block:"sidebar",elem:"tabs",tabs:t});e&&(n=e),-1===t.indexOf(n)&&(n=null),this._tabs=t,this._readyTabs=[],this.delMod("selected"),BEM.DOM.replace(this.findElem("tabs"),s),BEM.DOM.destruct(!1,this.findElem("tab-content")),this.hasMod("state","open")&&this.open(n||i),this.redraw()},redraw:function(){},_bindEvents:function(){this.channel("sidebar").on("tab:select",function(t,e){this.open(e.tabName)},this),this.channel("sidebar").on("tab:ready",this._onTabReady,this),this.channel("getting-started").on("showrevisions",this.open.bind(this,"events")),this.channel("getting-started").on("showattaches",this.open.bind(this,"files")),this.channel("getting-started").on("showgridcode",this.open.bind(this,"grid-code")),BEM.channel("common").on("sidebar.diff",function(t,e){this.open("events"),this.findBlockInside(this.findElem("tab-content"),"b-events-log").setDiff(e.params)},this)},_onTabReady:function(){this.setMod("ready","yes")},_selectTab:function(t){var e=this.findElem("tab","type",t);this._unSelectTabs(),this.setMod(e,"selected","yes")},_unSelectTabs:function(){var t=this.findElem("tab");this.setMod(t,"selected","")},_getFirstTab:function(){var t=this.findElem("tab").get(0);return this.getMod($(t),"type")},_openTabContent:function(t){this.setMod("selected",t)},_onTransitionEnd:function(t){this.domElem.is(t.data.domElem)&&(this.unbindFrom("transitionend"),this.trigger(this.hasMod("state","open")?"shown":"hide"))},_onMouseenter:function(){this.setMod("hovered","yes").bindTo("mouseleave",this._onMouseleave)},_onMouseleave:function(){this.delMod("hovered").unbindFrom("mouseleave")}},{live:function(){this.liveBindTo("tab","click",function(t){var e=this.getMod(t.data.domElem,"type");this.getMod("selected")===e&&this.hasMod("state","open")?this.close():this.open(e)}),this.liveBindTo("click",function(t){this.hasMod("state","close")&&this.domElem.is(t.target)&&this.open()}),this.liveBindTo("close","click",function(){this.close()}),this.liveBindTo("mouseover",function(t){var e=this.domElem.is(t.relatedTarget)||$.contains(this.domElem[0],t.relatedTarget);this.hasMod("disabled")||e||this._onMouseenter(t)})}}),BEM.DOM.decl("b-toc",{onSetMod:{js:function(){this.hasMod("load")&&(this.setMod("load",""),this.afterCurrentEvent(this._loadToc))}},destruct:function(){this._request&&this._request.abort(),this.__base.apply(this,arguments)},_loadToc:function(){if(BEM.WISTORE.get("page").get("withNewWf")){var t={block:"w-toc",toc:this.findBlockOutside({block:"b-page",modName:"type",modVal:"article"}).getToc()};BEM.DOM.update(this.domElem,BEMHTML.apply(t)),this.channel("sidebar").trigger("tab:ready"),this.bindTo(this.domElem,"click",function(t){t.target.classList.contains("link")&&yaCounter&&yaCounter.reachGoal("tocitem_click")})}else this._request=BEM.create("wi-api-request",{apiPath:".toc",method:"GET",data:!1,path:BEM.blocks["wi-history"].getPath()}),this._request.run().then(this._onTocGetData.bind(this),BEM.blocks["wi-notification"].errorHandler()).always(function(){this._request=null,this.trigger("ready")}.bind(this))},_onTocGetData:function(t){var e=t.data.toc;e.content[0].mods={type:"sidebar"},BEM.DOM.update(this.domElem,BEMHTML.apply(e))}},{}),BEM.DOM.decl("wiki-toc",{onSetMod:{js:{inited:function(){this._findHeaders()}}},tryGoToHeader:function(t){var e=this._headers[t];e&&e.domElem?this._goToHeader(t,e):(BEM.channel("cuts").trigger("expand"),setTimeout(function(){this._findHeaders(),e=this._headers[t],this._goToHeader(t,e)}.bind(this),700))},_goToHeader:function(t,e){var i=e.findElem("anchor").eq(0).position();location.hash="#"+t,window.scrollTo(i.left,i.top)},_getWikiDoc:function(){return this.findBlockOutside("wiki-doc")},_findHeaders:function(){var t=this._getWikiDoc().findBlocksInside("wiki-head");this._headers={};for(var e=0,i=t.length;e<i;e++){var n=t[e],s=n.elemParams(n.domElem).anchor;this._headers[s]=n}}}),BEM.DOM.decl("wiki-toc",{_goToHeader:function(t){location.hash="#"+t}}),BEM.DOM.decl("w-toc",{onSetMod:{js:function(){this.bindTo(this.findElem("item"),"click",this._onClick)}},_onClick:function(t){var e=t.target.getAttribute("href");e.startsWith("#")&&BEM.channel("anchor").trigger("go",e.slice(1))}}),BEM.DOM.decl({block:"link",baseBlock:"control"},{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},pressed:{yes:function(){return!this.hasMod("disabled")}},disabled:{"":function(){this.__base.apply(this,arguments),this.domElem.attr("tabindex",this.params._tabindex)},yes:function(){this.__base.apply(this,arguments),this.domElem.attr("tabindex",-1),this.delMod("pressed")}}},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")}},{live:function(){return this.liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}),this.__base()}}),BEM.DOM.decl("link",{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("hovered")}}},_onPointerenter:function(t){this.setMod("hovered","yes")},_onPointerleave:function(t){this.delMod("hovered")}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.hasMod("disabled")||this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}),this.__base.apply(this,arguments)}}),BEM.DOM.decl("b-cluster-tree",{onSetMod:{js:function(){this._localStorage=BEM.blocks["mi-storage"],this.sortBy=this._localStorage.getItem("wiki-ct-sort")||"title","supertag"===this.sortBy&&(this.sortBy="tag"),this.pageTypes=this._localStorage.getItem("wiki-ct-filter")||"G",this._clusterTreeSort=this.findBlockInside("b-cluster-tree-sort"),this._clusterTreeFilter=this.findBlockInside("b-cluster-tree-filter"),this._closePopupsThrottle=$.throttle(this._closePopups,100,this),this._parents=this.domElem.parents(),this.afterCurrentEvent(this.initBlock)}},destruct:function(){this.unbindFromDoc("scroll",this._closePopupsThrottle,this),this.unbindFrom(this._parents,"scroll",this._closePopupsThrottle,this),this._request&&this._request.abort(),this._request=null,this.__base.apply(this,arguments)},initBlock:function(){this._getClusterTree(),this._clusterTreeSort.initBlock(),this._clusterTreeFilter.initBlock(),this.bindToDoc("scroll",this._closePopupsThrottle,this),this.bindTo(this._parents,"scroll",this._closePopupsThrottle.bind(this))},_getClusterTree:function(){var t="&sort_order="+this.sortBy;this.pageTypes&&(t+="&page_types="+this.pageTypes),this._request=BEM.create("wi-api-request",{apiPath:".treecluster",path:BEM.blocks["wi-history"].getCorrectPath(),urlParams:["format=json"+t]}),this._request.run().then(this._onGotData.bind(this),this._onFailedData.bind(this)).always(function(){this._request=null,this.trigger("ready")}.bind(this))},_onGotData:function(t){BEM.DOM.update(this.elem("total-count"),t.data.length),this.setMod("sort",this.sortBy.replace("_","-"));var e=BEMHTML.apply(this._getClusterTreeBEMJSON(t.data));BEM.DOM.update(this.elem("list"),e),this.elem("item").on("click",function(){yaCounter&&yaCounter.reachGoal("from_sidebar")})},_getClusterTreeBEMJSON:function(t){var e=this,i=[];return t.forEach(function(t){var n={block:"link",url:t.url,content:[],mods:{type:t.page_type},mix:[{block:"b-cluster-tree",elem:"item"},{block:"clearfix"}]};switch("P"==t.page_type&&(n.mods["no-icon"]=!0),t.page_type){case"G":n.content.push({block:"b-cluster-tree",elem:"type",content:{block:"awesome-icon",mods:{icon:"table"}}});break;case"R":n.content.push({block:"b-cluster-tree",elem:"type",content:{block:"awesome-icon",mods:{icon:"share"}}});break;case"403":n.content.push({block:"b-cluster-tree",elem:"type",content:{block:"awesome-icon",mods:{icon:"lock"}}});break;case"404":n.content.push({block:"b-cluster-tree",elem:"type",content:{block:"awesome-icon",mods:{icon:"plus-circle"}}})}n.content.push({block:"b-cluster-tree",elem:"title",content:t.title||t.tag,attrs:{title:t.url}}),t.children_count&&n.content.push({block:"b-cluster-tree",elem:"count",content:t.children_count}),n.content.push({block:"b-cluster-tree",elem:"url",content:t.url.slice(1).replace(e.params.supertag,"")}),n.content.push({block:"b-cluster-tree",elem:"date",elemMods:{type:"created-at"},timestamp:t.created_at||""},{block:"b-cluster-tree",elem:"date",elemMods:{type:"modified-at"},timestamp:t.modified_at||""}),i.push(n)}),i},_onFailedData:function(t){this._request&&!this._request.aborted&&BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-cluster-tree","cant_load_cluster_tree"),t))},changeSorting:function(t){this.sortBy=t,this._localStorage.setItem("wiki-ct-sort",t),this._getClusterTree()},changeFilter:function(t){this.pageTypes=t,this._localStorage.setItem("wiki-ct-filter",t),this._getClusterTree()},_closePopups:function(){this._clusterTreeSort.findBlockInside("select2").popup.delMod("visible"),this._clusterTreeFilter.findBlockInside("select2").popup.delMod("visible")}}),BEM.DOM.decl("b-cluster-tree-sort",{initBlock:function(){this.clusterTree=this.findBlockOutside("b-cluster-tree"),BEM.DOM.update(this.domElem,BEMHTML.apply({block:"b-cluster-tree-sort",elem:"select",val:this.clusterTree.sortBy})),this.findBlockInside("select2").on("change",this._onSelect,this)},_onSelect:function(t,e){this.clusterTree.changeSorting(e.currVal)}}),BEM.DOM.decl("select2",{onSetMod:{js:{inited:function(){this.button=this.findBlockOn("button","button2"),this.initSelect()}},disabled:{"*":function(t,e){this.button.setMod(t,e)}}},initSelect:$.noop,getVal:$.noop,setPrevVal:$.noop,getPrevVal:$.noop,getClearVal:$.noop,setVal:$.noop,_onControlChange:$.noop,_onButtonKeypress:$.noop,_onButtonKeydown:$.noop,_changeIcon:$.noop,_buildLeftIcon:$.noop,_setMinWidth:$.noop},{live:function(){this.liveInitOnBlockInsideEvent("init","button2"),this.liveBindTo("control","pointerdown").liveBindTo("pointerdown",function(){}),this.liveBindTo("button","keydown",function(t){this._onButtonKeydown(t)}).liveBindTo("button","keypress",function(t){this._onButtonKeypress(t)})}}),BEM.DOM.decl("select2",{onSetMod:{disabled:{"*":function(t,e){this.__base.apply(this,arguments),this.control.prop("disabled",Boolean(e))}}},initSelect:function(){this.control=this.elem("control");var t=this.getVal();this.initialVal=this.button.getText(),this.setPrevVal(t),BEM.afterCurrentEvent(function(){if(this.control&&this.control.length&&this.domElem){var e=this.getVal();e&&0!==e.length&&e!==t&&this.setVal(e)}},this),this.bindTo("control","change",function(t){this._onControlChange(t)})},getVal:function(){var t=this.control.val();if(!t){var e=this.getOptions();return e.length?e[0].value:[]}return t},setVal:function(t){if(this.getVal()!==t)for(var e=this.getOptions(),i=0;i<e.length;i++){var n=e[i];if(n.value===t){this.control[0].value=t,this.button.setText(n.text),this.triggerChange();break}}},setPrevVal:function(t){this.prevVal=t},getPrevVal:function(){return this.prevVal},getClearVal:function(t){return t&&1===t.length?t[0]:t},triggerChange:function(){this.trigger("change",{prevVal:this.getClearVal(this.getPrevVal()),currVal:this.getClearVal(this.getVal())})},controlChange:function(t){for(var e=this.getOptions(),i=0;i<e.length;i++){var n=e[i];if(n.value===t){this.button.setText(n.text);break}}},_onControlChange:function(t,e){var i=this.getVal();this.controlChange(i),this.triggerChange(),this.setPrevVal(i)},getOptions:function(){return Array.prototype.slice.call(this.control[0].options)},getName:function(){return this.control.attr("name")},setName:function(t){this.control.attr("name",t),this.trigger("setName")},reset:function(){this.setVal(this.initialVal),this.button.setText(this.initialVal),this.trigger("reset")}}),BEM.DOM.decl({block:"menu",baseBlock:"control"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.elem("item").attr("id",function(t,e){return e||$.identify()}),this._val=this.getVal()}},disabled:function(t,e){this.__base.apply(this,arguments),this.setMod(this.elem("item"),t,e)}},onElemSetMod:{item:{hovered:{yes:function(t){if(this.hasMod(t,"disabled"))return!1;this.delMod(this.elem("item","hovered","yes"),"hovered"),this.domElem.attr("aria-activedescendant",t.attr("id")),this.trigger("item-hover",{item:t})},"":function(){this.domElem.removeAttr("aria-activedescendant"),this.trigger("item-hover",{})}},checked:function(t,e,i){this.domElem.attr("aria-selected",Boolean(i))},disabled:{yes:function(){this.delMod("hovered"),this.domElem.attr("aria-disabled",!0)},"":function(){this.domElem.attr("aria-disabled",!1)}}}},_onChange:function(){var t=this._val,e=this.getVal();return t!==e&&(this._val=e,this.trigger("change",{prevVal:t,currVal:e})),this},getItems:function(t,e){return this.elem("item",t,e).get().map(function(t){return $(t)})},setContent:function(t){return BEM.DOM.update(this.domElem,t),this.reset(),this},getVal:function(){},reset:function(){this.dropElemCache()},_onItemEnter:function(t,e){this.setMod(t,"hovered","yes")},_onItemLeave:function(t,e){this.delMod(t,"hovered")},_onItemFocusin:function(t,e){this.setMod(t,"hovered","yes")},_onFocusout:function(t){this.__base.apply(this,arguments),this.delMod(this.elem("item","hovered","yes"),"hovered")},_onItemClick:function(t,e,i){this.trigger("click",{item:t,source:i.source})}},{live:function(){return this.liveBindTo("item","pointerover pointerout",function(t){var e=t.data.domElem;e[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onItemEnter(e,t):this._onItemLeave(e,t))}).liveBindTo("item","pointerclick",function(t){var e=t.data.domElem;this._onItemClick(e,t,{source:"pointer"})}).liveBindTo("item","focusin",function(t){var e=t.data.domElem;this._onItemFocusin(e,t)}).liveBindTo("focusout",function(t){this._onFocusout(t)}),this.__base()}}),BEM.DOM.decl("menu",{onSetMod:{focused:{yes:function(){if(this.__base.apply(this,arguments),this.hasMod("type","navigation"))return!1;this.elem("item","hovered","yes").length||(this.setMod(this.elem("item").eq(0),"hovered","yes"),this._scrollToItem(this.elem("item").eq(0))),this.bindToDoc("keydown",this._onKeydown).bindToDoc("keyup",this._onKeyup).bindToDoc("keypress",this._onKeypress)},"":function(){this.__base.apply(this,arguments),this.unbindFromDoc("keydown keyup keypress").delMod(this.elem("item","hovered","yes"),"hovered")}}},hoverNext:function(t){for(var e,i,n=t?this.getItems().reverse():this.getItems(),s=0,o=!1;i=n[s];s++)if(!this.hasMod(i,"disabled"))if(this.hasMod(i,"hovered"))o=!0;else{if(o){e=i;break}e||(e=i)}e&&(this.setMod(e,"hovered","yes"),this._scrollToItem(e))},hoverText:function(t,e){for(var i,n=this.getItems(),s=n.length,o=this._normalizeText(t),r=e||0;r<s;){if(i=n[r],!this.hasMod(i,"disabled")&&0===this._normalizeText(i.text()).indexOf(o))return this.setMod(i,"hovered","yes"),void this._scrollToItem(i);++r===n.length&&(r=0,s=e)}},_normalizeText:function(t){return t.toLowerCase().replace(/ё/,"е")},reset:function(){this.__base.apply(this,arguments),this._dropSearchCache()},_dropSearchCache:function(){this._lastTime=this._lastChar=this._searchTerm=void 0},_scrollToItem:function(t){var e=this.domElem.offset().top,i=t.offset().top,n=0;i<e?n=i-e:(n=i+t.outerHeight()-e-this.domElem.outerHeight())<0&&(n=0),this.domElem.scrollTop(this.domElem.scrollTop()+n)},_onKeydown:function(t,e){var i=BEM.blocks.keycodes,n=t.keyCode;t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||((i.is(n,"UP","DOWN")||!e&&n===i.SPACE)&&t.preventDefault(),i.is(n,"UP","DOWN")&&(this.hoverNext(i.is(n,"UP")),this._dropSearchCache()))},_onKeyup:function(t){var e=BEM.blocks.keycodes,i=t.keyCode;t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||e.is(i,"ENTER","SPACE")&&this._onItemClick(this.elem("item","hovered","yes"),t,{source:"keyboard"})},_onKeypress:function(t){var e,i,n=Number(new Date),s=t.charCode,o=String.fromCharCode(s).toLowerCase(),r=o===this._lastChar&&1===this._searchTerm.length,a=this.getItems();s<=BEM.blocks.keycodes.SPACE||t.ctrlKey||t.altKey||t.metaKey?this._lastTime=n:(n-this._lastTime>this.SEARCH_TIMEOUT||r?this._searchTerm=o:this._searchTerm=(this._searchTerm||"")+o,this._lastChar=o,this._lastTime=n,e=this.elem("item","hovered","yes"),i=(i=$($.map(a,function(t){return t.get()})).index(e))>=0?i:0,r&&0===this._normalizeText(e.text()).indexOf(this._searchTerm)&&(i=i>=a.length-1?0:i+1),this.hoverText(this._searchTerm,i))},SEARCH_TIMEOUT:1500}),BEM.DOM.decl("b-cluster-tree-filter",{initBlock:function(){var t;this.filters=[{val:"G",text:BEM.I18N("b-cluster-tree-filter","tables")},{val:"R",text:BEM.I18N("b-cluster-tree-filter","redirects")},{val:"404",text:BEM.I18N("b-cluster-tree-filter","non_existent")},{val:"403",text:BEM.I18N("b-cluster-tree-filter","closed_pages")}],this.clusterTree=this.findBlockOutside("b-cluster-tree"),t=this.clusterTree.pageTypes.split(","),this.setOptions(t)},setOptions:function(t){var e=[],i=this;return this.filters.forEach(function(i){t.indexOf(i.val)>-1&&e.push(i.val)}),BEM.DOM.update(this.domElem,BEMHTML.apply({block:"b-cluster-tree-filter",elem:"select",items:this.filters,val:e}),function(){i.findBlockInside("select2").on("change",i._onSelect,i)}),this.clusterTree.changeFilter(e.join(",")),this},_onSelect:function(t,e){this.clusterTree.changeFilter(e.currVal.join(","))}}),BEM.DOM.decl({block:"menu",modName:"type",modVal:"check"},{getVal:function(){return this.getItems("checked","yes").map(function(t){return this.elemParams(t).val},this)},setVal:function(t){return Array.isArray(t)||(t=[t]),this.getItems().forEach(function(e){-1!==t.indexOf(this.elemParams(e).val)?this.setMod(e,"checked","yes"):this.delMod(e,"checked")},this),this._onChange(),this},_onItemClick:function(t,e,i){this.__base.apply(this,arguments),this.toggleMod(t,"checked","yes"),this._onChange()},_onChange:function(){var t=this._val,e=this.getVal();return t.length===e.length&&e.every(function(e){return-1!==t.indexOf(e)})||(this._val=e,this.trigger("change",{prevVal:t,currVal:e})),this}}),BEM.DOM.decl("b-events-log",{loaded:0,currentEvent:null,diffEvent:null,firstLoad:!0,currentRevisionId:null,_latestRevisionId:null,onSetMod:{js:function(){this._pageStore=BEM.WISTORE.get("page"),this.bPage=this.findBlockOutside("b-page"),this.pageType=this._pageStore.get("type"),this.spinner=this.findBlockInside("spin2"),this._eventsSelect=this.findBlockInside("b-events-select"),this.mask=this.elem("mask"),this._parents=this.domElem.parents(),this._closePopupsThrottle=$.throttle(this._closePopups,100,this),this.bindToDoc("scroll",this._closePopupsThrottle.bind(this)),this.bindTo(this._parents,"scroll",this._closePopupsThrottle.bind(this)),this._getEvents(!1)}},destruct:function(){BEM.blocks["b-event"].bPage=null,BEM.blocks["b-event"].bEventsLog=null,BEM.blocks["b-event"].bGridTable=null,BEM.blocks["b-event"].bContent=null,BEM.blocks["b-event"].wikiDoc=null,BEM.blocks["b-revision-diff"].bEventsLog=null,BEM.blocks["b-revision-diff"].bPage=null,BEM.blocks["b-revision-diff"].bContent=null,BEM.blocks["b-revision-diff"].wikiDoc=null,this.unbindFromDoc("scroll",this._closePopupsThrottle,this),this.unbindFrom(this._parents,"scroll",this._closePopupsThrottle,this),this.__base.apply(this,arguments)},_closePopups:function(){this._eventsSelect.isOpened()&&this._eventsSelect.close()},setDiff:function(t){t.revision_1&&t.revision_2&&t.revision_1!==t.revision_2?(this._diffFromURL=t,void 0!==this.total&&this._showDiff(t)):this._showIncorrectDiffDataError()},_showDiff:function(t){var e,i;this.findBlocksInside("b-event").forEach(function(n,s){s||n,n.params.revisionId==t.revision_1&&(e=n),n.params.revisionId==t.revision_2&&(i=n)},this),e&&i?(e.select(!0),i.setDiffEvent(),this._customDiffShowed=!0):this._loadedAll?this._showIncorrectDiffDataError():this._getEvents(!0,!0)},_showIncorrectDiffDataError:function(){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-events-log","diff_not_found")))},_getEvents:function(t,e){t?this.spinner.setMod("progress","yes"):this.loaded=0,BEM.create("wi-api-request",{apiPath:".events",path:"/"+this._pageStore.get("superTag"),urlParams:["format=json","event_types="+this.__self._types,"start="+this.loaded,e?"":"limit="+this.__self._limit]}).run().then(this._onGotData.bind(this,t,e),this._onFailedData.bind(this,t))},_onMoreClick:function(){this._getEvents(!0)},_getRevisionsBEMJSON:function(t){return t.map(function(t,e){var i=t.event_type,n={block:"b-events-log",elem:"item",mix:[1===e&&{block:"w-getting-started",elem:"elem",elemMods:{"sidebar-revisions":"2"}}],content:[]};return"edit"!==i&&"create"!==i&&"edit_structure"!==i||!t.revision?n.mix.push({block:"b-event",mods:{type:i,theme:this.getMod("theme")}}):(n.mix.push({block:"b-event",mods:{compared:"edit"===i||"create"===i?"yes":"",type:i,selectable:"yes",theme:this.getMod("theme")},js:{revisionId:t.revision.id,timestamp:t.created_at,user:t.author.display}}),n.content.push({block:"checkbox",mods:{size:"m",theme:this.getMod("theme"),visibility:BEM.WISTORE.get("page").get("redirect")?"hidden":""},mix:[{block:"b-event",elem:"check"},{block:"b-revision-diff",js:!0}],js:{revisionId:t.revision.id}})),n.content.push({block:"b-event",elem:"user",login:t.author.login,isDismissed:t.author.is_dismissed,theme:this.getMod("theme")},": ",{block:"b-event",elem:"action",elemMods:{type:"subscribe_other_user"===i||"change_owner"===i?i.replace(/_/g,"-"):"default"},type:i,data:t.additional_fields,theme:this.getMod("theme")},{block:"b-event",elem:"date",timestamp:t.created_at}),n},this)},_getNoRevisionsBEMJSON:function(){var t={block:"b-events-log",elem:"item",mix:[],content:BEM.I18N("b-events-log","no_events")};return this.elem("more-link").hide(),[t]},_onGotData:function(t,e,i){var n;this._loadedAll=e,this.total=i.data.total,!this._latestRevisionId&&i.data.data&&i.data.data.length&&i.data.data[0].revision?this._latestRevisionId=i.data.data[0].revision.id:this._latestRevisionId=this._pageStore.get("version"),n=BEMHTML.apply(this.total?this._getRevisionsBEMJSON(i.data.data):this._getNoRevisionsBEMJSON()),this.loaded=this.loaded+i.data.data.length,this.total-this.loaded?this.elem("more-link").show():this.elem("more-link").hide(),t?(this.spinner.delMod("progress"),BEM.DOM.append(this.elem("list"),n)):BEM.DOM.update(this.elem("list"),n),BEM.blocks["b-event"].on(this.domElem,"disable-compare",this._disableCompare,this),BEM.blocks["b-event"].on(this.domElem,"enable-compare",this._enableCompare,this),this.currentEvent=this._getCurrentEvent(),!this._latestRevisionId&&i.data.data&&i.data.data.length?this._latestRevisionId=i.data.data[0].revision.id:this._latestRevisionId=this._pageStore.get("version"),this.currentEvent&&this.currentEvent.setSelection(),this.firstLoad&&this.currentEvent&&(this.currentRevisionId=this.currentEvent.params.revisionId),this.currentEvent&&!t&&this.currentEvent._getRevisionBEMJSON(),this.trigger("ready"),this._diffFromURL&&!this._customDiffShowed&&this._showDiff(this._diffFromURL)},_disableCompare:function(){this.findBlocksInside("checkbox").forEach(function(t){t.setMod("disabled","yes")},this)},_enableCompare:function(){this.findBlocksInside("checkbox").forEach(function(t){t.delMod("disabled")},this)},_onFailedData:function(t,e){t?this.spinner.delMod("progress"):this.trigger("ready"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-events-log","cant_load_revision"),e))},showRevisionInfo:function(){var t,e,i,n=this.bPage.findBlockInside("b-page-title-info"),s=this.bPage.findBlockInside({block:"b-revision-info",modName:"type",modVal:"view"});s?(BEM.DOM.update(s.elem("text"),BEMHTML.apply(this.getRevisionInfoTextBEMJSON())),"grid"===this.pageType&&((i=s.findBlockInside("button2")).params.revisionId=this.currentEvent.params.revisionId),"article"===this.pageType&&((t=this.bPage.findBlockInside({block:"w-action",modName:"type",modVal:"edit"})).params.revisionId=this.currentEvent.params.revisionId)):(BEM.DOM.after(n.domElem,BEMHTML.apply(this.getRevisionInfoBEMJSON())),s=this.bPage.findBlockInside({block:"b-revision-info",modName:"type",modVal:"view"}),"grid"!==this.pageType||BEM.WISTORE.get("page").get("redirect")||(BEM.DOM.append(s.elem("button"),BEMHTML.apply(this.getRevisionInfoGridButtonBEMJSON())),(i=s.findBlockInside("button2")).params.revisionId=this.currentEvent.params.revisionId,i.on("click",this.returnGridRevision,this)),"article"!==this.pageType||BEM.WISTORE.get("page").get("redirect")||(t=this.bPage.findBlockInside({block:"w-action",modName:"type",modVal:"edit"}),e=this.bPage.findBlockInside("b-page-more"),BEM.DOM.append(s.elem("button"),t.domElem),(t=this.bPage.findBlockInside({block:"w-action",modName:"type",modVal:"edit"})).params.revisionId=this.currentEvent.params.revisionId,(i=t.findBlockOn("button2")).delMod("side"),i.delMod("pseudo"),i.setMod("size","s"),i.setMod("theme","clear"),i.elem("text").text(BEM.I18N("b-events-log","edit_version")),e.domElem.hide()))},getRevisionInfoBEMJSON:function(){return{block:"b-revision-info",mods:{type:"view"},content:[{elem:"text",content:this.getRevisionInfoTextBEMJSON()},{elem:"button",content:""}]}},getRevisionInfoTextBEMJSON:function(){return["article"===this.pageType?BEM.I18N("b-events-log","old_page_version"):BEM.I18N("b-events-log","old_table_version"),{block:"m-date",format:"full",timestamp:this.currentEvent.params.timestamp},". "+BEM.I18N("b-events-log","author")+" "+this.currentEvent.params.user+"."]},getRevisionInfoGridButtonBEMJSON:function(){return{block:"button2",mods:{size:"s",theme:"clear"},text:BEM.I18N("b-events-log","return_this_version")}},returnGridRevision:function(t){var e=t.target.params.revisionId;e&&BEM.create("wi-api-request",{apiPath:".grid/revisions/"+e+"/rollback",path:BEM.blocks["wi-history"].getCorrectPath(),method:"POST",urlParams:["format=json"]}).run().then(this._onReturnGridSuccess.bind(this),this._onReturnGridError.bind(this,t.target))},_onReturnGridSuccess:function(){window.location.reload()},_onReturnGridError:function(t,e){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,e))},hideRevisionInfo:function(){var t,e,i,n=this.bPage.findBlockInside({block:"b-revision-info",modName:"type",modVal:"view"});n&&("article"===this.pageType&&(t=this.bPage.findBlockInside({block:"w-action",modName:"type",modVal:"edit"}),e=this.bPage.findBlockInside("b-page-more"),i=t.findBlockOn("button2"),e.domElem.show(),BEM.DOM.before(e.domElem,t.domElem),t.params.revisionId=null,i.setMod("size","m"),i.setMod("side","left"),i.setMod("pseudo","yes"),i.setMod("theme","pseudo"),i.elem("text").text(BEM.I18N("b-events-log","page_edit"))),BEM.DOM.destruct(n.domElem))},_getCurrentEvent:function(){var t=null,e=this._pageStore.get("version");return this.findBlocksInside({block:"b-event",modName:"selectable",modVal:"yes"}).some(function(i){return i.revisionId===e&&(t=i,!0)}),t||(t=this.findBlockInside({block:"b-event",modName:"selectable",modVal:"yes"}))&&this._pageStore.set("version",t.revisionId),t}},{_limit:10,_types:"create,edit",live:function(){return this.liveBindTo("more-link","click",function(){this._onMoreClick()}),!1}}),BEM.DOM.decl("b-events-log",{_onGotData:function(t,e,i){var n;this._loadedAll=e,this.total=i.data.total,!this._latestRevisionId&&i.data.data&&i.data.data.length&&i.data.data[0].revision?this._latestRevisionId=i.data.data[0].revision.id:this._latestRevisionId=this._pageStore.get("version"),n=BEMHTML.apply(this.total?this._getRevisionsBEMJSON(i.data.data):this._getNoRevisionsBEMJSON()),this.loaded=this.loaded+i.data.data.length,!i.data.limit_exceeded&&this.total-this.loaded?this.elem("more-link").show():this.elem("more-link").hide(),this.setMod(this.elem("limit-exceeded"),"visibility",i.data.limit_exceeded?"visible":""),t?(this.spinner.delMod("progress"),BEM.DOM.append(this.elem("list"),n)):BEM.DOM.update(this.elem("list"),n),BEM.blocks["b-event"].on(this.domElem,"disable-compare",this._disableCompare,this),BEM.blocks["b-event"].on(this.domElem,"enable-compare",this._enableCompare,this),this.currentEvent=this._getCurrentEvent(),!this._latestRevisionId&&i.data.data&&i.data.data.length?this._latestRevisionId=i.data.data[0].revision.id:this._latestRevisionId=this._pageStore.get("version"),this.currentEvent&&this.currentEvent.setSelection(),this.firstLoad&&this.currentEvent&&(this.currentRevisionId=this.currentEvent.params.revisionId),this.currentEvent&&!t&&this.currentEvent._getRevisionBEMJSON(),this.trigger("ready"),this._diffFromURL&&!this._customDiffShowed&&this._showDiff(this._diffFromURL)}}),BEM.DOM.decl("b-events-select",{onSetMod:{js:function(){this.bEventsLog=this.findBlockOutside("b-events-log"),this._select=this.findBlockInside("select2"),this._select.on("change",this._onSelect,this)}},close:function(){return this._getPopup().delMod("visible"),this},isOpened:function(){return this._getPopup().hasMod("visible","yes")},_getPopup:function(){return this._popup||(this._popup=this.findBlockOn(this._select.elem("popup"),"popup2")),this._popup},_onSelect:function(t,e){this.bEventsLog.__self._types=e.currVal,this.bEventsLog._getEvents(!1)}}),BEM.DOM.decl({block:"checkbox",baseBlock:"control"},{onSetMod:{js:{inited:function(){var t=this.elem("control");this.toggleMod("checked","yes",t.prop("checked")),this.toggleMod("focused","yes",t.isFocused())}},hovered:{yes:function(){return!this.hasMod("disabled")}},pressed:{yes:function(){return!this.hasMod("disabled")}},checked:function(t,e){var i=this.elem("control");i.prop("checked",e),i.attr("aria-checked","mixed"===i.attr("aria-checked")?"mixed":Boolean(e)),this.trigger("change",{checked:Boolean(e)})},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("hovered").delMod("pressed")}}},isDisabled:function(){return this.hasMod("disabled")},isChecked:function(){return Boolean(this.elem("control").prop("checked"))},toggle:function(){this.toggleMod("checked","yes")},val:function(t){var e=this.elem("control");return void 0===t?e.val():(e.val(t),this)},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},_onChange:function(t){this.toggleMod("checked","yes",t.target.checked)},_onPointerenter:function(t){this.setMod("hovered","yes")},_onPointerleave:function(t){this.delMod("hovered")},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onClick:function(t){var e=this.elem("label"),i=t.target;this.domElem[0]===i&&this._onChange(t),i!==e[0]&&this.trigger("click",{domEvent:t}),this.setMod("focused","yes")},_onKeydown:function(t){t.keyCode===BEM.blocks.keycodes.SPACE&&this.setMod("pressed","yes")},_onKeyup:function(t){t.keyCode===BEM.blocks.keycodes.SPACE&&this.delMod("pressed")}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.isDisabled()||this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}).liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}).liveBindTo("pointerclick",function(t){this.hasMod("disabled")||this._onClick(t)}).liveBindTo("control","keydown",function(t){this.hasMod("disabled")||this._onKeydown(t)}).liveBindTo("control","keyup",function(t){this.hasMod("disabled")||this._onKeyup(t)}).liveBindTo("control","change",function(t){this._onChange(t)}),this.__base()}}),BEM.blocks["mi-helpers"]={getDateFromHumanString:function(t){var e,i=Math.abs(-(t.search(/\./)+1)||-(t.search("Z")+1)),n=t;return n=n.replace(/-/g,",").replace("T",",").replace(/:/g,","),(n=(n=i?n.substr(0,i-1):n).split(","))[1]=n[1]-1,e=this.getUTC_YMD(n[0],n[1],n[2]),n[3]&&e.setHours(n[3]),n[4]&&e.setMinutes(n[4]),n[5]&&e.setSeconds(n[5]),e},getUTC_YMD:function(t,e,i){return new Date(t,e,i)},getHumanStringFromDate:function(t){var e,i,n,s,o,r,a,c;return t&&t.date?(n=(i=t.date).getFullYear(),s=(i.getMonth()+1).toString(),o=i.getDate().toString(),r=i.getHours().toString(),a=i.getMinutes().toString(),c=i.getSeconds().toString(),1===s.length&&(s="0"+s),e=n+"-"+s,!1!==t.needDay&&(1===o.length&&(o="0"+o),e=e+"-"+o,t.needHours&&(1===r.length&&(r="0"+r),e=e+"T"+r,t.needMinutes&&(1===a.length&&(a="0"+a),e=e+":"+a,t.needSeconds&&(1===c.length&&(c="0"+c),e=e+":"+c)))),e):null},validateNumberOnlyInput:function(t){var e,i,n,s=!1,o=t.target,r=$(o),a=o.selectionStart,c=r.val(),l=/^[-|\d]{1}\d{0,}(?:[.,]{0,1}\d{0,})$/;if(!l.exec(c)&&c.length){for(e=0;e<c.length;e++)if(i=c.substr(0,e)+c.substr(e+1,c.length),l.exec(i)){r.val(i),o.setSelectionRange(a-1,a-1),s=!0;break}s||(n=/\d+(?:[.,]{0,1}\d{0,})/.exec(c),r.val(n?n[0]:""))}},isVisible:function(t){var e,i=BEM.DOM.win.get(0);return t===BEM.DOM.doc.get(0)||!(!t||!t.parentNode)&&((!t.style||"none"!==t.style.display&&"hidden"!==t.style.visibility)&&((!i.getComputedStyle||"none"!==(e=i.getComputedStyle(t,"")).display&&"hidden"!==e.visibility)&&this.isVisible(t.parentNode)))},htmlSpecialChars:function(t){return"string"==typeof t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):t},dateFormat:function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,e=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,i=/[^-+\dA-Z]/g,n=function(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t},s={default:"d mmm yyyy",shortDate:"d mmm yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"HH:MM",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",dayMonthTime:"dd.mm hh:mm",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};return function(o,r,a){1!=arguments.length||"[object String]"!=Object.prototype.toString.call(o)||/\d/.test(o)||(r=o,o=void 0);try{if(o=o?new Date(o):new Date,isNaN(o))throw SyntaxError("invalid date");"UTC:"==(r=String(s[r]||r||s.default)).slice(0,4)&&(r=r.slice(4),a=!0);var c=a?"getUTC":"get",l=o[c+"Date"](),d=o[c+"Day"](),h=o[c+"Month"](),u=o[c+"FullYear"](),m=o[c+"Hours"](),p=o[c+"Minutes"](),f=o[c+"Seconds"](),_=o[c+"Milliseconds"](),g=a?0:o.getTimezoneOffset(),b={d:l,dd:n(l),ddd:BEM.I18N("i-tanker__days","short"+(d||7)),dddd:BEM.I18N("i-tanker__days","n"+(d||7)),m:h+1,mm:n(h+1),mmm:BEM.I18N("i-tanker__months","short"+(h+1)),mmmm:BEM.I18N("i-tanker__months","g"+(h+1)),yy:String(u).slice(2),yyyy:u,h:m%12||12,hh:n(m%12||12),H:m,HH:n(m),M:p,MM:n(p),s:f,ss:n(f),l:n(_,3),L:n(_>99?Math.round(_/10):_),t:m<12?"a":"p",tt:m<12?"am":"pm",T:m<12?"A":"P",TT:m<12?"AM":"PM",Z:a?"UTC":(String(o).match(e)||[""]).pop().replace(i,""),o:(g>0?"-":"+")+n(100*Math.floor(Math.abs(g)/60)+Math.abs(g)%60,4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10]};return r.replace(t,function(t){return t in b?b[t]:t.slice(1,t.length-1)})}catch(t){}}}()},BEM.DOM.decl("b-event",{revisionId:null,revisionCache:null,onSetMod:{js:function(){this.revisionId=this.params.revisionId,this._pageStore=BEM.WISTORE.get("page"),this.__self.bPage||(this.__self.bPage=BEM.blocks["i-global"].getbPage()),this.__self.bEventsLog||(this.__self.bEventsLog=this.findBlockOutside("b-events-log")),this.checkbox=this.findBlockInside("checkbox"),this.channel("update-diff").on("showDiff",this._onShowDiff,this),this.channel("update-diff").on("uncheckDiff",this._onUncheckDiff,this)}},destruct:function(){this.channel("update-diff").un("showDiff",this._onShowDiff,this),this.channel("update-diff").un("uncheckDiff",this._onUncheckDiff,this),this.__base.apply(this,arguments)},setDiffEvent:function(){this.setMod("selected","yes"),this.checkbox.setMod("checked","yes")},setSelection:function(){this.setMod("selected","yes"),this.checkbox.setMod("checked","yes"),this.checkbox.setMod("disabled","yes")},removeSelection:function(){this.delMod("selected"),this.checkbox.delMod("disabled"),this.checkbox.delMod("checked")},_getRevisionApiPath:function(t){return("grid"==this.__self.bEventsLog.pageType?".grid/revisions/":".revisions/")+t},_getRevisionBEMJSON:function(){this.revisionCache?this._showRevision():BEM.create("wi-api-request",{apiPath:this._getRevisionApiPath(this.__self.bEventsLog.currentEvent.params.revisionId),path:BEM.blocks["wi-history"].getCorrectPath(),urlParams:["format=json"]}).run().then(this._onGotData.bind(this),this._onFailedData.bind(this))},_onGotData:function(t){this.revisionCache=t,this.__self.bEventsLog.firstLoad?(this.isCurrentRevision()?this.__self.bEventsLog.hideRevisionInfo():this.__self.bEventsLog.showRevisionInfo(),this.__self.bEventsLog.firstLoad=!1):this._showRevision()},_onFailedData:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this.domElem,BEM.I18N("b-event","cant_load_revision"),t))},_showRevision:function(){var t;"grid"==this.__self.bEventsLog.pageType&&(this.__self.bGridTable||(this.__self.bGridTable=this.__self.bPage.findBlockInside("b-grid-table")),this.isCurrentRevision()?(this.__self.bGridTable.delMod("readonly"),this.__self.bGridTable.delMod("revision"),this.__self.bGridTable.readOnly=!1):(this.__self.bGridTable.setMod("readonly","true"),this.__self.bGridTable.setMod("revision","true"),this.__self.bGridTable.readOnly=!0),this.__self.bGridTable._onGotData(this.revisionCache)),"article"==this.__self.bEventsLog.pageType&&(this.channel("content").trigger("update",this.revisionCache),this.__self.bContent||(this.__self.bContent=this.__self.bPage.findBlockInside("b-content")),this.__self.wikiDoc=this.__self.bContent.findBlockInside("wiki-doc"),this.isCurrentRevision()||(t=this.__self.wikiDoc.findBlocksInside("b-wiki-form")).length&&t.forEach(function(t){var e=t.findBlockInside({block:"button2",modName:"role",modVal:"form-submit"});e&&e.setMod("disabled","yes")})),this.isCurrentRevision()?this.__self.bEventsLog.hideRevisionInfo():this.__self.bEventsLog.showRevisionInfo(),this._pageStore.set("version",this.revisionId)},isCurrentRevision:function(){return this.__self.bEventsLog._latestRevisionId===this.__self.bEventsLog.currentEvent.params.revisionId},select:function(t){var e=this.hasMod("compared","yes");BEM.blocks["wi-history"].pushState(""),e&&this.trigger("enable-compare"),this.__self.bEventsLog.currentEvent&&this.__self.bEventsLog.currentEvent.removeSelection(),this.__self.bEventsLog.diffEvent&&(this.__self.bEventsLog.diffEvent.removeSelection(),this.__self.bEventsLog.diffEvent=null),this.__self.bEventsLog.currentEvent=this,this.setSelection(),!t&&this._getRevisionBEMJSON(),!e&&this.trigger("disable-compare")},_onShowDiff:function(){this.__self.bEventsLog.currentEvent.findBlockInside("checkbox").delMod("disabled")},_onUncheckDiff:function(){this.__self.bEventsLog.currentEvent._getRevisionBEMJSON(),this.__self.bEventsLog.currentEvent.findBlockInside("checkbox").setMod("disabled","yes")}},{live:function(){this.liveBindTo("click",function(t){this.hasMod("selectable")&&this.select()}),this.liveBindTo("check","click",function(t){t.stopPropagation()})}}),BEM.DOM.decl("staff-lite-card",{onSetMod:{js:function(){this._card={destruct:function(){}},this._onMouseOver()}},_onMouseOver:function(){var t=this.domElem,e=this.params.user,i=this;this._unbindFromMouseOver(),this.__self._cardReady(this._getStaffHost()).then(function(){i._card=new StaffLiteCard({elem:t,login:e}),i._card.show()},function(){i._bindToMouseOver()})},_bindToMouseOver:function(){this.bindTo("pointerover",this._onMouseOver)},_unbindFromMouseOver:function(){this.unbindFrom("pointerover",this._onMouseOver)},_getStaffHost:function(){return this.params.staffLiteHost||"https://staff.yandex.ru"},destruct:function(){return this._card.destruct(),this.__base.apply(this,arguments)}},{_cardScriptRequest:null,_cardReady:function(t){if(this._cardScriptRequest)return this._cardScriptRequest;if("undefined"==typeof StaffLiteCard){var e=document.createElement("script"),i=jQuery.Deferred(),n=this;return e.type="text/javascript",e.src=t+"/m/staff-lite-card/build/index.js",e.onload=i.resolve,e.onerror=function(){n._cardScriptRequest=null,i.reject(),e.remove()},document.body.appendChild(e),this._cardScriptRequest=i.promise(),this._cardScriptRequest}return jQuery.when()},live:function(){this.liveBindTo("pointerover")}}),BEM.DOM.decl("staff-lite-card",{_onMouseOver:function(){var t=this.domElem,e=this.domElem.data("wf"),i=e&&e.user||this.params.user,n=this;this._unbindFromMouseOver(),this.__self._cardReady(this._getStaffHost()).then(function(){n._card=new StaffLiteCard({elem:t,login:i}),n._card.show()},function(){n._bindToMouseOver()})},_getStaffHost:function(){var t=this.domElem.data("wf");return t&&t.staffLiteHost||this.params.staffLiteHost||"https://staff.yandex.ru"}}),BEM.DOM.decl("mi-staff-card",{onSetMod:{js:function(){var t=this.domElem,e=this.params.user,i=this;this.bindTo("pointerout",this._onPointerOut),this._card={destruct:function(){}},$.when(this.__self._cardReady()).then(function(){i._card=new StaffCard(t,e),i.afterCurrentEvent(function(){i.hasMod("hovered","yes")&&i._card.onHover()})})}},_onPointerOut:function(){this.delMod("hovered")},destruct:function(){return this.unbindFrom("pointerout",this._onPointerOut),this._card.destruct(),this.__base.apply(this,arguments)}},{_cardScriptRequest:null,_cardReady:function(){return this._cardScriptRequest?this._cardScriptRequest:"undefined"==typeof StaffCard?(this._cardScriptRequest=$.ajax({dataType:"script",cache:!0,url:"//static.yandex.net/staff-card/_/staff-card-base.min.js"}),this._cardScriptRequest):void 0},live:function(){this.liveBindTo("pointerover",function(t){this.setMod("hovered","yes")})}}),BEM.DOM.decl("mi-staff-card",{_buildMStaffCard:function(t){t&&t.gap&&t.gap.time&&(t.gap.time=t.gap.time.replace(/\&nbsp;/g," ")),this.__base.apply(this,[t])}},{live:!1}),BEM.DOM.decl("b-revision-diff",{onSetMod:{js:function(){this.__self.bEventsLog||(this.__self.bEventsLog=this.findBlockOutside("b-events-log"))}},destruct:function(){this.__base.apply(this,arguments)},_onCheckboxChange:function(t,e){this.findBlockOn("checkbox");var i=this.findBlockOutside("b-event");if(!this.__self.bEventsLog.currentEvent)return!1;if(e.checked){if(this.__self.bEventsLog.currentEvent==i)return!1;this.__self.bEventsLog.diffEvent&&this.__self.bEventsLog.diffEvent!=i&&this.__self.bEventsLog.diffEvent.removeSelection(),this.__self.bEventsLog.diffEvent=i,this._getDiff(this.__self.bEventsLog.currentEvent.params.revisionId,this.__self.bEventsLog.diffEvent.params.revisionId),this.__self.bEventsLog.diffEvent.setMod("selected","yes"),this.channel("update-diff").trigger("showDiff")}else{if(this.__self.bEventsLog.currentEvent!=i&&this.__self.bEventsLog.diffEvent!=i)return!1;this.__self.bEventsLog.currentEvent==i&&(this.__self.bEventsLog.currentEvent.delMod("selected"),this.__self.bEventsLog.currentEvent=this.__self.bEventsLog.diffEvent),this.__self.bEventsLog.diffEvent==i&&this.__self.bEventsLog.diffEvent.delMod("selected"),this.__self.bEventsLog.diffEvent=null,this.afterCurrentEvent(function(){this.channel("update-diff").trigger("uncheckDiff")},this)}},_showDiff:function(t,e){e.params&&(this.channel("update-diff").trigger("showDiff"),e.params.revision_1&&e.params.revision_2&&this._getDiff(e.params.revision_1,e.params.revision_2))},_getDiff:function(t,e){this.__self.bPage||(this.__self.bPage=this.findBlockOutside("b-page")),BEM.blocks["wi-history"].pushState(".log?revision_1="+t+"&revision_2="+e),BEM.create("wi-api-request",{apiPath:".diff",path:BEM.blocks["wi-history"].getCorrectPath(),urlParams:["format=json","a="+t,"b="+e]}).run().then(this._onGotData.bind(this),BEM.blocks["wi-notification"].errorHandler(null,BEM.I18N("b-revision-diff","cant_load_diff")))},_onGotData:function(t){var e;this.__self.bContent||(this.__self.bContent=this.__self.bPage.findBlockInside("b-content")),"article"===this.__self.bEventsLog.pageType?this._showArticleDiffData(BEMHTML.apply({block:"b-diff-content",content:this._buildDiffStringBEMJSON(t.data.diff)})):((e=this.__self.bContent.findBlockInside("b-grid-table")).setMod("readonly","true"),e.readOnly=!0,e&&e.showDiff(t.data))},_buildDiffStringBEMJSON:function(t){var e=[];return t.forEach(function(t){var i={block:"b-diff-string",mods:{"diff-type":t.changes},content:[]};t.chunks.forEach(function(t){i.content.push({elem:"chunk",elemMods:{"diff-type":t.action},content:t.substring})},this),e.push(i)},this),e},_showArticleDiffData:function(t){this.__self.bContent||(this.__self.bContent=this.__self.bPage.findBlockInside("b-content")),BEM.DOM.update(this.__self.bContent.findBlockInside("w-content").domElem,t)}},{live:function(){this.liveInitOnBlockEvent("change","checkbox",function(t,e){this._onCheckboxChange(t,e)})}}),BEM.DOM.decl("w-attachments",{_filesIndex:0,onSetMod:{js:function(){this._uploader=BEM.create("wi-uploader",{url:"/.upload"}),this._attachBtn=this.findBlockInside("attach"),this._moreBtn=this.findBlockInside(this.elem("more"),"link"),this._attachBtn.elem("control")[0].multiple=!0,this._events(),this._getFiles()},loading:function(t,e){this._moreBtn.setMod("disabled",e?"yes":"")}},destruct:function(){this._filesRequest&&this._filesRequest.abort(),this.channel("attachments").un("add",this._onAddFiles,this),BEM.blocks["w-attach"].un("open",this._onAttachOpen,this),this.__base.apply(this,arguments)},_events:function(){this.channel("attachments").on("add",this._onAddFiles,this),this._uploader.on("progress",this._onUploadProgress,this),this._uploader.on("success",this._onUploadSuccess,this),this._uploader.on("error",this._onUploadError,this),this.bindTo("more","click",function(){this._getFiles()}),this._attachBtn.on("change",function(t){var e=this._attachBtn.elem("control")[0].files;this._onAddFiles(t,e),this._attachBtn.resetFile()},this),BEM.blocks["w-attach"].on("open",this._onAttachOpen,this)},_getFiles:function(){this.setMod("loading","yes"),this._filesRequest=BEM.create("wi-api-request",{apiPath:".files",path:BEM.blocks["wi-history"].getCorrectPath(),urlParams:["format=json","start="+this._filesIndex,"limit="+this.__self._filesPerPage]}),this._filesRequest.run().then(this._onGotFiles.bind(this),function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("w-attachments","filed-to-load-files"),t))}).always(function(){this.setMod("loading",""),this.trigger("ready"),"rejected"===this._filesRequest.promise.state()&&this.elem("more").hide(),this._filesRequest=null}.bind(this))},_onGotFiles:function(t){var e=t.data.data,i=this.elem("attachments"),n=t.data.total,s=this.getMod("theme");this.elem("more").show();var o=this;BEM.DOM.append(i,BEMHTML.apply(e.map(function(t){var e=Object.assign({},t);return e.upload_date=o.__self._processDate(e.upload_date),{block:"w-attachments",elem:"attach",elemMods:{theme:s},attach:e,redirect:BEM.WISTORE.get("page").get("redirect")}}))),this._filesIndex+=e.length,this._filesIndex>=n&&this.elem("more").hide(),this.elem("more-count").html(n-this._filesIndex)},_onAddFiles:function(t,e){var i=this._normalizeFiles(e),n=this.__self._getFileLoadersJSON(i);BEM.DOM.prepend(this.elem("attachments"),BEMHTML.apply(n)),this.elem("overall-progress").css("width",0),this._uploader.setData(i),this._uploader.send()},_onUploadProgress:function(t,e){var i=this.findElem("attach-loader").filter("[id="+e.id+"]"),n=t.block.getSummary();100===n.percent&&setTimeout(function(){this.elem("overall-progress").css("width",0)}.bind(this),2e3),this.elem("overall-progress").css("width",n.percent+"%"),this.findElem(i,"percent").html(e.progress),this.findElem(i,"meter").css("width",e.progress+"%")},_onUploadSuccess:function(t,e){var i=this.findElem("attach-loader").filter("[id="+e.file.id+"]"),n=e.data.data.storage_id;BEM.create("wi-api-request",{apiPath:".attach",method:"POST",data:{files:[n]},path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(function(t){this._onAttachSuccess(i,e,t)}.bind(this),function(t){this._onUploadError(t,e.file)}.bind(this))},_onAttachSuccess:function(t,e,i){if(i.error)this._onUploadError(null,e.file);else{var n=i.data.data[0];n.upload_date=this.__self._processDate(n.upload_date),t.length&&BEM.DOM.replace(t,BEMHTML.apply({block:"w-attachments",elemMods:{theme:this.getMod("theme")},elem:"attach",attach:n}))}},_onUploadError:function(t,e){var i=this.findElem("attach-loader").filter("[id="+e.id+"]"),n=this.__self._getErrorMessage(e.response,e.raw);this.findElem(i,"percent").html(0),this.findElem(i,"meter").css("width",0),this.setMod(i,"error","yes"),BEM.channel("notification").trigger("error",{message:n}),this.bindTo(this.findElem(i,"repeat"),"click",this._onRetry.bind(this,e,i)),this.bindTo(this.findElem(i,"cancel"),"click",function(){BEM.DOM.destruct(i)})},_onRetry:function(t,e){this.delMod(e,"error"),this._uploader.send(t)},_onAttachOpen:function(t,e){Array.prototype.slice.call(this.findBlocksInside("w-attach")).forEach(function(t){t.setMod("open",e?"yes":"")})},_normalizeFiles:function(t){return Array.prototype.slice.apply(t).map(function(t){return{raw:t,id:this.__self._generateFileId(t)}},this)}},{_processDate:function(t){var e=moment(t),i=moment();return this._isSameDay(e,i)?e.format("HH:mm"):e.format("DD.MM.YYYY")},_isSameDay:function(t,e){var i=moment(t),n=moment(e);return i.startOf("day").valueOf()===n.startOf("day").valueOf()},_getFileLoadersJSON:function(t){return t.map(function(t){return{block:"w-attachments",elem:"attach-loader",name:t.raw.name,id:t.id}},this)},_getErrorMessage:function(t,e){return t&&t.responseJSON&&t.responseJSON.error?BEM.blocks["wi-notification"].createErrorMessage(t.responseJSON.error):413===t.status?BEM.I18N("w-attachments","filed-to-load")+" "+e.name+"<br/>"+BEM.I18N("w-attachments","body_to_large"):BEM.I18N("w-attachments","filed-to-load")+" "+e.name},_generateFileId:function(t){return $.md5(t.name+"?"+Date.now())},_filesPerPage:10}),BEM.DOM.decl("w-attach",{onSetMod:{js:function(){this._appStore=BEM.WISTORE.get("app"),this._pageStore=BEM.WISTORE.get("page"),this._tooltip=this.findBlockInside("tooltip"),"edit"!==this._appStore.get("view")&&"grid"!==this._pageStore.get("type")||this.setMod("dragable","yes"),this._attachWfUrl=this.params.attach.url.replace(".files/",""),this._events()},hovered:function(){this._tooltip.setMod("shown","")},open:function(t,e){var i=e?BEM.I18N("w-attach","show_options_hint"):BEM.I18N("w-attach","hide_options_hint");this.elem("hider").attr("title",i)}},_events:function(){this.bindTo("mouseenter",function(){this.setMod("hovered","yes")}.bind(this)),this.bindTo("mouseleave",function(){this.setMod("hovered","")}.bind(this)),this.bindTo(this.elem("control","type","remove"),"click",this._onAttachRemove.bind(this)),this.bindTo(this.elem("control","type","copy"),"click",this._onAttachCopy.bind(this)),this.bindTo(this.elem("hider"),"click",this._onHideShowControls,this),this._appStore.on("change:view",function(t,e){"edit"===e?this.setMod("dragable","yes"):this.setMod("dragable","")},this)},_onAttachCopy:function(){var t="file:"+this._attachWfUrl,e=BEM.create("wi-clipboard");e.isSupported()&&e.copy(t)?this._tooltip.setOwner(this.elem("control","type","copy")).setMod("shown","yes"):window.prompt(BEM.I18N("w-attach","copy_clipboard_message"),t)},_onAttachRemove:function(){confirm(BEM.I18N("w-attach","remove_link")+"?")&&(this.setMod("loading","yes"),this.setMod(this.elem("control","type","remove"),"loading","yes"),BEM.create("wi-api-request",{method:"DELETE",apiPath:"",path:this.params.attach.url,urlParams:!1}).run().then(this._onFileRemoveDone.bind(this),BEM.blocks["wi-notification"].errorHandler(this.domElem,BEM.I18N("w-attach","remove_attach_error"))).always(function(){this.setMod("loading",""),this.setMod(this.elem("control","type","remove"),"loading","")}.bind(this)))},_onFileRemoveDone:function(){BEM.DOM.destruct(this.domElem)},_onHideShowControls:function(){var t=this.hasMod("open","yes");this.setMod("open",t?"":"yes"),this.trigger("open",!t)}},{live:function(){this.liveInitOnEvent("mouseover",function(){this.setMod("hovered","yes")})}}),BEM.decl("wi-clipboard",{onSetMod:{js:function(){}},copy:function(t){var e=document.createElement("textarea");e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.width="2em",e.style.height="2em",e.style.padding=0,e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.background="transparent",e.value=t,document.body.appendChild(e),e.select();var i=!1;try{i=document.execCommand("copy")}catch(t){i=!1}return document.body.removeChild(e),i},isSupported:function(){return document.queryCommandSupported("copy")}}),BEM.DOM.decl("tooltip",{onSetMod:{js:{inited:function(){this._popup=null,this._owner=null}},shown:{yes:function(){this._getPopup().setMod("visible","yes").unbindFromDoc("keydown")},"":function(){this._getPopup().delMod("visible")}}},getOwner:function(){return this._owner},setOwner:function(t){return this._owner=t,this._getPopup().setAnchor(t),this},setContent:function(t){return BEM.DOM.update(this.elem("content"),t),this.redraw()},redraw:function(){return this.hasMod("shown","yes")&&this._getPopup().redraw(),this},destruct:function(){this.delMod("shown"),this.__base.apply(this,arguments)},_getPopup:function(){return this._popup||(this._popup=this.findBlockOn("popup2").on("beforeOpen",this._onPopupShow,this).on("beforeClose",this._onPopupHide,this)),this._popup},_onPopupShow:function(){this.trigger("show")},_onPopupHide:function(){this.delMod("shown").trigger("hide")},_onClick:function(){this.trigger("click").delMod("shown")}},{live:function(){this.liveBindTo("click",function(){this._onClick()})}}),BEM.decl("wi-uploader",{_files:[],_summary:{},onSetMod:{js:function(){}},getSummary:function(){return this._updateSummary()},getFiles:function(){return this._files},setData:function(t){return t instanceof Array?t.forEach(function(t){t.raw&&t.raw instanceof File&&this._append(t)},this):t.raw&&t.raw instanceof File&&this._append(t),this},send:function(t){arguments.length?t.send():this._files.forEach(function(t){t.send()})},convertToOptimalSize:function(t){for(var e=["B","Kb","Mb","Gb"],i=0;i<e.length;i++){var n=t/1024;if(!(n>1))return t.toFixed(2)+e[i];t=n}},clear:function(){return this._files=[],this},_append:function(t){this._files.push(this._createFileObject(t))},_createFileObject:function(t){var e=$.extend({},t,{size:this.convertToOptimalSize(t.raw.size),response:null,status:{uploaded:!1,inProgress:!1},total:t.raw.size,loaded:0,send:this._sendFile});return e.req=this._req(e),t.raw.type.match(/image.*/)&&this._createThumbnail(e),e},_createThumbnail:function(t){var e=this,i=new FileReader,n=e.params.thumbnail;i.onloadend=function(){n&&(n.height||n.width)?e._getThumbImage(i.result,t):t.thumbnail=i.result},i.readAsDataURL(t.raw)},_getThumbImage:function(t,e){var i=new Image,n=e.raw.type,s=this.params.thumbnail;i.onload=function(){var t=s.height||null,o=s.width||null,r=i.width,a=i.height,c=document.createElement("canvas"),l=new Image,d=null,h=null,u=r>a&&r>o,m=a>r&&a>t,p=a===r&&a>t;!function s(){var f=u&&i.width>>1>o||m&&i.height>>1>t||p&&i.height>>1>t;l.onload=function(){i=l,s()};f?(r>>=1,a>>=1):(u?(a*=o/r,r=o,t&&a>t&&(r*=t/a,a=t)):(m||p)&&(r*=t/a,a=t,o&&r>o&&(a*=o/r,r=o)),r=Math.round(r),a=Math.round(a));c.width=r;c.height=a;d=c.getContext("2d");d.drawImage(i,0,0,r,a);h=c.toDataURL(n);f?l.src=h:e.newthumbnail=h}()},i.src=t},_req:function(t){var e,i=this,n=new FormData;return n.append("data",t.raw),e={xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){e.lengthComputable&&(t.progress=e.loaded/e.total*100<<0,t.loaded=e.loaded,t.total=e.total,i._updateSummary(),i.trigger("progress",t))},!1),e},type:"POST",url:this.params.url,data:n,processData:!1,contentType:!1,beforeSend:function(){t.status.inProgress=!0,i.trigger("beforeSend",t)},success:function(e){i._onSuccess(e,t)},error:function(e){i._onError(e,t)}},this.params.hasOwnProperty("ajaxExtend")&&$.extend(e,this.params.ajaxExtend),e},_onSuccess:function(t,e){e.status.uploaded=!0,e.status.inProgress=!1,e.response=t,this.trigger("success",{file:e,data:t})},_onError:function(t,e){e.status.inProgress=!1,e.response=t,this.trigger("error",e)},_updateSummary:function(){var t=this,e=0,i=0;return this._summary.filesUploaded=0,this._summary.filesTotal=this._files.length,this._summary.percent=this._getOverallPercent(),this._files.forEach(function(n){n.status.uploaded&&t._summary.filesUploaded++,e+=n.total,i+=n.loaded}),this._summary.total=e,this._summary.loaded=i,this._summary},_getOverallPercent:function(){var t=0,e=0,i=0,n=0;return this._files.length&&(this._files.forEach(function(i){t+=i.total||0,e+=i.loaded||0}),n=t/100,i=Math.round(e/n)),i},_sendFile:function(){this.status.uploaded||this.status.inProgress||$.ajax(this.req)}}),BEM.DOM.decl("wi-notification",{onSetMod:{js:function(){BEM.channel("notification").on("error",this.__self._onError,this.__self),BEM.channel("notification").on("success",this.__self._onSuccess,this.__self),BEM.channel("notification").on("info",this.__self._onInfo,this.__self)}}},{_getNotifier:function(){return this._notifier||(this._notifier=BEM.create("mi-notifier",{icons:!0,options:{warning:{autoclosable:!0}}})),this._notifier},_tooltips:{},_onError:function(t,e){return this.createNotification("error",e)},_onSuccess:function(t,e){return this.createNotification("success",e)},_onInfo:function(t,e){return this.createNotification("info",e)},createNotification:function(t,e,i){var n,s=e;return"string"==typeof s&&(s={message:s}),"string"!=typeof s.message&&(s.message=BEMHTML.apply(s.message)),n=s.elem?this._showTargetNotification(t,s,i):this._showDefaultNotification(t,s),BEM.WISTORE.get("app")&&BEM.WISTORE.get("app").get("debug")&&e.originalError&&this._getNotifier().warn(["DEBUG:<br/>",e.originalError.id,": ",e.originalError.debug,"</br>META: ",BEM.blocks["mi-helpers"].htmlSpecialChars(JSON.stringify(e.originalError.meta))]),n},_showTargetNotification:function(t,e,i){return this._getTooltip(t,i).setContent(e.message).setOwner(e.elem).setMod("shown","yes")},_showDefaultNotification:function(t,e){this._getNotifier().log(t,e.message)},_getTooltip:function(t,e){var i=this._getTooltipType(t);if(!this._tooltips.hasOwnProperty(i)){var n=BEMHTML.apply(this._getTooltipJson(i,e)),s=$(n);this._tooltips[i]=s.bem("tooltip"),BEM.DOM.append(BEM.DOM.scope,s)}return this._tooltips[i]},getError:function(t,e,i){var n=[];return e&&n.push(e),i&&(n.length&&n.push({tag:"br"}),n.push(BEM.blocks["wi-notification"].createErrorMessage(i))),{elem:t,message:n,originalError:i}},createErrorMessage:function(t){var e="";return t&&(t instanceof Error?e=t.message:t.xhr?e=this._buildXHRMessage(t.xhr):t.message?"string"==typeof t.message?e=t.message:t.message.length&&(e=t.message.join("\n")):t.message||t.meta?t.meta&&(e=this._createErrorMessageMeta(t.meta)):e=t.id),e},_createErrorMessageMeta:function(t){var e="";if(t){var i=Object.keys(t);if(1===i.length)e=i[0]+": "+t[i[0]].join(" ");else if(i.length>1){var n=[];i.forEach(function(e){n.push(e+": "+t[e].join(" "))}),e=n.join("\n")}}return e},errorHandler:function(t,e){return function(i){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(t,e,i))}},_getTooltipJson:function(t,e){return{block:"tooltip",mods:{size:"s",theme:t,autoclosable:"yes"},mix:[{block:"wi-notification",elem:"tooltip"},e||{}],content:""}},_buildXHRMessage:function(t){return 0===t.status?BEM.I18N("wi-notification","no-internet"):t.status+": "+t.statusText},_getTooltipType:function(t){switch(t){case"error":case"success":return t;case"warning":case"info":default:return"normal"}}}),BEM.DOM.decl({block:"m-notification"},{onSetMod:{js:function(){this.bindTo("click",this._onClick.bind(this)),this.params.delay&&setTimeout(this._remove.bind(this),this.params.delay)}},_onClick:function(t){var e=$(t.target),i=$(t.target.parentNode);(i.is(this.domElem)||e.is(this.domElem)||i.is(this.elem("icon")))&&this._remove()},_remove:function(){this.trigger("remove"),this.domElem&&BEM.DOM.destruct(this.domElem)}}),BEM.DOM.decl("b-grid-table-code-form",{onSetMod:{js:function(){this.params.data.url=BEM.WISTORE.get("page").get("url"),this._initBlock()}},_initBlock:function(){BEM.DOM.update(this.domElem,BEMHTML.apply(this._getBEMJSON())),this._bindEvents(),this._updateCode(),this.afterCurrentEvent(function(){this.trigger("ready")})},_bindEvents:function(){var t=this,e=this._getControls();Object.keys(e).forEach(function(e){t._controls[e].on("change",t._updateCode,t)}),this._textarea||(this._textarea=this.findBlockInside(this.elem("code"),"input")),this._textarea.on("focus",this._onTextareaFocus,this)},_updateCode:function(){this._textarea||(this._textarea=this.findBlockInside(this.elem("code"),"input")),this._textarea.val(this._getCode())},_onTextareaFocus:function(){this._textarea.elem("control").select()},_getCode:function(){var t=this._getControls(),e='"'+this.params.data.url+'" ',i=t.width.val(),n=t.width_units.getVal(),s=t.readonly.isChecked()?'readonly="1" ':"",o=t.sorting.isChecked()?"":'sort="0" ',r=t.numbers.isChecked()?"":'num="0" ';return i&&(i='width="'+i+n+'" '),"{{grid page="+e+s+i+o+r+"}}"},_getControls:function(){return this._controls||(this._controls={width:this.findBlockInside(this.elem("width"),"input"),width_units:this.findBlockInside(this.elem("width"),"select2"),readonly:this.findBlockInside(this.elem("readonly"),"checkbox"),sorting:this.findBlockInside(this.elem("show-sorting"),"checkbox"),numbers:this.findBlockInside(this.elem("show-numbers"),"checkbox")}),this._controls},_getBEMJSON:function(){return[{block:this.__self.getName(),elem:"code",content:{block:"input",mods:{type:"textarea",size:"s",theme:this.getMod("theme")},content:{elem:"control",attrs:{readonly:"readonly",rows:5}}}},{block:this.__self.getName(),elem:"width",content:{block:"b-grid-table-width-controll",mods:{theme:this.getMod("theme")},width:this.params.data.width,width_units:this.params.data.width_units,label:BEM.I18N("b-grid-table-code-form","width"),size:"m"}},{block:this.__self.getName(),elem:"readonly",content:{block:"checkbox",mods:{size:"m",checked:!!this.params.data.read_only&&"yes",theme:this.getMod("theme")},text:BEM.I18N("b-grid-table-code-form","read_only")}},{block:this.__self.getName(),elem:"show-numbers",content:{block:"checkbox",mods:{size:"m",checked:!!this.params.data.show_numbers&&"yes",theme:this.getMod("theme")},text:BEM.I18N("b-grid-table-code-form","show_line_nums")}},{block:this.__self.getName(),elem:"show-sorting",content:{block:"checkbox",mods:{size:"m",checked:!!this.params.data.show_sorting&&"yes",theme:this.getMod("theme")},text:BEM.I18N("b-grid-table-code-form","can_sort")}}]}}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this._val=this.elem("control").val()}},disabled:{"*":function(t,e){this.elem("control").prop("disabled",e)},yes:function(){this.delMod("focused")}},focused:function(t,e){if(this.hasMod("disabled"))return!1;e?this._focused||this._focus():this._focused&&this._blur(),this.afterCurrentEvent(function(){this.domElem&&this.trigger(e?"focus":"blur")})}},isDisabled:function(){return this.hasMod("disabled")},val:function(t,e){var i=void 0!==t,n=this.elem("control");return t=i?null===t?"":t.toString():n.val(),this._val!==t&&(this._val=t,n.val()!==t&&n.val(t),this.trigger("change",e)),i?this:t},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},getSelectionEnd:function(){var t=this.elem("control")[0],e=0;if("number"==typeof t.selectionEnd)e=t.selectionEnd;else{var i=document.selection.createRange();if(i&&i.parentElement()===t){var n=t.value.length,s=t.createTextRange();s.moveToBookmark(i.getBookmark());var o=t.createTextRange();o.collapse(!1),e=s.compareEndPoints("EndToEnd",o)>-1?n:-s.moveEnd("character",-n)}}return e},_onFocus:function(){if(parseInt(BEM.blocks["i-ua"].ios,10)>=8&&!this.hasMod("type","textarea")){var t=this.elem("control")[0];t.selectionStart===t.value.length&&(t.scrollLeft=t.scrollWidth)}return this._focused=!0,this.setMod("focused","yes")},_onBlur:function(){return this._returnFocus?(this.afterCurrentEvent(function(){this.domElem&&this._focus()}),this):this.hasMod(this.elem("clear"),"pressed")?this:(this._focused=!1,this.delMod("focused"))},_focus:function(){if(this.hasMod("disabled","yes"))return!1;this.elem("control").focus()},_blur:function(){this._returnFocus=!1,this.elem("control").blur()},_updateVal:function(){this.val(this.elem("control").val())},destruct:function(){this._blur(),this.__base.apply(this,arguments)}},{live:function(){this.liveBindTo("control","focusin focusout",function(t){this["focusin"===t.type?"_onFocus":"_onBlur"](t)}),this.liveBindTo("control","input",function(){this._updateVal()})}}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);var t=this.elem("control"),e=$.dom.getActiveElement(),i=this.params.autoFocus&&!e.is("input, textarea");(e[0]===t[0]||i)&&(this.setMod("focused","yes")._focused=!0),this.params.shortcut&&this.bindToDoc("keydown",function(t){t.ctrlKey&&t.which===BEM.blocks.keycodes.UP&&!$(t.target).is("input, textarea")&&this.setMod("focused","yes")})}}},_focus:function(){if(!1===this.__base())return!1;var t=this.elem("control")[0];if(t.createTextRange&&!t.selectionStart){var e=t.createTextRange();e.move("character",t.value.length),e.select()}},destruct:function(){this.params.shortcut&&this.unbindFromDoc("keydown"),this.__base.apply(this,arguments)},_onPointerenter:function(t){this.setMod("hovered","yes")},_onPointerleave:function(t){this.delMod("hovered")}},{live:function(){return this.liveBindTo("box","pointerover pointerout",function(t){this.hasMod("disabled")||this.elem("box")[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}),this.liveBindTo("control","dragenter"),this.__base()}}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.on("change",this._updateClear)._updateClear()}}},_onClearClick:function(){return this.trigger("clear"),this.removeInsets&&this.removeInsets(),this.clearInput({source:"clear"})._focus()},clearInput:function(t){return this.val("",t),this},_updateClear:function(){return this.toggleMod(this.elem("clear"),"visibility","visible",Boolean(this._val))}},{live:function(){return this.liveBindTo("clear","pointerpress",function(t){this.setMod(this.elem("clear"),"pressed","yes")}).liveBindTo("clear","pointerover",function(t){this.setMod(this.elem("clear"),"hovered","yes")}).liveBindTo("clear","pointerout",function(t){this.delMod(this.elem("clear"),"hovered")}).liveBindTo("clear","pointerclick",function(){this.delMod(this.elem("clear"),"pressed"),this._onClearClick()}).liveBindTo("control","paste",function(){this.setMod(this.elem("clear"),"visibility","visible")}),this.__base()}}),BEM.DOM.decl("b-grid-table-settings",{onSetMod:{js:function(){this.bPage=BEM.blocks["i-global"].getbPage(),this._table=this.bPage.findBlockInside("b-grid-table"),this._title=this.findBlockInside(this.elem("grid-title"),"input"),this._sorting=this.findBlockInside("b-grid-table-sorting-controll"),this._saveButton=this.findBlockInside(this.elem("submit"),"button2"),this._saveButton.on("click",this._onSave,this),this._buildSettings()}},_buildSettings:function(){return BEM.create("wi-api-request",{apiPath:".grid",path:"/"+BEM.WISTORE.get("page").get("superTag"),urlParams:["format=json"]}).run().then(this._onGotData.bind(this),BEM.blocks["wi-notification"].errorHandler()).always(function(){this.trigger("ready")}.bind(this))},_onGotData:function(t){var e=t.data.structure;this._title.val(e.title),this._sorting.sortings=e.sorting,this._sorting.fields=e.fields,this._sorting._buildBlock()},_onSave:function(){this._table._saveTitle(this._title.val()),this._sorting.changed&&(this._table._saveSorting(this._sorting.getSortingValue()),this._sorting.changed=!1)}}),BEM.DOM.decl("b-grid-table-sorting-controll",{onSetMod:{js:function(){this._addSortingLink=this.findBlockInside(this.elem("add-sorting"),"link"),this._addSortingLink.on("click",this._onAddSortingClick,this),this.sortings=[],this.fields=[],this.changed=!1,this.bindTo("click",this._onClick.bind(this))}},_onRemoveSorting:function(t){var e=this.findBlockInside(t.data.domElem.closest(this.elem("sorting")),"select2").params.defaultValue;this.sortings=this.getCurrentSortings(),this.sortings=this.sortings.filter(function(t){return t.name!==e}),this._buildBlock(),this.elem("sortings")[0].className=this.elem("sortings")[0].className},_onAddSortingClick:function(){var t=!1;this.sortings=this.getCurrentSortings();for(var e=0;e<this.fields.length;e++){for(var i=0;i<this.sortings.length;i++){if(this.fields[e].name===this.sortings[i].name){t=!0;break}t=!1}if(!t){this.sortings.push({type:"asc",name:this.fields[e].name});break}}this._buildBlock()},_buildBlock:function(){BEM.DOM.update(this.elem("sortings"),BEMHTML.apply(this._getBEMJSON())),this.dropElemCache(),this.bindTo(this.elem("delete"),"click",this._onRemoveSorting),this.sortings&&this.sortings.length===this.fields.length?this._addSortingLink.setMod("disabled","yes"):this._addSortingLink.delMod("disabled")},_getBEMJSON:function(){var t=this;return this.sortings&&this.sortings.map(function(e,i){return{block:t.__self.getName(),elem:"sorting",content:[{elem:"title",content:[{elem:"title-text",tag:"span",content:0===i?BEM.I18N("b-grid-table-sorting-controll","sort"):BEM.I18N("b-grid-table-sorting-controll","then")},{elem:"delete",tag:"span",content:[{block:"awesome-icon",attrs:{title:BEM.I18N("b-grid-table-sorting-controll","remove_sort")},mods:{icon:"remove"}}]}]},{block:t.__self.getName(),elem:"sorting-field",content:{block:"b-grid-table-fields-list",mods:{theme:t.getMod("theme")},fields:t.fields,selected:e.name}},{block:t.__self.getName(),elem:"sorting-type",content:{block:"b-grid-table-sorting-list",mods:{theme:t.getMod("theme")},selected:e.type}}]}})},_onClick:function(){this.changed=!0},getSortingValue:function(){var t=this,e=[];return this.findElem("sorting").each(function(){var i=t.findBlockInside($(this),"select2").getVal(),n=t.findBlockInside($(this),"radio-button").val(),s={};s[i]=n,e.push(s)}),e},getCurrentSortings:function(){var t=this;return this.findElem("sorting").map(function(){return{name:t.findBlockInside($(this),"select2").getVal(),type:t.findBlockInside($(this),"radio-button").val()}}).toArray()}}),BEM.DOM.decl("radiobox",{onSetMod:{js:{inited:function(){this._val=this.findElem(this.elem("radio","checked","yes"),"control").val(),this.elem("control").each(function(t,e){var i=$(e),n=this.__self._getRadioByElem(i);i.isFocused()&&this.setMod(n,"focused","yes"),i.prop("checked")&&this.setMod(n,"checked","yes")}.bind(this))}},disabled:{yes:function(){this.setMod(this.elem("radio"),"disabled","yes")},"":function(){this.delMod(this.elem("radio"),"disabled")}}},onElemSetMod:{radio:{focused:{yes:function(t){this.delMod(this.elem("radio","focused","yes"),"focused");var e=this.findElem(t,"control");e.isFocused()||e.focus(),this.afterCurrentEvent(function(){this.domElem&&this.trigger("focus",{current:t})})},"":function(t){this.afterCurrentEvent(function(){this.domElem&&this.trigger("blur",{prev:t})})}},checked:{yes:function(t){var e=this.elem("radio","checked","yes"),i=this.findElem(t,"control"),n=this._val;this._willSwitch=!0,this.delMod(e,"checked"),this._willSwitch=!1,i.prop("checked",!0),this._val=i.val(),this.trigger("change",{current:t,currentVal:this._val,prev:e,prevVal:n})},"":function(t){var e=this.findElem(t,"control"),i=this._val;e.prop("checked",!1),this._val=void 0,this._willSwitch||this.trigger("change",{current:$(),currentVal:void 0,prev:t,prevVal:i})}},hovered:function(t){return!this.isDisabled(t)},pressed:function(t){return!this.isDisabled(t)},disabled:function(t,e,i){t.find(this.buildSelector("control")).prop("disabled",i),i&&this.delMod(t,"hovered").delMod(t,"pressed")}}},isDisabled:function(t){return this.hasMod(t,"disabled","yes")},val:function(t){if(void 0===t)return this._val;var e=this;return this.elem("control").each(function(i,n){if(n.value===t)return e.setMod(e.__self._getRadioByElem($(n)),"checked","yes"),!1}),e},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},getCurrent:function(){return this.findElem("radio","checked","yes")},uncheckAll:function(){return this.delMod(this.elem("radio","checked","yes"),"checked"),this},_onRadioEnter:function(t){this.setMod(t.data.domElem,"hovered","yes")},_onRadioLeave:function(t){this.delMod(t.data.domElem,"hovered")},_onRadioClick:function(t,e){this.isDisabled(t)||this.setMod(t,"focused","yes")},_onChange:function(t){this.setMod(this.__self._getRadioByElem(t.data.domElem),"checked","yes")},_onPointerpress:function(t){var e=t.data.domElem;this.setMod(e,"pressed","yes").bindToDoc("pointerrelease",function(){this.delMod(e,"pressed").unbindFromDoc("pointerrelease")})}},{live:function(){this.liveBindTo("radio","pointerclick",function(t){this._onRadioClick(t.data.domElem,t)}).liveBindTo("control","change",function(t){this._onChange(t)}).liveBindTo("radio","pointerover pointerout",function(t){t.data.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onRadioEnter(t):this._onRadioLeave(t))}).liveBindTo("control","focusin focusout",function(t){var e=this.__self._getRadioByElem(t.data.domElem);this.setMod(e,"focused","focusin"===t.type?"yes":""),parseInt(BEM.blocks["i-ua"].ios,10)>=8&&t.preventDefault()}).liveBindTo("radio","pointerpress",function(t){this.hasMod(t.data.domElem,"disabled")||this._onPointerpress(t)})},_getRadioByElem:function(t){return t.closest(this.buildSelector("radio"))}}),BEM.DOM.decl("wi-files-dropper",{onSetMod:{js:function(){BEM.WISTORE.get("page").get("redirect")||this._events()},drag:function(t,e){if(e){var i=this._getDropZone();BEM.DOM.append(this.domElem,i)}else BEM.DOM.destruct(this.findElem("drop-zone"))}},_events:function(){this.bindTo("dragover",function(t){var e=t.originalEvent;-1!==e.dataTransfer.types.indexOf("Files")&&(t.preventDefault(),t.stopPropagation(),e.dataTransfer.dropEffect="copy",this.setMod("drag","over"))}),this.bindTo("dragleave",function(t){t.preventDefault(),t.stopPropagation(),this.delMod("drag")}),this.bindTo("drop",function(t){var e=t.originalEvent.dataTransfer;t.preventDefault(),t.stopPropagation(),this.delMod("drag"),this.trigger("drop",e.files)})},_getDropZone:function(){return this.__self._dropZone||(this.__self._dropZone=BEMHTML.apply({block:"wi-files-dropper",elem:"drop-zone"})),this.__self._dropZone}},{}),BEM.decl("i-routes",{},{getRoute:function(t){var e,i,n=BEM.blocks["wi-history"].getRoute(),s=!!n&&this.actions[n.route];if(s){i=s.page?s.page[t]:s;var o=function(){BEM.channel("common").trigger(i.block+"."+i.event,_.extend({},{route:n.route,params:n.params},i.data,{initial:!0}))};if(!(e=i&&BEM.DOM.blocks[i.block]))return;i.triggerBeforeInit?o():e.on("init",function(t){i.modName&&!t.block.hasMod(i.modName,i.modVal)||(o(),e.un("init"))})}},actions:{".log":{block:"sidebar",event:"diff"},".settings":{block:"w-action",modName:"type",modVal:"settings",event:"create-settings"},".delete":{page:{article:{block:"w-action",modName:"type",modVal:"delete",event:"delete"},grid:{block:"w-action",modName:"type",modVal:"delete",event:"delete"}}},".tree":{page:{article:{block:"w-action",modName:"type",modVal:"tree",event:"create-tree"},grid:{block:"w-action",modName:"type",modVal:"tree",event:"create-tree"}}},".files":{page:{article:{block:"w-action",modName:"type",modVal:"files",event:"open-sidebar-files"},grid:{block:"w-action",modName:"type",modVal:"files",event:"open-sidebar-files"}}},".import":{page:{grid:{block:"w-action",modName:"type",modVal:"import",event:"create-import"}}},".move":{page:{article:{block:"w-action",modName:"type",modVal:"move",event:"create-move"},grid:{block:"w-action",modName:"type",modVal:"move",event:"create-move"}}},".copy":{page:{grid:{block:"w-action",modName:"type",modVal:"copy",event:"create-copy"}}},".authors":{block:"w-action",modName:"type",modVal:"settings",event:"create-settings",data:{tab:"authors"}},".subpages-change-author":{page:{article:{block:"w-action",modName:"type",modVal:"subpages-change-author",event:"create-subpages-change-author"},grid:{block:"w-action",modName:"type",modVal:"subpages-change-author",event:"create-subpages-change-author"}}},".request_page_author":{page:{article:{block:"w-action",modName:"type",modVal:"request-page-author",event:"create-request-page-author"},grid:{block:"w-action",modName:"type",modVal:"request-page-author",event:"create-request-page-author"}}},".requestauthorship":{page:{article:{block:"w-action",modName:"type",modVal:"authorship",event:"create-request-authorship"},grid:{block:"w-action",modName:"type",modVal:"authorship",event:"create-request-authorship"}}},".unwatch":{page:{article:{block:"w-action",modName:"type",modVal:"unsubscribe",event:"create-unsubscribe"},grid:{block:"w-action",modName:"type",modVal:"unsubscribe",event:"create-unsubscribe"}}},".subscribe":{page:{article:{block:"w-action",modName:"type",modVal:"subscribe",event:"create-subscribe"},grid:{block:"w-action",modName:"type",modVal:"subscribe",event:"create-subscribe"}}},".referrers":{page:{article:{block:"w-action",modName:"type",modVal:"referrers",event:"create-referrers"},grid:{block:"w-action",modName:"type",modVal:"referrers",event:"create-referrers"}}},".links":{page:{article:{block:"w-action",modName:"type",modVal:"referrers",event:"create-referrers"},grid:{block:"w-action",modName:"type",modVal:"referrers",event:"create-referrers"}}},".watchers":{page:{article:{block:"w-action",modName:"type",modVal:"subscribe",event:"create-subscribe",data:{subscribersTab:!0}},grid:{block:"w-action",modName:"type",modVal:"subscribe",event:"create-subscribe",data:{subscribersTab:!0}}}},".obsolete":{page:{article:{block:"w-action",modName:"type",modVal:"old-page",event:"create-old-page"},grid:{block:"w-action",modName:"type",modVal:"old-page",event:"create-old-page"}}},".create":{block:"b-head",event:"newPageCreate"},".access":{block:"w-action",modName:"type",modVal:"access",event:"create-access"},".edit":{block:"w-action",modName:"type",modVal:"edit",event:"open-editor"},".requestaccess":{block:"b-page",event:"accessRequest"},".ru-en":{block:"w-translate-content",event:"translate",triggerBeforeInit:!0},".en-ru":{block:"w-translate-content",event:"translate",triggerBeforeInit:!0},".ru-tr":{block:"w-translate-content",event:"translate",triggerBeforeInit:!0},".tr-ru":{block:"w-translate-content",event:"translate",triggerBeforeInit:!0}}}),BEM.decl("i-routes",{},{getRoute:function(t){var e,i,n=BEM.blocks["wi-history"].getRoute(),s=!!n&&this.actions[n.route];s&&(i=s.page?s.page[t]:s,(e=i&&BEM.DOM.blocks[i.block])&&e.on("init",function(t){i.modName&&!t.block.hasMod(i.modName,i.modVal)||(BEM.channel("common").trigger(i.block+"."+i.event,_.extend({},{route:n.route,params:n.params},i.data,{initial:!0})),e.un("init"))}))},actions:{".log":{block:"sidebar",event:"diff"},".settings":{block:"w-action",modName:"type",modVal:"settings",event:"create-settings"},".delete":{page:{article:{block:"w-action",modName:"type",modVal:"delete",event:"delete"},grid:{block:"w-action",modName:"type",modVal:"delete",event:"delete"}}},".tree":{page:{article:{block:"w-action",modName:"type",modVal:"tree",event:"create-tree"},grid:{block:"w-action",modName:"type",modVal:"tree",event:"create-tree"}}},".request_page_author":{page:{article:{block:"w-action",modName:"type",modVal:"request-page-author",event:"create-request-page-author"},grid:{block:"w-action",modName:"type",modVal:"request-page-author",event:"create-request-page-author"}}},".subpages-change-author":{page:{article:{block:"w-action",modName:"type",modVal:"subpages-change-author",event:"create-subpages-change-author"},grid:{block:"w-action",modName:"type",modVal:"subpages-change-author",event:"create-subpages-change-author"}}},".files":{page:{article:{block:"w-action",modName:"type",modVal:"files",event:"open-sidebar-files"},grid:{block:"w-action",modName:"type",modVal:"files",event:"open-sidebar-files"}}},".import":{page:{grid:{block:"w-action",modName:"type",modVal:"import",event:"create-import"}}},".move":{page:{article:{block:"w-action",modName:"type",modVal:"move",event:"create-move"},grid:{block:"w-action",modName:"type",modVal:"move",event:"create-move"}}},".copy":{page:{grid:{block:"w-action",modName:"type",modVal:"copy",event:"create-copy"}}},".authors":{block:"w-action",modName:"type",modVal:"settings",event:"create-settings",data:{tab:"authors"}},".requestauthorship":{page:{article:{block:"w-action",modName:"type",modVal:"authorship",event:"create-request-authorship"},grid:{block:"w-action",modName:"type",modVal:"authorship",event:"create-request-authorship"}}},".unwatch":{page:{article:{block:"w-action",modName:"type",modVal:"unsubscribe",event:"create-unsubscribe"},grid:{block:"w-action",modName:"type",modVal:"unsubscribe",event:"create-unsubscribe"}}},".subscribe":{page:{article:{block:"w-action",modName:"type",modVal:"subscribe",event:"create-subscribe"},grid:{block:"w-action",modName:"type",modVal:"subscribe",event:"create-subscribe"}}},".referrers":{page:{article:{block:"w-action",modName:"type",modVal:"referrers",event:"create-referrers"},grid:{block:"w-action",modName:"type",modVal:"referrers",event:"create-referrers"}}},".links":{page:{article:{block:"w-action",modName:"type",modVal:"referrers",event:"create-referrers"},grid:{block:"w-action",modName:"type",modVal:"referrers",event:"create-referrers"}}},".watchers":{page:{article:{block:"w-action",modName:"type",modVal:"subscribe",event:"create-subscribe",data:{subscribersTab:!0}},grid:{block:"w-action",modName:"type",modVal:"subscribe",event:"create-subscribe",data:{subscribersTab:!0}}}},".obsolete":{page:{article:{block:"w-action",modName:"type",modVal:"old-page",event:"create-old-page"},grid:{block:"w-action",modName:"type",modVal:"old-page",event:"create-old-page"}}},".create":{block:"b-head",event:"newPageCreate"},".access":{block:"w-action",modName:"type",modVal:"access",event:"create-access"},".edit":{block:"w-action",modName:"type",modVal:"edit",event:"open-editor"},".requestaccess":{block:"b-page",event:"accessRequest"},".ru-en":{block:"w-translate-content",event:"translate"},".en-ru":{block:"w-translate-content",event:"translate"},".ru-tr":{block:"w-translate-content",event:"translate"},".tr-ru":{block:"w-translate-content",event:"translate"}}}),BEM.DOM.decl("page-layout",{onSetMod:{js:function(){this._sidebar=this.findBlockOn("sidebar","sidebar"),this._sidebar&&this._sidebar.on("toggle",this._setSidebarState.bind(this,!1)),this._sidebar&&this._sidebar.on("shown hide",this._setSidebarState.bind(this,!0)),this._sidebar&&this._setSidebarState()}},_setSidebarState:function(t){this.setMod("sidebar",this._sidebar.getMod("state")),t&&BEM.channel("layout").trigger("change")}},{}),BEM.DOM.decl("b-action-widget",{onSetMod:{js:function(){BEM.create("wi-api-request",{apiPath:".actions/"+this.params.action,urlParams:[this.params.actionParams],path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onGotData.bind(this),BEM.blocks["wi-notification"].errorHandler()).always(function(){this.setMod("loading","no")}.bind(this))}},_onGotData:function(t){var e=t;this.setMod("loading","no"),"string"==typeof e?BEM.DOM.update(this.domElem,t):(e=BEMHTML.apply(e.data),BEM.DOM.update(this.domElem,e))}}),BEM.DOM.decl("w-translate-content",{onSetMod:{js:{inited:function(){this._bPage=this.findBlockOutside("b-page")}},progress:function(t,e){this._popup&&(this._popupSpinner.setMod("progress",e),this.setMod(this.findElem(this._popup.domElem,"paranja"),"visibility","yes"===e?"visible":""))}},_translateFromAction:function(t,e){var i=/\.(\w\w)-(\w\w)/.exec(e.route),n=i[1],s=i[2];this._initPopup(),this._translateItems.forEach(function(t){t.params.from===n&&t.params.to===s&&this._translate(t,!0)},this)},_onMouseOver:function(){this._initPopup(),this._popup.setMod("visible","yes"),this._closePopupTimeout&&(clearTimeout(this._closePopupTimeout),this._closePopupTimeout=null)},_initPopup:function(){this._popup||(this._popup=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply(this.__self._getPopupBEMJSON())).bem("popup2").setAnchor(this.domElem).bindTo("mouseover",this._onPopupMouseOver.bind(this)).bindTo("mouseout",this._onPopupMouseOut.bind(this)),this._popupSpinner=this._popup.findBlockInside("spin2"),this._translateItems=this._popup.findBlocksInside("w-translate-item"),BEM.blocks["w-translate-item"].on(this._popup.domElem,"click",this._onTranslateClick,this))},_onMouseOut:function(){this._closePopupTimeout&&clearTimeout(this._closePopupTimeout),this._closePopupTimeout=setTimeout(this._hidePopup.bind(this),700)},_onPopupMouseOver:function(){this._closePopupTimeout&&(clearTimeout(this._closePopupTimeout),this._closePopupTimeout=null)},_onPopupMouseOut:function(){this._closePopupTimeout&&clearTimeout(this._closePopupTimeout),this._closePopupTimeout=setTimeout(this._hidePopup.bind(this),700)},_hidePopup:function(){this._popup&&this._popup.delMod("visible")},_onTranslateClick:function(t){this._translate(t.block)},_translate:function(t,e){var i=t.params.from+"-"+t.params.to;t.hasMod("selected")||(this.setMod("progress","yes"),this._request(i).then(this._onSuccessGetData.bind(this,t,Boolean(e)),this._onErrorGetData.bind(this)).always(function(){this.delMod("progress")}.bind(this)))},_selectItem:function(t){this._unselectItems(),t.setMod("selected","yes")},_processContentResult:function(t){var e=Object.assign({},t),i=$(e[0].text[0]);return i.attr("data-wf",this._wfAttr),e[0].text[0]=i[0].outerHTML,e},_onSuccessGetData:function(t,e,i,n){var s=this._processContentResult(i);this._selectItem(t),this._updateContent(s,n),this.setMod("lang-selected","yes"),e||BEM.blocks["wi-history"].pushState("."+t.params.from+"-"+t.params.to),BEM.WISTORE.get("page").set("translation",{from:t.params.from,to:t.params.to})},_onErrorGetData:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.blocks["wi-notification"].createErrorMessage(t)))},_onSuccessSkipTranslate:function(t,e){this._unselectItems(),this.delMod("lang-selected"),this.channel("content").trigger("update",e),t&&BEM.blocks["wi-history"].removeState(),BEM.WISTORE.get("page").set("translation",null)},_onErrorSkipTranslate:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.blocks["wi-notification"].createErrorMessage(t)))},_unselectItems:function(){this._translateItems&&this._translateItems.forEach(function(t){t.delMod("selected")},this)},_onActionReplaced:function(t,e){/\.\w\w-\w\w/.exec(e.from)&&this._resetTranslate(!1)}},{live:function(){this.liveBindTo("click",function(){this._resetTranslate(!0)}),this.liveBindTo("mouseover",function(){this._onMouseOver()}),this.liveBindTo("mouseout",function(){this._onMouseOut()}),this.liveInitOnChannelEvent("wiki-states","replace-state",function(){this._onActionReplaced.apply(this,arguments)}),this.liveInitOnChannelEvent("common","w-translate-content.translate",function(){this._translateFromAction.apply(this,arguments)})},_getPopupBEMJSON:function(){return{block:"popup2",mix:{block:"w-translate-content",elem:"items"},mods:{target:"anchor",theme:"normal",autoclosable:"yes"},directions:["right-center"],content:[{block:"w-translate-item",from:"ru",to:"us"},{block:"w-translate-item",from:"us",to:"ru"},{block:"w-translate-item",from:"ru",to:"tr"},{block:"w-translate-item",from:"tr",to:"ru"},{block:"w-translate-content",elem:"paranja"},{block:"spin2",mods:{size:"xs"}}]}}}),BEM.DOM.decl("w-translate-item",{onSetMod:{js:function(){this.bindTo("click",function(){this.trigger("click")}.bind(this))}}}),BEM.DOM.decl("w-comments",{onSetMod:{js:function(){this._commentsCount=this.params.commentsCount,this._commentsCount||(this._commentsLoaded=!0),this._loadedCount=0,this._initBlocks(),this.__self._domElem=this.domElem,this.__self.initWithNewWf=BEM.WISTORE.get("page").get("withNewWf")},"loading-comments":function(t,e){this._switchVisionButton.setMod("disabled",e),this._loadCommentsListSpinner.setMod("progress",e),this._showMoreSpinner.setMod("progress",e)},"add-comment":function(t,e){this._addCommentCancelButton.setMod("disabled",e),this._addCommentSubmitButton.setMod("disabled",e),this._addCommentSpinner.setMod("progress",e)},commenting:function(t,e){var i=this._getAddCommentEditor();"yes"===e&&(i.val(""),this.afterCurrentEvent(function(){i.findBlockInside("textarea").elem("control").focus(),BEM.DOM.win.scrollTop(BEM.DOM.doc.height())}),this._addCommentSubmitButton.setMod("disabled","yes"))},short:function(t,e){this._switchVisionButton.elem("text").text(BEM.I18N("w-comments","yes"===e?"expand":"turn"))}},_initBlocks:function(){this.findBlockInside({block:"button2",modName:"role",modVal:"add-comment"}).on("click",this._onAddCommentButtonClick,this),this.findBlockInside({block:"button2",modName:"role",modVal:"add-comment-header"}).on("click",this._onAddCommentButtonClick,this),this._loadCommentsListSpinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"load-comments"}),this._addCommentCancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel-new-comment"}).on("click",this._onAddCommentCancelButtonClick,this),this._addCommentSubmitButton=this.findBlockInside({block:"button2",modName:"role",modVal:"submit-new-comment"}).on("click",this._onAddCommentSubmitButtonClick,this),this._addCommentSpinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"add-comment"}),this._switchVisionButton=this.findBlockInside({block:"button2",modName:"role",modVal:"short-switch"}),this._showMoreButton=this.findBlockInside({block:"button2",modName:"role",modVal:"show-more"}).on("click",this._getComments,this),this._showMoreSpinner=this.findBlockInside({block:"spin2",modName:"role",modVal:"show-more"}),BEM.blocks["w-comment"].on(this.domElem,"reply",this._onCommentReplyed,this),BEM.blocks["w-comment"].on(this.domElem,"active",this._onCommentActive,this),BEM.blocks["w-comment"].on(this.domElem,"remove",this._onCommentRemoved,this),BEM.blocks["w-comment"].on(this.domElem,"edit",this._onCommentEdited,this)},_switchVisionMode:function(){this.hasMod("loading-comments")||(this._commentsLoaded?this.toggleMod("short","yes","").delMod("commenting"):this._getComments())},_getComments:function(){this.setMod("loading-comments","yes"),BEM.create("wi-api-request",{apiPath:".comments",method:"GET",urlParams:["limit=100","start="+this._loadedCount],path:"/"+this.params.supertag}).run().then(this._onSuccessGetComments.bind(this),this._onErrorGetComments.bind(this)).always(function(){this.delMod("loading-comments")}.bind(this))},_onSuccessGetComments:function(t){this._commentsLoaded=!0,BEM.DOM.append(this.elem("comments-list"),BEMHTML.apply(this.__self._formComments(t.data).map(function(t){return this.__self._getCommentBEMJSON(t,this.params.supertag,this.params.user.login)},this))),this.setMod("more",t.data.length>99?"yes":""),this._loadedCount+=t.data.length,this.delMod("short"),this.channel("comments").trigger("updated")},_onErrorGetComments:function(){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("w-comments","get_comments_list_error")))},_onAddCommentCancelButtonClick:function(){this.delMod("commenting")},_onAddCommentSubmitButtonClick:function(){var t=this._getAddCommentEditor().val();this.setMod("add-comment","yes"),BEM.create("wi-api-request",{apiPath:".comments",method:"POST",data:{body:t},urlParams:!1,path:"/"+this.params.supertag}).run().then(this._onSuccessAddComment.bind(this),this._onErrorAddComment.bind(this)).always(function(){this.delMod("add-comment")}.bind(this))},_onSuccessAddComment:function(t){this.delMod("commenting").delMod("no-comments").delMod("short")._changeCommentsCount(!0),t.data.level=1,BEM.DOM.append(this.elem("comments-list"),BEMHTML.apply(this.__self._getCommentBEMJSON(t.data,this.params.supertag,this.params.user.login))),this.channel("comments").trigger("updated")},_onErrorAddComment:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this._addCommentSubmitButton.domElem,BEM.blocks["wi-notification"].createErrorMessage(t)))},_getAddCommentEditor:function(){return this._addCommentEditor||(BEM.DOM.update(this.elem("add-comment-editor"),BEMHTML.apply(this.__self._getEditorBEMJSON())).bem("m-editor"),this._addCommentEditor=this.findBlockInside(this.elem("add-comment-form"),"m-editor"),this._addCommentEditor.init(this.findBlockInside(this.elem("add-comment-form"),"m-editor-buttons")),this._addCommentEditor.findBlockInside("textarea").on("change",this._onAddCommentEditorChange,this)),this._addCommentEditor},_onAddCommentEditorChange:function(t){this._addCommentSubmitButton.setMod("disabled",t.block.val()?"":"yes")},_onAddCommentButtonClick:function(){this.setMod("commenting","yes")},_onCommentEdited:function(){this.channel("comments").trigger("updated")},_onCommentRemoved:function(){this._changeCommentsCount(!1),this._commentsCount||(this.setMod("no-comments","yes").setMod("short","yes"),BEM.DOM.update(this.elem("comments-list"),""))},_onCommentReplyed:function(t,e){this._changeCommentsCount(!0),e.level=t.block.params.data.level+1,BEM.DOM.append(this.findElem("childrens","id",String(t.block.params.data.id)),BEMHTML.apply(this.__self._getCommentBEMJSON(e,this.params.supertag,this.params.user.login))),this.channel("comments").trigger("updated")},_onCommentActive:function(t){this.findBlocksInside("w-comment").forEach(function(e){t.block!==e&&e.delMod("editing").delMod("replying")},this)},_changeCommentsCount:function(t){this._commentsCount+=t?1:-1,BEM.DOM.replace(this.findElem("caption"),BEMHTML.apply({block:"w-comments",elem:"caption",count:this._commentsCount}))}},{live:function(){this.liveBindTo("show-comments","click",function(){this._switchVisionMode()}),this.liveBindTo("add-comment","click",function(){this._onAddCommentButtonClick()})},_MAX_LEVELS:6,_formComments:function(t){var e=[];return t.forEach(function(t){t.parent||(t.level=1)}),t.forEach(function(i){i.parent?t.forEach(function(t){t.id===i.parent&&(t.childrens||(t.childrens=[]),t.childrens.push(i),i.level=t.level+1)},this):e.push(i)},this),e},_getEditorBEMJSON:function(){var t=BEM.blocks["wi-history"].getCorrectPath(),e=BEM.blocks["i-global"].param("hosts").wikiApi.v1+"/pages"+t+".files?format=json";return[{block:"m-editor-buttons",mix:[{block:"m-editor",js:{id:"add-comment-editor"}}]},{block:"m-editor",mix:{block:"w-editor-suggest",js:{url:BEM.blocks["i-global"].param("hosts").suggest.url,layers:{people:{itemType:"staff",keywords:["@","staff:","кто:","укого:","ского:","кому:","кого:","кем:","ком:","оком:"],valueField:"login"}}}},mods:{type:"add-comment"},js:{id:"add-comment-editor",uploadParams:{reqParams:{type:"PUT",url:e,xhrFields:{withCredentials:!0}},URLPath:"data.data.url"},buttons:[["bold","italic","underline","strikethrough"],["ul","ol"],["indent","outdent"],["quote","link","picture","code","table","readmore","help"]]}}]},_getCommentContentBEMJSON:function(t){return this.formatter||(this.formatter=new Ya.FormatterViewPort({domElem:this._domElem[0],settings:{extensions:{"wiki-doc":null,"wiki-head":null},remark:{woofmd:{actions:!1}}}})),this.initWithNewWf?{html:this.formatter.getHTMLFromText(t.body)}:t.bemjson},_getCommentBEMJSON:function(t,e,i){return[{block:"w-comment",js:{data:t,supertag:e},mods:{editable:i===t.user.login?"yes":"","max-level":t.level>this._MAX_LEVELS?"yes":"",removed:t.is_deleted?"yes":""},data:t,bemjson:this._getCommentContentBEMJSON(t)},{block:"w-comments",elem:"childrens",elemMods:{id:t.id},content:t.childrens&&t.childrens.map(function(t){return this._getCommentBEMJSON(t,e,i)},this)}]}}),BEM.DOM.decl("w-comments",{},{_getEditorBEMJSON:function(){var t=BEM.blocks["wi-history"].getCorrectPath(),e=BEM.blocks["i-global"].param("hosts").wikiApi.v1+"/pages"+t+".files?format=json";return[{block:"m-editor-buttons",mix:[{block:"m-editor",js:{id:"add-comment-editor"}}]},{block:"m-editor",mix:{block:"w-editor-suggest",js:{url:BEM.blocks["i-global"].param("hosts").suggest.url,layers:{people:{itemType:"b2b-people",keywords:["@","staff:","кто:","укого:","ского:","кому:","кого:","кем:","ком:","оком:"],valueField:"login"}}}},mods:{type:"add-comment"},js:{id:"add-comment-editor",uploadParams:{reqParams:{type:"PUT",url:e,xhrFields:{withCredentials:!0}},URLPath:"data.data.url"},buttons:[["bold","italic","underline","strikethrough"],["ul","ol"],["indent","outdent"],["quote","link","code","table","readmore"]]}}]}}),BEM.DOM.decl("w-comment",{onSetMod:{js:function(){this._body=this.params.data.body,this._initBlocks(),BEM.blocks["w-comments"].initWithNewWf&&Ya.FormatterViewPort.BEM.DOM.init(this.domElem)},editing:function(t,e){var i=this._getEditor();"yes"===e?(i.val(this._body),this.afterCurrentEvent(function(){i.findBlockInside("textarea").elem("control").focus()}),this._cancelEditorButton.on("click",this._cancelEditComment,this),this._submitEditorButton.delMod("disabled").on("click",this._saveEditedComment,this).elem("text").text(BEM.I18N("w-comment","save"))):(this._submitEditorButton.un("click"),this._cancelEditorButton.un("click"))},replying:function(t,e){var i=this._getEditor();"yes"===e?(i.val(""),this.afterCurrentEvent(function(){i.findBlockInside("textarea").elem("control").focus()}),this._cancelEditorButton.on("click",this._cancelReplyComment,this),this._submitEditorButton.setMod("disabled","yes").on("click",this._saveReplyToComment,this).elem("text").text(BEM.I18N("w-comment","send"))):(this._submitEditorButton.un("click"),this._cancelEditorButton.un("click"))},"editor-progress":function(t,e){this._cancelEditorButton.setMod("disabled",e),this._submitEditorButton.setMod("disabled",e),this._submitEditorSpinner.setMod("progress",e)},"remove-progress":function(t,e){this._removePopupCancelButton.setMod("disabled",e),this._removePopupSubmitButton.setMod("disabled",e),this._removePopupSpinner.setMod("progress",e)},removed:function(t,e){"yes"===e&&this.elem("content").text(BEM.I18N("w-comment","comment_removed"))}},_initBlocks:function(){this._cancelEditorButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}),this._submitEditorButton=this.findBlockInside({block:"button2",modName:"role",modVal:"submit"}),this._submitEditorSpinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"editor-submit"}),this.bindTo(this.findElem("edit"),"click",this._onEditClick.bind(this)).bindTo(this.findElem("reply"),"click",this._onReplyClick.bind(this)).bindTo(this.findElem("remove"),"click",this._onRemoveClick.bind(this))},_onEditClick:function(){this.trigger("active").setMod("editing","yes")},_onReplyClick:function(){this.trigger("active").setMod("replying","yes")},_onRemoveClick:function(){var t=this._getRemovePopup();this._removePopupCancelButton.on("click",function(){t.delMod("visible")}),this._removePopupSubmitButton.on("click",this._removeComment,this),t.on("afterClose",this._onRemovePopupHide,this),this.trigger("active"),t.setMod("visible","yes")},_removeComment:function(){this.setMod("remove-progress","yes"),BEM.create("wi-api-request",{apiPath:".comments/"+this.params.data.id,method:"DELETE",urlParams:!1,path:"/"+this.params.supertag}).run().then(this._onSuccessRemoveComment.bind(this),this._onErrorRemoveComment.bind(this)).always(function(){this.delMod("remove-progress")}.bind(this))},_onSuccessRemoveComment:function(){this._getRemovePopup().delMod("visible"),this.setMod("removed","yes"),this.trigger("remove")},_onErrorRemoveComment:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.blocks["wi-notification"].createErrorMessage(t)))},_onRemovePopupHide:function(){this._removePopupCancelButton.un("click"),this._removePopupSubmitButton.un("click"),this._getRemovePopup().un("afterClose")},_getRemovePopup:function(){return this.__self._removePopup||(this.__self._removePopup=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply(this.__self._getRemovePopupBEMJSON())).bem("modal")),this._removePopupCancelButton||(this._removePopupCancelButton=this.__self._removePopup.findBlockInside({block:"button2",modName:"role",modVal:"remove-cancel"}),this._removePopupSubmitButton=this.__self._removePopup.findBlockInside({block:"button2",modName:"role",modVal:"remove-submit"}),this._removePopupSpinner=this.__self._removePopup.findBlockInside("spin2")),this.__self._removePopup},_getEditor:function(){return this._editor||(BEM.DOM.update(this.elem("comment-editor"),BEMHTML.apply(this.__self._getEditorBEMJSON(this.params.data.id))).bem("m-editor"),this._editor=this.findBlockInside(this.elem("form"),"m-editor"),this._editor.init(this.findBlockInside(this.elem("form"),"m-editor-buttons")),this._editor.findBlockInside("textarea").on("change",this._onEditorChange,this)),this._editor},_cancelEditComment:function(){this.delMod("editing")},_saveEditedComment:function(){var t=this._getEditor().val();this.setMod("editor-progress","yes"),BEM.create("wi-api-request",{apiPath:".comments/"+this.params.data.id,method:"POST",data:{body:t},urlParams:!1,path:"/"+this.params.supertag}).run().then(this._onSuccessEditComment.bind(this,t),this._onErrorEditComment.bind(this)).always(function(){this.delMod("editor-progress")}.bind(this))},_updateEditCommentContent:function(t){BEM.blocks["w-comments"].initWithNewWf?(BEM.DOM.update(this.elem("content"),BEMHTML.apply({html:BEM.blocks["w-comments"].formatter.getHTMLFromText(t.body)})),Ya.FormatterViewPort.BEM.DOM.init(this.elem("content"))):BEM.DOM.update(this.elem("content"),BEMHTML.apply(t.bemjson))},_onSuccessEditComment:function(t,e){this._updateEditCommentContent(e.data),this.delMod("editing"),this._body=t,this.trigger("edit")},_onErrorEditComment:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this._submitEditorButton.domElem,BEM.blocks["wi-notification"].createErrorMessage(t)))},_cancelReplyComment:function(){this.delMod("replying")},_saveReplyToComment:function(){this.setMod("editor-progress","yes"),BEM.create("wi-api-request",{apiPath:".comments",method:"POST",data:{body:this._getEditor().val(),parent:this.params.data.id},urlParams:!1,path:"/"+this.params.supertag}).run().then(this._onSuccessReplyToComment.bind(this),this._onErrorReplyToComment.bind(this)).always(function(){this.delMod("editor-progress")}.bind(this))},_onSuccessReplyToComment:function(t){this.trigger("reply",t.data),this.delMod("replying")},_onErrorReplyToComment:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this._submitEditorButton.domElem,BEM.blocks["wi-notification"].createErrorMessage(t)))},_onEditorChange:function(t){this._submitEditorButton.setMod("disabled",t.block.val()?"":"yes")}},{_getEditorBEMJSON:function(t){var e=BEM.blocks["wi-history"].getCorrectPath();return[{block:"m-editor-buttons",mix:[{block:"m-editor",js:{id:"comment-editor#"+t}}]},{block:"m-editor",js:{id:"comment-editor#"+t,uploadParams:{reqParams:{type:"PUT",url:BEM.blocks["i-global"].param("hosts").wikiApi.v1+"/pages"+e+".files?format=json",xhrFields:{withCredentials:!0}},URLPath:"data.data.url"},buttons:[["bold","italic","underline","strikethrough"],["ul","ol"],["indent","outdent"],["quote","link","picture","code","table","readmore","help"]]}}]},_getRemovePopupBEMJSON:function(){return{block:"modal",mods:{theme:"normal",autoclosable:"yes"},mix:{block:"w-comment",elem:"remove-popup"},content:[{block:"w-comment",elem:"header",content:BEM.I18N("w-comment","remove-confirm")},{block:"w-comment",elem:"right",content:[{block:"spin2",mods:{size:"xs",type:"remove-submit"}},{block:"button2",mods:{size:"s",role:"remove-cancel",theme:"normal"},text:BEM.I18N("w-comment","cancel")},{block:"button2",mods:{size:"s",theme:"action",role:"remove-submit"},text:BEM.I18N("w-comment","remove")}]}]}}}),BEM.DOM.decl("w-comment",{},{_getEditorBEMJSON:function(t){var e=BEM.blocks["wi-history"].getCorrectPath();return[{block:"m-editor-buttons",mix:[{block:"m-editor",js:{id:"comment-editor#"+t}}]},{block:"m-editor",js:{id:"comment-editor#"+t,uploadParams:{reqParams:{type:"PUT",url:BEM.blocks["i-global"].param("hosts").wikiApi.v1+"/pages"+e+".files?format=json",xhrFields:{withCredentials:!0}},URLPath:"data.data.url"},buttons:[["bold","italic","underline","strikethrough"],["ul","ol"],["indent","outdent"],["quote","link","code","table","readmore"]]}}]}}),function(t){t.fn.splendid=function(e){var s=t.extend({},t.fn.splendid.defaults,e),c=a(s,{mods:{editor:"yes"},elemForContent:"data"}),l=a(s,{mods:{form:"yes"},elemForContent:"data"}),d=a(s,{mods:{behaviour:"scrollable"},padding:"0"}),h=a(s,{directions:["bottom-right"]}),u=a(s,{mods:{drafts:"yes"},elemForContent:"data",directions:["bottom-center","bottom-left","bottom-right"],padding:"3px 0"});return this.each(function(){var e={element:t(this),interactions:null,selection:{start:0,end:0,length:0},container:null,value:null};e.interactions=new t.fn.splendid.interactions(e.element),e.element.on("focusout",function(){e.selection=e.interactions.getSelection()}),s.hotKeysScope&&keymaster.deleteScope(s.hotKeysScope),t.each(s.buttons,function(a,m){var p=this.params,f="",_="",g=function(a){if("keydown"!==a.type||e.element.is(":focus")){p.notPrevent||a.preventDefault();var m,g,b,v,y,k,w,M,x,E,B,I,S,C,T,N,D=s.buttons,O=[];if(e.selection=e.interactions.getSelection(),e.value=e.element.val(),Object.keys(D).forEach(function(t){D[t].params.wrap&&"none"===D[t].params.wrap&&O.push(D[t].params.before)}),m=p.before,g=p.after,v=(b=e).value,k=(y=b.selection).noneSelected,C=y.multiline,"selection"in p&&(f||(f=p.placeholder),p.placeholder=_||f,k||(v=r(y.start,y.end,v),v=o(p.placeholder,y.start,v),y.newStart=y.start,y.end=y.newEnd=y.start+p.placeholder.length)),"replace"in p&&(e.value=[v.slice(0,y.start),v.slice(y.end),p.replace].join("")),"toggle"in p)T=0,N=new RegExp(p.toggle),E=n(y.currentLine.text,p.before),B=Boolean(y.currentLine.text.match(N)),E||B?!E&&B?C?(Object.keys(C).forEach(function(t,e){var i,n=C[t].text.match(N);n?(n=n[0],i=C[t].text.indexOf(n),v=o(p.before,y.currentLine.start+C[t].start+i-T,r(y.currentLine.start+C[t].start+i-T,y.currentLine.start+C[t].start+i+n.length-T,v)),S=y.currentLine.start+C[t].start+i-T+C[t].text.length-(n.length-p.before.length),T+=n.length-p.before.length):S=y.currentLine.start+C[t].start+T+C[t].text.length}),y.newStart=y.currentLine.start+p.before.length,y.newEnd=S):(w=k?{start:k.start,end:k.end}:{start:y.currentLine.start,end:y.currentLine.end},x=(M=v.slice(w.start,w.end+1)).replace(N,p.before),I=M.match(N)[0].length,v=o(x,w.start,r(w.start,w.end+1,v)),y.newStart=w.start,y.newEnd=w.end+1+p.before.length-I):E&&!B&&(C?(y.newStart=y.currentLine.start+p.before.length,y.newEnd=y.currentLine.start+C[Object.keys(C).length].end+2):(y.newStart=y.currentLine.start,y.newEnd=y.currentLine.end+1)):("before"in p&&(k?(v=o(m,k.start,v),y.newStart=k.start+m.length,y.newEnd=k.end+m.length+1):C?(Object.keys(C).forEach(function(t,e){var i=0;!e&&C[t].rangeDiff>1&&(i=C[t].rangeDiff),v=o(m,y.currentLine.start+C[t].start+e*p.before.length+i,v),y.newEnd=y.end+(e+1)*p.before.length}),y.newStart=y.start+m.length):(v=o(m,y.currentLine.start,v),y.newStart=y.currentLine.start+m.length,y.newEnd=y.currentLine.end+m.length+1)),"placeholder"in p&&y.isEmptyLine&&(v=o(p.placeholder,y.start+m.length,v),y.newStart=y.start+m.length,y.newEnd=y.newStart+p.placeholder.length));else{if("before"in p)if(k)"block"===p.type?(v=o(m,y.currentLine.start,v),y.newStart=y.currentLine.start+m.length):(v=o(m,y.start,v),y.newStart=k.start,y.newEnd=k.end+m.length+1);else if(C){var P=!1;Object.keys(C).forEach(function(t,e){!p.ignoreExceptions&&O.forEach(function(e){var n,s=i(e,C[t].text);if(s&&(e=s[0]),-1!==(n=C[t].text.indexOf(e))){var r=m.length;t>=1&&(r=t*m.length+e.length-m.length),v=o(m,y.currentLine.start+C[t].start+n+r,v),P=!0}})}),P||(v=o(m,y.start,v),y.newStart=y.start+m.length,y.newEnd=y.end+m.length)}else{var A=!1;!p.ignoreExceptions&&O.forEach(function(t){var e,n=i(t,y.text);if(n&&(t=n[0]),-1!==(e=y.text.indexOf(t))&&(A=!0,v=o(m,y.currentLine.start+e+t.length,v),y.newStart=y.currentLine.start+t.length+m.length,y.newEnd=y.currentLine.end+m.length+1),!A){var s=i(t,y.currentLine.text);s&&y.start<=y.currentLine.start+s[0].length-1&&(A=!0,v=o(m,y.currentLine.start+s[0].length,v))}}),A||(p.type&&"block"===p.type?(v=o(m,y.currentLine.start,v),y.newStart=y.currentLine.start+m.length,y.newEnd=y.currentLine.end+m.length):(v=o(m,y.start,v),y.newStart=y.start+m.length,y.newEnd=y.end+m.length))}"placeholder"in p&&k&&("block"!==p.type||"block"===p.type&&y.isEmptyLine)&&(v=o(p.placeholder,y.start+m.length,v),y.newStart=y.start+m.length,y.newEnd=y.newStart+p.placeholder.length)}if("after"in p)if(k){var L=0,j=p.placeholder?p.placeholder.length:0;y.start!==y.currentLine.end&&(L=1),"block"!==p.type?(v=o(g,y.start+m.length+j,v),y.newEnd=y.start+m.length+j):"block"===p.type&&y.isEmptyLine?(v=o(g,y.currentLine.end+m.length+j,v),y.newEnd=y.currentLine.end+m.length+j):(v=o(g,y.currentLine.end+m.length+L,v),y.newEnd=y.currentLine.end+m.length+L)}else if(C&&Object.keys(C).length>1){P=!1;!p.ignoreExceptions&&Object.keys(C).forEach(function(t,e){O.forEach(function(e){var n=i(e,y.text);if(n&&(e=n[0]),-1!==y.text.indexOf(e)){var s=m.length+1;t==Object.keys(C).length?s=t*(m.length+g.length):t>1&&(s=t*(m.length+g.length)-1),v=o(g,y.currentLine.start+C[t].end+s,v),P=!0}})}),P||(v=o(g,y.newEnd,v))}else{P=!1;!p.ignoreExceptions&&O.forEach(function(t){if(!P){var e=i(t,y.currentLine.text);e&&y.start<=y.currentLine.start+e[0].length-1&&(P=!0,v=o(p.after,y.currentLine.end+(m?m.length:0)+1,v))}}),P||("\n"===v[y.newEnd-1]?(v=o(p.after,y.newEnd-1,v),y.newEnd-=1):"\n"===v[y.newEnd]&&"\n"===v[y.newEnd-1]?(v=o(p.after,y.newEnd-1,v),y.newEnd-=1):"block"===p.type?(v=o(p.after,y.currentLine.end+m.length+1,v),y.newEnd=y.currentLine.end+m.length+1):(v=o(p.after,y.end+m.length,v),y.newEnd=y.end+m.length))}if("add"in p){var R=p.add,z=R.length,F=y.currentLine.start,q=y.currentLine.end;if(C){var H=(W=Object.keys(C)).length;W.forEach(function(t,e){v=o(R,F+C[t].start+z*e,v)}),y.newStart=F+C[1].start,y.newEnd=F+C[H].end+H*z+2}else v=o(R,F,v),y.newStart=F,y.newEnd=q+z+1}if("del"in p){var U=p.del.length,V=(F=y.currentLine.start,q=y.currentLine.end,0);if(C){var W;H=(W=Object.keys(C)).length;W.forEach(function(t){C[t].text.slice(0,U)===p.del&&(v=r(F+C[t].start-V*U,F+C[t].start-V*U+U,v),V++)}),y.newStart=F,y.newEnd=F+C[H].end-V*U+2}else v.substr(F,U)===p.del?(v=r(F,F+U,v),y.newEnd=q-U+1):y.newEnd=q+1,y.newStart=F}if("popup"in p){var $,G,J,Y=p.popup.type||"",K=function(t,e){s.editor.setText(e)},Z=function(t,i){y.length&&(v=r(y.start,y.end,v)),v=o(i,y.start,v,Boolean(p.separate)),s.editor.val(v),e.interactions.setSelection(y.start,y.start+i.length),resultPopup.hide()};switch(Y){case"file":case"spell":resultPopup=d;break;case"form":resultPopup=l;break;case"other":resultPopup=h;break;case"drafts":resultPopup=u;break;default:resultPopup=c}G=BEMHTML.apply({block:"m-editor-popup",js:{selection:t.extend(e.selection,{text:_}),text:b.element.val()},mods:{editor:p.notEditor?"":"yes",type:Y},data:p.data,uploadReqParams:s.uploadReqParams,uploadURLPath:s.uploadURLPath,forms:s.forms}),resultPopup.setContent(G),$=resultPopup.show(t(a.currentTarget)),"other"===Y&&(e.element.splendid({buttons:$.findBlocksInside("button2"),editor:s.editor}),e.interactions.setSelection(e.selection.start,e.selection.end),BEM.blocks.button2.on($.domElem,"click",function(){resultPopup.hide()},this)),$.on("onadd",Z),$.on("update-text",K),(J=$.findBlockInside("m-editor-popup")).on("update-text",function(t,e){K(0,e),$.onUpdateText&&$.onUpdateText(t,e)}),J.on("add-text",Z),J.on("prevent-close",function(){$._preventHideByClick=!0}),J.on("event",function(t,e){s.editor.trigger(e.name,e.data)}.bind(this)),speller=$.findBlockInside("m-speller"),speller&&speller.on("change",function(t,e){s.editor.val(e)})&&speller.on("cancel",function(t,e){resultPopup.hide()})&&speller.check(b.element.val())}p.popup||(e.element.focus(),s.editor.val(v),e.interactions.setSelection(e.selection.newStart,e.selection.newEnd))}};p.hotkey&&keymaster(p.hotkey.toLowerCase(),s.hotKeysScope?s.hotKeysScope:g,s.hotKeysScope?g:void 0),this.bindTo("mousedown",function(){var t=s.editor.findBlockInside("textarea").elem("control")[0],e=t.selectionStart,i=t.selectionEnd,n=s.popupIsShown?s.prevSelection:"";_=t.value&&t.value.substring(e,i)?t.value.substring(e,i):n,s.prevSelection=_}),this.bindTo("click",g)})})},t.fn.splendid.interactions=function(t){this.splendid=t},t.fn.splendid.interactions.prototype.getPosition=function(){},t.fn.splendid.interactions.prototype.getSelection=function(t){var i,n,o={start:0,end:0,length:0,text:null,multiline:!1,multilineFullText:null,isEmptyLine:!1,noneSelected:!1,currentLine:!1};if("number"==typeof this.splendid.get(0).selectionStart&&"number"==typeof this.splendid.get(0).selectionEnd)o.start=this.splendid.get(0).selectionStart,o.end=this.splendid.get(0).selectionEnd,o.length=o.end-o.start;else{var r={range:document.selection.createRange(),normalized:this.splendid.val().replace(/\r\n/g,"\n"),selection:this.splendid.get(0).createTextRange(),endRange:this.splendid.get(0).createTextRange()};r.selection.moveToBookmark(r.range.getBookmark()),r.endRange.collapse(!1),r.selection.compareEndPoints("StartToEnd",r.endRange)>-1?(o.start=o.end=this.splendid.val().length,o.length=o.end-o.start):(o.start=-r.selection.moveStart("character",-this.splendid.val().length),r.selection.compareEndPoints("EndToEnd",r.endRange)>-1?o.end=this.splendid.val().length:(o.end=-r.selection.moveEnd("character",-this.splendid.val().length),o.end+=r.normalized.slice(0,o.end).split("\n").length-1),o.length=o.end-o.start)}return o.currentLine=e(o.start,this.splendid.val()),o.currentLine.text=this.splendid.val().slice(o.currentLine.start,o.currentLine.end+1),void 0!==o.start&&void 0!==o.end&&o.start===o.end&&(stringRange=e(o.start,this.splendid.val()),stringRange.start===stringRange.end&&(o.isEmptyLine=!0),o.noneSelected=stringRange),o.text=this.splendid.val().slice(o.start,o.end),i=this.splendid.val().slice(0,o.start).lastIndexOf("\n"),o.text.match(/\n/g)&&(o.multilineFullText=this.splendid.val().slice(i+1,o.end),(n=s(o.multilineFullText,o))&&Object.keys(n).length>1&&(o.multiline=s(o.multilineFullText))),o},t.fn.splendid.interactions.prototype.setSelection=function(t,e){if("number"==typeof this.splendid.get(0).selectionStart&&"number"==typeof this.splendid.get(0).selectionEnd)this.splendid.get(0).selectionStart=t,this.splendid.get(0).selectionEnd=e;else{var i={range:this.splendid.get(0).createTextRange()};i.range.collapse(!0),i.range.moveStart("character",t),i.range.moveEnd("character",e-t),i.range.select()}};var e=function(t,e){for(var i,n,s=!0,o=t,r=t,a=e,c=a.length,l=0;s;)void 0!==i&&void 0!==n&&(s=!1),void 0===i&&("\n"===a[o-=1]?i=o+1:o<=0&&(i=0)),void 0===n&&(a[r]&&"\n"!==a[r]?"\n"===a[r+=1]?n=r-1:r===c-1&&(n=r):n=r),l>999999&&(s=!1),l++;return{start:i,end:n}},i=function(t,e){return new RegExp(function(t){return t.replace(/\d+/,"\\d+").replace(/\s/,"\\s").replace(/\*/,"\\*").replace(/\./,"\\.")}(t)).exec(e)},n=function(t,e){return-1!==t.indexOf(e)},s=function(t){var e=1,i={},n="",s=0,o=0,r=t.split(""),a=null;return r.forEach(function(c,l){if(null===a&&"\n"===c){for(var d=0;"\n"===r[l+d];)d++;a=d}(n+=c).replace(/\n/g,"")&&("\n"!==c&&l!==t.length-1||(o=l,i[e]={rangeDiff:a,text:n.replace(/\n/gi,""),start:s?s+1:s,end:o-1},n="",e++,s=l))}),!!Object.keys(i).length&&i},o=function(t,e,i,n){var s=new RegExp("^[а-я,А-Я,\\w,\\d]{1}$");return n&&(i[e-1]&&s.exec(i[e-1])&&(t=" "+t),i[e]&&s.exec(i[e])&&(t+=" ")),i.slice(0,e).concat(t,i.slice(e))},r=function(t,e,i){return i.slice(0,t)+i.slice(e)},a=function(e,i){if(!n)var n=t(BEMHTML.apply({block:"m-popup",mods:t.extend(i.mods,{hiding:"yes",target:"anchor",theme:"normal",autoclosable:"yes"}),directions:i.directions,attrs:i&&i.padding?{style:"padding: "+i.padding}:{}})).bem("m-popup");return n._popup.on("beforeClose",function(){e.popupIsShown=!1}),{setContent:function(t){i.elemForContent?BEM.DOM.update(n.elem(i.elemForContent),t):n.setContent(t)},show:function(t,i){return n._popup.setAnchor(t).setMod("visible","yes").domElem.find("input,textarea").eq(0).focus(),e.popupIsShown=!0,n._popup},hide:function(){return n._popup.un("onadd").delMod("visible")},popup:function(){return n._popup}}};t.fn.splendid.defaults={container:'<ul class="splendid-container">',buttons:'<li class="splendid-button">',maps:{},generate:!1,hotKeysScope:null}}(jQuery),BEM.DOM.decl({block:"m-editor-popup"},{processParams:function(t){return""},getText:function(){var t={},e=this.findBlocksInside("textinput"),i=this.findBlocksInside("textarea"),n=e.concat(i).map(function(t){return{name:t.findElem("control").attr("name"),val:t.val()}}),s=this.findBlocksInside("select2").map(function(t){return{name:t.findElem("control").attr("name"),val:t.getVal()}});return n.concat(s).forEach(function(e){e.val&&(t[e.name]=e.val)}),this.processParams(t)},addVideoParser:function(t){"function"==typeof t?this.parsers.push(t):Array.isArray(t)&&this._isArrayOfFuncitons(t)&&(this.parsers=this.parsers.concat(t))},_isArrayOfFuncitons:function(t){return t.every(function(t){return"function"==typeof t})}}),BEM.DOM.decl({block:"textinput",baseBlock:"control"},{onSetMod:{js:{inited:function(){this._control=this.elem("control"),this._text=this._control.val()}}},val:function(t){var e=void 0!==t,i=this._control;return(t=e?null===t?"":t.toString():i.val())!==this._text&&(i.val(t),this._textChange()),e?this:t},getText:function(){return this._control.val()},setText:function(t){return t===this.getText()?this:(this._control.val(t),this._textChange(),this)},_textChange:function(t){var e=this._control.val(),i=this._text;if(!Boolean(e!==i))return!1;this._text=e;var n={text:e,oldText:i,byCode:t};this.trigger("change",n)}},{live:function(){return this.liveBindTo("control","input",function(){this._textChange()}),this.__base()}}),BEM.DOM.decl({block:"textinput"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.params.autofocus&&(this.setMod("focused","yes"),this._getControl().focus())}}},_onPointerenter:function(){this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.hasMod("disabled")||this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}),this.__base()}}),BEM.DOM.decl("mi-uploader",{_files:[],_summary:{},dragEvents:["dragstart","dragenter","dragover","dragleave","drag","dragend"],onSetMod:{js:function(){this._events()}},_events:function(){var t=this;this.dragEvents.forEach(function(e){t.bindTo(e,function(i){i.preventDefault(),t.trigger(e)})}),this.bindTo("drop",this._onDrop)},_onDrop:function(t){var e=Array.prototype.slice.apply(t.originalEvent.dataTransfer.files),i=[];t.preventDefault(),e.forEach(function(t){i.push(this._createFileObject(t))},this),this.trigger("drop",1===i.length?i[0]:i),this._files=this._files.concat(i)},_append:function(t){this._files.push(this._createFileObject(t))},_createFileObject:function(t){var e={raw:t,size:this.convertToOptimalSize(t.size),response:null,status:{uploaded:!1,inProgress:!1},total:t.size,loaded:0,send:this._sendFile};return e.req=this._req(e),t.type.match(/image.*/)&&this._createThumbnail(e),e},_createThumbnail:function(t){var e=this,i=new FileReader,n=e.params.thumbnail;i.onloadend=function(){n&&(n.height||n.width)?e._getThumbImage(i.result,t):t.thumbnail=i.result},i.readAsDataURL(t.raw)},_getThumbImage:function(t,e){var i=new Image,n=e.raw.type,s=this.params.thumbnail;i.onload=function(){var t=s.height||null,o=s.width||null,r=i.width,a=i.height,c=document.createElement("canvas"),l=new Image,d=null,h=null,u=r>a&&r>o,m=a>r&&a>t,p=a===r&&a>t;!function s(){var f=u&&i.width>>1>o||m&&i.height>>1>t||p&&i.height>>1>t;l.onload=function(){i=l,s()};f?(r>>=1,a>>=1):(u?(a*=o/r,r=o,t&&a>t&&(r*=t/a,a=t)):(m||p)&&(r*=t/a,a=t,o&&r>o&&(a*=o/r,r=o)),r=Math.round(r),a=Math.round(a));c.width=r;c.height=a;d=c.getContext("2d");d.drawImage(i,0,0,r,a);h=c.toDataURL(n);f?l.src=h:e.newthumbnail=h}()},i.src=t},_req:function(t){var e,i=this,n=new FormData;return n.append("file",t.raw),e={xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var n=e.loaded/e.total*100<<0;t.progress=n,t.loaded=e.loaded,t.total=e.total,i._updateSummary(),i.trigger("progress",t)}},!1),e},type:"POST",url:this.params.url,data:n,processData:!1,contentType:!1,beforeSend:function(){t.status.inProgress=!0,i.trigger("beforeSend",t)},success:function(e){i._onSuccess(e,t)},error:function(e){i._onError(e,t)}},this.params.hasOwnProperty("ajaxExtend")&&$.extend(e,this.params.ajaxExtend),e},_onSuccess:function(t,e){e.status.uploaded=!0,e.status.inProgress=!1,e.response=t,this.trigger("success",{file:e,data:t})},_onError:function(t,e){e.status.inProgress=!1,e.response=t,this.trigger("error",e)},_updateSummary:function(){var t=this,e=0,i=0;return this._summary.filesUploaded=0,this._summary.filesTotal=this._files.length,this._summary.percent=this._getOverallPercent(),this._files.forEach(function(n){n.status.uploaded&&t._summary.filesUploaded++,e+=n.total,i+=n.loaded}),this._summary.total=e,this._summary.loaded=i,this._summary},_getOverallPercent:function(){var t=0,e=0,i=0,n=0;return this._files.length&&(this._files.forEach(function(i){t+=i.total||0,e+=i.loaded||0}),n=t/100,i=Math.round(e/n)),i},_sendFile:function(){this.status.uploaded||this.status.inProgress||$.ajax(this.req)},getSummary:function(){return this._updateSummary()},getFiles:function(){return this._files},setData:function(t){return t instanceof Array?t.forEach(function(t){t instanceof window.File&&this._append(t)},this):t instanceof window.File&&this._append(t),this},convertToOptimalSize:function(t){for(var e=["B","Kb","Mb","Gb"],i=0;i<e.length;i++){var n=t/1024;if(!(n>1))return t.toFixed(2)+e[i];t=n}},clear:function(){return this._files=[],this}}),BEM.DOM.decl("progress",{onSetMod:{js:{inited:function(){this.update(this.params.value,this.params.timing)}}},update:function(t,e){return this.setMod("timing",e||"").domElem.css({width:t<=0?"0":t>=1?"100%":(100*t).toPrecision(2)+"%"}).css("width"),this}}),BEM.DOM.decl({block:"menu",modName:"type",modVal:"radio"},{getVal:function(){var t=this.getItems("checked","yes")[0];return t&&this.elemParams(t).val},setVal:function(t){return this.getItems().forEach(function(e){this.elemParams(e).val===t?this.setMod(e,"checked","yes"):this.delMod(e,"checked")},this),this._onChange(),this},_onItemClick:function(t,e,i){this.__base.apply(this,arguments),this.hasMod(t,"checked","yes")||(this.delMod(this.elem("item","checked","yes"),"checked"),this.setMod(t,"checked","yes"),this._onChange())}}),BEM.DOM.decl({block:"textarea",baseBlock:"control"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._control=this.elem("control"),this._text=this._control.val()}}},val:function(t){var e=void 0!==t,i=this._control;return(t=e?null===t?"":t.toString():i.val())!==this._text&&(i.val(t),this._textChange()),e?this:t},getText:function(){return this._control.val()},setText:function(t){return this._control.val(t||""),this._textChange(),this},_textChange:function(){var t=this._control.val(),e=this._text;if(!(t!==e))return!1;this._text=t;var i={text:t,oldText:e};this.trigger("change",i)}},{live:function(){return this.liveBindTo("control","input",function(){this._textChange()}),this.__base()}}),BEM.DOM.decl("textarea",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.params.autofocus&&(this.setMod("focused","yes"),this._getControl().focus())}}},_onPointerenter:function(){this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.hasMod("disabled")||this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}),this.__base()}}),BEM.DOM.decl("select",{onSetMod:{js:{inited:function(){this._items=[],this._curItemIndex=-1,this._scrollableElemOutsidePopup=null,this._rowHeight=22,this.on("change",this._redrawParentPopup);var t=this._getSelectedText();t&&t!==this._getButtonText()&&this.elem("control").trigger("change")}},disabled:function(t,e){this.elem("control").prop("disabled",e),this._getButton().setMod(t,e),e&&this.delMod("opened").delMod("focused")},focused:{yes:function(){if(this.hasMod("disabled"))return!1;this._useNativeControl()||this.bindTo("keydown",this._onKeyDown),this.afterCurrentEvent(function(){this.domElem&&this.trigger("focus")})},"":function(){this._useNativeControl()||this.delMod("opened").unbindFrom("keydown"),this.afterCurrentEvent(function(){this.domElem&&this.trigger("blur")})}},opened:function(t,e){this._getButton()&&this._getButton().domElem&&this._getButton().toggleMod("arrow","up","down",Boolean(e))}},isDisabled:function(){return this.hasMod("disabled","yes")},isOpened:function(){return this.hasMod("opened","yes")},open:function(){return this.setMod("opened","yes")},close:function(){return this.delMod("opened")},val:function(t,e){if(void 0===t)return this.elem("control").val();var i,n=-1;return this.findElem("option").each(function(e){this.value===t&&!this.disabled&&(!(i=$(this).parent("optgroup")[0])||!i.disabled)&&(n=e)}),n>-1&&this._selectedIndex(n,e),this},name:function(t){var e=this.elem("control");return arguments.length?(e.attr("name",t),this):e.attr("name")},_selectedIndex:function(t,e){var i=this._getSelectedIndex();return void 0===t||t===i?i:(this.elem("control").prop("selectedIndex",t),this._useNativeControl()||(this._setButtonText(this._getSelectedText()),this._items[0]&&this.delMod(this._items,"selected").setMod(this._items.eq(t),"selected","yes")),this.trigger("change",$.extend({index:t,prev:i},e)),t)},setOptions:function(t){return t?(BEM.DOM.update(this.elem("control"),BEMHTML.apply($.map(t,this.__self._buildOption))),this.redraw()):this},redraw:function(){return this._popup&&this._redrawList(),this.elem("control").trigger("change"),this},_useNativeControl:function(){return null!==this.__self.useNativeControl?this.__self.useNativeControl:this.__self.useNativeControl="none"!==this.elem("control").css("display")},_redrawParentPopup:function(){var t;return this._isParentPopup()&&((t=this._popup._parent).repaint||t.redraw).call(t),this},_isParentPopup:function(){return this._popup&&this._popup._parent&&!this.hasMod("layout","fixed")},_onSelectChange:function(){this._setButtonText(this._getSelectedText()),this.trigger("change",{index:this._getSelectedIndex(),prev:-1})},_onControlFocusInOut:function(t){this._useNativeControl()&&this.toggleMod("focused","yes","","focusin"===t.type)},_onMouseDown:function(t){this._isControlFocused()&&t.preventDefault()},_onKeyDown:function(t){var e=BEM.blocks.keycodes,i=t.keyCode===e.UP,n=t.keyCode===e.DOWN,s=t.keyCode===e.ENTER,o=t.keyCode===e.SPACE;if(i||n){if(t.preventDefault(),!this.isOpened())return this.open();var r=this._items.length,a=this._curItemIndex;if(i&&0===a||n&&a>r-2)return;if(r){var c,l=n?1:-1;for(c=a;c>=0&&c<=r;)if(c+=l,this._isSelectableItem(this._items.eq(c))){a=c;break}this._onEnterItem(this._items.eq(a),!0)}}(s||o)&&this._onEnterItem(this._items.eq(this._curItemIndex),!0,!0)},_onEnterItem:function(t,e,i){this.elem("button").attr("aria-activedescendant",t.attr("id"));var n=this._curItemIndex,s=this._getItemIndex(t),o=this._items;n>-1&&this.delMod(o.eq(n),"hovered"),s>-1&&(this._curItemIndex=s,this.setMod(o.eq(s),"hovered","yes")),i&&this._selectedIndex(this._curItemIndex),e&&this._scrollToCurrent()},_onLeaveItem:function(t){var e=this._curItemIndex;e>-1&&e===this._getItemIndex(t)&&(this.delMod(this._items.eq(e),"hovered")._curItemIndex=-1)},_onSelectItem:function(t){return this._isSelectableItem(t)&&this._selectedIndex(this._curItemIndex),this.close()},_onButtonFocus:function(){this.setMod("focused","yes")},_findScrollableElemOutsidePopup:function(){if(null===this._scrollableElemOutsidePopup){var t,e=this._getPopup().domElem;do{t=(e=e.parent()).css("overflow-y")}while("scroll"!==t&&"auto"!==t&&"HTML"!==e.prop("tagName"));this._scrollableElemOutsidePopup=e}return this._scrollableElemOutsidePopup},_onButtonBlur:function(){if(this.isOpened()&&this._isPopupFocused())if(8===BEM.blocks["i-ua"].ie){var t=this._findScrollableElemOutsidePopup(),e=t.scrollTop();this._focusButton(),t.scrollTop(e)}else this._focusButton();else this.delMod("focused")},_onButtonPress:function(){this.toggleMod("opened","yes","")},_focusButton:function(){return this._getButton().setMod("focused","yes"),this},_blurButton:function(){return this._getButton().delMod("focused"),this},_isPopupFocused:function(){try{return this._getPopup().containsDomElem($(document.activeElement))}catch(t){return!1}},_getButtonText:function(){return this._getButton().elem("text").text()},_setButtonText:function(t){t.length&&(this._getButton().elem("text").text(t),BEM.blocks["i-ua"].ie<10&&this.domElem.parent().css("outline",""))},_isOutsideClicked:function(t,e){return this.containsDomElem($(e.target))},_getItemIndex:function(t){return $.inArray(t.get(0),this._items)},_getSelectedText:function(){return this.elem("control").find(":selected").text()},_getSelectedIndex:function(){return this.elem("control").prop("selectedIndex")},_isSelectableItem:function(t){return!this.hasMod(t,"disabled","yes")&&!this.hasMod(t,"label","yes")},_getButton:function(){return this._button||(this._button=this.findBlockOn("button","button"))},_getRowHeight:function(){return this.findElem(this._getPopup().domElem,"item").outerHeight()},_isControlFocused:function(){try{return this.containsDomElem($(this.__self.doc[0].activeElement))}catch(t){return!1}},destruct:function(){this._outPopup&&this._outPopup.un("outside-click"),this.delMod("opened"),this._popup&&this._popup.domElem&&BEM.DOM.destruct(this._popup.domElem),this.__base.apply(this,arguments)},getDefaultParams:function(){return{rows:15,popupMods:{direction:"down"}}}},{live:function(){this.liveBindTo("control","change",function(t){this._onSelectChange()}),this.liveBindTo("control","focusin focusout",function(t){this._onControlFocusInOut(t)}),this.liveBindTo("mousedown",function(t){this._onMouseDown(t)}),this.liveInitOnBlockInsideEvent("focus","button",function(){this._onButtonFocus()}).liveInitOnBlockInsideEvent("blur","button",function(){this._onButtonBlur()})},useNativeControl:null,_buildOption:function t(e,i,n){var s={};return"option"===e.item?(s={block:"select",elem:"option",tag:"option",attrs:{value:e.value},content:e.content},e.disabled&&(s.attrs.disabled="disabled"),e.selected&&(s.attrs.selected="selected")):"optgroup"===e.item&&(s={elem:"option-group",tag:"optgroup",attrs:{label:e.label}},e.disabled&&(s.attrs.disabled="disabled"),s.content=Array.isArray(e.content)?e.content.map(t):e.content),s.block="select",s}}),BEM.DOM.decl("select",{onElemSetMod:{item:{hovered:function(){BEM.blocks["i-ua"].opera<13&&this._popup.domElem.css("display","inline").css("display","")}}}},{live:function(){return this.liveInitOnBlockInsideEvent("press","button",function(){this._onButtonPress()}),this.__base.apply(this,arguments)}}),BEM.DOM.decl("button",{onSetMod:{js:{inited:function(){var t=this.isDisabled(),e=this.domElem;(this._href=e.attr("href"))&&t&&e.removeAttr("href")}},disabled:function(t,e){var i=this.domElem;e&&this.delMod("hovered"),this._href&&(e?i.removeAttr("href"):i.attr("href",this._href)),this.afterCurrentEvent(function(){i&&i.prop("disabled",e)})},pressed:function(t,e){if(this.hasMod("disabled"))return!1;this.trigger(e?"press":"release")}},isDisabled:function(){return this.hasMod("disabled","yes")},url:function(t){return void 0===t?this._href:(this._href=t,this.isDisabled()||this.domElem.attr("href",t),this)},getUrl:function(){return this.url()},setUrl:function(t){return this.url(t)},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onClick:function(t){this.isDisabled()?t.preventDefault():this.afterCurrentEvent(function(){this.domElem&&this.trigger("click")})}},{live:function(){this.liveBindTo("pointerclick",function(t){this._onClick(t)}).liveBindTo("pointerpress",function(t){this.isDisabled()||this._onPointerpress(t)})}}),BEM.DOM.decl("button",{onSetMod:{focused:{yes:function(){if(this.isDisabled())return!1;this.bindToWin("unload",function(){this.delMod("focused")}).bindTo("keydown",this._onKeyDown),this._isControlFocused()||this._getControl().focus(),this.trigger("focus")},"":function(){var t=BEM.blocks["i-ua"].opera<13;this.unbindFromWin("unload").unbindFrom("keydown"),(t||document.hasFocus())&&this._isControlFocused()&&this._getControl().blur(),this.trigger("blur")}},disabled:function(t,e){this.__base.apply(this,arguments),e&&(this.delMod("focused"),this.domElem.keyup())},hovered:function(t,e){if(this.isDisabled())return!1;!e&&this.delMod("pressed")},pressed:function(){return this.isDisabled()||this.setMod("focused","yes"),this.__base.apply(this,arguments)}},_getControl:function(){return this.elem("control").length&&this.elem("control")||this.domElem},_isControlFocused:function(){return this.containsDomElem($.dom.getActiveElement())},_onKeyDown:function(t){var e=BEM.blocks.keycodes,i=t.keyCode;!this._keyDowned&&e.is(i,"ENTER","SPACE")&&(this._keyDowned=!0,this.setMod("pressed","yes").bindTo("keyup",function(){this.delMod("pressed").unbindFrom("keyup"),delete this._keyDowned,i===e.SPACE&&this.domElem.attr("href")&&(document.location=this.domElem.attr("href"))}))},destruct:function(){this.delMod("focused"),this.__base.apply(this,arguments)}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.isDisabled()||this.domElem[0].contains(t.relatedTarget)||this.toggleMod("hovered","yes","pointerover"===t.type)}).liveBindTo("focusin focusout",function(t){this.toggleMod("focused","yes","focusin"===t.type)}),8===BEM.blocks["i-ua"].ie&&this.liveBindTo("mouseup mouseout",function(t){this.domElem.height()}),this.__base()}}),BEM.DOM.decl("select",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._initButton()}}},_initButton:function(){},_redrawList:function(){var t,e=this,i=this._getPopup().domElem;return BEM.DOM.update(this.findElem(i,"list"),this.__self._buildItemsHtml(this.elem("control").children())),t=this.findElem(i,"item"),this._curItemIndex=-1,this._items=t.filter(function(){return!e.hasMod($(this),"label","yes")}),this.bindTo(e._items,{pointerclick:function(t){t.preventDefault(),e._onSelectItem(t.data.domElem)},pointerover:function(t){e._onEnterItem(t.data.domElem)},pointerout:function(t){e._onLeaveItem(t.data.domElem)}}),this}},{_buildItemsHtml:function(t){var e={block:"select",elem:"separator",tag:"i"},i=[],n=[];function s(t,e,i){var n={block:"select",elem:"item",content:{elem:"text",tag:"span",content:{tag:!1,html:e}||"   "},elemMods:{}};return i&&(n.elemMods=i),n}return function t(o,r){var a=o.length;if(a){var c=0;do{var l=$(o[c]),d=l.attr("disabled")&&{disabled:"yes"};if(l.is("optgroup")){!0,!l.prev().is("optgroup")&&c>0&&i.push(e),n.push(i),(i=[]).push(s(0,l.attr("label"),$.extend({label:"yes"},d,r))),t(l.children(),$.extend({inner:"yes"},d,r));var h=i;(i=n.pop()).push({block:"select",elem:"group",content:h})}else i.push(s(0,l.html(),$.extend(d,l.is(":selected")&&{selected:"yes"},r)))}while(++c<a||!1)}}(t),BEMHTML.apply(i)}}),BEM.DOM.decl("select",{onSetMod:{opened:{yes:function(){if(this.hasMod("disabled"))return!1;this._drawPopup();var t=this.findElem(this._popup.domElem,"item","selected","yes");this.elem("button").attr({"aria-activedescendant":t.attr("id"),"aria-expanded":!0})},"":function(){this.elem("button").attr("aria-expanded",!1).removeAttr("aria-activedescendant"),this._getPopup().hide()}}},_getPopupContent:function(t){return{block:t,elem:"list"}},_getPopupMix:function(t){return{block:t,elem:"popup",elemMods:{}}},_getPopup:function(){if(this._popup)return this._popup;var t=this,e=t.params,i=t.__self.getName(),n=this._getPopupContent(i),s=this._getPopupMix(i),o={animate:"no"},r={directions:[{to:"bottom",axis:"left",offset:{top:8}},{to:"top",axis:"left",offset:{bottom:8}}]};["size","layout","theme","width"].forEach(function(e){t.hasMod(e)&&(s.elemMods[e]=t.getMod(e))}),$.extend(s.elemMods,e.elemPopupMods),$.extend(o,e.popupMods),$.extend(r,e.popupParams);var a=$(BEMHTML.apply({block:"popup",mods:o,mix:s,js:r,content:{elem:"content",content:n}}));return this._popup=this.findBlockOn(a,"popup"),this._popup.on({show:function(){t._curItemIndex=t._getSelectedIndex();var e=t._items.eq(t._curItemIndex);t.delMod(t._items,"selected").setMod(e,"hovered","yes").setMod(e,"selected","yes")},"outside-click":function(e,i){t._isOutsideClicked(e,i)?e.preventDefault():t._blurButton()},hide:function(){t.delMod("opened").delMod(t._items,"hovered").delMod(t.findElem(t._popup.domElem,"popup"),"scrollable")}}).bindTo("mousedown",function(t){t.preventDefault()}),BEM.DOM.append(BEM.DOM.scope,t._popup.domElem),t._redrawList(),t._outPopup=t.findBlockOutside("button","popup"),t._outPopup&&t._outPopup.on("outside-click",function(e,i){t._popup.containsDomElem($(i.target))&&e.preventDefault()}),t._popup},_calcPopupDimensions:function(){this._popupContent||(this._popupContent=this._getPopup().findBlockInside("popup").elem("content"));var t=parseInt(this.params.rows,10),e=this._getPopup();if(t&&this.findElem(this._popupContent,"item").size()>t){this._rowHeight=this._getRowHeight();var i=parseInt(e.domElem.css("height"),10),n=t*this._rowHeight;i!==n&&(e.setSize({height:n}),i>n&&this.setMod(this.findElem(e.domElem,"popup"),"scrollable","yes"))}else e.setSize({height:"auto"})},_drawPopup:function(){var t=this.findBlockInside("select");this._getPopup().show(t),this._calcPopupDimensions(),this._scrollToCurrent()},_scrollToCurrent:function(){if(this._popupContent&&!(this._curItemIndex<0)){var t,e=this._items.eq(this._curItemIndex).get(0).offsetTop,i=this._popupContent,n=i.scrollTop(),s=e-n,o=2*this._rowHeight;s>i.height()-o?t=e-o:n&&s<o&&(t=e-i.height()+o),t&&i.scrollTop(t)}}},{SHADOW_OFFSET:1}),BEM.DOM.decl({block:"m-suggest"},{onSetMod:{js:function(){this._input=this.findBlockInside("textinput").on("change focus",this._update,this).on("blur",this._onInputBlur,this),this._input.bindTo(this._input.elem("control"),"click",this._onInputClick),this._input.elem("clear").length&&this._input.bindTo(this._input.elem("clear"),"click",this._onClearText.bind(this)),this.hasMod("disabled","yes")&&this._disable(),this._notSendRequest=0,this.state={val:null,result:null},this.on("state-update",function(){this.render()})},disabled:{yes:function(){this._disable()},"":function(){this._enable()}}},val:function(t,e){var i,n,s,o,r=this._input.val(),a=typeof t;return"undefined"===a||e||this._notSendRequest++,"string"===a?(t!==r&&this._notSendRequest++,this._input.val(t)):"object"===a&&(i=t.params.value,n=t.params.fullData,i!==r&&this._notSendRequest++,o={fullData:n,value:i},this.params.multiple?((s=r.substr(0,r.lastIndexOf(",")+1))?this._input.val(s+" "+i):this._input.val(i),this.state.val?this.setState({val:this.state.val.concat(o)}):this.setState({val:[o]})):(this._input.val(i),this.setState({val:o.fullData}))),this._input.val()},name:function(){return this._input.elem("control").attr("name")},getData:function(){var t,e,i=null;return this.state.val&&this.params.multiple?(t=this._input.val().split(","),i=this.state.val.filter(function(i){return e=!0,t.forEach(function(t){-1!==t.indexOf(i.value)&&(e=!1)}),!e}).map(function(t){return t.fullData})):this.state.val&&(i=this.state.val),i},clearData:function(){this.setState({val:null}),this._input&&this._input.val("")},_update:function(t){var e=this._getInputValue4Request(),i=t&&"change"===t.type;i&&this.trigger("change",this._input&&this._input.val()),!this._notSendRequest&&e?(this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(this._sendRequest(),200),i&&(this._lastInputVal=this._input.val())):this._notSendRequest?this._notSendRequest--:this._input.val()||(this._popup&&this._popup.delMod("visible"),this.clearData())},_getInputValue4Request:function(){var t=this._input.val(),e=t.lastIndexOf(",");return this.params.multiple&&-1!==e&&(t=t.substr(e+1)),t},_sendRequest:function(){var t=this._getInputValue4Request(),e=this._prepareRequestData(t);this._lastRequestText=t;var i=this;this._input.val()?$.ajax(e).done(function(e){if(t!==i._lastRequestText)return i._sendRequest();i.setState({result:e})}).fail(this._onFailRequest):this._popup&&this._popup.delMod("visible")},setState:function(t){var e=!1;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&this.state[i]!==t[i]&&(this.state[i]=t[i],e=!0);e&&this.trigger("state-update")},render:function(){var t,e=this.state.result;this._popup=this._getPopup(),this._isNotEmptyResult(e)&&this._input.val()&&(t=this._getItemsHTML(e))?(this._popup.setMod("visible","yes"),this._updatePopupContent(t)):(this._popup.delMod("visible"),BEM.DOM.update(this._popup.elem("items"),""))},_updatePopupContent:function(t){this._popup=this._getPopup(),BEM.DOM.update(this._popup.elem("items"),t,function(){this._items=this._popup.findBlocksInside("m-suggest-item"),this.trigger("update-items")}.bind(this)),this._curItemIndex=-1},_onFailRequest:function(t){throw new Error("meccano:m-suggest:request failed")},_isNotEmptyResult:function(t){return Boolean(t&&t.length)},_getItemTypeFromOptions:function(t){var e=null;return this.params.types.forEach(function(i){"object"==typeof i?i.name===t&&(e=i):i===t&&(e={name:i})}),e},_onClearText:function(){this._notSendRequest=1},_getPopupBEMJSON:function(){var t=this.params.inHeader,e=this.params.inSearchHeader,i=!e&&"b2b"!==this.getMod("type");return{block:"popup2",mods:{theme:"normal",hiding:"yes",target:"anchor",autoclosable:"yes",role:"suggest-items","suggest-type":this.getMod("type")},mix:{block:this.__self.getName(),elem:"popup",elemMods:{labels:(t||e)&&"yes",header:t&&"yes","search-header":e&&"yes"}},directions:["bottom-left"],secondaryOffset:t?-100:0,mainOffset:i?9:0,content:{elem:"content",content:{elem:"items",cls:e&&"m-suggest-in-search-header",mix:[{block:this.__self.getName(),elem:"popup-items"}]}}}},_getPopup:function(){return this._popup||(this._popup=$(BEMHTML.apply(this._getPopupBEMJSON())).bem("popup2").setAnchor(this._input.domElem).on({beforeOpen:this._onPopupShow,beforeClose:this._onPopupHide},this).bindTo("click",this._onPopupClick.bind(this)).bindTo("mousedown",this._onPopupMouseDown.bind(this)),this.bindTo("keydown",this._onKeyDown),BEM.blocks["m-suggest-item"].on(this._popup.domElem,{mouseover:this._onMouseOverInItem,mouseout:this._onLeaveItem,click:this._onClickItem},this),BEM.DOM.init(this._popup.domElem)),this._popup},_onLeaveItem:function(t,e){e.toElement&&($(t.block.domElem[0]).has(e.toElement).length||t.block.domElem[0]===e.toElement)||(this._items[this._curItemIndex]&&this._items[this._curItemIndex].delMod("hovered"),this._curItemIndex=-1)},_onInputBlur:function(){this._popup&&!this._notHide&&this._popup.delMod("visible"),this._notHide=!1},_onClickItem:function(t){this._selectItem(t.block)},_onInputClick:function(t){t.stopPropagation()},_onPopupMouseDown:function(){this._notHide=!0,this._notSendRequest=1},_onPopupClick:function(){setTimeout(function(){this._input.elem("control")[0].focus()}.bind(this),0)},_onPopupShow:function(){this.trigger("popup-shown")._isPopupShown=!0,this._input.unbindFrom("mousedown"),this._lastInputVal=this._input.val()},_onPopupHide:function(){this.trigger("popup-hidden")._curItemIndex=-1,this._input.bindTo("mousedown",this._showHiddenPopup.bind(this)),this._isPopupShown=!1,BEM.blocks["m-suggest-item"].un(this._popup.domElem,"mousemove",this._onMouseMoveInItem,this)},_showHiddenPopup:function(){!this._isPopupShown&&this._update()},_selectItem:function(t,e,i){!i&&this.trigger("select",t.params.fullData)},_toggleItem:function(t){BEM.blocks["m-suggest-item"].on(this._popup.domElem,"mousemove",this._onMouseMoveInItem,this),this._items[this._curItemIndex]&&this._items[this._curItemIndex].delMod("hovered"),this._curItemIndex+=38===t?-1:1,this._curItemIndex===this._items.length&&(this._curItemIndex=-1),-2===this._curItemIndex&&(this._curItemIndex=this._items.length-1),this._items[this._curItemIndex]&&this._items[this._curItemIndex].setMod("hovered","yes")},_onMouseOverInItem:function(t){var e;t.block.hasMod("hovered")||(this._items[this._curItemIndex]&&this._items[this._curItemIndex].hasMod("hovered")&&this._items[this._curItemIndex].delMod("hovered"),e=this._items.indexOf(t.block),this._curItemIndex=e,this._items[this._curItemIndex].setMod("hovered","yes"))},_onMouseMoveInItem:function(t){this._onMouseOverInItem(t),BEM.blocks["m-suggest-item"].un(this._popup.domElem,"mousemove",this._onMouseMoveInItem,this)},_onKeyDown:function(t){this._isPopupShown&&(38===t.keyCode||40===t.keyCode?(t.preventDefault(),this._toggleItem(t.keyCode)):13===t.keyCode&&this._curItemIndex>-1&&(t.preventDefault(),this._selectItem(this._items[this._curItemIndex],!0)))},_getItemBEMJSON:function(t,e,i){return{block:"m-suggest-item",mods:{type:t,size:this.getMod("size"),link:i?"yes":"",labels:this.params.inHeader||this.params.inSearchHeader?"yes":"","in-search-header":this.params.inSearchHeader&&"yes"},data:e,inputData:{text:this._getInputValue4Request(),offset:this._input.findElem("box").offset(),width:this._input.domElem.outerWidth()},inSearchHeader:this.params.inSearchHeader}},_disable:function(){this._popup&&this._popup.delMod("visible"),this._input&&this._input.setMod("disabled","yes")},_enable:function(){this._input&&this._input.delMod("disabled")},destruct:function(){this._popup&&(this._popup.un("beforeOpen"),this._popup.un("beforeClose"),BEM.DOM.destruct(this._popup.domElem)),this.__base.apply(this,arguments)}},{REQUEST_TYPE:"GET",REQUEST_DATA_TYPE:"jsonp",REQUEST_TIMEOUT:2e4}),BEM.DOM.decl({block:"m-suggest"},{onSetMod:{js:function(){this._input=this.findBlockInside("textinput")||this.findBlockInside("input"),this._input.on("change focus",this._update,this).on("blur",this._onInputBlur,this),this._input.bindTo(this._input.elem("control"),"click",this._onInputClick),this._input.elem("clear").length&&this._input.bindTo(this._input.elem("clear"),"click",this._onClearText.bind(this)),this.hasMod("disabled","yes")&&this._disable(),this._notSendRequest=0,this.state={val:null,result:null},this.on("state-update",function(){this.render()})}},hidePopup:function(){var t=this._getPopup();t&&t.delMod("visible")},_selectItem:function(t,e,i){!i&&this.trigger("select",{entityData:t.params.fullData,fromKeyboard:e})},_onMouseOverInItem:function(t){this.__base.apply(this,arguments),t.block.hasMod("hovered")||this.trigger("item-highlighted",this._curItemIndex)},_toggleItem:function(t){this.__base.apply(this,arguments),-1===this._curItemIndex?this.trigger("item-unhighlighted"):this.trigger("item-highlighted",this._curItemIndex)},_onLeaveItem:function(t,e){this.__base.apply(this,arguments),this.trigger("item-unhighlighted")},_getPopupBEMJSON:function(){var t=this.__base();return this.params.maxPopupHeight&&(t.content.attrs={style:"max-height: "+this.params.maxPopupHeight+"px"}),t}}),BEM.DOM.decl({block:"m-suggest-item"},{},{live:function(){return this.liveBindTo("click mousedown mouseout mousemove mouseover",function(t){this.trigger(t.type,t)}),!1}}),BEM.DOM.decl({block:"m-editor-popup",modName:"type",modVal:"form"},{onSetMod:{js:function(){this._bindEvents(),this._setDefaults(),this._positionPopup(),this._createForm()},loading:function(t,e){this._getSpin().toggleMod("progress","yes",Boolean(e))}},_bindEvents:function(){var t=this._getPopup();t.on("beforeOpen",this._beforePopupOpen,this),t.on("beforeClose",this._beforePopupClose,this)},_setDefaults:function(){var t=this.params.forms||{};this._formId=0,this._formOptions=$.extend({apiUrl:"https://api.study.yandex-team.ru:9514/admin/api/v2/surveys/",adminUrl:"https://admin.forms.yandex-team.ru/#/surveys/",groupId:9,user:"login"},t)},_createForm:function(){var t=this,e=this._formOptions,i=this._createFormName();this.setMod("loading","yes"),$.ajax({url:e.apiUrl,contentType:"application/json; charset=utf-8",type:"POST",dataType:"json",crossDomain:!0,data:JSON.stringify({group_id:e.groupId,name:i}),timeout:5e3,xhrFields:{withCredentials:!0}}).then(function(e){t._onFormCreate(e)},function(e){t._onFormCreateError(e)}).always(function(){t.delMod("loading")})},_onFormCreate:function(t){t.id?(this._formId=t.id,this._setIframeSrc()):this.trigger("error",{message:"API Error: form id parameter is missing",data:t})},_onFormCreateError:function(t){this.trigger("error",{message:"API Error: cannot create form",data:t})},_createFormName:function(){var t=(new Date).toISOString();return t=t.substring(0,19).replace(/[T:]/g,"-"),this._formOptions.user+"-"+t},_setIframeSrc:function(){var t=this._formOptions.adminUrl+this._formId+"/";this.elem("iframe").attr("src",t)},_getSpin:function(){return this._spin||(this._spin=this.findBlockOn("loading","spin2")),this._spin},_getPopup:function(){return this._popup||(this._popup=this.findBlockOutside("popup2")),this._popup},processParams:function(t){var e="",i=$.extend({formId:0},t);return i.formId&&(e='\n{{forms id="'+i.formId+'"}}\n'),e},getText:function(){return this.processParams({formId:this._formId})},_beforePopupClose:function(){this.trigger("popupClose",{formId:this._formId})},_beforePopupOpen:function(){var t=this._getPopup();t.afterCurrentEvent(function(){t.unbindFromWin("scroll resize")},this)},_positionPopup:function(){var t=this._getPopup();t.afterCurrentEvent(function(){t.domElem.css({left:0,right:0})},this)}}),BEM.DOM.decl({block:"m-editor-popup",modName:"type",modVal:"form"},{_bindEvents:function(){this.__base.apply(this,arguments),this.on("error",this._onError,this)},_onError:function(t,e){BEM.channel("notification").trigger("error",e)},_setIframeSrc:function(){var t=this._formOptions.adminUrl+this._formId+"/edit";this.elem("iframe").attr("src",t)}}),BEM.DOM.decl({block:"m-editor-popup",modName:"type",modVal:"video"},{onSetMod:{js:function(){var t=BEM.blocks.keycodes;this._codeInput=this.findBlockInside({block:"textinput",modName:"video",modVal:"link"}),this._popup2=this.findBlockOutside({block:"popup2",modName:"editor",modVal:"yes"}),this._notifier||(this._notifier=BEM.create("mi-notifier",{icons:!0,autoclosable:!0,delay:4e3})),this.bindTo(this._codeInput.domElem,"keyup",function(e){e.keyCode===t.ENTER&&this._popup2._addButton.trigger("click")})}},destruct:function(t){this._notifier.destruct(),this.__base(t)},getVideoTag:function(t){return'<#<video src="'+t+'" width="640" height="480" controls="controls"/>'+BEM.I18N("m-editor-popup","notSupportVideo")+'. <a href="'+t+'" target="_blank">'+BEM.I18N("m-editor-popup","downloadVideo")+"</a></video>#>"},getAudioTag:function(t){return'<#<audio src="'+t+'" controls="controls"/>'+BEM.I18N("m-editor-popup","notSupportAudio")+'. <a href="'+t+'" target="_blank">'+BEM.I18N("m-editor-popup","downloadAudio")+"</a></audio>#>"},getIframeTag:function(t,e,i){return'{{iframe src="'+t+'" frameborder="0" width="'+e+'" height="'+i+'"}}'},processParams:function(t){var e,i,n,s="";return(e=$.extend({},{videoSrc:""},t)).videoSrc&&(i=this._rawCodeParser(),$.isPlainObject(i)?i.src?(e.videoWidth=i.width||"560",e.videoHeight=i.height||"315",n=i.src,i.video?s=this.getVideoTag(n):i.audio?s=this.getAudioTag(n):i.default?(s="(("+n+"))",this._notifier.error(BEM.I18N("m-editor-popup","srcLinkError"))):s=this.getIframeTag(n,e.videoWidth,e.videoHeight)):this._notifier.error(BEM.I18N("m-editor-popup","videoParserError")):this._notifier.error(BEM.I18N("m-editor-popup","videoLinkError"))),s},_rawCodeParser:function(){var t,e=this._codeInput.val();if(e){for(var i=0;i<this.parsers.length&&(t=this.parsers[i](e),!$.isPlainObject(t));i++);$.isPlainObject(t)||(t=this._parseDefaultUrl(e))}return t},parsers:[function(t){var e,i,n=t.match(/^(?:<iframe )([^>]+)(?:>)(?:.*)(?:<\/iframe>)$/),s={};if(null!==n){if(""!==n[1])for(var o=0,r=(e=n[1].split(" ")).length;o<r;o++)null!==(i=e[o].match(/(^[^\=]+)\=(\S+)/))&&(i[2]=i[2].replace(/(^"|')([^"']+)("|'$)/,"$2"),s[i[1]]=i[2]);return{src:s.src||"",width:s.width||"",height:s.height||""}}},function(t){if(null!==t.match(/^((https?:\/\/)(w{3}\.)?|(w{3}\.))\S+\.(mp4|ogv|ogg|webm|mov)$/i))return{video:!0,src:t}},function(t){if(null!==t.match(/^((https?:\/\/)(w{3}\.)?|(w{3}\.))\S+\.(mp3)$/i))return{audio:!0,src:t}},function(t){var e=t.match(/youtube\.com\/watch\?v=([^&]+)|youtu\.be\/(\S+)$/i);if(null!==e)return{src:"https://www.youtube.com/embed/"+(e[1]||e[2])}},function(t){var e=t.match(/vimeo\.com\S*\/([0-9]+)$/i);if(null!==e)return{src:"https://player.vimeo.com/video/"+e[1],width:"500",height:"281"}},function(t){var e=t.match(/coub\.com\/view\/(\S+)$/i);if(null!==e)return{src:"https://coub.com/embed/"+e[1]+"?muted=false&autostart=false&originalSize=false&hideTopBar=false&startWithHD=false",width:"480",height:"270"}},function(t){var e=t.match(/music\.yandex\.(ru|ua|kz|by)\/(?:album\/(.*)\/|users\/(.*)\/)?(album|track|artist|playlists)\/(\d+)/i);if(null!==e){var i,n,s=e[1],o=void 0!==e[2]?e[2]:"",r=e[3],a=e[4],c=e[5],l="https://music.yandex."+s+"/iframe/#";switch(a){case"album":l+="album/"+c,i="450",n="400";break;case"track":l+="track/"+c+"/"+o,i="500",n="100";break;case"artist":l+="artist/"+c,i="500",n="600";break;case"playlists":l+="playlist/"+r+"/"+c,i="500",n="400"}return{src:l,width:i,height:n}}}],_parseDefaultUrl:function(t){var e=t.match(/^((https?:\/\/)(w{3}\.)?|(w{3}\.))\S+$/i);if(null!==e)return{src:e[0],default:!0}}}),BEM.DOM.decl("mi-editor-history",{_historyStack:[],_suppressEvents:!1,onSetMod:{js:function(){this._control=this.findBlockOn("textarea"),this._control&&this._attach()}},destruct:function(){this._unSubscribeOnChange(this._control),this.__base.apply(this,arguments)},_attach:function(){this._currentState=this.__self._getCurrentState(this._control),this._debounceHandler=$.debounce(this._onTextChange,this.__self.DEBOUNCE_TIME,this),this._currentState.text||(this._currentState=null),this._subscribeOnChange(this._control),this._subscribeUndo()},_subscribeOnChange:function(t){t.on("change",this._debounceHandler,this)},_unSubscribeOnChange:function(t){t.un("change",this._debounceHandler,this)},_subscribeUndo:function(){window.keymaster("command+z, ctrl+z",function(t){this._historyStack.length&&this._control&&this._control.hasMod("focused","yes")&&(t.preventDefault(),this._undoHistory())}.bind(this))},_onTextChange:function(){this._currentState&&(this._historyStack.push(this._currentState),this._currentState=null),this._currentState=this.__self._getCurrentState(this._control),this._historyStack=this.__self._cleanUpStack(this._historyStack)},_setText:function(t){this._unSubscribeOnChange(this._control),this._suppressEvents=!0,this._control.val(t),this.afterCurrentEvent(function(){this._subscribeOnChange(this._control)})},_undoHistory:function(){var t=this._historyStack.pop();this._setText(t.text),this._currentState=t,this.__self._trySetSelection(this._control.elem("control"),t)}},{DEBOUNCE_TIME:300,MAX_STACK_SYMBOLS:1e5,_getCurrentState:function(t){return t?{text:t.val(),selectionStart:t.elem("control")[0].selectionStart,selectionEnd:t.elem("control")[0].selectionEnd}:null},_cleanUpStack:function(t){if(t.length%10!=0)return t;for(;this._getStackLength(t)>this.MAX_STACK_SYMBOLS;)t.shift();return t},_getStackLength:function(t){var e=0;return t.forEach(function(t){e+=t.text.length}),e},_trySetSelection:function(t,e){if(!e.selectionStart||!e.selectionEnd)return!1;try{return t[0].setSelectionRange(e.selectionStart,e.selectionEnd),!0}catch(t){return!1}}}),BEM.decl("mi-editor-drafts",{onSetMod:{js:function(){this._settings=$.extend({},this.__self._settings,this.params),this._settings.key||(this._settings.key=document.location.href+(this._settings.id?"#"+this._settings.id:"")),this._bag=new window.Bag({prefix:this.__self._indexedDBPrefix,stores:["indexeddb"]}),this._scheduleCleaning()}},get:function(){var t=this,e=$.Deferred();return this._bag.get(this._settings.key,function(i,n){return n?t.__self._isCurrentVersion(n)?void e.resolve(n.items):(t._bag.clear(),e.resolve([])):e.resolve([])}),e.promise()},store:function(t){var e=$.Deferred(),i={version:this.__self.version,saveDate:Date.now(),items:t};return this._bag.set(this._settings.key,i,this._settings.timeToLive/1e3,function(i){i?e.reject(i):e.resolve(t)}),e.promise()},_scheduleCleaning:function(){setTimeout(function(){this._bag.clear(!0)}.bind(this),1e4)}},{version:1,_indexedDBPrefix:"drafts",_settings:{timeToLive:6048e5},_isCurrentVersion:function(t){return t&&t.version&&t.version===this.version}}),BEM.DOM.decl("w-raw",{onSetMod:{js:{inited:function(){BEM.blocks["wi-notification"].createNotification("info",BEM.I18N("w-raw","large_page")),BEM.WISTORE.get("page").get("withNewWf")&&Ya&&Ya.Rum&&Ya.Rum.logError&&Ya.Rum.logError({message:"wf_render_timeout",level:"error",additional:{supertag:BEM.WISTORE.get("page").get("superTag")}})}}}}),BEM.DOM.decl("w-nps",{_cancelForceSchool:function(){$.cookie("wid","",{path:"/"}),location.reload()}},{live:function(){this.liveBindTo("school-link","click",function(){this._cancelForceSchool()})}}),BEM.DOM.decl("dropdown2",{onSetMod:{js:{inited:function(){this._switcher=null,this._popup=null}},opened:{yes:function(){if(this.hasMod("disabled"))return!1;this.trigger("beforeOpen").getPopup().setAnchor(this.getSwitcher()).setMod("visible","yes").on("beforeClose",this._onPopupBeforeClose,this)},"":function(){this.trigger("beforeClose").getPopup().delMod("visible").un("beforeClose",this._onPopupBeforeClose,this)}},disabled:{"*":function(t,e){this.getSwitcher().setMod(t,e)},yes:function(){this.delMod("opened")}}},getPopup:function(){return this._popup||(this._popup=this.findBlockInside("popup2")),this._popup},getSwitcher:function(){return this._switcher||(this._switcher=this.findBlockInside(this.getMod("switcher"))),this._switcher},_onPopupBeforeClose:function(){this.delMod("opened")},_onSwitcherClick:function(t){this._switcher||(this._switcher=t.block),this.toggleMod("opened","yes")}},{live:!0}),BEM.DOM.decl("b-page-more",{onSetMod:{js:{inited:function(){this._createPageMorePanel(),this.findBlockOn("button2").on("click",this._toggle,this),this.channel("getting-started").on("open-user-menu",this._open,this)}}},_toggle:function(){this._popup.toggleMod("visible","yes","")},_createPageMorePanel:function(){var t=this.params.pageData;this._popup||(this._popup=BEM.DOM.after(this.domElem,BEMHTML.apply({block:"popup2",mods:{theme:"normal",target:"anchor",autoclosable:"yes"},directions:["bottom-right"],content:{block:"b-page-more-panel",actuality:BEM.blocks["i-global"].getbPage().getMod("actuality"),user:t.user,breadcrumbs:t.data.breadcrumbs,redirect:BEM.WISTORE.get("page").get("redirect")}})).bem("popup2").setAnchor(this.domElem),this._popup.findBlockInside("b-page-more-panel").bindTo("click",function(){this._popup.delMod("visible")}.bind(this)))}}),BEM.DOM.decl("w-action",{onSetMod:{js:function(){this.bindTo(this.domElem,"mouseup",this._onClick.bind(this))},progress:{yes:function(){var t=this._getProgressBlocks();t.paranja.open(),t.spinner.setMod("progress","yes")},"":function(){var t=this._getProgressBlocks();t.paranja.close(),t.spinner.delMod("progress")}}},_onClick:function(t){this._run(t)},_run:function(){var t=!0,e=BEM.WISTORE.get("page");return!e||!e.get("redirect")||-1!==this.__self._allowWidgetsOnRedirectPage.indexOf(this.getMod("type"))||this.params&&this.params.isAction||(t=!1,this._redirectMessageWidget||(this._redirectMessageWidget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"redirect-message"}})).bem("b-widget")),this._redirectMessageWidget.show()),t},_showOutside:function(t,e){var i=!0;return this.params.isAction?this.__self._isNewTabClick(t)?window.open(this.params.source+"/"+e,"_blank").focus():location.href=this.params.source+"/"+e:this.__self._isNewTabClick(t)?window.open(BEM.blocks["wi-history"].getCorrectPath()+e,"_blank").focus():i=!1,i},_getProgressBlocks:function(){return this.__self._progressBlocks||(this.__self._progressBlocks={paranja:BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"paranja",mods:{type:"widget-progress"}})).bem("paranja"),spinner:BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"spin2",mods:{size:"m",type:"widget-progress"}})).bem("spin2")}),this.__self._progressBlocks},_pushState:function(t,e){BEM.blocks["wi-history"].pushState(e)}},{_isNewTabClick:function(t){return t&&"mouseup"===t.type&&(keymaster.command||keymaster.ctrl||2===t.which)},_allowWidgetsOnRedirectPage:["settings","sub","tree"]}),BEM.DOM.decl("paranja",{onSetMod:{js:{inited:function(){[].concat(this.params.rel||[]).forEach(function(t){$(t.elem||this.domElem).on(t.event,this[t.method].bind(this))},this),this.bindTo("pointerclick",function(){this.trigger("click")})}},state:{open:function(){this.trigger("open")},close:function(){this.trigger("close")}}},open:function(t){this.setMod("state","open")},close:function(t){this.setMod("state","close")}},{live:!1}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"delete"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.delete",this._run,this)}},_onGetData:function(t,e,i){this._widget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"page-delete"},js:{pages:e.data.wiki_pages,users:i.data,breadcrumbs:this.params.breadcrumbs}})).bem("b-widget"),this._widget.show(),this._pushState(t,".delete")},_onGetDataError:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("w-action","cant_load_data"),t))},_run:function(t,e){this.__base.apply(this,arguments)&&BEM.WISTORE.get("page").get("canEdit")&&(this._showOutside(t,".delete")||(this._widget?(this._widget.show(),this._pushState(e,".delete")):(this.setMod("progress","yes"),$.when(BEM.create("wi-api-request",{apiPath:".referrers",method:"GET",data:!1,urlParams:"",path:BEM.blocks["wi-history"].getCorrectPath()}).run(),BEM.create("wi-api-request",{apiPath:".watchers",method:"GET",data:!1,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run()).then(this._onGetData.bind(this,e),this._onGetDataError.bind(this)).always(function(){this.delMod("progress")}.bind(this)))))}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"move"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._bPage=BEM.blocks["i-global"].getbPage(),this._path=this.params.source||BEM.blocks["wi-history"].getCorrectPath(),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-move",this._run,this)}},_movePage:function(t){var e;this._moveWidget?(this._moveWidget.show(),this._pushState(t,".move")):(e=BEMHTML.apply({block:"b-widget",mods:{type:"page-move","page-move":this.params.type},js:{type:this.params.type}}),BEM.DOM.append(this._bPage.domElem,e),this._initWidget(t))},_initWidget:function(t){BEM.create("wi-api-request",{apiPath:".move",method:"GET",data:!1,urlParams:!1,path:this._path}).run().then(this._onSuccess.bind(this,t),BEM.blocks["wi-notification"].errorHandler())},_onSuccess:function(t,e){this._moveWidget=this._bPage.findBlockInside({block:"b-widget",modName:"page-move",modVal:this.params.type}),this._moveWidget.params.data=e.data,this._moveWidget.params.ajaxPath=this._path,this._moveWidget.show(),this._pushState(t,".move")},destruct:function(){BEM.channel("common").un("w-action.create-move"),this.__base.apply(this,arguments)},_run:function(t,e){this.__base.apply(this,arguments)&&(this._showOutside(t,".move")||this._movePage(e))}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"old-page"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.__self._bPage||(this.__self._bPage=BEM.blocks["i-global"].getbPage()),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-old-page",this._run,this)}},_initWidget:function(){var t=this,e=this.__self._widget;this.__self._linksContainer=e.findElem("links"),this.__self._addLinksButton=e.findBlockInside("link"),this.__self._cancelButton=e.findBlockInside({block:"button2",modName:"role",modVal:"old-page-cancel"}),this.__self._sendButton=e.findBlockInside({block:"button2",modName:"role",modVal:"old-page"}),this.__self._spinner=e.findBlockInside({block:"spin2",modName:"type",modVal:"old-page"}),this.__self._addLinksButton.bindTo("click",function(){BEM.DOM.append(t.__self._linksContainer,BEMHTML.apply({block:"b-widget",elem:"link",content:{block:"input",mods:{size:"s"},placeholder:BEM.I18N("w-action","link_wiki_page"),content:[{elem:"control"}]}}))}),this.__self._cancelButton.on("click",function(){e.hide()}),this.__self._sendButton.on("click",function(){var i,n=e.findBlockInside(e.elem("comment"),"input"),s=e.findBlocksInside(t.__self._linksContainer,"input"),o=e.getMod("actuality"),r=[];s.forEach(function(t){var e=t.val();e&&r.push(e)}),i={actual:"actual"!==o,comment:n.val(),links:r},t.__self._spinner.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".actuality",method:"POST",data:i,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(t._onSuccess.bind(t),BEM.blocks["wi-notification"].errorHandler(t.__self._sendButton.domElem,BEM.I18N("w-action","mark_failed"))).always(function(){t.__self._spinner.delMod("progress")})})},_onSuccess:function(){var t="actual"===this.__self._widget.getMod("actuality")?"obsolete":"actual";BEM.WISTORE.get("page").set("isOld","obsolete"===t);var e,i=this.__self._bPage.findBlockInside({block:"b-page-more-panel-item",modName:"type",modVal:"old-page"}),n=this.__self._bPage.findBlockInside({block:"b-grid-table-options-item",modName:"action",modVal:"old-page"}),s=i||n;this.__self._widget.hide(),this._refreshWidgetForm(),"possibly-obsolete"===this.__self._bPage.getMod("actuality")&&(e=this.__self._bPage.findBlockInside({block:"w-page-info",modName:"type",modVal:"possibly-obsolete"}))&&e.hide(),this.__self._bPage.setMod("actuality",t),s&&(s.domElem.text("obsolete"===t?BEM.I18N("w-action","mark_as_actual"):BEM.I18N("w-action","mark_as_obsolete")),s.findBlockOn({block:"w-action",modName:"type",modVal:"old-page"}).params.actuality=t)},_refreshWidgetForm:function(){var t=this.__self._widget,e=t.findBlockInside(t.elem("comment"),"input"),i=t.findBlocksInside(this.__self._linksContainer,"input");e.val(""),i.forEach(function(t,e){t.val(""),e>0&&t.destruct()})},destruct:function(){BEM.channel("common").un("w-action.create-old-page"),this.__base.apply(this,arguments)},_run:function(t,e){this.__base.apply(this,arguments)&&this.afterCurrentEvent(function(){var i;this.__self._isNewTabClick(t)?window.open(BEM.blocks["wi-history"].getCorrectPath()+".obsolete","_blank").focus():(this._pushState(e,".obsolete"),this.__self._widget||(i=BEMHTML.apply({block:"b-widget",mods:{type:"old-page"}}),BEM.DOM.append(this.__self._bPage.domElem,i),this.__self._widget=this.__self._bPage.findBlockInside({block:"b-widget",modName:"type",modVal:"old-page"}),this._initWidget()),this.__self._widget.setMod("actuality",this.params.actuality),this.__self._widget.show())})}}),BEM.DOM.decl("b-old-page-mark",{onSetMod:{js:function(){this.bPage=BEM.blocks["i-global"].getbPage(),this._popup=this.findBlockInside("popup2").setAnchor(this.domElem)}},_onClick:function(){this._popup.hasMod("visible","yes")?this._popup.delMod("visible"):this._showPopup()},_showPopup:function(){this._loaded?this._popup.setMod("visible","yes"):BEM.create("wi-api-request",{apiPath:".actuality",path:BEM.blocks["wi-history"].getCorrectPath(),urlParams:["format=json"]}).run().then(this._onGotData.bind(this),this._onFailedData.bind(this))},_onGotData:function(t){var e=BEMHTML.apply(this._getContentBEMJSON(t.data)),i=this;BEM.DOM.append(this._popup.elem("content"),e),this._button=this._popup.findBlockInside({block:"button2",modName:"type",modVal:"old-page-mark"}),this._button.on("click",function(){i._popup.delMod("visible")},this),this._popup.setMod("visible","yes"),this._loaded=!0},_getContentBEMJSON:function(t){var e=t.marked_at,i=t.user,n=t.comment,s=t.links,o=[];return e&&i&&o.push({block:"b-old-page-mark",elem:"user-date",content:[{block:"m-username",mods:{dismissed:i.is_dismissed?"yes":""},mix:[{block:"mi-staff-card",js:{user:i.login}}],url:"//staff.yandex-team.ru/"+i.login,content:i.display},": "+BEM.I18N("b-old-page-mark","marked_obsolete")+" ",{block:"m-date",format:"full",timestamp:e}]}),n&&o.push({block:"b-old-page-mark",elem:"comment",content:n}),s&&s.length&&(o.push({block:"b-old-page-mark",elem:"links-title",content:BEM.I18N("b-old-page-mark","actual_pages")+":"}),s.forEach(function(t){o.push({block:"b-old-page-mark",elem:"link",content:{block:"link",url:t,content:t}})})),o.push({block:"b-old-page-mark",elem:"button",content:{block:"button2",mods:{size:"s",type:"old-page-mark",theme:"normal"},mix:[{block:"w-action",mods:{type:"old-page"},js:{actuality:"obsolete"}}],text:BEM.I18N("b-old-page-mark","unmark")}}),o},_onFailedData:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,t)),this._popup.setMod("visible","yes")}},{live:function(){this.liveBindTo("click",function(t){this._onClick(t)})}}),BEM.DOM.decl("b-old-page-mark",{_getContentBEMJSON:function(t){var e=t.marked_at,i=t.user,n=t.comment,s=t.links,o=[];return e&&i&&o.push({block:"b-old-page-mark",elem:"user-date",content:[{block:"m-username",mods:{is_dismissed:i.is_dismissed?"yes":""},content:i.display,login:i.login},": "+BEM.I18N("b-old-page-mark","marked_obsolete")+" ",{block:"m-date",format:"full",timestamp:e}]}),n&&o.push({block:"b-old-page-mark",elem:"comment",content:n}),s&&s.length&&(o.push({block:"b-old-page-mark",elem:"links-title",content:BEM.I18N("b-old-page-mark","actual_pages")+":"}),s.forEach(function(t){o.push({block:"b-old-page-mark",elem:"link",content:{block:"link",url:t,content:t}})})),o.push({block:"b-old-page-mark",elem:"button",content:{block:"button2",mods:{size:"s",type:"old-page-mark",theme:"normal"},mix:[{block:"w-action",mods:{type:"old-page"},js:{actuality:"obsolete"}}],text:BEM.I18N("b-old-page-mark","unmark")}}),o}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"settings"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._path=this.params.source||BEM.blocks["wi-history"].getCorrectPath(),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-settings",this._run,this)}},_onGotSettingsData:function(t,e,i,n,s,o){var r=BEM.WISTORE.get("page"),a=r&&r.get("redirect");Array.isArray(s)||(s=s.data.authors),this._settingsWidget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"page-settings"},js:{redirect:e.data.redirect_to_tag,keywords:i.data.keywords,authors:s,canEdit:this.params.user.is_admin||s.some(function(t){return t.login===this.params.user.login},this),ajaxPath:this._path,isRedirectPage:a,comments:n.data,readonly:o.data.is_readonly}})).bem("b-widget"),this._settingsWidget.show(t&&t.tab),this._pushState(t,".settings")},_onFailedSettingsData:function(){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("w-action","cant_get_settings")))},destruct:function(){BEM.channel("common").un("w-action.create-settings"),this.__base.apply(this,arguments)},_run:function(t,e){var i=this.__base.apply(this,arguments),n=e&&e.tab,s=BEM.WISTORE.get("page"),o=s&&s.get("authors");i&&(this.params.isAction?this.__self._isNewTabClick(t)?window.open(this.params.source+"/.settings","_blank").focus():location.href=this.params.source+"/.settings":this.__self._isNewTabClick(t)?window.open(BEM.blocks["wi-history"].getCorrectPath()+".settings","_blank").focus():this._settingsWidget?(this._pushState(e,".settings"),this._settingsWidget.show(n)):(this.setMod("progress","yes"),$.when(BEM.create("wi-api-request",{apiPath:".redirect",method:"GET",path:this._path}).run(),BEM.create("wi-api-request",{apiPath:".keywords",method:"GET",path:this._path}).run(),BEM.create("wi-api-request",{apiPath:".comments/status",method:"GET",data:!1,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run(),o||BEM.create("wi-api-request",{apiPath:".authors",method:"GET",path:this._path}).run(),BEM.create("wi-api-request",{apiPath:".readonly",method:"GET",data:!1,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run()).then(this._onGotSettingsData.bind(this,e),this._onFailedSettingsData.bind(this)).always(function(){this.delMod("progress")}.bind(this))))}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"sub"},{_run:function(){this.__base.apply(this,arguments)&&(yaCounter&&yaCounter.reachGoal("create_subpage"),BEM.channel("common").trigger("b-head.newPageCreate"))}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"subscribe"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-subscribe",this._run,this)}},_run:function(t,e){this.__base.apply(this,arguments)&&(this.__self._isNewTabClick(t)?window.open(BEM.blocks["wi-history"].getCorrectPath()+".subscribe","_blank").focus():(this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".watchers",method:"GET",data:!1,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onGetSubscribers.bind(this,e),this._onFailGetSubscribers.bind(this)).always(function(){this.delMod("progress")}.bind(this))))},_onGetSubscribers:function(t,e){var i=e.data,n=t&&t.subscribersTab;this._pushState(t,".subscribe"),this._widget||(this._widget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"subscribe",subscribers:n?"yes":""},subscribers:i})).bem("b-widget")),this._widget.show(!1,i,n)},_onFailGetSubscribers:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("w-action","cant_load_subscribers"),t))},_pushState:function(t,e){t&&t.subscribersTab||BEM.blocks["wi-history"].pushState(e)}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"tree"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-tree",this._run,this)}},destruct:function(){BEM.channel("common").un("w-action.create-tree"),this.__base.apply(this,arguments)},_run:function(t,e){this.__base.apply(this,arguments)&&(this._showOutside(t,".tree")||(this._treeWidget?(this._treeWidget.show(e),this._pushState(e,".tree")):(this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".tree",method:"GET",data:!1,urlParams:["depth=3","show_redirects=True","show_grids=True","show_titles=True","nomark=True"],path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onGotTreeData.bind(this,e),this._onFailGotTreeData.bind(this)).always(function(){this.delMod("progress")}.bind(this)))))},_onGotTreeData:function(t,e){e.data?(this._treeWidget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"tree"},data:e.data})).bem("b-widget"),this._treeWidget.show(t),this._pushState(t,".tree")):this._onFailGotTreeData()},_onFailGotTreeData:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("w-action","cant_get_tree"),t))}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"unsubscribe"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-unsubscribe",this._run,this)}},destruct:function(){BEM.channel("common").un("w-action.create-unsubscribe"),this.__base.apply(this,arguments)},_run:function(t,e){this.__base.apply(this,arguments)&&(this._unsubscribeWidget||(this._unsubscribeWidget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"unsubscribe"}})).bem("b-widget")),this._unsubscribeWidget.show())}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"referrers"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-referrers",this._run,this)}},_onGetData:function(t){this._widget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"referrers"},js:{pages:t.data.wiki_pages}})).bem("b-widget"),this._widget.show(),BEM.blocks["wi-history"].pushState(".referrers")},_onGetDataError:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("w-action","cant_load_data"),t))},_run:function(t){this.__base.apply(this,arguments)&&(this._showOutside(t,".referrers")||(this._widget?(this._widget.show(),BEM.blocks["wi-history"].pushState(".referrers")):(this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".referrers",method:"GET",data:!1,urlParams:"",path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onGetData.bind(this),this._onGetDataError.bind(this)).always(function(){this.delMod("progress")}.bind(this)))))}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"files"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.open-sidebar-files",this._run,this)}},_run:function(){this.__base.apply(this,arguments)&&BEM.channel("sidebar").trigger("tab:select",{tabName:"files"})}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"export"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._bPage=BEM.blocks["i-global"].getbPage(),this._path=this.params.source||BEM.blocks["wi-history"].getCorrectPath(),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-export",this._run,this)}},_export:function(t){var e;this._exportWidget?(this._exportWidget.show(),this._pushState(t,".export")):(e=BEMHTML.apply({block:"b-widget",mods:{type:"page-export"},js:{pageTitle:BEM.WISTORE.get("page").get("title")}}),BEM.DOM.append(this._bPage.domElem,e),this._getWidgetData(t))},_getWidgetData:function(t){$.when(BEM.create("wi-api-request",{apiPath:".move",method:"GET",data:!1,urlParams:!1,path:this._path}).run(),BEM.create("wi-api-request",{apiPath:".export_filename",method:"GET",data:!1,urlParams:!1,path:this._path}).run()).then(this._onSuccessGetWidgetData.bind(this,t),BEM.blocks["wi-notification"].errorHandler())},_onSuccessGetWidgetData:function(t,e,i){this._exportWidget=BEM.DOM.append(this._bPage.domElem,BEMHTML.apply({block:"b-widget",mods:{type:"page-export"},js:{pageTitle:BEM.WISTORE.get("page").get("title"),subpagesCount:e.data.subpages_count,filename:i.data.filename}})).bem("b-widget"),this._exportWidget.show(),this._pushState(t,".export")},destruct:function(){BEM.channel("common").un("w-action.create-export"),this.__base.apply(this,arguments)},_run:function(t,e){this.__base.apply(this,arguments)&&(this._showOutside(t,".export")||this._export(e))}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"authors"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-authors",this._run,this)}}},destruct:function(){BEM.channel("common").un("w-action.create-authors"),this.__base.apply(this,arguments)},_run:function(t){this.__base.apply(this,arguments)&&(this._showOutside(t,".authors")||(this._authorsWidget?(this._authorsWidget.show(),this._pushState(null,".authors")):(this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".authors",method:"GET",data:!1,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onGetAuthorsData.bind(this),this._onFailGetAuthorsData.bind(this)).always(function(){this.delMod("progress")}.bind(this)))))},_onGetAuthorsData:function(t){this._authorsWidget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"authors"},user:t.user,authors:t.data.authors})).bem("b-widget"),this._authorsWidget.show(),this._pushState(null,".authors")},_onFailGetAuthorsData:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("w-action","cant_get_authors"),t))}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"request-page-author"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-request-page-author",this._run,this)}},_run:function(t,e){this.__base.apply(this,arguments)&&(this._widget||(this._widget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"request-page-author"},request_login:e.params&&e.params.new_author})).bem("b-widget")),this._widget.show())}}),function(){var t={};BEM.decl("i-request",{onSetMod:{js:{inited:function(){this._preventCache=!1}}},get:function(t,e,i,n){return $.isFunction(i)||(n=i,i=this.params.onError),this._get(t,e,i,$.extend({},this.params,n)),this},_get:function(e,i,n,s){var o=this._buildCacheKey(e,s),r=t[s.cacheGroup];s.cache&&r&&o in r.data?this.afterCurrentEvent(function(){i.call(this.params.callbackCtx,r.data[o])},this):this._do(e,i,n,s)},_do:function(t,e,i,n){},_onSuccess:function(t,e,i,n){n.cache&&!this._preventCache&&this.putToCache(n,t,i),this._preventCache=!1},_buildCacheKey:function(t,e){return"string"==typeof t?t:$.param(t)},putToCache:function(e,i,n){var s=t[e.cacheGroup]||(t[e.cacheGroup]={keys:[],data:{}});s.keys.length>=e.cacheSize&&delete s.data[s.keys.shift()];var o=this._buildCacheKey(i,e);return s.data[o]=n,s.keys.push(o),this},dropCache:function(){return delete t[this.params.cacheGroup],this},getDefaultParams:function(){return{cache:!1,cacheGroup:"default",cacheSize:100,callbackCtx:this}}},{_cache:t})}(),BEM.DOM.decl("b-autocomplete-item",{val:function(){return this.params.val||this.elem("text").text()||this.domElem.text()},enter:function(){},select:function(t){},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")}},{live:function(){this.liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)})},highlight:function(t,e){if(!$.isArray(e))return t;var i,n=[],s=0,o=e.sort(function(t,e){return t[0]-e[0]}),r=[],a=-1!==t.indexOf("?"),c=function(t){if(a)return t;for(;-1!==t.indexOf("?")&&r.length;)t=t.replace("?",r[0]),r.shift();return t};return!a&&function(){for(var e,i=/\&(#\d+|#x[a-f\d]+|\w+);/gi;e=i.exec(t);)r.push(e[0]),t=t.replace(e[0],"?")}(),o.forEach(function(e){i=s>e[0]?s:e[0],n.push({tag:"span",elem:"span",content:c(t.slice(s,i))}),n.push({tag:"em",elem:"em",content:c(t.slice(i,s=e[1]))})},this),n.push({tag:"span",elem:"span",content:c(t.slice(s))}),n}}),BEM.DOM.decl("b-autocomplete-item",{},{live:function(){return this.liveBindTo("mouseover mouseout mousedown mouseup pointerover pointerout pointerdown pointerup",function(t){this.trigger(t.type)}),this.__base()}}),BEM.DOM.decl({block:"b-autocomplete-item",modName:"type",modVal:"foot"},{select:function(){return!1}}),BEM.DOM.decl("b-page-more-panel-item",{},{live:function(){this.liveBindTo("click",function(){this.trigger("click")})}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"edit"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._bPage=BEM.blocks["i-global"].getbPage(),this._button=this.findBlockOn("button2"),this._localStorage=BEM.blocks["mi-storage"],this._appStore=BEM.WISTORE.get("app"),this._bindEvents()},progress:{yes:function(){this._button.setMod("disabled","yes")},"":function(){this._button.delMod("disabled")}}},destruct:function(){BEM.channel("common").un("w-action.open-editor",this._run,this),this.__base.apply(this,arguments)},_bindEvents:function(){this.params&&this.params.isAction||BEM.channel("common").on("w-action.open-editor",this._run,this),BEM.WISTORE.get("app").on("change:view",this._onPageViewChange,this)},_run:function(t,e){var i=e.params||{};this.__base.apply(this,arguments)&&BEM.WISTORE.get("page").get("canEdit")&&(yaCounter&&yaCounter.reachGoal("edit"),this.params.revisionId&&(i.revision=this.params.revisionId),this.setMod("progress","yes"),this._getDataForEditor(i).then(function(t){var n=t.data,s=this._getEditor(),o=location.search||"?";if(n.redirect_to_tag)location.href="/"+n.redirect_to_tag+"/.edit";else{switch(i.revision&&(o=$.url.setParam(o,"revision",i.revision)),n.version&&(BEM.blocks["i-global"].pageVersion=n.version),s.open({type:this._button.params.type,body:n.body,title:n.title}),this._bPage.setMod("editor","visible"),this.delMod("progress"),1===o.length&&(o=""),this._button.params.type){case"edit":o&&!i.section?this._pushState(e,".edit"+o):-1===location.pathname.indexOf(".edit")&&this._pushState(e,".edit");break;case"create":this._bPage.setMod("new-page","visible"),this._subPagePreview()}BEM.channel("common").trigger("update",{type:"page-title",data:n.title}),this._appStore.set({action:"edit",view:"edit"})}}.bind(this)).done())},_getDataForEditor:function(t){var e=[],i=BEM.blocks["wi-history"].getCorrectPath();return t&&(t.section&&!t.revision&&e.push("section_id="+t.section),t.revision&&(this._bPage.setMod("revision","edit"),e.push("revision="+t.revision)),t.path&&(i.toLocaleLowerCase()!==t.path.toLocaleLowerCase()&&history.replaceState({url:location.pathname+location.search+"&originpath="+t.path},null,location.pathname+location.search+"&originpath="+t.path),i=t.path),t.originpath&&(i=t.originpath)),e.length||(e=!1),BEM.create("wi-api-request",{apiPath:".raw",method:"GET",data:!1,urlParams:e,path:i}).run().then(this._onGetEditorData.bind(this),this._onGetEditorDataError.bind(this))},_onGetEditorData:function(t){return t},_onGetEditorDataError:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-editor-open-button","cant_load_wiki_text"),t))},_subPagePreview:function(){this._subPageHint&&this._subPageHint.domElem.text(this._editor.params.url+"'"+BEM.I18N("b-editor-open-button","subpage_address")+"'"),this._subpageBlock||(this._subpageBlock=this._editor.findBlockInside({block:"input",modName:"type",modVal:"subpage"}),this._subPageHint=this._editor.findBlockInside("b-subpage-hint"),this._subpageBlock.on("change",function(){this._subPageHint.domElem.text(this._editor.params.url+"/"+this._subpageBlock.elem("control").val())},this))},_getEditor:function(){if(!this.__self._editor){var t=this._bPage.findBlockInside("b-content").domElem,e=BEMHTML.apply(this.__self._getEditorBemjson());BEM.DOM.after(t,e),this.__self._editor=this._bPage.findBlockInside("page-editor"),BEM.channel("common").trigger("created",{type:"editor"})}return this.__self._editor},_onPageViewChange:function(t,e){"edit"===e?this._setEditTitle():"view"===e&&"edit"===t._previousAttributes.view&&this._removeEditTitle(),BEM.WISTORE.get("page").get("canSwitchWf")&&("edit"===e?(this._getEditor().showPromoWf(),this._getEditor().changeWfTumbler(BEM.WISTORE.get("page").get("withNewWf"))):"view"===e&&"edit"===t._previousAttributes.view&&this._getEditor().hidePromoWf())},_setEditTitle:function(){0!==document.title.indexOf("* ")&&(document.title="* "+document.title)},_removeEditTitle:function(){0===document.title.indexOf("* ")&&(document.title=document.title.replace("* ",""))},_onClick:function(t){if(t.ctrlKey||t.metaKey)return!0;t.preventDefault(),this._run(t,{params:BEM.blocks["wi-history"].parseQueryParams()})}},{_getEditorBemjson:function(){var t=BEM.WISTORE.get("page");return{block:"page-editor",pageUrl:window.location.href,withNewWf:t.get("withNewWf"),canSwitchWf:t.get("canSwitchWf")}}}),BEM.DOM.decl("page-editor",{_currentKey:"",onSetMod:{js:function(){this._buttons=this.findBlockInside("m-editor-buttons"),this._closeBtn=this.findBlockInside("b-editor-close-button"),this._saveBtn=this.findBlockInside("b-editor-save-button"),this._title=this.findBlockInside("m-replacer"),keymaster("ctrl+enter, command+enter",this._saveBtn._onClick.bind(this._saveBtn)),this._wfTumbler=this.findBlockInside("wf-switcher","tumbler"),this._wfTumbler&&this._wfTumbler.on("change",this._onWfTumblerChange,this);var t="true"===(BEM.blocks["mi-storage"].getItem("split-enabled")||"true");this._splitTumbler=this.findBlockInside("split-switcher","tumbler").setMod("checked",t?"yes":"").on("change",this._onSplitTumblerChange,this),this._debouncedOnEditorChange=$.debounce(this._renderSplitPreview.bind(this),50)},preview:function(t,e){var i=e?"yes":"";this._wfTumbler&&this._wfTumbler.setMod("disabled",i),this._splitTumbler&&this._splitTumbler.setMod("disabled",i)},newwf:{true:function(){this.setMod("split",this._splitTumbler.hasMod("checked","yes"))},"":function(){this.delMod("split")}},split:{true:function(){this._split?this._currentSizes&&this._split.setSizes(this._currentSizes):this._initSplit(),this._bindSplitEvents(),this._renderSplitPreview()},"":function(){this._editorInput.domElem.attr({style:"width: 100%"}),this._editor.un("change"),this.unbindFrom(this._editorInput.elem("control"),"input",this._debouncedOnEditorChange)}}},open:function(t){var e=BEM.blocks["wi-history"].getSuperTag();this._openEditor(e),this._saveBtn.setMod("status",t.type),this._editor.setText(t.body||""),this._title.setText(t.title||""),this.hasMod("split")&&this._renderSplitPreview()},setText:function(t){this._editor.setText(t)},getText:function(){return this._editor.val()},onSuccessSubmit:function(){this._editor.revert(),this._editor.close()},changeWfTumbler:function(t){this._wfTumbler&&this._wfTumbler.val(String(t))},isNewWf:function(){return this._wfTumbler?"true"===this._wfTumbler.val():BEM.WISTORE.get("page").get("withNewWf")},showPromoWf:function(){var t=BEM.blocks["mi-storage"].getItem("wf-promo");t?t=JSON.parse(t):(t={shown:!1},BEM.blocks["mi-storage"].setItem("wf-promo",JSON.stringify(t))),t.shown||(this._wfTooltip||(this._wfTooltip=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply(this.__self._getTooltipBemjson())).bem("tooltip")),this._wfTooltip.setOwner(this._wfTumbler).setMod("shown","yes"),this._wfTooltip.elem("close").on("click",this._onPromoWfClose),this._wfTooltip.findBlocksInside("link").forEach(function(t){t.bindTo("click",function(t){t.stopPropagation()})}))},hidePromoWf:function(){this._wfTooltip&&this._wfTooltip.setMod("shown","")},_initSplit:function(){var t=this;BEM.DOM.append(this._editor.domElem,BEMHTML.apply({block:"page-editor",elem:"split-preview",attrs:{id:"split-preview"},cls:"split"})),this._split=Split(["#split-editor","#split-preview"],{sizes:[100,0],minSize:[200,200],expandToMin:!0,direction:"horizontal",onDragEnd:function(e){BEM.blocks["mi-storage"].setItem("split-sizes",JSON.stringify(e)),t._currentSizes=e}}),this._splitFormatter=new Ya.FormatterViewPort({domElem:this.findElem("split-preview")[0],settings:{renderActionsByClick:!0,extensions:{"wiki-head":null}}});var e=BEM.blocks["mi-storage"].getItem("split-sizes");return this._currentSizes=e?JSON.parse(e):[70,30],this._split.setSizes(this._currentSizes),this},_bindSplitEvents:function(){return this._editor.on("change",this._debouncedOnEditorChange),this.bindTo(this._editorInput.elem("control"),"input",this._debouncedOnEditorChange),this},_onPromoWfClose:function(){BEM.blocks["mi-storage"].setItem("wf-promo",JSON.stringify({shown:!0}))},_onWfTumblerChange:function(t,e){this.setMod("newwf",e.checked)},_onSplitTumblerChange:function(t,e){BEM.blocks["mi-storage"].setItem("split-enabled",e.checked),this.setMod("split",e.checked)},_renderSplitPreview:function(){this._splitFormatter.render(this._editor.val()),BEM.DOM.init(this.findElem("split-preview"))},_openEditor:function(t){var e=this._currentKey&&this._currentKey!==t;return this._currentKey!==t&&this._renderEditor(t),keymaster.unbind("ctrl+enter, command+enter"),keymaster("ctrl+enter, command+enter",this._saveBtn._onClick.bind(this._saveBtn)),this._editor.hasNewDraft=!1,this._editorInput=this._editor.findBlockInside("textarea"),this.setMod("newwf",this.isNewWf()),e&&(this._split=null,this.hasMod("split")&&this._initSplit()._bindSplitEvents()),this._editor},_renderEditor:function(t){var e=BEM.blocks["wi-history"].getCorrectPath(),i=BEM.blocks["i-global"].param("hosts").wikiApi.v1+"/pages"+e+".files?format=json",n=BEM.blocks["i-global"].param("hosts").formsApi+"/surveys/",s=BEM.blocks["i-global"].param("hosts").formsAdmin,o=BEMHTML.apply({block:"page-editor",elem:"editor",key:t,uploadUrl:i,formsApiUrl:n,formsAdminUrl:s,user:BEM.blocks["i-global"].param("login")});BEM.DOM.replace(this.findElem("editor"),o),this._editor=this.findBlockInside("m-editor"),this._editor.init(this._buttons),this._currentKey=t}},{_getTooltipBemjson:function(){return{block:"tooltip",mix:{block:this.getName(),elem:"wf-promo"},mods:{size:"l",theme:"promo",view:"classic",tone:"default"},js:{to:["top-right","top-left"]},content:[{elem:"close"},{elem:"description",content:{html:BEM.I18N("page-editor","wf_tooltip",{markdown:BEMHTML.apply({block:"link",mods:{theme:"dark"},url:"https://daringfireball.net/projects/markdown/syntax",target:"_blank",text:"Markdown"}),more:BEMHTML.apply({block:"link",mods:{theme:"dark"},url:"https://clubs.at.yandex-team.ru/tools/15544",target:"_blank",text:BEM.I18N("page-editor","more")+"..."})})}}]}}}),BEM.DOM.decl("page-editor",{_renderEditor:function(t){var e=BEM.blocks["wi-history"].getCorrectPath(),i=BEM.blocks["i-global"].param("hosts").wikiApi.v1+"/pages"+e+".files?format=json",n=BEMHTML.apply({block:"page-editor",elem:"editor",key:t,uploadUrl:i});BEM.DOM.replace(this.findElem("editor"),n),this._editor=this.findBlockInside("m-editor"),this._editor.init(this._buttons),this._currentKey=t}},{_getTooltipBemjson:function(){return{block:"tooltip",mix:{block:this.getName(),elem:"wf-promo"},mods:{size:"l",theme:"promo",view:"classic",tone:"default"},js:{to:["top-right","top-left"]},content:[{elem:"close"},{elem:"description",content:{html:BEM.I18N("page-editor","wf_tooltip",{markdown:BEMHTML.apply({block:"link",mods:{theme:"dark"},url:"https://daringfireball.net/projects/markdown/syntax",target:"_blank",text:"Markdown"}),more:""})}}]}}}),BEM.DOM.decl("m-replacer",{onSetMod:{js:function(){}},setText:function(t){return this.elem("text").text(t),this},getValue:function(){return this.elem("text").text()},_onClick:function(){var t=this._getInput();this.setMod("state","edit"),t.val(this.elem("text").text()),t.elem("control").focus()},_getInput:function(){return this._input||(BEM.DOM.after(this.elem("text"),BEMHTML.apply({block:this.__self._name,elem:"field"})),this._input=this.findBlockInside("input"),this._input.on("blur",this.closeInput,this),this._input.bindTo("keypress",this._onInputKeypress.bind(this))),this._input},_onInputKeypress:function(t){13===t.keyCode&&this.closeInput()},closeInput:function(){this.setMod("state","view"),this._input.val()&&this.elem("text").text(this._input.val()),this.trigger("change")}},{live:function(){this.liveBindTo("text","click",function(t){this.hasMod("disabled","yes")||this._onClick(t)})}}),BEM.DOM.decl("b-editor-actions",{onSetMod:{js:function(){this._bPage=this.findBlockOutside("b-page"),this._button=this.findBlockOn("radio-button"),this._pageEditor=this._bPage.findBlockInside("page-editor"),this._preview=this._pageEditor.elem("preview"),this._spinner=this.findBlockInside(this._preview,"spin2"),this._previewContent=this._pageEditor.elem("preview-content"),this._replacer=this._bPage.findBlockInside({block:"m-replacer",modName:"type",modVal:"page-title"}),this._button.on("change",this._onChange,this),this._bindEvents(),this._formatterViewPort=new Ya.FormatterViewPort({domElem:this._previewContent[0],settings:{extensions:{"wiki-doc":null,"wiki-head":null}}})}},_bindEvents:function(){BEM.channel("common").on("reset",function(t,e){"editor-action-buttons"===e.type&&this._button.setMod(this._button.elem("radio").eq(0),"checked","yes")},this)},_onChange:function(t){switch(this.channel("errors").trigger("errorHide"),this._replacer.delMod("disabled"),t.block._val){case"view":this._pageEditor.setMod("preview"),this._getDataForPreview();break;case"edit":this._abortPreviewRequest(),this._pageEditor.delMod("preview")}},_abortPreviewRequest:function(){this._previewRequest&&(this._previewRequest.abort(),this._spinner.delMod("progress")),BEM.DOM.destruct(this.findBlockInside(this._previewContent,"wiki-doc").domElem)},_getDataForPreview:function(){this._pageEditor.isNewWf()?(this._formatterViewPort.render(this._pageEditor.getText()),BEM.DOM.init(this._previewContent)):(this._isError&&(delete this._isError,this.channel("errors").trigger("errorHide")),this._pageData=this._pageEditor.getText(),this._spinner.setMod("progress","yes"),this._previewRequest=BEM.create("wi-api-request",{apiPath:".preview",method:"POST",data:{body:this._pageData},urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}),this._previewRequest.run().then(this._onGetData.bind(this),this._onGetDataError.bind(this)).always(function(){this._spinner.setMod("progress","")}.bind(this)))},_onGetData:function(t){this._replacer.setMod("disabled","yes"),BEM.DOM.update(this._previewContent,BEMHTML.apply(t.data.bemjson)),this._previewRequest=null,this._bPage.highLightCode(),this.findBlocksInside(this._previewContent,{block:"button2",modName:"type",modVal:"form-submit"}).forEach(function(t){t.setMod("disabled","yes")})},_onGetDataError:function(t){this._isError=!0,this._previewRequest=null,BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this.domElem,null,t))}}),BEM.DOM.decl("w-editor-suggest",{onSetMod:{js:{inited:function(){var t=this.params.layers;return Object.keys(t).forEach(function(e){t[e].regexp=t[e].keywords.map(function(t){return new RegExp("(?:\\s|^)("+t+"(\\S+))$","i")})}),this._editor=this.findBlockOn("m-editor").on("change",this._onEditorChange,this),this._textarea=this._editor.elem("textarea","editor","wiki").bem("textarea").elem("control"),this._popup=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply(this.__self._getPopupBEMJSON())).bem("popup2").on({modName:"visible",modVal:""},this._onPopupHide,this),this._lastXHR=null,this._hoveredItem=null,this._inputData=null,this.__base.apply(this,arguments)}},opened:{yes:function(){this._popup.setMod("visible","yes"),BEM.blocks["m-suggest-item"].on(this._popup.domElem,{click:this._onItemClick,mouseover:this._onItemMouseOver,mouseout:this._onItemMouseOut},this),this.bindTo("keydown",this._onKeyDown)},"":function(){this._popup.delMod("visible"),BEM.blocks["m-suggest-item"].un(this._popup.domElem,{click:this._onItemClick,mouseover:this._onItemMouseOver,mouseout:this._onItemMouseOut},this),this.unbindFrom("keydown",this._onKeyDown),this._hoveredItem=null}}},_onEditorChange:function(t,e){this._inputData=this._getInputData(e),this._inputData?this._sendRequest():this.delMod("opened")},_getInputData:function(t){var e=this._textarea[0].selectionEnd;t=t.substr(0,e);for(var i=Object.keys(this.params.layers),n=0;n<i.length;n++)for(var s=this.params.layers[i[n]].regexp,o=0;o<s.length;o++){var r=t.match(s[o]);if(r)return{pattern:r[1],text:r[2],layer:i[n],start:e-r[2].length,end:e}}return null},_getRequestParams:function(){return{type:"GET",url:this.params.url,crossDomain:!0,xhrFields:{withCredentials:!0},dataType:"json",data:Object.assign({version:2,text:this._inputData.text,layers:this._inputData.layer},this.params.addRequestParams),context:this}},_sendRequest:function(){if(this._lastXHR&&"pending"===this._lastXHR.state())try{this._lastXHR.abort()}catch(t){}this._lastXHR=$.ajax(this._getRequestParams()).done(this._onRequestDone).fail(this._onRequestFail)},_onRequestDone:function(t){if(this._hoveredItem=null,this._inputData){var e=t[this._inputData.layer].result||[];if(e.length){var i=this._getPopupPosition();this._popup.setPosition(i.left,i.top).setContent(BEMHTML.apply({block:this.__self.getName(),elem:"items",content:this._getItems(e)})),this._items=this._popup.findBlocksInside("m-suggest-item"),this.setMod("opened","yes")}else this.delMod("opened")}},_onRequestFail:function(){throw new Error("w-editor-suggest:request failed")},_getPopupPosition:function(){this._textarea[0].selectionStart-=this._inputData.pattern.length;var t=this._textarea.caret("offset");return this._textarea[0].selectionStart+=this._inputData.pattern.length,{left:t.left,top:t.top+t.height/2}},_getItems:function(t){var e=this.params.layers[this._inputData.layer].itemType;return t.map(function(t){return{block:"m-suggest-item",mods:{type:e},inputData:{text:this._inputData.text},data:this.__self.transformData(e,t)}},this)},_setVal:function(t){var e=this._inputData.start,i=this._inputData.end,n=this._textarea.val();this._textarea.val(n.substr(0,e)+t+n.substr(i)),this._textarea[0].selectionEnd=e+t.length,this.delMod("opened")},_onItemClick:function(t){var e=this.params.layers[this._inputData.layer].valueField;this._setVal(e?t.block.params.fullData[e]:t.block.params.value)},_onItemMouseOut:function(){this._hoveredItem&&this._hoveredItem.delMod("hovered")},_onItemMouseOver:function(t){this._hoverItem(t.block)},_hoverItem:function(t){this._hoveredItem&&this._hoveredItem.delMod("hovered"),this._hoveredItem=t,this._hoveredItem.setMod("hovered","yes")},_toggleItem:function(t){var e=this._items.length;if(e){var i=this._items.indexOf(this._hoveredItem)+t;i>=e&&(i=0),i<0&&(i=e-1),this._hoverItem(this._items[i])}},_onKeyDown:function(t){var e=BEM.blocks.keycodes;if(this.hasMod("opened")&&(t.keyCode!==e.UP&&t.keyCode!==e.DOWN||(t.preventDefault(),this._toggleItem(t.keyCode===e.UP?-1:1)),t.keyCode===e.ENTER&&this._hoveredItem)){t.preventDefault();var i=this.params.layers[this._inputData.layer].valueField,n=i?this._hoveredItem.params.fullData[i]:this._hoveredItem.params.value;this._setVal(n)}},_onPopupHide:function(){this.delMod("opened")},destruct:function(){return this.delMod("opened"),this._popup&&this._popup.destruct(),this.__base.apply(this,arguments)}},{_getPopupBEMJSON:function(){return{block:"popup2",mods:{target:"position",theme:"normal",autoclosable:"yes",role:"editor-suggest"},mainOffset:12,directions:["bottom-left","bottom-right","top-left","top-right"]}},transformData:function(t,e){switch(t){case"b2b-people":return $.extend(e,{fields:["avatar_url","department_name","is_dismissed","login"].map(function(t){return{type:t,value:e[t]}})});case"maillist":return $.extend(e,{email:e.id,name:e.title});case"group":return $.extend(e,{name:e.title});case"staff":return $.extend(e,{department:e.department_name});default:return e}}}),BEM.DOM.decl({block:"popup2",modName:"target",modVal:"position"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.params.position&&this.setPosition(this.params.position.left,this.params.position.top)}},visible:{yes:function(){this.__base.apply(this,arguments)}}},setPosition:function(t,e){return this._position={left:t,top:e},this._setVisible(),this.redraw()},_onWinScrollAndResize:$.noop,_calcTargetDimensions:function(){var t=this._position;return{left:t.left,top:t.top,width:0,height:0}},getDefaultParams:function(){return $.extend(this.__base(),{mainOffset:0,viewportOffset:0})}}),BEM.DOM.decl("b-editor-close-button",{onSetMod:{js:function(){this._bPage=BEM.blocks["i-global"].getbPage(),this._localStorage=BEM.blocks["mi-storage"],this._appStore=BEM.WISTORE.get("app"),this.bindTo("click",this._onClick.bind(this)),keymaster("esc",this._closeOnESC.bind(this))}},_onClick:function(){this._bPage.findBlockInside("m-editor").hasNewDraft?confirm(BEM.I18N("b-editor-close-button","want_to_close"))&&(this._bPage.findBlockInside("m-editor").revert(),this._closeEditor()):this._closeEditor()},_closeOnESC:function(){var t=this._bPage.findBlockInside({block:"popup2",modName:"role",modVal:"editor-suggest"}),e=this._bPage.findBlockInside({block:"popup2",modName:"editor",modVal:"yes"});(this._bPage.hasMod("editor")||this._bPage.hasMod("new-page"))&&(e&&e.getMod("visible")||t&&t.getMod("visible")||this._onClick())},_closeEditor:function(){this._bPage.findBlockInside("m-editor").close(),this._appStore.set({action:"view",view:"view"}),keymaster.unbind("ctrl+enter, command+enter"),this._bPage.delMod("revision"),BEM.channel("common").trigger("reset",{type:"editor-action-buttons"})}}),BEM.DOM.decl("b-editor-save-button",{onSetMod:{js:function(){this._appStore=BEM.WISTORE.get("app"),this._pageStore=BEM.WISTORE.get("page"),this._button=this.findBlockOn("button2"),this._bPage=this.findBlockOutside("b-page"),this._bTitle=this._bPage.findBlockInside("b-page-title"),this._bEditor=this._bPage.findBlockInside("page-editor"),this._pageTitle=this._bPage.findBlockInside({block:"m-replacer",modName:"type",modVal:"page-title"}),this._spinner=this._bPage.findBlockInside({block:"spin2",modName:"editor",modVal:"save"}),this._closeButton=this._bPage.findBlockInside("b-editor-close-button").findBlockOn("button2"),this._editorActions=this._bPage.findBlockInside("b-editor-actions").findBlockOn("radio-button"),this.bindTo("click",this._onClick.bind(this)),keymaster.unbind("ctrl+enter, command+enter"),keymaster("ctrl+enter, command+enter",this._onClick.bind(this))}},_onClick:function(){yaCounter&&yaCounter.reachGoal("save"),this._urlParams=BEM.blocks["wi-history"].parseQueryParams(),this._status=this.getMod("status"),this._showSpinner(),this._savePage(),this._disableElements()},_showSpinner:function(){this._spinner.setMod("show","yes"),this._spinner.setMod("progress","yes")},_hideSpinner:function(){this._spinner.setMod("show","no"),this._spinner.delMod("progress")},_savePage:function(){var t,e="",i={},n=BEM.blocks["wi-history"].getCorrectPath(),s=/^\/{0,}(.+[^/])\/{0,}$/.exec(n)[1],o=BEM.WISTORE.get("page").get("withNewWf"),r=this._bEditor.isNewWf();r&&!o&&yaCounter&&yaCounter.reachGoal("go_to_new_WF"),!r&&o&&yaCounter&&yaCounter.reachGoal("go_to_old_WF"),"edit"===this._pageTitle.getMod("state")&&this._pageTitle.closeInput(),t={body:this._bEditor.getText(),title:this._pageTitle.getValue(),page_type:"article",version:BEM.blocks["i-global"].pageVersion,showpage:decodeURIComponent(s)},BEM.WISTORE.get("page").get("canSwitchWf")&&o!==r&&(t.with_new_wf=r),this._urlParams&&(this._urlParams.section&&(t.section_id=this._urlParams.section),this._urlParams.originpath&&(n=this._urlParams.originpath)),"create"===this._status&&(e=this._subpageBlock.elem("control").val()),r||(i.fields="bemjson"),BEM.create("wi-api-request",{apiPath:e,method:"POST",data:t,urlParams:i,path:n,timeout:5e4}).run().then(this._onSaveData.bind(this),function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-editor-save-button","save_error"),t))}).always(function(){this._hideSpinner(),this._enableElements()}.bind(this))},_updateDocumentContent:function(t){const e=t.data.body;t.data.raw=e,this._pageStore.set({withNewWf:this._bEditor.isNewWf(),raw:e}),this.channel("content").trigger("update",t);var i=t.data,n=BEM.blocks["wi-history"].parseQueryParams();this._bEditor.onSuccessSubmit(),n&&n.gopage?location.href=n.gopage+(n.goanchor?"#"+n.goanchor:""):(document.title=(i.title||BEM.I18N("b-editor-save-button","page_title_prefix"))+" @ Wiki",BEM.blocks["i-explainer"].explainAllLinks(this._bPage),this._bPage.delMod("editor"),this._bPage.setMod("revision",""),BEM.channel("common").trigger("reset",{type:"editor-action-buttons"}),keymaster.unbind("ctrl+enter, command+enter"),this.hideRevisionInfo(),this._pageStore.set({type:i.page_type,superTag:i.supertag,version:parseInt(i.version)}),this._appStore.set({action:"view",view:"view"}),BEM.blocks["wi-history"]._clearUrl())},_onSaveData:function(t){"edit"===this._status?this._updateDocumentContent(t):this._redirectOnSave(t)},hideRevisionInfo:function(){var t,e,i,n=this._bPage.findBlockInside({block:"b-revision-info",modName:"type",modVal:"view"});this.pageType=this._pageStore.get("type"),n&&("article"===this.pageType&&(t=this._bPage.findBlockInside({block:"w-action",modName:"type",modVal:"edit"}),e=this._bPage.findBlockInside("b-page-more"),i=t.findBlockOn("button2"),e.domElem.show(),BEM.DOM.before(e.domElem,t.domElem),t.params.revisionId=null,i.setMod("size","m"),i.setMod("side","left"),i.setMod("pseudo","yes"),i.setMod("theme","pseudo"),i.elem("text").text(BEM.I18N("b-events-log","page_edit"))),BEM.DOM.destruct(n.domElem))},_redirectOnSave:function(t){window.location.pathname=t.data.supertag},_disableElements:function(){this._button.setMod("disabled","yes"),this._closeButton.setMod("disabled","yes"),this._editorActions.setMod("disabled","yes")},_enableElements:function(){this._button.delMod("disabled"),this._closeButton.delMod("disabled"),this._editorActions.delMod("disabled")}}),BEM.DOM.decl("b-readonly-item",{onSetMod:{js:function(){this.__self._isReadOnly&&this.setMod("disabled","yes")}},_enable:function(){this._isTable||(this._isTable=this.findBlockOn("b-grid-table")),this._isTable?(this._isTable.readOnly=!0,this._isTable.setMod("readonly",!0),this._isTable.rebuild()):(this.setMod("disabled","yes"),this.__self._isReadOnly=!0)},_disable:function(){this._isTable||(this._isTable=this.findBlockOn("b-grid-table")),this._isTable?(this._isTable.readOnly=!1,this._isTable.setMod("readonly",!1),this._isTable.rebuild()):(this.delMod("disabled"),this.__self._isReadOnly=!1)}},{live:function(){this.liveInitOnChannelEvent("readonly","enable",function(){this._enable()}),this.liveInitOnChannelEvent("readonly","disable",function(){this._disable()})},_isReadOnly:!1}),BEM.DOM.decl({block:"tumbler"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._inputValues=this.elemParams(this.elem("input"))._values,this._labelsLength=this.elem("label").length,this._buttonWidth=this.elem("button").width(),this._maxLeft=this.elem("box").width()-this._buttonWidth}},checked:function(t,e){var i=this._inputValues[e?1:0],n=2===this._labelsLength?this.elem("text","side",e?"right":"left")[0].id:this.elem("text").length?this.elem("text")[0].id:"";this.elem("input").attr("aria-labelledby",n).val(i).prop("checked",e),this.elem("button").attr("aria-pressed",Boolean(e)),this.trigger("change",{checked:Boolean(e),value:this.val()})},disabled:function(t,e){this.__base.apply(this,arguments),this.findBlockOn("button","button2").setMod("disabled",e),this.elem("input").prop("disabled",Boolean(e))}},val:function(t){return void 0===t?this.elem("input").val():-1===this._inputValues.indexOf(t)||this.val()===t?this:this._toggle()},_toggle:function(){return this.toggleMod("checked","yes",!this.elem("input").prop("checked")),this},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(t){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onStickerClick:function(){this._toggle(),this.findBlockOn(this.elem("button"),"button2").setMod("focused","yes")},_onLabelClick:function(t){this._shouldChange(t)&&(this._toggle(),this.findBlockOn(this.elem("button"),"button2").setMod("focused","yes"))},_onButtonClick:function(){this._toggle()},_onButtonFocus:function(){this.setMod(this.elem("button"),"focused","yes"),this.setMod("focused","yes")},_onButtonBlur:function(){this.delMod(this.elem("button"),"focused"),this.delMod("focused")},_shouldChange:function(t){var e="left"===this.getMod(t.data.domElem,"side");if(2===this._labelsLength){var i=!e&&this.elem("input").prop("checked");if(e&&!this.elem("input").prop("checked")||i)return!1}return!0}},{live:function(){return this.liveInitOnBlockInsideEvent("focus","button2",function(){this.hasMod("disabled")||this._onButtonFocus()}).liveInitOnBlockInsideEvent("blur","button2",function(){this.hasMod("disabled")||this._onButtonBlur()}).liveInitOnBlockInsideEvent("click","button2",function(t){this.hasMod("disabled")||this._onButtonClick()}).liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}).liveBindTo("sticker","pointerclick",function(t){this.hasMod("disabled")||this._onStickerClick()}).liveBindTo("label","pointerclick",function(t){this.hasMod("disabled")||this._onLabelClick(t)}).liveBindTo("button","keydown",function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||BEM.blocks.keycodes.is(t.keyCode,"SPACE","LEFT","UP","RIGHT","DOWN")&&t.preventDefault()}).liveBindTo("button","keyup",function(t){var e=BEM.blocks.keycodes,i=t.keyCode;t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||(e.is(i,"LEFT","UP")?this.delMod("checked"):e.is(i,"RIGHT","DOWN")&&this.setMod("checked","yes"))}),this.__base()}}),BEM.DOM.decl("tumbler",{_onPointerenter:function(t){this.hasMod(this.elem("button"),"hovered")||this.setMod("hovered","yes")},_onPointerleave:function(t){this.delMod("hovered")},_onButtonPointerenter:function(t){this.hasMod("view","classic")&&this.delMod("hovered").setMod(this.elem("button"),"hovered","yes")},_onButtonPointerleave:function(t){this.hasMod("view","classic")&&this.delMod(this.elem("button"),"hovered").setMod("hovered","yes")}},{live:function(){return this.liveBindTo("box","pointerover pointerout",function(t){this.hasMod("disabled")||this.elem("box")[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}).liveBindTo("button","pointerover pointerout",function(t){this.hasMod("disabled")||this.elem("button")[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onButtonPointerenter(t):this._onButtonPointerleave(t))}),this.__base()}}),BEM.DOM.decl("b-grid-table",{onSetMod:{js:function(){var t=this;this.params.newWF&&this.params.isAction?BEM.create("wi-api-request",{path:"/"+this.params.supertag}).run().then(function(e){e&&e.data&&e.data.redirect_to_tag&&(t.params.supertag="/"+e.data.redirect_to_tag)}).always(function(){t._initGrid()}):this._initGrid()}}},{_getFormatterInstance:function(t,e){return this._formatter||(this._formatter=new Ya.FormatterViewPort({domElem:t,settings:{page_path:e}})),this._formatter},getNotEmptyStringContent:function(t,e,i,n){var s=this._getFormatterInstance(e[0],n);return i?{html:s.getHTMLFromText(t.raw,{remark:{woofmd:{actions:[{name:"iframe",scope:"block"}]}}})}:JSON.parse(t.transformed)},getStringBEMJSON:function(t,e,i,n){var s={block:"b-grid-table-cell",elem:"i"};return t.raw?s.content=this.getNotEmptyStringContent(t,e,i,n):(t._isEmpty=!0,s.content={block:"b-grid-table-cell",elem:"br"}),s}}),BEM.DOM.decl("b-grid-table",{readOnly:!1,_rowsToRemove:[],onSetMod:{mode:{edit:function(){this._rowsToRemove=[],this._editButton.elem("text").text(BEM.I18N("b-grid-table","finish")),this._bindEvents(),this.trigger("start-edit"),this.bindToDomElem(this.elem("row-delete"),"click",this._onRowDeleteClick),this._newRow.setMod("ready","yes")},"":function(){this.syncGrid().then(function(){this.dropElemCache(),this._editButton.elem("text").text(BEM.I18N("b-grid-table","edit")),this._unbindEvents(),this.trigger("stop-edit"),this.unbindFromDomElem(this.elem("row-delete"),"click"),this._newRow.setMod("ready","no"),this.elem("row-dragger").css({top:0,height:0})}.bind(this))}},panels:{"":function(){this.updatePanelsPosition()}}},onElemSetMod:{"row-delete":{restore:function(t,e,i){var n=this.findBlockInside("row-delete","awesome-icon");i?n.setMod("icon","repeat"):n.setMod("icon","remove")}}},_initGrid:function(){this._uaParser=new UAParser,this.readOnly=!0===this.params.readonly,this.showNumbers=!1!==this.params.num,this.noSorting=!1===this.params.sort,this.bPage=BEM.blocks["i-global"].getbPage(),this.setMod("readonly",this.readOnly?"true":"false"),this.noSorting&&this.setMod("no-sorting",this.noSorting?"true":"false"),this.tableId="id_"+Date.now(),this.params.gridData&&(this._gridData=this.params.gridData),this.buildGrid(),BEM.blocks["b-grid-table-cell"].on(this.domElem,"save",this._onCellSave,this),BEM.blocks["b-grid-table-head"].on(this.domElem,"sort",this._onSort,this),this.channel("getting-started").on("showaddcolpopup",this._showAddColPopup,this)},destruct:function(){BEM.blocks["b-grid-table-cell"].un(this.domElem,"save",this._onCellSave,this),BEM.blocks["b-grid-table-head"].un(this.domElem,"sort",this._onSort,this),this.__base.apply(this,arguments)},updatePanelsPosition:function(){this._setHeaderPosition(),this._tableBar&&this._tableBar.setPosition()},rebuild:function(t,e){var i=this;t&&(this._gridData=t),this.params.isAction?this.params.width&&this.domElem.css({width:this.params.width}):this.domElem.css({width:"100%"}),this._notNew&&(this.delMod("mode"),this.dropElemCache()),BEM.blocks["b-grid-table-token"].un(this.domElem,"remove"),BEM.blocks["b-grid-table-cell"].un(this.domElem,"start-edit"),BEM.blocks["b-grid-table-row"].un(this.domElem,"start-edit"),BEM.blocks["b-grid-table-cell"].un(this.domElem,"save"),this.unbindFrom(this.elem("table-wrapper"),"scroll"),this.unbindFrom(this.elem("scroll-left"),"click"),this.unbindFrom(this.elem("scroll-right"),"click"),BEM.blocks["b-grid-table-cell"].on(this.domElem,"save",this._onCellSave,this),this.afterCurrentEvent(function(){BEM.DOM.update(i.elem("i"),BEMHTML.apply(i._buildGridBEMJSON()),i._afterUpdate.bind(i,e)),BEM.WISTORE.get("app").set("contentLoaded",!0)}),this.afterCurrentEvent(this._updateColsWidth,this);var n=this._uaParser.setUA(BEM.blocks["i-ua"].ua).getBrowser().name;-1===["Safari","IE"].indexOf(n)&&this.afterCurrentEvent(function(){this._setHeaderPosition(),this.params.isAction||(this.unbindFromDoc("scroll.bar",this._setHeaderPosition),this.unbindFromWin("resize.bar",this._setHeaderPosition),this.bindToDoc("scroll.bar",this._setHeaderPosition),this.bindToWin("resize.bar",this._setHeaderPosition))},this)},_setHeaderPosition:function(){var t=this.findElem("head"),e=BEM.DOM.win.scrollTop(),i=t.offset().top,n=this.findElem("table-wrapper").height(),s=t.height(),o=e>i-this.__self._pageInfoPanelWidth&&e-i+this.__self._pageInfoPanelWidth+s<n;this.findBlocksInside("b-grid-table-head").forEach(function(t){o?t.domElem.css({position:"relative",top:e-i+this.__self._pageInfoPanelWidth}):t.domElem.css({position:"initial",top:"auto"})},this)},_updateColsWidth:function(){var t=this._gridData.structure.fields,e=this.hasMod("fixed-columns-width","yes"),i=this.findBlocksInside(this.findElem("body"),"b-grid-table-row").length,n=10*(String(i).length-1)+1;this._sumPXColsWidth=0,t.forEach(function(t){"px"===t.width_units&&(this._sumPXColsWidth+=parseInt(t.width)+this.__self._colPadding)},this),this.showNumbers&&(this._sumPXColsWidth+=n+this.__self._colPadding),e?(this.findElem("table").width(this._sumPXColsWidth+"px"),this.findElem("counter-cell").width(n+"px"),this.findElem("new-col-cell").width("25px")):(this.findElem("table").width(""),this.findElem("counter-cell").width(""),this.findElem("new-col-cell").width(""))},_afterUpdate:function(t){this._notNew=!0,this._editButton=this.findBlockInside({block:"button2",modName:"role",modVal:"edit"}),this._editButton&&this._editButton.on("click",this._onEdit,this),this._newRow=this.findBlockInside("b-grid-table-new-row"),this._setEditAfterRebuild&&(this._onEdit(),this._setEditAfterRebuild=!1),window.localStorage["wiki-new-grid"]&&(this._onEdit(),this.findBlockInside({block:"b-grid-table-head",modName:"type",modVal:"new-col"})._onEditClick("create"),window.localStorage.removeItem("wiki-new-grid")),this.bPage.highLightCode(),this._content||(this._content=this.bPage.findBlockInside("b-content")&&this.bPage.findBlockInside("b-content").domElem||this.bPage.findBlockInside("page-editor").elem("preview-content")),this.recalculateScroll(),this.bindTo(this.findElem("table-wrapper"),"scroll",this.recalculateScroll.bind(this)),this.bindTo(this.findElem("scroll-left"),"click",this.scrollTable.bind(this,"left")),this.bindTo(this.findElem("scroll-right"),"click",this.scrollTable.bind(this,"right")),"add"===t&&this.elem("table-wrapper").scrollLeft(this.elem("table").width()),this.params.isAction&&this.channel("common").trigger("reset-hash"),this._tableBar=this.findBlockInside("b-grid-table-bar"),this.params.newWF&&Ya.FormatterViewPort.BEM.DOM.init(this.domElem),this.setMod("loaded","yes")},showDiff:function(t){BEM.DOM.update(this.elem("i"),BEMHTML.apply(this._buildGridDiffBEMJSON(t))),this.setMod("fixed-columns-width","no")},syncGrid:function(){return this.removeRows()},_getRowMaxCellVersion:function(t){var e=-1;return t&&t.findBlocksInside("b-grid-table-cell").forEach(function(t){var i=parseInt(t.getVersion());e=e<i?i:e},this),e},createRowAfter:function(t,e,i){var n,s,o=this,r=this._getRowMaxCellVersion(t),a=this._getRowMaxCellVersion(e),c=r>a?r:a;this._newRow.hasMod("ready","no")||(this._newRow.setMod("ready","no"),s={version:c>=0?c:this._gridData.version,changes:[{added_row:{after_id:t?t.params.row_id:"-1",before_id:e?e.params.row_id:"-1",data:{}}}]},t?(BEM.DOM.after(t.domElem,BEMHTML.apply(this._getEmptyRow())),t.delMod("state"),t._activeCell&&t._activeCell.delMod("state"),n=t.domElem.next().bem("b-grid-table-row")):(BEM.DOM.prepend(this.elem("body"),BEMHTML.apply(this._getEmptyRow())),n=this.findBlockInside(this.elem("body"),"b-grid-table-row")),n.setMod("state","edit").delMod("type"),i||setTimeout(function(){n.findBlocksInside("b-grid-table-cell")[o.showNumbers?1:0].setMod("state","edit")},0),BEM.create("wi-api-request",{apiPath:".grid/rows",path:"/"+this.params.supertag,method:"POST",data:s,apiTimeout:this.__self._apiTimeout,urlParams:this.gridOptionsUrlParams()}).run().then(this._onAddRow.bind(this,n),this._onAddRowFailed.bind(this,n)).always(function(){this._newRow.setMod("ready","yes")}.bind(this)))},buildGrid:function(){this._notNew||BEM.DOM.update(this.domElem,BEMHTML.apply({block:this.__self.getName(),elem:"i",content:{block:"spin2",mods:{size:"s",progress:"yes",type:"data-load"}}}),this._buildContent,this)},removeRows:function(){var t={changes:this._rowsToRemove.map(function(t){return{removed_row:{id:t.params.row_id}}})};return t.changes.length?BEM.create("wi-api-request",{apiPath:".grid/change",path:"/"+this.params.supertag,method:"POST",data:t,apiTimeout:this.__self._apiTimeout,urlParams:this.gridOptionsUrlParams()}).run().then(this._onRowDelete.bind(this),BEM.blocks["wi-notification"].errorHandler()):Promise.resolve()},_onSort:function(t,e){this._gridData=e,this.rebuild(),this.trigger("sorted")},_onAddRow:function(t,e){t.params.row_id=e.data.id,t.findBlocksInside("b-grid-table-cell").forEach(function(t){t.version=e.data.version},this),t._activeCell&&t._activeCell.setRowId(e.data.id),this.trigger("row-added"),this._rebindEvents(),this.delMod("empty"),this._updateColsWidth()},_onAddRowFailed:function(t,e){t.destruct(),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,e))},_buildGridDiffBEMJSON:function(t){var e,i,n,s,o=[],r=this._getRowBEMJSON(),a=t.diff,c=t.titles,l=this.__self.getName(),d={block:l,elem:"table",content:[r,{block:l,elem:"body",tag:"tbody",content:o}]};return Object.keys(c).length&&r.content.push({block:"b-grid-table-head",mods:{type:"settings"},tag:"th"}),r.mods={type:"head"},Object.keys(c).forEach(function(t){s={base:c[t]},this._formDiffCol(s),i={block:"b-grid-table-head",mods:{state:s.state},tag:"th",content:{elem:"i",content:{elem:"text",content:s.content}}},r.content.push(i)},this),Object.keys(a).forEach(function(t){(e=this._getRowBEMJSON()).content.push({block:"b-grid-table-cell",mods:{type:"counter",state:this._getDiffCounterState(a[t])},mix:{elem:"custom-counter"},tag:"td",content:t}),Object.keys(a[t]).forEach(function(o){n={name:o,type:"diff"},s={base:a[t][o]},this._formDiffCol(s),(i=this._getCell(n.type,s,n)).mods.state=s.state,e.content.push(i)},this),o.push(e)},this),d},_getDiffCounterState:function(t){var e=0,i=0,n="",s=Object.keys(t),o=s.length;return s.forEach(function(n){var s=t[n];null!==s&&(void 0!==s.new&&void 0===s.old&&e++,void 0!==s.old&&void 0===s.new&&i++)},this),e===o&&(n="new"),i===o&&(n="old"),n},_formDiffCol:function(t){null===t.base?t.content="":void 0!==t.base.old&&void 0!==t.base.new?(t.state="change",t.content=[{elem:"old-changed",content:t.base.old}," ",{elem:"new-changed",content:t.base.new}]):void 0!==t.base.old?(t.state="old",t.content={elem:"old-deleted",content:t.base.old}):void 0!==t.base.new?(t.state="new",t.content={elem:"old-added",content:t.base.new}):t.base.current&&(t.state="current",t.content={elem:"current",content:t.base.current})},_onEdit:function(){!this.readOnly&&BEM.WISTORE.get("page").get("canEdit")&&(this._currentRow&&this.elem("row-delete").css({height:0}),this.toggleMod("mode","edit"),this.trigger("grid-edit"))},_buildContent:function(t){if(!0===t&&(this._setEditAfterRebuild=!0),!this._gridData){var e=BEM.WISTORE.get("page").get("translation");return(e?BEM.create("wi-api-request",{apiPath:".translate/"+e.from+"-"+e.to,method:"GET",urlParams:!1,path:"/"+this.params.supertag}):BEM.create("wi-api-request",{apiPath:".grid",path:"/"+this.params.supertag,apiTimeout:this.__self._apiTimeout,urlParams:this.gridOptionsUrlParams(["format=json","noredirect=true"])})).run().then(this._onGotData.bind(this),this._onFailedData.bind(this))}this.rebuild()},_onGotData:function(t){this._gridData=t.data,this._gridData.structure?this.rebuild():this._showGridError(BEM.I18N("b-grid-table","incorrect_format"))},_onFailedData:function(t){this._showGridError(BEM.I18N("b-grid-table","cant_load_table"),t,!0)},_showGridError:function(t,e,i){var n=[t,{html:"<br/>"},BEM.blocks["wi-notification"].createErrorMessage(e)];i&&n.push({block:"button2",mods:{size:"s",theme:"normal",role:"build"},text:BEM.I18N("b-grid-table","try_more")}),BEM.DOM.update(this.domElem,BEMHTML.apply({block:"b-grid-error",content:{elem:"message",content:n}}),this._onGridErrorMessage,this)},scrollTable:function(t){var e=this.findElem("table"),i=this.findElem("table-wrapper"),n=Math.round(i.width()/3),s="left"===t?i.scrollLeft()-n:i.scrollLeft()+n,o=Math.round(e.width()/10);"left"===t&&s<o&&(s=0),"right"===t&&e.width()-s-i.width()<o&&(s=e.width()),i.animate({scrollLeft:s},300)},recalculateScroll:function(){this._recalculateScrollTimeout||(this._recalculateScrollTimeout=setTimeout(function(){var t=this.findElem("table-wrapper"),e=this.findElem("table");e.width()>t.width()?this.setMod("left-scroll",t.scrollLeft()>0?"yes":"").setMod("right-scroll",t.scrollLeft()+t.width()<=e.width()?"yes":""):this.delMod("left-scroll").delMod("right-scroll"),this._recalculateScrollTimeout=null}.bind(this),100))},_bindEvents:function(){this.bindTo(this.findElem("body","tr"),"mouseenter",this._onRowMouseEnter),BEM.blocks["b-grid-table-head"].on(this.domElem,"delete",this._onColDelete,this),this.bindTo(this.domElem,"clickoutside",this._onTableOutsideClick)},_unbindEvents:function(){this.unbindFrom(this.elem("tr"),"mouseenter"),BEM.blocks["b-grid-table-head"].un(this.domElem,"delete"),this.unbindFrom(this.domElem,"clickoutside")},_rebindEvents:function(){this._unbindEvents(),this.dropElemCache(),this._bindEvents()},_onColDelete:function(t,e){var i;return this.syncGrid().then(function(){e.table===this.tableId&&(i={version:this._gridData.version,changes:[{removed_column:{name:t.block.params.id}}]},BEM.create("wi-api-request",{apiPath:".grid/change_and_get_document",path:"/"+this.params.supertag,method:"POST",data:i,apiTimeout:this.__self._apiTimeout,urlParams:this.gridOptionsUrlParams()}).run().then(this._onColDeleteSuccess.bind(this),BEM.blocks["wi-notification"].errorHandler()))}.bind(this))},_onColDeleteSuccess:function(t){this.dropElemCache(),this._setEditAfterRebuild=!0,this._gridData=t.data.grid,this.rebuild()},_onCellSave:function(t,e){var i={version:t.block.getVersion(),changes:[{edited_row:{id:e.rowId,data:{}}}]};i.changes[0].edited_row.data[t.block.params.name]=e.val?e.val:"",BEM.create("wi-api-request",{apiPath:".grid/change_get_cell",path:"/"+this.params.supertag,method:"POST",data:i,apiTimeout:this.__self._apiTimeout,urlParams:this.gridOptionsUrlParams()}).run().then(this._onCellSaveSuccess.bind(this,t),this._onCellSaveFail.bind(this,t))},_onCellSaveSuccess:function(t,e){t.block.trigger("saved",e)},_onCellSaveFail:function(t,e){t.block.trigger("save-error"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(t.block.domElem,null,e))},_onRowDeleteClick:function(){var t=this._currentRow.next(),e=this._currentRow.bem("b-grid-table-row");if(e.hasMod("removed","yes")){var i=this._rowsToRemove.indexOf(e);return-1!==i&&this._rowsToRemove.splice(i,1),this.delMod(this.elem("row-delete"),"restore"),void e.delMod("removed")}this._rowsToRemove.push(e),e.setMod("removed","yes"),this._currentRow=t,0===this._currentRow.prev().length&&0===this._currentRow.next().length&&this.setMod("empty","body"),this.elem("row-delete").css({top:0,height:0}),this.trigger("row-delete")},_onRowDelete:function(){this._rowsToRemove.forEach(function(t){BEM.DOM.destruct(t.domElem)}),this._rowsToRemove=[],this._updateColsWidth(),this.trigger("grid-synced")},_onRowMouseEnter:function(t){var e=$(t.currentTarget),i=e.bem("b-grid-table-row"),n=this.elem("row-delete");this._currentRow=e,n.css({right:-22,top:this._currentRow.offset().top-this.domElem.offset().top,height:this._currentRow.outerHeight()}),i.hasMod("removed","yes")?this.setMod(n,"restore","yes"):this.setMod(n,"restore","")},_onGridErrorMessage:function(){this._buildButton=this.findBlockInside({block:"button2",modName:"role",modVal:"build"}),this._buildButton&&this._buildButton.on("click",this._onBuildButtonClick,this),this.setMod("loaded","yes")},_onBuildButtonClick:function(){this.buildGrid()},_onTableOutsideClick:function(){this._preventCellOutside||this._preventRowOutside||this._lockOutsideClicks||this._onEdit()},_saveTitle:function(t){var e;this._gridData.structure.title!==t&&(e={version:this._gridData.version,changes:[{title_changed:{title:t}}]},BEM.create("wi-api-request",{apiPath:".grid/change",path:"/"+this.params.supertag,method:"POST",data:e,apiTimeout:this.__self._apiTimeout,urlParams:this.gridOptionsUrlParams()}).run().then(this._onTitleSaveSuccess.bind(this,t),BEM.blocks["wi-notification"].errorHandler()))},_onTitleSaveSuccess:function(t,e){var i=this.bPage.findBlockInside("b-grid-table-settings");this._gridData.version=e.data.version,document.title=(t||BEM.I18N("b-grid-table","page"))+" @ Wiki",this.bPage.findBlockInside("b-page-title").domElem.text(t),this._gridData.structure.title=t,i.findBlockInside(i.elem("grid-title"),"input").val(t)},_saveSorting:function(t){var e={version:this._gridData.version,changes:[{sorting_changed:{sorting:t}}]};BEM.create("wi-api-request",{apiPath:".grid/change_and_get_document",path:"/"+this.params.supertag,method:"POST",data:e,apiTimeout:this.__self._apiTimeout,urlParams:this.gridOptionsUrlParams()}).run().then(this._onSortingSaveSuccess.bind(this),BEM.blocks["wi-notification"].errorHandler())},_onSortingSaveSuccess:function(t){this.dropElemCache(),this._gridData=t.data.grid,this.rebuild()},_buildGridBEMJSON:function(){var t=[{block:this.__self.getName(),elem:"scroll-left"},{block:this.__self.getName(),elem:"scroll-right"},{block:this.__self.getName(),elem:"head-indicator"},{block:this.__self.getName(),elem:"row-indicator"},{block:this.__self.getName(),elem:"row-dragger",attrs:{draggable:"true"},content:{block:"awesome-icon",mods:{icon:"ellipsis-v"}}},{block:this.__self.getName(),elem:"drag-image"},{block:this.__self.getName(),elem:"row-delete",content:{block:"awesome-icon",mods:{icon:"remove"}}},{block:this.__self.getName(),elem:"table-wrapper",content:{block:this.__self.getName(),elem:"table",content:[this._buildGridHeadBEMJSON()].concat(this._buildGridBodyBEMJSON())}}];return t.push({block:"b-grid-table-bar",mods:{visibility:this.readOnly?"hidden":""},gridUrl:this.params.supertag,isAction:this.params.isAction,actuality:this.bPage.getMod("actuality"),fieldsCount:this._gridData.structure.fields.length,user:this.params.user,breadcrumbs:this.params.breadcrumbs||[],redirect:BEM.WISTORE.get("page").get("redirect")}),t},_buildGridHeadBEMJSON:function(){var t=this._gridData.structure.fields,e=this._getRowBEMJSON(),i=!0,n=!1;return e.mods={type:"head"},this.showNumbers&&e.content.push({block:"b-grid-table-head",mods:{type:"settings"},mix:{block:"b-grid-table",elem:"counter-cell"},tag:"th"}),t.forEach(function(t){"px"!==t.width_units&&(i=!1),t.width_units||(n=!0)}),t.forEach(function(t){var n=t.type,s=t.sorting?"asc"===t.sorting?"sort-down":"sort-up":"angle-down",o={block:"b-grid-table-head",attrs:{draggable:"true"},mix:[{block:"b-grid-table-head-draggable",js:!0}],tag:"th",js:{id:t.name,required:Boolean(t.required),value:t.title,width:!!t.width&&t.width,width_units:!!t.width&&t.width_units,markdone:Boolean(t.markdone),options:!!t.options&&t.options},content:{elem:"i",content:[{elem:"text",content:t.title},{elem:"edit",content:{block:"awesome-icon",mods:{icon:"reorder"}}},{elem:"sort",content:{block:"awesome-icon",mods:{icon:s,type:"sort"}}}]}};t.width&&(o.attrs.style="width: "+t.width+t.width_units,i&&(o.content.attrs={style:"width: "+Number(t.width)+"px"})),"select"===t.type&&!0===t.multiple&&(n="multiselect"),"staff"===t.type&&!0===t.multiple&&(n="multistaff"),o.js.type=n,e.content.push(o)}),this.setMod("fixed-columns-width",i?"yes":"no"),this.setMod("auto-width-columns",n?"yes":"no"),this._newColId=Date.now(),e.content.push({block:"b-grid-table-head",js:{id:this._newColId},mods:{type:"new-col"},mix:{block:"b-grid-table",elem:"new-col-cell"},tag:"th",content:{elem:"edit",content:{block:"awesome-icon",mods:{icon:"plus"}}}}),{block:this.__self.getName(),elem:"head",tag:"thead",content:e}},_buildGridBodyBEMJSON:function(){var t,e,i=this,n={block:this.__self.getName(),elem:"body",tag:"tbody",content:[]},s=this._gridData.rows||[];return this._gridData.structure.fields.forEach(function(t){"ticket"===t.type&&(this.isTicket=!0)},this),s.forEach(function(s){e={raw:[]},t=i._getRowBEMJSON(),i.showNumbers&&t.content.push({block:"b-grid-table-cell",mods:{type:"counter"},tag:"td"}),t.mix.push({block:"b-grid-table-row-draggable",js:!0}),s.forEach(function(n,s){var o=i._gridData.structure.fields[s],r=o.type;e.raw.push(n.raw),"checkbox"===r&&o.markdone&&!0===n.raw&&(t=i._markRowChecked(t)),"select"===r&&!0===o.multiple&&(r="multiselect"),"staff"===r&&!0===o.multiple&&(r="multistaff"),t.content.push(i._getCell(r,n,o))}),e.row_id=s[0]?s[0].row_id:-1,t.js=e,t.content.push(i._getNewColCell()),n.content.push(t)}),n.content.push(this._getNewRow()),s.length||this.setMod("empty","body"),n},_getNewColCell:function(){return{block:"b-grid-table-cell",mods:{type:"new-col"},tag:"td"}},_getCell:function(t,e,i){var n={block:"b-grid-table-cell",mods:{type:t},js:{raw:e.raw,name:i.name},tag:"td",attrs:i.width&&{width:i.width+i.width_units},content:this._getContentByType(t,e,i)};return i.required&&(n.mods.required="yes",e._isEmpty&&(n.mods["required-empty"]="yes"),n.content=[n.content,{block:"b-grid-table-required-info",content:BEM.I18N("b-grid-table","this_required")}]),-1===t.search(/^ticket-/)&&(n.mods.editable="yes"),i.options&&(n.js.options=i.options),"staff"!==t&&"multistaff"!==t||(n.js.transformed=e.transformed),n},_swapStructure:function(t,e,i){var n=this._gridData.structure[i];n.splice(e,0,n.splice(t,1)[0])},_getNewRow:function(){return{block:"b-grid-table-new-row",mix:[{block:"w-getting-started",elem:"elem",elemMods:{"edit-grid-add-row":"1"}}],js:!0,tag:"tr",content:{elem:"cell",attrs:{colspan:this._gridData.structure.fields.length+2},tag:"td",content:BEM.I18N("b-grid-table","add_line")}}},_getEmptyRow:function(){var t,e,i={raw:[]},n=this._gridData.structure.fields.length,s=this._getRowBEMJSON(),o=this._gridData.structure.fields;s.mods={type:"new"},this.showNumbers&&s.content.push({block:"b-grid-table-cell",mods:{type:"counter"},tag:"td"}),s.mix.push({block:"b-grid-table-row-draggable",js:!0});for(var r=0;r<n;r++)t=o[r].type,"select"===o[r].type&&!0===o[r].multiple&&(t="multiselect"),"staff"===o[r].type&&!0===o[r].multiple&&(t="multistaff"),e={raw:""},"number"===o[r].type&&(e.raw=null),"checkbox"===o[r].type&&(e.raw=!1),"select"!==o[r].type&&"staff"!==o[r].type||(e.raw=[],e.transformed=[]),i.raw.push(e),s.content.push(this._getCell(t,e,o[r]));return s.js=i,s.content.push(this._getNewColCell()),s},_getRowBEMJSON:function(){return{block:"b-grid-table-row",mix:[{block:this.__self.getName(),elem:"tr"}],tag:"tr",content:[]}},_getContentByType:function(t,e,i){var n;switch(t){case"diff":n=e.content||"";break;case"string":n=this.__self.getStringBEMJSON(e,this.domElem,this.params.newWF,this.params.supertag);break;case"number":n=this.__self.getNumberBEMJSON(e);break;case"checkbox":n=this.__self.getCheckBoxBEMJSON(e,i,this.readOnly);break;case"date":n=this.__self.getDateBEMJSON(e);break;case"select":n=this.__self.getSelectBEMJSON(e);break;case"multiselect":n=this.__self.getMultiSelectBEMJSON(e);break;case"staff":case"multistaff":n=this.__self.getStaffBEMJSON(e);break;case"ticket":n=this.__self.getTicketBEMJSON(e);break;case"ticket-subject":case"ticket-type":e.view?n=e.view:e.raw?n=e.raw:e._isEmpty=!0;break;case"ticket-assignee":case"ticket-reporter":e.transformed?n=this.__self.getStaffBEMJSON(e):e._isEmpty=!0;break;case"ticket-status":case"ticket-priority":e.view?n=e.view:e.raw?n=e.raw:e._isEmpty=!0;break;case"ticket-createdat":case"ticket-updatedat":n=this._getTicketDateString(e);break;case"ticket-originalestimation":case"ticket-fixversions":case"ticket-components":case"ticket-storypoints":e.view?n=e.view:e.raw?n=e.raw:e._isEmpty=!0;break;default:n=BEM.I18N("b-grid-table","undefined_column")}return-1!==t.indexOf("ticket-")&&"string"==typeof n&&(n={html:filterXSS(n)}),n},_getTicketDateString:function(t){var e,i;return t.view&&(i=BEM.blocks["mi-helpers"].getDateFromHumanString(t.view),e={block:"m-date",short:!0,format:"middle",alwaysShowYear:!0,timestamp:i=BEM.blocks["mi-helpers"].getHumanStringFromDate({date:i})}),e||""},_markRowChecked:function(t){return t.mods=t.mods||{},t.mods.checked="yes",t},gridOptionsUrlParams:function(t){var e=t||[];return this.params.sort&&e.push("sort="+this.params.sort),this.params.filter&&e.push("filter="+this.params.filter),this.params.width&&e.push("width="+this.params.width),this.params.num&&e.push("num="+this.params.num),this.params.columns&&e.push("columns="+this.params.columns),!!e.length&&e},_showAddColPopup:function(){if("edit"===this.getMod("mode")){var t=this.findBlockInside({block:"b-grid-table-head",modName:"type",modVal:"new-col"});t&&t.createCol()}}},{_colPadding:21,_apiTimeout:45e3,_pageInfoPanelWidth:50,isEmpty:function(t){return null===t||(void 0===t||(!t.length||""===t))},getTicketBEMJSON:function(t){var e={block:"b-grid-table-cell",elem:"i"};return t.raw?e.content={block:"link",url:t.url,content:t.raw}:(t._isEmpty=!0,e.content={block:"b-grid-table-cell",elem:"br"}),e},getNumberBEMJSON:function(t){var e={block:"b-grid-table-cell",elem:"i"};return t.raw?e.content=t.raw:(t._isEmpty=!0,e.content={block:"b-grid-table-cell",elem:"br"}),e},getCheckBoxBEMJSON:function(t,e,i){var n={mix:{block:"b-grid-table-checkbox"},block:"checkbox",mods:{size:"m",theme:"normal"}};return e.markdone&&(n.mods.markdone="yes"),!0===t.raw&&(n.mods.checked="yes"),i&&(n.mods.disabled="yes"),{block:"b-grid-table-cell",elem:"edit",content:n}},getDateBEMJSON:function(t){var e={block:"b-grid-table-cell",elem:"i"};return t.raw?e.content={block:"m-date",short:!0,format:"middle",alwaysShowYear:!0,timestamp:t.raw}:(t._isEmpty=!0,e.content={block:"b-grid-table-cell",elem:"br"}),e},getSelectBEMJSON:function(t){var e={block:"b-grid-table-cell",elem:"i"};return t.raw&&t.raw.length?e.content={html:t.raw.join("")}:(t._isEmpty=!0,e.content={block:"b-grid-table-cell",elem:"br"}),e},getMultiSelectBEMJSON:function(t){var e=t.raw,i={block:"b-grid-table-cell",elem:"i"};return e&&e.length?i.content={html:e.join(", ")}:(t._isEmpty=!0,i.content={block:"b-grid-table-cell",elem:"br"}),i},getStaffBEMJSON:function(t){var e=t.transformed,i={block:"b-grid-table-cell",elem:"i",content:{block:"b-grid-table-users",content:""}};return e&&e.length?(i.content.content=[],e.forEach(function(t,e){0!==e&&i.content.content.push(", "),t.first_name?i.content.content.push({block:"m-username",mods:{dismissed:t.is_dismissed?"yes":""},mix:[{block:"mi-staff-card",js:{user:t.login}}],url:"//staff.yandex-team.ru/"+t.login,content:t.first_name+" "+t.last_name}):i.content.content.push(t.login)})):(t._isEmpty=!0,i.content={block:"b-grid-table-cell",elem:"br"}),i}}),BEM.DOM.decl("b-grid-table",{},{getStaffBEMJSON:function(t){var e=t.transformed,i={block:"b-grid-table-cell",elem:"i",content:{block:"b-grid-table-users",content:[]}};return e&&e.length?e.forEach(function(t,e){0!==e&&i.content.content.push(", ");var n=t.title;t.first_name&&t.last_name&&(n=t.first_name+" "+t.last_name),n?i.content.content.push({block:"m-username",login:t.login,content:n||t.login}):i.content.content.push(t.login)}):(t._isEmpty=!0,i.content={block:"b-grid-table-cell",elem:"br"}),i}}),BEM.DOM.decl("b-grid-table-cell",{onSetMod:{state:{edit:function(){this._initBlock(),this.trigger("start-edit")},"":function(){this.unbindFrom(this.domElem,"clickoutside"),this.unbindFrom(BEM.DOM.win,"resize.cellWidth"),this.trigger("stop-edit"),this.params.row_id?this._save():this._saveAfterSetRowId=!0}}},val:function(){return this.hasMod("state","edit")||this.hasMod("saving","yes")},getVersion:function(){return this._storage||this._createStorage(),this.version||this._storage._table._gridData.version},setRowId:function(t){this.params.row_id=t,this._saveAfterSetRowId&&(this._save(),this._saveAfterSetRowId=!1)},_initBlock:function(){this._storage||this._createStorage(),this._storage._row=this.findBlockOutside("b-grid-table-row"),this._storage._table.hasMod("mode","edit")&&this._storage._row.setMod("state","edit"),!this.params.row_id&&this._storage._row.params.row_id&&(this.params.row_id=this._storage._row.params.row_id),this.bindTo(this.domElem,"clickoutside",this._onClickOutside),this.on("saved",this._onSaved),this.on("save-error",this._onSaveError),this._storage._row.on("stop-edit",function(){this.delMod("state")},this)},_onClick:function(){!this.hasMod("state","edit")&&this.hasMod("editable","yes")&&(this._storage||this._createStorage(),this._storage._table.hasMod("mode","edit")&&(this._setSizes(),this.setMod("state","edit")))},_onClickOutside:function(){this._preventExitEditing?this._preventExitEditing=!1:this.delMod("state")},_resetValue:function(t,e){var i=void 0===t?this.val():t,n=void 0===e?this.params.raw:e;return!!this._hasChanges(i,n)||(this._storage._table.delMod("mode"),!1)},_setSizes:function(){this._getSizesInfo(),this.domElem.css({width:this._sizes.outerWidth,"min-width":this._sizes.outerWidth,height:this._sizes.outerHeight})},_getSizesInfo:function(){this._sizes={width:this.domElem.width(),height:this.domElem.height(),outerWidth:this.domElem.outerWidth(),outerHeight:this.domElem.outerHeight()}},_onSaved:function(t,e){this.delMod("saving").delMod("required-empty"),this._clearSize(),this.params.raw=e.data.cell.raw,this._isRequiredAndEmpty()&&this.setMod("required-empty","yes"),this.version=e.data.version},_onSaveError:function(){this.domElem.removeAttr("style"),this._clearSize(),this.afterCurrentEvent(function(){this.delMod("saving")},this)},_isRequiredAndEmpty:function(){return!!this.hasMod("required")&&(!this.params.raw||Boolean("object"==typeof this.params.raw&&!this.params.raw.length))},_createStorage:function(){var t=this.findBlockOutside("b-grid-table");this.__self[t.tableId]||(this.__self[t.tableId]={_table:t}),this._storage=this.__self[t.tableId]},_setEdit:function(){this._getSizesInfo(),this._resizeEdit(),this.bindTo(BEM.DOM.win,"resize.cellWidth",function(){this._getSizesInfo(),this._resizeEdit()},this),this.setMod("state","edit")},_resizeEdit:function(){},_clearSize:function(){this.domElem.removeAttr("style")},_save:function(){return{rowId:this.params.row_id,cellPosition:this.domElem.index()-(this._storage._table.showNumbers?1:0),tableId:this._storage._table.tableId}},_hasChanges:function(t,e){if(BEM.blocks["b-grid-table"].isEmpty(t)&&BEM.blocks["b-grid-table"].isEmpty(e))return!1;if(typeof t!=typeof e)return!0;if(e.length!==t.length)return!0;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!0;return!1},showEditControl:$.noop},{live:function(){this.liveBindTo("click",function(t){if(!this.hasMod("editable","yes"))return this._storage||this._createStorage(),this._storage._row&&this._storage._row.delMod("state"),!1;this._onClick(),"checkbox__control"===t.target.className&&this._save(this._checkbox.isChecked())}),this.liveBindTo("dblclick",function(){this._storage||this._createStorage(),!this._storage._table.hasMod("mode","edit")&&this.hasMod("editable","yes")&&this._storage._table._onEdit(),this._onClick()})},_getCellLang:function(){var t=BEM.WISTORE.get("page").get("translation"),e=BEM.I18N.lang(),i=t&&t.to;return i&&"tr"!==i||(i=e),i}}),BEM.DOM.decl("b-grid-table-token",{_onClick:function(){this.trigger("remove")}},{live:function(){this.liveBindTo("remove","click",function(){return this._onClick(),!1})}}),BEM.DOM.decl("m-datepicker",{getDate:function(){return!!this._isDateSelected&&this._selectedDate},getSelectedDay:function(){return!!this._isDateSelected&&this._selectedDate.getDate()},setDate:function(t,e,i){if("string"==typeof t)this._selectedDate=BEM.blocks["mi-helpers"].getDateFromHumanString(t);else{if("object"!=typeof t)throw new Error("Wrong argument! Should be ISOString string or { from: ISOString, to: ISOString } object");this._selectedDate={from:BEM.blocks["mi-helpers"].getDateFromHumanString(t.from),to:BEM.blocks["mi-helpers"].getDateFromHumanString(t.to)}}this._isDateSelected=!0,this.trigger("change",{date:this.getDate(),fromArrow:!e}),e||this._buildDatepicker(i?this._selectedDate:null),this.clearButton&&this.clearButton.delMod("disabled")},clearDate:function(){this._isDateSelected=!1,this.trigger("change",{date:this.getDate()})},_getFootElemBEMJSON:function(t){return{block:"m-datepicker",elem:"foot",content:t}},_getCurrentDate:function(){return new Date},_getStartDay:function(t,e,i){var n;return"string"==typeof t||"number"==typeof t?(i=e,e=t,n=BEM.blocks["mi-helpers"].getUTC_YMD(i,e,1).getDay()):n=t.getDay(),0===n&&(n=7),n},_getMonthDays:function(t,e){var i=[31,28,31,30,31,30,31,31,30,31,30,31][t];return 28!==i||e%4!=0||e%100==0&&e%400!=0||(i=29),i},_isDateSelected:!1}),function(t,e,i){var n=t.INTERNAL,s=n.ELEM_DELIM,o={area:1,base:1,br:1,col:1,command:1,embed:1,hr:1,img:1,input:1,keygen:1,link:1,meta:1,param:1,source:1,wbr:1},r=n.buildClass,a=n.buildClasses,c={};function l(t,e,i){(t[e]||(t[e]=[])).unshift(i)}function d(t,e){return e.modName?function(i){(i._curBlock.mods||{})[e.modName]===e.modVal&&t(i)}:t}function h(t,i){var n,s=e.isArray(i);return e.isArray(t)?s?n=t.concat(i):(n=t).push(i):s?(n=i).unshift(t):n=[t,i],n}var u={'"':"&quot;","&":"&amp;","<":"&lt;",">":"&gt;"},m=/["&<>]/g;t.HTML={decl:function(t,i){"string"==typeof t&&(t={block:t}),t.name&&(t.block=t.name);var n=c[t.block]||(c[t.block]={});i.onBlock&&l(n,"_block",d(i.onBlock,t)),i.onElem&&(e.isFunction(i.onElem)?l(n,"_elem",d(i.onElem,t)):e.each(i.onElem,function(e,i){l(n,"_elem"+("*"===e?"":s+e),d(i,t))}))},build:function(t){var e=new this.Ctx(t);return e._buildAll(),e._flush()},Ctx:e.inherit({__constructor:function(t){this._buffer=[],this._params=t,this._tParams=null,this._tParamsChanges=null,this._curBlock=void 0},pos:function(){return this._params._pos},isFirst:function(){return 1===this._params._pos},isLast:function(){var t=this._params;return t._pos===t._siblingsCount},params:function(t){return void 0===t?this._params:(this._params=t,this)},param:function(t,i,n,s){var o=this._params;return void 0===i?o[t]:(!n&&t in o?s&&(o[t]=e.extend(i,o[t])):o[t]=i,this)},attrs:function(t,e){return this.param("attrs",t,e,!0)},attr:function(t,e,i){if(void 0===e)return(this._params.attrs||{})[t];var n=this._params.attrs;return n?(i||!(t in n))&&(n[t]=e):(this._params.attrs={})[t]=e,this},tag:function(t,e){return this.param("tag",t,e)},cls:function(t,e){return this.param("cls",t,e)},mods:function(t,e){return this.param("mods",t,e,!0)},mod:function(t,e,i){if(void 0===e)return(this._params.mods||{})[t];var n=this._params.mods;return n?(i||!(t in n))&&(n[t]=e):(this._params.mods={})[t]=e,this},mix:function(t,e){var i=this._params;return void 0===t?i.mix:(i.mix=!e&&"mix"in i?i.mix.concat(t):t,this)},js:function(t){return this.param("js",t)},content:function(t,e){return this.param("content",t,e)},wrapContent:function(t){var e=this._params;return t.content=e.content,e.content=t,this},beforeContent:function(t){var e=this._params;return e.content=h(t,e.content),this},afterContent:function(t){var e=this._params;return e.content=h(e.content,t),this},wrap:function(t){var e=this._params;return t.block||(t._curBlock=this._curBlock),t.content=e._wrapper?e._wrapper:e,e._wrapper=t,this},tParam:function(t,e){var i=this._tParams||(this._tParams={});if(void 0===e)return i[t];var n=this._tParamsChanges||(this._tParamsChanges={});return t in n||(n[t]=i[t]),i[t]=e,this},generateId:function(){return e.identify()},stop:function(){this._params._isStopped=!0},_buildAll:function(){var t=this._buffer,i=this._params,n=typeof i;if("string"===n||"number"===n)t.push(i);else if(e.isArray(i))for(var s,o,r=0,a=i.length;r<a;)this._params=s=i[r++],"string"===(o=typeof s)||"number"===o?t.push(s):s&&(s._pos=r,s._siblingsCount=a,this._buildByDecl());else i&&(this._params._pos=this._params._siblingsCount=1,this._buildByDecl())},_build:function(){var t,i=this._buffer,n=this._params,s=n.tag||"div",c=n.block||n.elem,l=c&&(n.block||this._curBlock.block),d=!1;n.js&&((t={})[r(l,n.elem)]=!0===n.js?{}:n.js,d=!n.elem),i.push("<",s),(c||n.cls)&&(i.push(' class="'),c&&(a(l,n.elem,n.mods,i),n.mix&&e.each(n.mix,function(e,n){n&&(i.push(" "),a(n.block,n.elem,n.mods,i),n.js&&((t||(t={}))[r(n.block,n.elem)]=!0===n.js?{}:n.js,d||(d=!n.elem)))})),n.cls&&i.push(c?" ":"",n.cls),d&&i.push(" i-bem"),i.push('"')),t&&i.push(' onclick="return ',JSON.stringify(t).replace(m,function(t){return u[t]}),'"'),n.attrs&&e.each(n.attrs,function(t,e){void 0!==e&&null!==e&&!1!==e&&i.push(" ",t,'="',e.toString().replace(/"/g,"&quot;"),'"')}),o[s]?i.push("/>"):(i.push(">"),void 0!==n.content&&(this._params=n.content,this._buildAll()),i.push("</",s,">"))},_flush:function(){var t=this._buffer.join("");return delete this._buffer,t},_buildByDecl:function(){var t=this._curBlock,i=this._params;if(i._curBlock&&(this._curBlock=i._curBlock),i.block&&(this._curBlock=i),!i._wrapper){if(i.block||i.elem){var n,o=c[this._curBlock.block];if(o)if(i.elem?(n=o["_elem"+s+i.elem],o._elem&&(n=n?n.concat(o._elem):o._elem)):n=o._block,n)for(var r,a=0;(r=n[a++])&&(r(this),!i._isStopped););}if(i._wrapper)return i._curBlock=this._curBlock,this._params=i._wrapper,this._buildAll()}var l=this._tParamsChanges;if(this._tParamsChanges=null,this._build(),this._curBlock=t,l){var d=this._tParams;e.each(l,function(t,e){void 0===e?delete d[t]:d[t]=e})}}})}}(BEM,jQuery),function(){var t=0,e=!1,i=0,n=BEM.channel("sys"),s=window.setTimeout;BEM.decl("i-system",{},{start:function(){$(document).bind("mousemove keydown",function(){i=0,e&&(e=!1,n.trigger("wakeup"))}),this._tick()},_tick:function o(){n.trigger("tick",{counter:t++}),!e&&(i+=50)>3e3&&(e=!0,n.trigger("idle")),s(o,50)}}).start()}(),BEM.DOM.decl("mi-error",{_onError:function(t,e){var i;if(e&&(!e.error||e.error.id)){if(!e.content&&e.error||e.error&&!e.error.message){var n=e.error.meta;e.content={body:[BEM.I18N("mi-error",e.error.id)]},n&&Object.keys(n).forEach(function(t){e.content.body.push({elem:"meta",content:t+": "+n[t]})})}i=BEMHTML.apply(this._getErrorBEMJSON(e.content)),e.node?(this._getPopup(),this._popup.setContent(i).show(e.node)):(this._getModal(),this._modal.setContent(i).show())}}}),BEM.DOM.decl("mi-error",{_onError:function(t,e){var i;if(e&&(!e.error||e.error.id)){if(!e.content&&e.error||e.error&&!e.error.message){var n=e.error.meta;e.content={body:[BEM.I18N("mi-error",e.error.id)]},n&&Object.keys(n).forEach(function(t){e.content.body.push({elem:"meta",content:t+": "+n[t]})})}i=BEMHTML.apply(this._getErrorBEMJSON(e.content)),e.node?(this._getPopup(),this._popup.setContent(i).show(e.node)):(this._getModal(),this._modal.setContent(i).show())}}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"checkbox"},{onSetMod:{state:{edit:function(){var t=this;this.__base.apply(this,arguments),this._setEdit(),this._resizeEdit(),setTimeout(function(){keymaster("space",function(e){e.preventDefault(),t._toggleCheckbox(e)})},0)},"":function(){this.domElem.removeAttr("style"),this._checkbox.domElem.blur(),this.unbindFrom(this.domElem,"clickoutside"),this.unbindFrom(BEM.DOM.win,"resize.cellWidth"),keymaster.unbind("space"),this.trigger("stop-edit"),this._clearSize()}}},val:function(){return this._checkbox.hasMod("checked")},_initBlock:function(){this.__base.apply(this,arguments),this._setEdit()},_onClick:function(){this.__base.apply(this,arguments),this._initBlock()},_setEdit:function(){this._checkbox||(this._checkbox=this.findBlockInside("checkbox"),this.afterCurrentEvent(function(){this._checkbox.on("change",function(t,e){this._save(e.checked)},this)}))},_resizeEdit:function(){this.elem("edit").css({width:this._sizes.outerWidth+1,height:this._sizes.outerHeight+1})},_clearSize:function(){this.hasMod("saving","yes")||(this.elem("edit").removeAttr("style"),this.__base.apply(this,arguments))},_toggleCheckbox:function(){this._checkbox.toggleMod("checked","yes")},_onSaved:function(t,e){this.delMod("saving"),this._checkbox.delMod("disabled"),this.params.raw=e.data.cell.raw,this.channel("errors").trigger("errorHide")},_onSaveError:function(){},_save:function(t){var e=this.__base.apply(this,arguments);e.val=t,e.val!==this.params.raw&&(this.afterCurrentEvent(function(){this._checkbox.setMod("disabled","yes")},this),this._checkbox.hasMod("markdone","yes")&&this._storage._row.setMod("checked",t?"yes":""),this.trigger("save",e))},_resetValue:function(){return!0}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"select"},{val:function(){if(this.__base.apply(this,arguments)){var t=this._select.getVal();return t!==BEM.I18N("b-grid-table-cell","select")?t:void 0}},_initBlock:function(){if(this.__base.apply(this,arguments),!this._storage._table.hasMod("mode","edit")||this.hasMod("state","edit"))return!1;this._setEdit()},_resizeEdit:function(){var t=this.findElem("edit"),e=this._sizes.outerWidth;t.width()<=e&&this.setMod(t,"offset","no"),t.css({"min-width":e+1,"min-height":this._sizes.outerHeight+1,"max-width":e<400?400:e})},_clearSize:function(){var t=this.findElem("edit");this.delMod(t,"offset"),t.removeAttr("style"),this.__base.apply(this,arguments)},_onClickOutside:function(){this._preventCellOutside||this.__base.apply(this,arguments),this._preventCellOutside=!1},_onSaved:function(){this.__base.apply(this,arguments),BEM.DOM.destruct(this.findElem("i")),BEM.DOM.append(this.domElem,BEMHTML.apply(BEM.blocks["b-grid-table"].getSelectBEMJSON(this.params)))},_setEdit:function(){this._select||(BEM.DOM.append(this.domElem,this._getSelect()),this._select=this.findBlockInside("select2"),this._selectButton=this._select.findBlockInside("button2"),this._select.popup.on("beforeOpen",this._onSelectOpen,this),this._select.popup.on("afterClose",this._onSelectClose,this)),this.__base.apply(this,arguments)},_getSelect:function(){var t=this._getSelectData();return BEMHTML.apply({block:this.__self.getName(),elem:"edit",content:{block:"select2",name:"rand_"+Date.now(),mods:{size:"m",text:"vary",theme:"normal",type:"radiocheck",role:"grid"},text:this.params.raw&&this.params.raw[0]||BEM.I18N("b-grid-table-cell","select"),items:t.items,val:t.val}})},_getSelectData:function(){var t,e,i=this;return(t=this.params.options.map(function(t){var n={val:t,text:t};return(i.params.raw&&i.params.raw[0])===t&&(e=t),n})).unshift({text:BEM.I18N("b-grid-table-cell","select"),val:BEM.I18N("b-grid-table-cell","select")}),{items:t,val:e}},_onSelectOpen:function(){this._storage._table._preventEnter=!0,this._storage._table._preventRowOutside=!0,this._preventCellOutside=!0,this._selectButton.setMod("focused","yes")},_onSelectClose:function(){var t=this;setTimeout(function(){t._storage._table._preventEnter=!1,t._storage._table._preventRowOutside=!1,t._preventCellOutside=!1,t._selectButton.delMod("pressed").delMod("focused")},0)},_save:function(){var t=this.__base.apply(this,arguments);t.val=this.val(),t.val!==this.params.raw[0]?this.setMod("saving","yes").trigger("save",t):(this.delMod("state"),this._clearSize())},_resetValue:function(){!1!==this.__base.call(this,this.val(),this.params.raw[0])&&this.val()!==this.params.raw[0]&&this._select.val(this.params.raw[0]?this.params.raw[0]:BEM.I18N("b-grid-table-cell","select"))},showEditControl:function(t){t.preventDefault(),this._select.isOpened()||this._select.open()}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"multiselect"},{val:function(){return this._raw},escaped_val:function(){return this._raw.map(_.escape)},_initRaw:function(){this._raw=[].concat(this.params.raw).map(function(t){return _.unescape(t).replace(/&#39;/g,"'")})},_removeFromRaw:function(t){var e=this.val().filter(function(e){return e!==t});this._raw=e},_addToRaw:function(t){this._raw.push(t)},_onClickOutside:function(){this._preventCellOutside||this.__base.apply(this,arguments),this._preventCellOutside=!1},_initBlock:function(){if(this.__base.apply(this,arguments),this._initRaw(),!this._storage._table.hasMod("mode","edit")||this.hasMod("state","edit"))return!1;this._setEdit()},_onSaved:function(){this.__base.apply(this,arguments),BEM.blocks["b-grid-table-token"].un(this.domElem,"remove",this._onTokenRemove),BEM.DOM.update(this.domElem,BEMHTML.apply(BEM.blocks["b-grid-table"].getMultiSelectBEMJSON(this.params)))},_setEdit:function(){this._updateEditState(),this.__base.apply(this,arguments)},_resizeEdit:function(){var t=this.findElem("edit"),e=this._sizes.outerWidth;t.width()<=e&&this.setMod(t,"offset","no"),t.css({"min-width":e+1,"min-height":this._sizes.outerHeight+1,"max-width":e<400?400:e})},_clearSize:function(){var t=this.findElem("edit");this.delMod(t,"offset"),t.removeAttr("style"),this.__base.apply(this,arguments)},_updateEditState:function(){this._select&&this._select.destruct();var t=this._getTokens(),e=this._getSelect(),i=this,n=BEMHTML.apply({block:this.__self.getName(),elem:"edit",content:e}),s=this.findElem("edit");this._preventCellOutside=!0,s.length?BEM.DOM.replace(s,n):BEM.DOM.append(this.domElem,n),this._select=this.findBlockInside("select2"),this._select&&(this._selectButton=this._select.findBlockInside("button2"),this._select.on("change",this._onSelectChange,this),this._select.on("beforeOpen",this._onSelectOpen,this),this._select.on("afterClose",this._onSelectClose,this));var o=this._getTokensPopup();o.setContent(BEMHTML.apply(t)),this.afterCurrentEvent(function(){o.setMod("visible","yes")}),setTimeout(function(){i._preventCellOutside=!1},0)},_getTokensPopup:function(){return this._tokensPopup&&this._tokensPopup.domElem||(this._tokensPopup=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply(this.__self._getPopupBEMJSON())).bem("popup2").setAnchor(this.findElem("edit")),this._tokensPopup.bindTo("click",this._onTokensPopupClick.bind(this)),BEM.blocks["b-grid-table-token"].on(this._tokensPopup.domElem,"remove",this._onTokenRemove,this)),this._tokensPopup},_onTokensPopupClick:function(){this._storage._table._preventCellOutside=!0,this._preventExitEditing=!0},_onTokenRemove:function(t){t.block.hasMod("type","multiselect")&&this.hasMod("state","edit")&&(this._removeFromRaw(t.block.params.raw),this._preventCellOutside=!0,this._storage._table._preventRowOutside=!0,this._updateEditState(),this._resizeEdit())},_onSelectChange:function(){var t=this._select.getVal();this._preventCellOutside=!0,this._storage._table._preventRowOutside=!0,t!==BEM.I18N("b-grid-table-cell","select")&&(this._addToRaw(t),this._updateEditState(),this._resizeEdit())},_onSelectOpen:function(){this._storage._table._preventEnter=!0,this._selectButton.setMod("focused","yes")},_onSelectClose:function(){var t=this;setTimeout(function(){t._storage._table._preventEnter=!1,t._selectButton.domElem&&t._selectButton.delMod("pressed").delMod("focused")},0)},_getSelect:function(){return this._getSelectContent()?{block:"select2",name:"rand_"+Date.now(),mods:{size:"m",theme:"normal",type:"radiocheck",role:"grid"},text:BEM.I18N("b-grid-table-cell","to_choose"),items:this._getSelectContent()}:""},_getTokens:function(){var t,e=this.val();return e.length&&(t={block:"b-grid-table-tokens",content:e.map(function(t){return{block:"b-grid-table-token",mods:{type:"multiselect"},js:{raw:t},content:[t,{elem:"remove",tag:"span",content:"×"}]}})}),t},_getSelectContent:function(){var t=this._getOptions();if(t.length)return t.unshift(BEM.I18N("b-grid-table-cell","select")),t.map(function(t){return{val:t,text:t}})},_getOptions:function(){return _.difference(this.params.options,this.val())},_save:function(){var t=this.__base.apply(this,arguments);t.val=this.val(),this._storage._table._preventRowOutside=!0,this._hasChanges(this.escaped_val(),this.params.raw)?this.setMod("saving","yes").trigger("save",t):(this.delMod("state"),BEM.DOM.update(this.domElem,BEMHTML.apply(BEM.blocks["b-grid-table"].getMultiSelectBEMJSON(this.params))),this._clearSize())},_resetValue:function(){!1!==this.__base.apply(this,arguments)&&this._hasChanges(this.escaped_val(),this.params.raw)&&(this._initRaw(),this._updateEditState(),this._resizeEdit())},showEditControl:function(t){t.preventDefault(),this._select.isOpened()||this._select.open()}},{_getPopupBEMJSON:function(){return{block:"popup2",mix:{block:"b-grid-table-cell",elem:"popup"},mods:{target:"anchor",theme:"normal"}}}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"number"},{val:function(){var t;if(this.__base.apply(this,arguments))return(t=this._input.val()).length?t:null},_initBlock:function(){if(this.__base.apply(this,arguments),!this._storage._table.hasMod("mode","edit")||this.hasMod("state","edit")||this.hasMod("saving","yes"))return!1;this._setEdit()},_onSaved:function(t,e){this.__base.apply(this,arguments),BEM.DOM.destruct(this.findElem("i")),BEM.DOM.append(this.domElem,BEMHTML.apply(BEM.blocks["b-grid-table"].getNumberBEMJSON(this.params)))},_isRequiredAndEmpty:function(){return!!this.hasMod("required")&&(null===this.params.raw||Boolean("object"==typeof this.params.raw&&!this.params.raw.length))},_setEdit:function(){this._input?this._input.val(null!==this.params.raw?this.params.raw:""):(BEM.DOM.append(this.domElem,this._getInput()),this._input=this.findBlockInside("input"),this._input.bindTo("input",BEM.blocks["mi-helpers"].validateNumberOnlyInput)),this.__base.apply(this,arguments),this.afterCurrentEvent(function(){this._input.setMod("focused","yes").elem("control").select()})},_resizeEdit:function(){this._input.elem("box").width(this._sizes.outerWidth-1),this._input.elem("control").height(this._sizes.outerHeight-1)},_clearSize:function(){this._input.elem("box").width(""),this._input.elem("control").height(""),this.__base.apply(this,arguments)},_getInput:function(){return BEMHTML.apply({block:this.__self.getName(),elem:"edit",content:{block:"input",mods:{size:"s"},content:{elem:"control"},value:this.params.raw}})},_save:function(){var t=this.__base.apply(this,arguments);t.val=this.val(),this._hasChanged(t.val)?this.setMod("saving","yes").trigger("save",t):(this.delMod("state"),this._clearSize())},_resetValue:function(){var t=this;!1!==this.__base.apply(this,arguments)&&this._hasChanged(this.val())&&this.afterCurrentEvent(function(){t._input.val(t.params.raw||"")})},_hasChanged:function(t){return t!==(this.params.raw?this.params.raw.toString():this.params.raw)}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"date"},{val:function(){var t;if(this.__base.apply(this,arguments))return(t=this._calendar.getDate())?BEM.blocks["mi-helpers"].getHumanStringFromDate({date:t}):""},_initBlock:function(){if(this.__base.apply(this,arguments),!this._storage._table.hasMod("mode","edit")||this.hasMod("state","edit"))return!1;this._setEdit()},_setEdit:function(){this._calendar||(BEM.DOM.append(this.domElem,this._getCalendar()),this._calendar=this.findBlockInside("m-calendar"),this._calendar.on("show",this._onCalendarShow,this).on("hide",this._onCalendarHide,this)),this.__base.apply(this,arguments)},_onCalendarShow:function(){this._storage._table._lockOutsideClicks=!0},_onCalendarHide:function(){var t=this;setTimeout(function(){t._storage._table._lockOutsideClicks=!1},0)},_onSaved:function(t,e){this.__base.apply(this,arguments),BEM.DOM.destruct(this.findElem("i")),BEM.DOM.append(this.domElem,BEMHTML.apply(BEM.blocks["b-grid-table"].getDateBEMJSON(this.params)))},_resizeEdit:function(){this.elem("edit").css({"min-width":this._sizes.outerWidth+1,"min-height":this._sizes.outerHeight+1})},_clearSize:function(){this.elem("edit").removeAttr("style"),this.__base.apply(this,arguments)},_onClickOutside:function(){this._preventCellOutside||this._storage._table._lockOutsideClicks||this.__base.apply(this,arguments),this._preventCellOutside=!1},_getCalendar:function(){var t={block:"m-calendar",mods:{toggler:"button",type:"month",has:"clear"},js:{defaultText:BEM.I18N("b-grid-table-cell","choose_date"),value:this.params.raw,autoclose:!0},size:"m",theme:"grey"};return BEMHTML.apply({block:this.__self.getName(),elem:"edit",content:t})},_save:function(){var t=this.__base.apply(this,arguments);t.val=this.val(),t.val!==this.params.raw?this.setMod("saving","yes").trigger("save",t):(this.delMod("state"),this._clearSize())},_resetValue:function(){!1!==this.__base.apply(this,arguments)&&this.val()!==this.params.raw&&(this.params.raw?this._calendar.setDate(this.params.raw):this._calendar.clearDate())},showEditControl:function(t){t.preventDefault(),this.afterCurrentEvent(function(){this._calendar._onTogglerClick()})}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"staff"},{_initBlock:function(){if(this.__base.apply(this,arguments),!this._storage._table.hasMod("mode","edit")||this.hasMod("state","edit"))return!1;var t=this.params.raw.length?this.params.raw[0]:"";this._cellValue=_.unescape(t).replace(/&#39;/g,"'"),this._controlValue=this._cellValue,this._setEdit()},val:function(){return[this._controlValue]},_setEdit:function(){this._storage._table._preventCurrentRowOutsideClick=!0,this._staffSelect||(BEM.DOM.append(this.domElem,this._getStaffSelect()),this._staffSelect=this.findBlockInside("m-suggest").on("select",this._updateUser,this).on("change",this._onControlChange,this).on("item-highlighted",this._disallowSaveTextFromEnter,this).on("item-unhighlighted",this._allowSaveTextFromEnter,this).on("popup-hidden",this._allowSaveTextFromEnter,this)),this.__base.apply(this,arguments),this._staffSelect.val(this._cellValue),this._setFocus(),this._allowSaveTextFromEnter()},_onControlChange:function(t){this._preventSuggestInputChange||(this._controlValue=t.block.val()),this._preventSuggestInputChange=!1},_updateUser:function(t,e){var i=this,n=e.entityData;n&&(this._controlValue=n.login,this._lastSelectedUser=n,this._preventSuggestInputChange=!0,this._staffSelect.val(n.login,!0)),e.fromKeyboard||(this._preventCellOutside=!0,this._storage._table._preventRowOutside=!0),setTimeout(function(){i._preventCellOutside=!1},150)},_getStaffSelect:function(){return BEMHTML.apply({block:this.__self.getName(),elem:"edit",content:{block:"m-suggest",mods:{type:"multicomplete",size:"m"},inputMods:{clear:"no"},types:[{name:"staff"}],value:this._cellValue||!1}})},_disallowSaveTextFromEnter:function(){this._storage._table._preventEnter=!0},_allowSaveTextFromEnter:function(){var t=this;setTimeout(function(){t._storage._table._preventEnter=!1},0)},_onClickOutside:function(){this._preventCellOutside||this._storage._table._lockOutsideClicks||this.__base.apply(this,arguments),this._preventCellOutside=!1},_save:function(){var t=this.__base.apply(this,arguments);t.val=[this._controlValue],t.val[0]!==this._cellValue?this.setMod("saving","yes").trigger("save",t):(this.delMod("state"),this._clearSize())},_onSaved:function(){var t,e="&login="+this._controlValue+"&lang="+this.__self._getCellLang();this.__base.apply(this,arguments),t=this._lastSelectedUser&&this._lastSelectedUser.login===this._controlValue?[this._lastSelectedUser]:[{login:_.escape(this._controlValue)}],BEM.DOM.destruct(this.findElem("i")),BEM.DOM.append(this.domElem,BEMHTML.apply(BEM.blocks["b-grid-table"].getStaffBEMJSON({transformed:t}))),this._cellValue=this._controlValue,this._lastSelectedUser&&this._lastSelectedUser.login===this._controlValue||BEM.create("wi-api-request",{apiPath:".staff",urlParams:["format=json"+e],path:""}).run().then(this._onGetLoginData.bind(this),this._onGetLoginDataError.bind(this))},_onGetLoginData:function(t){BEM.DOM.destruct(this.findElem("i")),BEM.DOM.append(this.domElem,BEMHTML.apply(BEM.blocks["b-grid-table"].getStaffBEMJSON({transformed:[{login:this._cellValue,first_name:t.data.first_name,last_name:t.data.last_name,is_dismissed:t.data.is_dismissed}]})))},_onGetLoginDataError:function(t){t.id&&"NOT_FOUND"===t.id||BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-grid-table-cell","get_user_data_error"),t))},_setFocus:function(){this.afterCurrentEvent(function(){this._staffSelect.findBlockInside("textinput").elem("control").focus()})},_resizeEdit:function(){this._staffSelect.findBlockInside("textinput").domElem.width(this._sizes.outerWidth-1),this._staffSelect.findBlockInside("textinput").domElem.height(this._sizes.outerHeight-2),this._staffSelect.findBlockInside("textinput").elem("control").height(this._sizes.outerHeight-1)},_clearSize:function(){this._staffSelect.findBlockInside("textinput").domElem.width(""),this._staffSelect.findBlockInside("textinput").domElem.height(""),this._staffSelect.findBlockInside("textinput").elem("control").height(""),this.__base.apply(this,arguments)},_resetValue:function(){!1!==this.__base.apply(this,[this.val()[0],this._cellValue])&&this.afterCurrentEvent(function(){this._staffSelect.val(this._cellValue),this._setFocus()})}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"staff"},{_updateUser:function(t,e){var i=this,n=e.entityData;if(n){var s=n.fields.find(function(t){return"login"===t.type}).value;this._controlValue=s,this._lastSelectedUser=_.extend(n,{login:s}),this._preventSuggestInputChange=!0}e.fromKeyboard||(this._preventCellOutside=!0,this._storage._table._preventRowOutside=!0),setTimeout(function(){i._preventCellOutside=!1},150)},_getStaffSelect:function(){return BEMHTML.apply({block:this.__self.getName(),elem:"edit",content:{block:"m-suggest",mods:{type:"b2b",size:"m",multicomplete:"yes"},url:BEM.blocks["i-global"].param("hosts").suggest.url,inputMods:{clear:"no"},types:[{name:"staff"}],value:this._cellValue||!1}})}}),BEM.DOM.decl({block:"m-suggest",modName:"type",modVal:"b2b"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._requestSettings={type:this.__self.REQUEST_TYPE,url:this.params.url,dataType:this.__self.REQUEST_DATA_TYPE,timeout:this.__self.REQUEST_TIMEOUT,xhrFields:{withCredentials:!0},crossDomain:!0}}},_prepareRequestData:function(t){return $.extend({},this._requestSettings,{data:$.extend({text:t,layers:this.params.layers||"people",version:1},this.params.addRequestParams)})},_isNotEmptyResult:function(t){return t.some(function(t){return t.result.length})},_getItemsHTML:function(t){return BEMHTML.apply(t.map(function(t){return Boolean(t.result.length)&&{block:"m-suggest-group",mods:{"is-b2b":"yes"},groupLabel:"b2b-"+t.layer,content:t.result.map(function(e){return e.href=e.url,delete e.url,this._getItemBEMJSON("b2b-"+t.layer,e)},this)}},this))},_getItemBEMJSON:function(t,e){return{block:"m-suggest-item",mods:{type:t,size:this.getMod("size"),link:this.hasMod("multicomplete","yes")?"":"yes",labels:this.params.inHeader||this.params.inSearchHeader?"yes":"","in-search-header":this.params.inSearchHeader&&"yes"},href:e.url,data:e,inputData:{text:this._getInputValue4Request(),offset:this._input.findElem("box").offset(),width:this._input.domElem.outerWidth()},inSearchHeader:this.params.inSearchHeader}},_selectItem:function(){this.__base.apply(this,arguments),this.hasMod("multicomplete","yes")?this._multicompleteItem.apply(this,arguments):this._suggestItem.apply(this,arguments)},_suggestItem:function(t,e){this.__base.apply(this,arguments),e&&BEM.DOM.win[0].open(t.params.href,this.params.target||"_self")},_multicompleteItem:function(t,e){this.val(t,!0),this.__base.apply(this,arguments),this._items[this._curItemIndex]&&this._items[this._curItemIndex].delMod("hovered"),this._curItemIndex=-1,this._popup.hide()}}),BEM.DOM.decl({block:"m-suggest",modName:"type",modVal:"b2b"},{_getItemBEMJSON:function(t,e){return{block:"m-suggest-item",mods:{type:t,size:this.getMod("size"),link:this.hasMod("multicomplete","yes")?"":"yes",labels:this.params.inHeader||this.params.inSearchHeader?"yes":"","in-search-header":this.params.inSearchHeader&&"yes"},href:e.url,data:e,inputData:{text:this._getInputValue4Request(),offset:this._input.findElem("box").offset(),width:this._input.domElem.outerWidth()},inSearchHeader:this.params.inSearchHeader,intranet:Boolean(this.params.intranet)}}}),BEM.DOM.decl({block:"m-suggest",modName:"type",modVal:"b2b"},{_multicompleteItem:function(t,e){this.val(t,!0),this._items[this._curItemIndex]&&this._items[this._curItemIndex].delMod("hovered"),this._curItemIndex=-1,this._popup.delMod("visible")}}),BEM.DOM.decl({block:"m-suggest",modName:"type",modVal:"b2b"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._requestSettings={type:this.__self.REQUEST_TYPE,url:this.params.url,timeout:this.__self.REQUEST_TIMEOUT,xhrFields:{withCredentials:!0},crossDomain:!0}}},_selectItem:function(t,e,i){this.hasMod("multicomplete","yes")?this._multicompleteItem.apply(this,arguments):this._suggestItem.apply(this,arguments),!i&&this.trigger("select",{entityData:t.params.fullData,fromKeyboard:e})}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"multistaff"},{val:function(){if(this.__base.apply(this,arguments))return this.params.raw},_onSaved:function(){this.__base.apply(this,arguments),BEM.DOM.destruct(this.elem("edit")),BEM.DOM.destruct(this.elem("i")),BEM.DOM.prepend(this.domElem,BEMHTML.apply(BEM.blocks["b-grid-table"].getStaffBEMJSON(this.params))),this.dropElemCache()},_initBlock:function(){if(this.__base.apply(this,arguments),!this._storage._table.hasMod("mode","edit")||this.hasMod("state","edit"))return!1;this._storage._table._preventEnter=!0,this._previousRaw=[].concat(this.params.raw),this._previousTransformed=[].concat(this.params.transformed).map(function(t){var e=t;return e.login=_.unescape(t.login).replace(/&#39;/g,"'"),e}),this._setEdit()},_resizeEdit:function(){var t=this.findElem("edit"),e=this._sizes.outerWidth;t.width()<=e&&this.setMod(t,"offset","no"),t.css({"min-width":e+1,"min-height":this._sizes.outerHeight+1,"max-width":e<400?400:e})},_clearSize:function(){var t=this.findElem("edit");this.delMod(t,"offset"),t.removeAttr("style"),this.__base.apply(this,arguments)},_onClickOutside:function(){this._preventCellOutside||this.__base.apply(this,arguments),this._preventCellOutside=!1},_setEdit:function(){var t=BEMHTML.apply({block:this.__self.getName(),elem:"edit",content:this._getMulticomplete()});BEM.DOM.append(this.domElem,t);var e=this._getUsersPopup();e.setContent(BEMHTML.apply({block:"b-grid-table-tokens",content:this._getUserTokens()})),this.afterCurrentEvent(function(){e.setMod("visible","yes")}),this._staffSelect=this.findBlockInside(this.elem("edit"),"m-suggest").on("select",this._onStaffSelect,this).on("item-highlighted",this._disallowSaveTextFromEnter,this).on("item-unhighlighted",this._allowSaveTextFromEnter,this).on("popup-hidden",this._allowSaveTextFromEnter,this),this._tokens=this.findBlockInside(e.domElem,"b-grid-table-tokens"),this._setFocus(),this._allowSaveTextFromEnter(),this.__base.apply(this,arguments)},_disallowSaveTextFromEnter:function(){this._staffSelect.unbindFrom("keyup")},_allowSaveTextFromEnter:function(){this._staffSelect.bindTo("keyup",function(t){13===t.keyCode&&(this._saveText(),this._staffSelect.hidePopup())}.bind(this))},_onStaffSelect:function(t,e){var i=this,n=e.entityData;this.params.transformed.push(n),this.params.raw.push(n.login),BEM.DOM.update(this._tokens.domElem,BEMHTML.apply(this._getUserTokens())),this._staffSelect.val(""),e.fromKeyboard||(this._preventCellOutside=!0,this._storage._table._preventRowOutside=!0),setTimeout(function(){i._preventCellOutside=!1},150)},_saveText:function(){var t=this._staffSelect.val();t&&(this.params.transformed.push({login:_.escape(t)}),this.params.raw.push(t),BEM.DOM.update(this._tokens.domElem,BEMHTML.apply(this._getUserTokens())),this._staffSelect.val(""),BEM.create("wi-api-request",{apiPath:".staff",urlParams:["format=json&login="+t+"&lang="+this.__self._getCellLang()],path:""}).run().then(this._onGetLoginData.bind(this,t),this._onGetLoginDataError.bind(this)))},_onGetLoginData:function(t,e){var i;for(i=0;i<this.params.transformed.length;i++)this.params.transformed[i].login===t&&(this.params.transformed[i]={login:t,first_name:e.data.first_name,last_name:e.data.last_name,is_dismissed:e.data.is_dismissed});BEM.DOM.update(this._tokens.domElem,BEMHTML.apply(this._getUserTokens()))},_onGetLoginDataError:function(t){t.id&&"NOT_FOUND"===t.id||BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-grid-table-cell","get_user_data_error"),t))},_onTokenRemove:function(t){var e,i,n=t.block;n.hasMod("type","multistaff")&&this.hasMod("state","edit")&&(this._preventCellOutside=!0,this._storage._table._preventRowOutside=!0,e=this.params.raw.filter(function(t){return t!==n.params.user}),i=this.params.transformed.filter(function(t){return t.login!==n.params.user}),this.params.raw=e,this.params.transformed=i,BEM.DOM.update(this._tokens.domElem,BEMHTML.apply(this._getUserTokens())))},_getMulticomplete:function(){return[{block:"m-suggest",mods:{type:"multicomplete",size:"m"},inputMods:{clear:"no"},types:[{name:"staff"}]}]},_getUserTokens:function(){if(this.params.transformed&&this.params.transformed.length)return this.params.transformed.map(function(t){return{block:"b-grid-table-token",mods:{type:"multistaff"},js:{user:t.login},content:[t.first_name?{block:"m-username",mods:{dismissed:t.is_dismissed?"yes":""},mix:[{block:"mi-staff-card",js:{user:t.login}}],url:"//staff.yandex-team.ru/"+t.login,content:t.first_name+" "+t.last_name}:t.login,{elem:"remove",tag:"span",content:"×"}]}})},_save:function(){var t=this.__base.apply(this,arguments);t.val=this.val(),this._hasChanges(t.val,this._previousRaw)?this.setMod("saving","yes").trigger("save",t):(this.delMod("state"),BEM.DOM.destruct(this.elem("edit")),this.dropElemCache())},_getUsersPopup:function(){return this._usersPopup&&this._usersPopup.domElem||(this._usersPopup=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply(this._getPopupBEMJSON())).bem("popup2").setAnchor(this.findElem("edit")),this._usersPopup.bindTo("click",this._onUsersPopupClick.bind(this)),BEM.blocks["b-grid-table-token"].on(this._usersPopup.domElem,"remove",this._onTokenRemove,this)),this._usersPopup},_onUsersPopupClick:function(){this._storage._table._preventCellOutside=!0,this._preventExitEditing=!0},_getPopupBEMJSON:function(){return{block:"popup2",mix:{block:"b-grid-table-cell",elem:"popup"},mods:{target:"anchor",theme:"normal"}}},_setFocus:function(){this.afterCurrentEvent(function(){this._staffSelect.findBlockInside("textinput").elem("control").focus()})},_resetValue:function(){!1!==this.__base.apply(this,[this.val(),this._previousRaw])&&(this.params.raw=[].concat(this._previousRaw),this.params.transformed=[].concat(this._previousTransformed),BEM.DOM.update(this._tokens.domElem,BEMHTML.apply(this._getUserTokens())),this._staffSelect.val(""))}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"multistaff"},{_getUserTokens:function(){if(this.params.transformed&&this.params.transformed.length)return this.params.transformed.map(function(t){var e=t.title;return t.first_name&&t.last_name&&(e=t.first_name+" "+t.last_name),{block:"b-grid-table-token",mods:{type:"multistaff"},js:{user:t.login},content:[e?{block:"m-username",login:t.login,content:e}:t.login,{elem:"remove",tag:"span",content:"×"}]}})},_getMulticomplete:function(){return[{block:"m-suggest",mods:{type:"b2b",size:"m",multicomplete:"yes"},url:BEM.blocks["i-global"].param("hosts").suggest.url,inputMods:{clear:"no"},types:[{name:"staff"}]}]},_onStaffSelect:function(t,e){var i=this,n=e.entityData;n.login=n.fields.find(function(t){return"login"===t.type}).value,this.params.transformed.push(n),this.params.raw.push(n.login),this._staffSelect.val(""),BEM.DOM.update(this._tokens.domElem,BEMHTML.apply(this._getUserTokens())),e.fromKeyboard||(this._preventCellOutside=!0,this._storage._table._preventRowOutside=!0),setTimeout(function(){i._preventCellOutside=!1},150)}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"ticket"},{val:function(){var t;if(this.__base.apply(this,arguments))return(t=this._input.val()).length?t:null},_initBlock:function(){if(this.__base.apply(this,arguments),!this._storage._table.hasMod("mode","edit")||this.hasMod("state","edit")||this.hasMod("saving","yes"))return!1;this._setEdit()},_onSaved:function(t,e){this.__base.apply(this,arguments),BEM.DOM.destruct(this.findElem("i")),BEM.DOM.prepend(this.domElem,BEMHTML.apply(BEM.blocks["b-grid-table"].getTicketBEMJSON(e.data.cell)))},_setEdit:function(){this._input||(BEM.DOM.append(this.domElem,this._getInput()),this._input=this.findBlockInside("input"),this._input.val(this.params.raw||"")),this.__base.apply(this,arguments),this.afterCurrentEvent(function(){this._input.setMod("focused","yes").elem("control").select()})},_resizeEdit:function(){this._input.elem("box").width(this._sizes.outerWidth-1),this._input.elem("control").height(this._sizes.outerHeight-1)},_clearSize:function(){this._input.elem("box").width(""),this._input.elem("control").height(""),this.__base.apply(this,arguments)},_getInput:function(){return BEMHTML.apply({block:this.__self.getName(),elem:"edit",content:{block:"input",mods:{size:"s"},value:this.params.raw,content:{elem:"control"}}})},_save:function(){var t=this.__base.apply(this,arguments);t.val=this.val(),this._hasChanges(t.val,this.params.raw)?this.setMod("saving","yes").trigger("save",t):this.delMod("state")},_resetValue:function(){var t=this;!1!==this.__base.apply(this,[this.val(),this.params.raw])&&this.afterCurrentEvent(function(){t._input.val(t.params.raw)})}}),BEM.DOM.decl("b-grid-table-head",{_onEditClick:function(t){this._storage||this._createStorage(),"create"===t&&this.createCol(),"edit"===t&&this.editCol()},_onSortClick:function(){var t;this._storage||this._createStorage(),this._storage._table.noSorting||(this._icon||(this._icon=this.findBlockInside(this.elem("sort"),"awesome-icon")),t=this._icon.hasMod("icon","angle-down")||this._icon.hasMod("icon","sort-up")?"asc":"desc",BEM.DOM.update(this.elem("sort"),BEMHTML.apply({block:"spin2",mods:{size:"xs",progress:"yes"}})),BEM.create("wi-api-request",{apiPath:".grid",path:"/"+this._storage._table.params.supertag,urlParams:this._storage._table.gridOptionsUrlParams(["sort_"+this.params.id+"="+t])}).run().then(this._onSortSuccess.bind(this),BEM.blocks["wi-notification"].errorHandler(this.elem("sort"))))},_onSortSuccess:function(t){this.trigger("sort",t.data)},_createStorage:function(){var t=this.findBlockOutside("b-grid-table");this.__self[t.tableId]||(this.__self[t.tableId]={_table:t}),this._storage=this.__self[t.tableId]},editCol:function(){var t=this._getPopup(),e={action:"edit",isTicket:Boolean(this._storage._table.isTicket),id:this.params.id,required:this.params.required,value:this.params.value,type:this.params.type,markdone:this.params.markdone,options:this.params.options,width:this.params.width,width_units:this.params.width_units};t.delMod("visible").setAnchor(this.elem("edit")).setContent(this._getPopupContent(e)).setMod("visible","yes"),this._form=t.findBlockInside("b-grid-table-edit-col-form"),this._form.on("edit",this._sendData.bind(this,"edit")),this._form.on("delete-col",this._deleteCol,this),this._form.on("close",this._hideEditPopup,this)},_hideEditPopup:function(){this._getPopup().delMod("visible")},_deleteCol:function(){this._getPopup().delMod("visible"),this.trigger("delete",{table:this._storage._table.tableId,index:this.domElem.index()-(this._storage._table.showNumbers?1:0)})},createCol:function(){this._storage||this._createStorage();var t=this._getPopup(),e={action:"add",isTicket:Boolean(this._storage._table.isTicket),width_units:"%",newCol:!0,markdone:!0};t.delMod("visible").setAnchor(this.elem("edit")).setContent(this._getPopupContent(e)).setMod("visible","yes"),this._form=t.findBlockInside("b-grid-table-edit-col-form"),this._form.on("add",this._sendData.bind(this,"add"))},_sendData:function(t,e,i){var n={version:this._storage._table._gridData.version,changes:[{}]};this._storage._table.syncGrid().then(function(){"edit"===e.type?(n.changes[0].edited_column=i,n.changes[0].edited_column.name=this.params.id):n.changes[0].added_column=i,BEM.create("wi-api-request",{apiPath:".grid/change_and_get_document",path:"/"+this._storage._table.params.supertag,method:"POST",data:n,urlParams:this._storage._table.gridOptionsUrlParams()}).run().then(this._onEditCol.bind(this,t),BEM.blocks["wi-notification"].errorHandler())}.bind(this)),this._getPopup().delMod("visible")},_onEditCol:function(t,e){this.dropElemCache(),this._storage._table._setEditAfterRebuild=!0,this._storage._table.rebuild(e.data.grid,t)},_getTitleBEMJSON:function(t){var e={elem:"title",mix:[t.newCol&&{block:"w-getting-started",elem:"elem",elemMods:{"edit-grid-add-col":"1"}}],content:{block:"input",mods:{size:"s"},content:{elem:"control"}}};return t.value&&(e.content.value=t.value),e},_getTypeBEMJSON:function(t){var e,i;if(t.type&&t.id){switch(t.type){case"string":i=BEM.I18N("b-grid-table-head","text");break;case"number":i=BEM.I18N("b-grid-table-head","number");break;case"checkbox":i=BEM.I18N("b-grid-table-head","checkbox");break;case"date":i=BEM.I18N("b-grid-table-head","date");break;case"select":i=BEM.I18N("b-grid-table-head","list");break;case"multiselect":i=BEM.I18N("b-grid-table-head","multiple_list");break;case"staff":i=BEM.I18N("b-grid-table-head","employee");break;case"multistaff":i=BEM.I18N("b-grid-table-head","several_employees");break;case"ticket":i=BEM.I18N("b-grid-table-head","ticket_in_tracker");break;default:i=t.type}e={block:"b-grid-table-edit-col-form",elem:"type-view",content:[i+". ",{elem:"id",content:"Id-"+t.id}]}}else e={block:"select2",name:"coltypes",mods:{size:"s",theme:"normal",type:"radiocheck",text:"vary"},text:BEM.I18N("b-grid-table-head","text"),val:"string",items:[{items:[{val:"string",text:BEM.I18N("b-grid-table-head","text")},{val:"number",text:BEM.I18N("b-grid-table-head","number")},{val:"checkbox",text:BEM.I18N("b-grid-table-head","checkbox")},{val:"date",text:BEM.I18N("b-grid-table-head","date")},{val:"select",text:BEM.I18N("b-grid-table-head","list")},{val:"multiple_select",text:BEM.I18N("b-grid-table-head","multiple_list")},{val:"staff",text:BEM.I18N("b-grid-table-head","employee")},{val:"multiple_staff",text:BEM.I18N("b-grid-table-head","several_employees")},!t.isTicket&&{val:"ticket",text:BEM.I18N("b-grid-table-head","ticket_in_tracker")}]},t.isTicket&&this._getTicketOptions(t)]};return e},_getTicketOptions:function(){return{title:BEM.I18N("b-grid-table-head","tickets"),items:[{val:"ticket",text:BEM.I18N("b-grid-table-head","ticket_in_tracker")},{val:"ticket-subject",text:BEM.I18N("b-grid-table-head","title")},{val:"ticket-type",text:BEM.I18N("b-grid-table-head","type")},{val:"ticket-assignee",text:BEM.I18N("b-grid-table-head","executor")},{val:"ticket-reporter",text:BEM.I18N("b-grid-table-head","author")},{val:"ticket-status",text:BEM.I18N("b-grid-table-head","status")},{val:"ticket-priority",text:BEM.I18N("b-grid-table-head","priority")},{val:"ticket-createdat",text:BEM.I18N("b-grid-table-head","date_created")},{val:"ticket-updatedat",text:BEM.I18N("b-grid-table-head","updated")},{val:"ticket-originalestimation",text:BEM.I18N("b-grid-table-head","original_estimation")},{val:"ticket-fixversions",text:BEM.I18N("b-grid-table-head","fix_versions")},{val:"ticket-components",text:BEM.I18N("b-grid-table-head","components")},{val:"ticket-storypoints",text:BEM.I18N("b-grid-table-head","story_points")}]}},_getOptionsBEMJSON:function(t){var e=[{elem:"option-necessary",content:{block:"checkbox",mods:{size:"s",theme:"normal"},text:BEM.I18N("b-grid-table-head","mandatory")}},{elem:"option-markdone",content:{block:"checkbox",mods:{size:"s",theme:"normal"},text:BEM.I18N("b-grid-table-head","mark_made")}}];return t.required&&(e[0].content.mods.checked="yes"),t.markdone&&(e[1].content.mods.checked="yes"),e},_getDeleteBEMJSON:function(t){var e="";return t.newCol||(e={elem:"delete",content:{block:"button2",mods:{size:"s",theme:"pseudo","pseudo-pressed":"yes"},text:BEM.I18N("b-grid-table-head","remove_column")}}),e},_getOkBEMJSON:function(t){return{block:"button2",mix:[t.newCol&&{block:"w-getting-started",elem:"elem",elemMods:{"edit-grid-add-col":"3"}}],mods:{theme:"action",type:"submit",size:"s",disabled:!t.newCol&&"yes"},text:t.newCol?BEM.I18N("b-grid-table-head","add"):BEM.I18N("b-grid-table-head","change")}},_getSelectListBEMJSON:function(){return{block:"b-grid-table-list-options",options:this.params.options||[]}},_getPopupContent:function(t){var e={block:"b-grid-table-edit-col-form",mods:{action:t.action,type:t.type},tag:"form",js:!0,content:[this._getTitleBEMJSON(t),{elem:"type",mix:[t.newCol&&{block:"w-getting-started",elem:"elem",elemMods:{"edit-grid-add-col":"2"}}],content:this._getTypeBEMJSON(t)},{elem:"select-list",content:this._getSelectListBEMJSON(t)},{elem:"size",content:{block:"b-grid-table-width-controll",width:t.width,width_units:t.width_units,label:BEM.I18N("b-grid-table-head","width"),size:"s"}},{elem:"options",content:this._getOptionsBEMJSON(t)},this._getDeleteBEMJSON(t),{elem:"ok",content:this._getOkBEMJSON(t)}]};return"select"!==t.type&&"multiselect"!==t.type||(e.mods.show="select-list"),BEMHTML.apply(e)},_getPopup:function(){return this._storage._popup&&this._storage._popup.domElem||(this._storage._popup=$(BEMHTML.apply({block:"popup2",directions:["bottom-center","bottom-left","bottom-right"],mods:{type:"grid-edit-col",target:"anchor",theme:"normal",autoclosable:"yes"}})),this._storage._popup=this._storage._popup.bem("popup2"),this._storage._popup.setAnchor(this.elem("edit")),this._storage._popup.on("beforeOpen",this._onPopupShow,this),this._storage._popup.on("afterClose",this._onPopupHide,this)),this._storage._popup},_onPopupShow:function(){this._storage._table._lockOutsideClicks=!0},_onPopupHide:function(){this._storage._table._lockOutsideClicks=!1}},{live:function(){this.liveBindTo("edit","click",function(){this.hasMod("type","new-col")?this._onEditClick("create"):this._onEditClick("edit")}),this.liveBindTo("sort","click",function(){this._onSortClick()})}}),BEM.DOM.decl("b-grid-table-edit-col-form",{onSetMod:{js:function(){this._submit=this.findBlockInside(this.elem("ok"),"button2"),this._submit.on("click",this._onSubmit,this),this.bindTo(this.domElem,"submit",function(){return!1}),this._delete=this.findBlockInside(this.elem("delete"),"button2"),this._delete&&this._delete.on("click",this._onDeleteCol,this),this.hasMod("action","edit")&&this._bindChange(),this.hasMod("action","add")&&this._buildSelectList()}},_onDeleteCol:function(){this.trigger("delete-col")},_buildSelectList:function(){this._controls||this._findControls(),this._controls.type.on("change",this._onTypeChange,this)},_onTypeChange:function(){var t=this._controls.type.getVal();"select"===t||"multiple_select"===t?this.setMod("show","select-list"):this.delMod("show"),this.setMod("type",t)},_bindChange:function(){this._controls||this._findControls(),this._controls.title.on("change",this._onFormChange,this),this._controls.width.on("change",this._onFormChange,this),this._controls.width_units.on("change",this._onFormChange,this),this._controls.required&&this._controls.required.on("change",this._onFormChange,this),this._controls.markdone&&this._controls.markdone.on("change",this._onFormChange,this),this._controls.options&&this._controls.options.on("change",this._onFormChange,this)},_onFormChange:function(t){this._controls.title.un("change",this._onFormChange),this._controls.width.un("change",this._onFormChange),this._controls.width_units.un("change",this._onFormChange),this._controls.required&&this._controls.required.un("change",this._onFormChange),this._controls.markdone&&this._controls.markdone.un("change",this._onFormChange),this._controls.options&&this._controls.options.un("change",this._onFormChange),this._submit.delMod("disabled")},_onSubmit:function(){var t=this._getChanges();!this.hasMod("show","select-list")||this._controls.options.getValue().length?this.trigger(this.hasMod("action","add")?"add":"edit",t):(BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-grid-table","options_list_empty"))),this.trigger("close"))},_getChanges:function(){var t={};return this._controls||this._findControls(),t.title=this._controls.title.val(),this.hasMod("action","add")&&(t.type=this._controls.type.getVal()),this.hasMod("show","select-list")&&(t.options={changes:this._controls.options.getChanges()}),this.hasMod("type","checkbox")?t.markdone=this._controls.markdone.hasMod("checked"):t.required=this._controls.required.hasMod("checked"),this._updateSize(t),t},_updateSize:function(t){var e=this._controls.width.val();""!==e&&(t.width=e,t.width_units="px"==this._controls.width_units.getVal()?"pixel":"percent")},_findControls:function(){this._controls={title:this.findBlockInside(this.elem("title"),"input"),width:this.findBlockInside(this.elem("size"),"input"),width_units:this.findBlockInside(this.elem("size"),"select2"),required:this.findBlockInside(this.elem("option-necessary"),"checkbox"),markdone:this.findBlockInside(this.elem("option-markdone"),"checkbox"),options:this.findBlockInside(this.elem("select-list"),"b-grid-table-list-options")},this.hasMod("action","add")&&(this._controls.type=this.findBlockInside(this.elem("type"),"select2"))}}),BEM.DOM.decl("b-grid-table-list-options",{onSetMod:{js:function(){this._changes=[],this._duplicateTooltip=this.findBlockInside({block:"tooltip",modName:"type",modVal:"duplicate"}),BEM.blocks["b-grid-table-list-options-item"].on(this.elem("items-container"),"edit",this._onItemEdit,this),BEM.blocks["b-grid-table-list-options-item"].on(this.elem("items-container"),"dragstart",this._onItemDragStart,this),BEM.blocks["b-grid-table-list-options-item"].on(this.elem("items-container"),"dragover",this._onItemDragOver,this),BEM.blocks["b-grid-table-list-options-item"].on(this.elem("items-container"),"dragend",this._onItemDrop,this),BEM.blocks["b-grid-table-list-options-item"].on(this.elem("items-container"),"press-enter",this._onItemPressEnter,this),BEM.blocks["b-grid-table-list-options-item"].on(this.elem("items-container"),"remove",this._onItemRemove,this),BEM.blocks["b-grid-table-list-options-item"].on(this.elem("items-container"),"change",this._onItemChange,this),this.bindTo(this.elem("add-item"),"click",this._addItem.bind(this))}},getChanges:function(){return this._changes},getValue:function(){return this.findBlocksInside(this.findElem("items-container"),"b-grid-table-list-options-item").filter(function(t){return Boolean(t.getValue())})},_onItemPressEnter:function(t){var e,i=t.block.domElem.next();this.hasMod("disabled","yes")||(i.length?(e=this.findBlockOn(i,"b-grid-table-list-options-item"),t.block.delMod("edit"),e.setMod("edit","yes")):this._addItem())},_onItemEdit:function(t){this.findBlocksInside(this.elem("items-container"),"b-grid-table-list-options-item").forEach(function(e){t.block!==e&&e.delMod("edit")})},_onItemDragStart:function(t){this._dragData={block:t.block}},_onItemDragOver:function(t,e){this._dragData.on=t.block,this._dragData.direction=e,this.setMod(this.elem("drag-delimiter"),"visibility","visible"),this.elem("drag-delimiter").css({top:26*t.block.domElem.index()+("top"===e?-26:0)})},_onItemDrop:function(){var t,e,i;this.delMod(this.elem("drag-delimiter"),"visibility"),this._dragData.on&&this._dragData.block!==this._dragData.on&&(t=this._dragData.block.domElem.index()-1,BEM.DOM.destruct(this._dragData.block.domElem),i=BEMHTML.apply({block:"b-grid-table-list-options-item",text:this._dragData.block.params.text}),e="bottom"===this._dragData.direction?BEM.DOM.after(this._dragData.on.domElem,i).index()-1:BEM.DOM.before(this._dragData.on.domElem,i).index()-1,this._duplicateTooltip.delMod("shown"),this._tryPushChanges({move_option:{old_index:t,new_index:e}}),this.trigger("change"))},_addItem:function(){this._duplicateTooltip.delMod("shown"),BEM.DOM.append(this.elem("items-container"),BEMHTML.apply({block:"b-grid-table-list-options-item",mods:{empty:"yes",is_new:"yes"},text:""})).bem("b-grid-table-list-options-item").setMod("edit","yes"),this.setMod("disabled","yes")},_onItemRemove:function(t,e){this._duplicateTooltip.delMod("shown"),t.block.hasMod("is_new","yes")?this.delMod("disabled"):(this._tryPushChanges({remove_option:{index:e}}),this.trigger("change"))},_onItemChange:function(t,e){this._duplicateTooltip.delMod("shown"),t.block.hasMod("is_new","yes")&&e.val?this._tryPushChanges({add_option:{value:e.val}},t.block)&&(t.block.delMod("is_new").delMod("empty"),this.delMod("disabled").trigger("change")):t.block.hasMod("empty","yes")&&e.val?this._tryPushChanges({rename_option:{index:e.index,new_value:e.val}},t.block)&&(t.block.delMod("empty"),this.delMod("disabled").trigger("change")):e.val?this._tryPushChanges({rename_option:{index:e.index,new_value:e.val}},t.block)&&this.trigger("change"):(t.block.setMod("empty","yes"),this.setMod("disabled","yes"))},_tryPushChanges:function(t,e){var i=this.params.options,n=_.extend([],i);if(t.add_option&&n.push(t.add_option.value),t.rename_option){if(n[t.rename_option.index]===t.rename_option.new_value)return!1;n[t.rename_option.index]=t.rename_option.new_value}return t.remove_option&&n.splice(t.remove_option.index,1),t.move_option&&this._moveArrayElem(n,t.move_option.old_index,t.move_option.new_index),!this._haveDuplicates(n)||t.remove_option?(this.params.options=n,this._changes.push(t),!0):!!e&&(this._duplicateTooltip.setOwner(e.domElem).setMod("shown","yes"),!1)},_moveArrayElem:function(t,e,i){var n=t[e];t.splice(e,1),t.splice(i,0,n)},_haveDuplicates:function(t){return _.uniq(t).length!==t.length}}),BEM.DOM.decl("b-grid-table-list-options-item",{onSetMod:{js:function(){this._valueInput=this.findBlockInside("input"),this.bindTo(this.elem("item-content-wrapper"),"click",this._onContentWrapperClick.bind(this)),this.findBlockInside({block:"awesome-icon",modName:"type",modVal:"sort"}).bindTo({dragstart:this._onDragStart.bind(this),dragend:this._onDragEnd.bind(this)}),this.bindTo("dragover",this._onDragOver.bind(this)),this.findBlockInside({block:"awesome-icon",modName:"type",modVal:"remove"}).bindTo("mouseup",this._removeSelf.bind(this)),this.findBlockInside({block:"input",modName:"type",modVal:"item-val"}).on("change",this._onValueInputChange,this).bindTo("keyup",this._onValueInputKeyUp.bind(this))},edit:{yes:function(){this.afterCurrentEvent(function(){this._valueInput.elem("control").focus(),this.trigger("edit")}.bind(this))},"":function(){this.elem("item-content").text(this._valueInput.val())}}},getValue:function(){return this._valueInput.val()},_onContentWrapperClick:function(){this.setMod("edit","yes")},_onDragStart:function(t){t.originalEvent.dataTransfer.setData("text/plain","Data to Drag"),t.originalEvent.dataTransfer.setDragImage(this.domElem[0],10,15),this.trigger("dragstart")},_onDragOver:function(t){var e=t.originalEvent.pageY,i=this.domElem.offset().top+12>e?"top":"bottom";this.trigger("dragover",i)},_onDragEnd:function(t){this.trigger("dragend")},_removeSelf:function(){this.trigger("remove",this.domElem.index()-1),BEM.DOM.destruct(this.domElem)},_onValueInputKeyUp:function(t){13===t.keyCode&&this.trigger("press-enter")},_onValueInputChange:function(t){this._changeInputTimeout&&(clearTimeout(this._changeInputTimeout),this._changeInputTimeout=null),this._changeInputTimeout=setTimeout(this._onValueChange.bind(this,t),200)},_onValueChange:function(t){this._changeInputTimeout=null,this.trigger("change",{index:this.domElem.index()-1,val:t.block.val().trim()}),this.params.text=t.block.val()}}),BEM.DOM.decl("b-grid-table-head-draggable",{onSetMod:{js:function(){var t=this.findBlockOutside("b-grid-table");this.tableId=t.tableId,this.__self[this.tableId]||(this.__self[this.tableId]={_table:t}),this._storage=this.__self[this.tableId],this._storage._counter?this._storage._counter++:this._storage._counter=1,this._storage._table.on("start-edit",this._bindEvents,this),this._storage._table.on("stop-edit",this._unbindEvents,this)}},destruct:function(){this._storage._table.un("start-edit"),this._storage._table.un("stop-edit"),this._unbindEvents(),this._storage._counter?this._storage._counter--:delete this.__self[this.tableId],this.__base.apply(this,arguments)},_bindEvents:function(){this._storage.parentRow=this.findBlockOutside("b-grid-table-row"),this._storage.headers=this._storage.parentRow.findBlocksInside("b-grid-table-head-draggable"),this.bindToDomElem(this.domElem,{dragstart:this._onDragStart,dragend:this._onDragEnd,drop:this._onDragDrop,dragenter:this._onDragEnter,dragover:this._onDragOver,dragleave:this._onDragLeave})},_unbindEvents:function(){this.unbindFromDomElem(this.domElem,"dragstart, dragend, drop, dragenter, dragover, dragleave")},_isMouseOnRow:function(t,e){var i=!1,n=BEM.DOM.win.scrollLeft(),s=BEM.DOM.win.scrollTop(),o=this._storage.parentRow.domElem,r=o.offset().top,a=o.offset().left+o.outerWidth(),c=o.offset().top+o.outerHeight(),l=o.offset().left;t+=n,e+=s;var d=Boolean(t>l&&t<a);return Boolean(e>r&&e<c)&&d&&(i=!0),i},_onDragStart:function(t){var e=t.originalEvent.dataTransfer;if(this._storage._table.draggingRow)return!1;this._isDragging=!0,this._storage._table.draggingHead=!0,this._storage.prev=this.domElem.prev(),this._storage.next=this.domElem.next(),this._storage.move={from:this.domElem.index(),movedId:this.findBlockOn(this.domElem,"b-grid-table-head").params.id},this.setMod("dragging","yes"),e.setData("text/plain"," "),e.effectAllowed="move",e.setDragImage(this.domElem[0],0,0)},_onDragEnd:function(){if(this._storage.move)return this._storage._table.draggingHead=!1,this._storage._dropAvailable&&this._moveCols(),this._isDragging?(this._isDragging=!1,this._onStopDragging(),!1):void 0},_onDragEnter:function(){if(this._storage.move)return!this._isDragging&&!this._storage._table.draggingRow&&void 0},_onDragLeave:function(t){if(this._storage.move)return this._isMouseOnRow(t.originalEvent.clientX,t.originalEvent.clientY)||this._storage._table.elem("head-indicator").hide(),!this._isDragging&&void 0},_onDragDrop:function(t){if(t.preventDefault(),this._storage.move){if(this._storage._table.draggingHead=!1,this._isDragging)return this._isDragging=!1,!1;this._storage._dropAvailable&&this._moveCols(),this._onStopDragging()}},_onDragOver:function(t){var e;if(this._storage.move)return!this._isDragging&&!this._storage._table.draggingRow&&(e=t.originalEvent,this._handleDropPosition(e.clientX),t.preventDefault(),!1)},_onStopDragging:function(){this.delMod("dragging"),this._storage._dropAvailable=!1,this._storage._table.elem("head-indicator").hide().css({left:0})},_handleDropPosition:function(t){var e=this.domElem.offset().left+this.domElem.outerWidth()/2;this._storage._table.elem("head-indicator").css({height:this.domElem.outerHeight(),top:this.domElem.offset().top-BEM.DOM.win.scrollTop()}),t>e?this.domElem[0]!==(this._storage.prev&&this._storage.prev[0])&&this._setIndicatorPosition(this._storage._table.elem("head-indicator"),"right"):this.domElem[0]!==(this._storage.next&&this._storage.next[0])&&this._setIndicatorPosition(this._storage._table.elem("head-indicator"),"left")},_setIndicatorPosition:function(t,e){var i,n=this.domElem.offset().left,s=this.domElem.outerWidth(),o=parseInt(t.css("left"));if(t.show(),"right"===e)i=Math.abs(o-(n+s)),this._storage.move.to={after:this.domElem.index(),afterId:this.findBlockOn(this.domElem,"b-grid-table-head").params.id},i>1&&(this._storage._dropAvailable=!0,t.css({left:n+s}));else{i=Math.abs(o-n);var r=this.findBlockOn(this.domElem.prev(),"b-grid-table-head");this._storage.move.to={before:this.domElem.index(),afterId:r&&r.params.id?r.params.id:"-1"},i>1&&(this._storage._dropAvailable=!0,t.css({left:n}))}},_moveCols:function(){this._storage._table.elem("table");var t,e,i,n=this._storage._table.findElem("tr"),s=this._storage.move;n.each(function(){e=$(this),i=e.children("th, td"),t=i.eq(s.from).detach(),void 0!==s.to.before?t.insertBefore(i.eq(s.to.before)):t.insertAfter(i.eq(s.to.after))}),this._sendMoveData()},_sendMoveData:function(){this.sendData={version:this._storage._table._gridData.version,changes:[{column_moved:{id:this._storage.move.movedId,after_id:this._storage.move.to.afterId}}]},BEM.create("wi-api-request",{apiPath:".grid/change_and_get_document",path:"/"+this._storage._table.params.supertag,method:"POST",data:this.sendData,urlParams:this._storage._table.gridOptionsUrlParams()}).run().then(this._onPostedColumnReorder.bind(this),this._onFailedColumnReorder.bind(this))},_onPostedColumnReorder:function(t){this._storage._table._setEditAfterRebuild=!0,this._storage._table.rebuild(t.data.grid)},_onFailedColumnReorder:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,t)),this._storage._table._buildContent(!0)}}),BEM.DOM.decl("b-grid-table-row",{onSetMod:{js:function(){this.hasMod("type","head")||(this._storage||this._createStorage(),this._storage._table.on("stop-edit",function(){this.delMod("state")},this),BEM.blocks["b-grid-table-cell"].on(this.domElem,"start-edit",this._onCellEditStart,this),BEM.blocks["b-grid-table-row"].on(this.domElem,"start-edit",this._onRowEditStart,this))},state:{edit:function(){var t=this;this.hasMod("removed","yes")?this.afterCurrentEvent(function(){this.delMod("state")}):(this.trigger("start-edit"),this.findBlockOn("b-grid-table-row-draggable")._onMouseEnter(),setTimeout(function(){t._storage._table.setMod("edit","row"),keymaster("ctrl+enter, command+enter",function(e){e.preventDefault(),t._storage._table.createRowAfter(t,t.getNextRow())}),keymaster("shift+enter",function(e){t._activeCell.showEditControl(e)}),keymaster("tab",function(e){e.preventDefault(),t._onTab(e)}),keymaster("shift+tab",function(e){e.preventDefault(),t._onShiftTab(e)}),t.bindTo(t.domElem,"clickoutside",t._onClickOutside),keymaster("ctrl+left, command+left",function(e){e.preventDefault(),t._onArrowLeft(e)}),keymaster("ctrl+right, command+right",function(e){e.preventDefault(),t._onArrowRight(e)}),keymaster("ctrl+down, command+down",function(e){e.preventDefault(),t._onArrowDown(e)}),keymaster("ctrl+up, command+up",function(e){e.preventDefault(),t._onArrowUp(e)}),keymaster("return",function(e){return t._storage._table._preventEnter||(t._storage._table._preventRowOutside=!1,t._activeCell._preventCellOutside=!1,t._onReturn(e)),!1}),keymaster("esc",function(e){e.preventDefault(),t._onEsc(e)})},0))},"":function(){this.trigger("stop-edit"),this._storage._table.delMod("edit"),keymaster.unbind("ctrl+enter, command+enter"),keymaster.unbind("tab"),keymaster.unbind("shift+tab"),keymaster.unbind("shift+enter"),keymaster.unbind("ctrl+left, command+left"),keymaster.unbind("ctrl+right, command+right"),keymaster.unbind("ctrl+down, command+down"),keymaster.unbind("ctrl+up, command+up"),keymaster.unbind("return"),keymaster.unbind("esc"),this.unbindFrom(this.domElem,"clickoutside")}}},destruct:function(){BEM.blocks["b-grid-table-cell"].un(this.domElem,"start-edit"),BEM.blocks["b-grid-table-row"].un(this.domElem,"start-edit"),this.__base.apply(this,arguments)},_onCellEditStart:function(t){this._activeCell=t.block},_onRowEditStart:function(t){t.block===this||this.hasMod("type","new")||this.hasMod("type","head")||this.delMod("state")},_onClickOutside:function(){this._storage._table._preventCellOutside||this._storage._table._preventRowOutside||this._storage._table._lockOutsideClicks||this.delMod("state"),this._storage._table._preventRowOutside=!1,this._storage._table._preventCellOutside=!1},_onTab:function(){return this._hightlightOnTab("next"),!1},_onShiftTab:function(){return this._hightlightOnTab("prev"),!1},_hightlightOnTab:function(t,e){var i,n,s;if(s=(e=e||this._activeCell)&&e.domElem[t](),e.params.row_id||!e.hasMod("editable","yes"))if(s=!(!s||!s.length)&&s.bem("b-grid-table-cell")){if(!s.hasMod("editable","yes"))return this._hightlightOnTab(t,s);this._activeCell._onClickOutside(),s._onClick()}else(i=!!(i=this.domElem[t]()).length&&i.bem("b-grid-table-row"))&&(s="next"===t?i.findBlockInside({block:"b-grid-table-cell",modName:"editable",modVal:"yes"}):!!(n=i.findBlocksInside({block:"b-grid-table-cell",modName:"editable",modVal:"yes"}))&&n[n.length-1])&&(this.delMod("state"),i.setMod("state","edit"),this._activeCell._onClickOutside(),s._onClick())},_onArrowLeft:function(){return this._hightlightOnLeftRight("left"),!1},_onArrowRight:function(){return this._hightlightOnLeftRight("right"),!1},_onArrowUp:function(){return this._hightlightOnUpDown("up"),!1},_onArrowDown:function(){return this._hightlightOnUpDown("down"),!1},_onReturn:function(){return this._hightlightOnUpDown("down",!0),!1},_hightlightOnLeftRight:function(t){var e=this._activeCell,i=e.domElem["left"===t?"prev":"next"]();if(e.params.row_id&&(i=!(!i||!i.length)&&i.bem("b-grid-table-cell"))){if(!i.hasMod("editable","yes"))return;this._activeCell._onClickOutside(),i._onClick()}},getNextRow:function(){var t=this.domElem.next();return t.next().length?t.bem("b-grid-table-row"):null},_hightlightOnUpDown:function(t,e){var i,n,s,o=this._activeCell;o.params.row_id&&(!(i=this.getNextRow())&&e&&"up"!==t&&(this._storage._table.createRowAfter(this,null,!0),i=this.domElem.next().bem("b-grid-table-row")),i&&(s=i.findBlocksInside({block:"b-grid-table-cell"}),(n=!!s&&s[o.domElem.index()])&&(this.delMod("state"),i.setMod("state","edit"),setTimeout(function(){o._onClickOutside(),n._onClick()},0))))},_onEsc:function(){var t=this._activeCell;t&&t._resetValue()},_createStorage:function(){var t=this.findBlockOutside("b-grid-table");this.__self[t.tableId]||(this.__self[t.tableId]={_table:t}),this._storage=this.__self[t.tableId]}}),BEM.DOM.decl("b-grid-table-new-row",{onSetMod:{ready:{yes:function(){this.bindTo(this.domElem,"click",function(){this._onClick()})},no:function(){this.unbindFrom(this.domElem,"click")}}},_onClick:function(){var t=this.domElem.prev();this._table||(this._table=this.findBlockOutside("b-grid-table")),t.length?this._table.createRowAfter(t.bem("b-grid-table-row"),null):this._table.createRowAfter(null,null)}}),BEM.DOM.decl("b-grid-table-row-draggable",{onSetMod:{js:function(){var t=this.findBlockOutside("b-grid-table"),e=new UAParser;this.tableId=t.tableId,this.__self[this.tableId]||(this.__self[this.tableId]={_table:t}),this._storage=this.__self[this.tableId],this._storage._counter?this._storage._counter++:this._storage._counter=1,this._storage._table.hasMod("mode","edit")&&this._initBlock(),this._storage._table.on("start-edit",this._initBlock,this),this._storage._table.on("stop-edit",this._unbindEvents,this),this._showBillet="Firefox"!==e.setUA(BEM.blocks["i-ua"].ua).getBrowser().name}},destruct:function(){this._storage._table.un("start-edit"),this._storage._table.un("stop-edit"),this._unbindEvents(),this._storage._counter?this._storage._counter--:delete this.__self[this.tableId],this.__base.apply(this,arguments)},_initBlock:function(){this._dragger||(this._dragger=this._storage._table.elem("row-dragger"),this._dragImage=this._storage._table.elem("drag-image")),setTimeout(this._setSizes.bind(this),0),this._bindToEvents()},_bindToEvents:function(){this._binded=!0,this.bindTo(this.domElem,"mouseenter",this._onMouseEnter),this.bindToWin("resize",this._setSizes),this.bindToDomElem(this._dragger,"dragstart",this._onDragStart),this.bindToDomElem(this._dragger,"dragend",this._onDragEnd),this.bindTo(this.domElem,{drop:this._onDragDrop,dragenter:this._onDragEnter,dragover:this._onDragOver,dragleave:this._onDragLeave}),this._storage._table.on("rows-reorder",this._setSizes,this),this._storage._table.on("row-added",this._setSizes,this),this._storage._table.on("row-added",this._setSizes,this),this._storage._table.on("grid-synced",this._setSizes,this),BEM.blocks["b-grid-table-cell"].on(this.domElem,"saved",this._setSizes,this)},_unbindEvents:function(){this._binded&&(this.unbindFrom(this.domElem,"mouseenter"),this.unbindFrom(this.domElem,"drop"),this.unbindFrom(this.domElem,"dragenter"),this.unbindFrom(this.domElem,"dragover"),this.unbindFrom(this.domElem,"dragleave"),this.unbindFromWin("resize"),this.unbindFromDomElem(this._dragger,"dragstart"),this.unbindFromDomElem(this._dragger,"dragend"),this._storage._table.un("rows-reorder",this._setSizes,this),this._storage._table.un("row-delete",this._setSizes,this),this._storage._table.un("row-added",this._setSizes,this),BEM.blocks["b-grid-table-cell"].un(this.domElem,"saved",this._setSizes))},_onDragStart:function(t){var e,i=t.originalEvent.dataTransfer,n=$.throttle(this._onDrag,100);this===this._storage._draggableThis&&(this._storage._table.setMod("dragging","yes"),this.setMod("dragging","yes"),this._storage._table.draggingRow=!0,this._storage.prev=this.domElem.prev(),this._storage.next=this.domElem.next(),this._storage.move={from:this.domElem.index(),draggingThis:this},i.setData("text/plain"," "),i.effectAllowed="move",this._showBillet?(this._storage._table.setMod(this._dragImage,"visibility","visible"),this._dragImage.css({top:this._sizes.top}),e=this._dragImage[0]):e=this.domElem[0],i.setDragImage&&i.setDragImage(e,0,0),this.bindToDoc("dragover",n))},_onDrag:function(t){if(this._storage.move){var e=BEM.DOM.win.scrollTop(),i=e+BEM.DOM.win.height(),n=e+t.originalEvent.clientY,s=this._storage._table.elem("body"),o=s.offset().top,r=s.offset().top+s.outerHeight();return this===this._storage._draggableThis&&(o-e<100&&n-e<80&&window.scrollBy(0,-20),i-r<75&&i-n<80&&window.scrollBy(0,20),this._isMouseOnBody(t.originalEvent.clientX,t.originalEvent.clientY)||this._storage._table.elem("row-indicator").hide()),!0}},_onDragDrop:function(t){if(t.originalEvent.preventDefault(),this._storage.move){if(this._storage._table.draggingRow=!1,this.hasMod("dragging","yes")||this._storage._table.draggingHead||!this._dropAvailable)return this._dropAvailable=!1,!1;this._moveRows(),this._onStopDragging()}},_onDragEnter:function(){if(this._storage.move)return!this.hasMod("dragging","yes")&&!this._storage._table.draggingHead&&void 0},_onDragOver:function(t){var e;if(this._storage.move)return!this.hasMod("dragging","yes")&&!this._storage._table.draggingHead&&(e=t.originalEvent,this._handleDropPosition(e.clientY),t.preventDefault(),!1)},_handleDropPosition:function(t){var e=this.domElem.offset().top+this.domElem.outerHeight()/2;this._storage._table.elem("row-indicator").css({width:this.domElem.outerWidth(),left:this.domElem.offset().left}),(t+=BEM.DOM.win.scrollTop())>e?this.domElem[0]!==(this._storage.prev&&this._storage.prev[0])&&this._setIndicatorPosition(this._storage._table.elem("row-indicator"),"after"):this.domElem[0]!==(this._storage.next&&this._storage.next[0])&&this._setIndicatorPosition(this._storage._table.elem("row-indicator"),"before")},_setIndicatorPosition:function(t,e){var i=this.domElem.offset().top-BEM.DOM.win.scrollTop(),n=this.domElem.outerHeight();t.show(),"after"===e?(this._storage.move.to={after:this.domElem.index()},this._dropAvailable=!0,t.css({top:i+n-1})):(this._storage.move.to={before:this.domElem.index()},this._dropAvailable=!0,t.css({top:i-1}))},_onDragLeave:function(t){return this._isMouseOnBody(t.originalEvent.clientX,t.originalEvent.clientY)||this._storage._table.elem("row-indicator").hide(),this._dropAvailable=!1,!1},_isMouseOnBody:function(t,e){var i=!1,n=BEM.DOM.win.scrollLeft(),s=BEM.DOM.win.scrollTop(),o=this._storage._table.elem("body"),r=o.offset().top,a=o.offset().left+o.outerWidth(),c=o.offset().top+o.outerHeight(),l=o.offset().left;t+=n,e+=s;var d=Boolean(t>l&&t<a),h=Boolean(e>r&&e<c);return d&&h&&(i=!0),i},_onDragEnd:function(){if(this._storage._table.delMod("dragging"),!this.hasMod("dragging","yes"))return!1;this._dropAvailable&&this._moveRows(),this._storage._table.draggingRow=!1,this._onStopDragging(),this.unbindFromDoc("dragover")},_onStopDragging:function(){this.delMod("dragging"),this._dropAvailable=!1,this._storage._table.elem("row-indicator").hide().css({top:0}),this._dragger.css({top:0,height:0}),this._storage._table.delMod(this._dragImage,"visibility")},_setSizes:function(){this.domElem&&(this._sizes={height:this.domElem.outerHeight(),top:this.domElem.offset().top-this._storage._table.domElem.offset().top})},_onMouseEnter:function(){this._storage._draggableThis=this,this._sizes||this._setSizes(),this.domElem.bem("b-grid-table-row").hasMod("removed","yes")?this.setMod(this._dragger,"restore","yes"):this.delMod(this._dragger,"restore"),this._dragger.css({top:this._sizes.top,height:this._sizes.height})},_moveRows:function(){var t,e,i,n,s=this._storage.move,o={id:s.draggingThis.findBlockOn("b-grid-table-row").params.row_id},r=this._storage._table.findElem("body","tr"),a=r.eq(s.from).detach();void 0!==s.to.before?(i=(e=(t=r.eq(s.to.before)).prev()).length?e.bem("b-grid-table-row"):null,o.after_id=i?i.params.row_id:"-1",n=i?i.getNextRow():null,o.before_id=n?n.params.row_id:"-1",a.insertBefore(t)):(e=(t=r.eq(s.to.after)).bem("b-grid-table-row"),o.after_id=e.params.row_id,n=e.getNextRow(),o.before_id=n?n.params.row_id:"-1",a.insertAfter(t)),this._storage._table.trigger("rows-reorder"),this._sendMoveData(o)},_sendMoveData:function(t){this.sendData={changes:[{row_moved:t}]},BEM.create("wi-api-request",{apiPath:".grid/change",path:"/"+this._storage._table.params.supertag,method:"POST",data:this.sendData,urlParams:this._storage._table.gridOptionsUrlParams()}).run().then(this._onPostedRowsReorder.bind(this),this._onFailedRowsReorder.bind(this))},_onPostedRowsReorder:function(t){var e=this._storage.move,i={from:e.from,to:void 0!==e.to.before?e.to.before:e.to.after};this._storage._table._swapStructure(i.from,i.to,"rows")},_onFailedRowsReorder:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,t)),this._storage._table._buildContent(!0)}}),BEM.DOM.decl("b-grid-table-bar",{onSetMod:{js:function(){this._table||(this._table=this.findBlockOutside("b-grid-table")),(this._content||(this._content=this.findBlockOutside("b-content")&&this.findBlockOutside("b-content").domElem||this.findBlockOutside("page-editor").elem("preview-content"),this._content))&&(this.setPosition(),this._subscribe())}},setPosition:function(){var t=this._table.findElem("table"),e=this._table.findElem("table-wrapper"),i=e.offset(),n=t.width(),s=BEM.DOM.win.scrollTop();this._coords={tableWrapperTop:i.top,tableWrapperBottom:i.top+t.height(),tableWrapperLeft:i.left,tableWidth:n,tableWrapperWidth:e.width(),winTop:s,winBottom:s+BEM.DOM.win.height()},this._coords.tableWrapperBottom>this._coords.winBottom&&this._coords.tableWrapperTop<this._coords.winBottom?(this.setMod("position","fixed").domElem.removeAttr("style"),this.domElem.css({left:this._coords.tableWrapperLeft,width:this._coords.tableWrapperWidth})):this.delMod("position").domElem.removeAttr("style"),this._table.recalculateScroll(),this._updateScrollState()},destruct:function(){this._table.domElem&&(this.unbindFromDoc("scroll.bar"),this.unbindFromWin("resize.bar"),this._table&&this.unbindFrom(this._table.findElem("table"),"resize"),this._content.off("scroll"),this._content.off("resize"),this._table.un("grid-edit",this.setPosition,this)),this._table.dropElemCache(),this.dropElemCache(),this._content=null,this._table=null,this.__base.apply(this,arguments)},_updateScrollState:function(){this.setMod("scroll-controls",this._table.findElem("table").width()>this._table.findElem("table-wrapper").width()?"yes":"")},_subscribe:function(){this.params.isAction||(this.bindToDoc("scroll.bar",this.setPosition),this.bindToWin("resize.bar",this.setPosition)),this.bindTo(this._table.findElem("table"),"resize",this.setPosition),this._content.on("scroll",this.setPosition.bind(this)),this._content.on("resize",this.setPosition.bind(this)),this._table.on("grid-edit",this.setPosition,this),BEM.channel("layout").on("change",this.setPosition,this),this.findBlockInside({block:"awesome-icon",modName:"type",modVal:"scroll-left"}).bindTo("click",this._table.scrollTable.bind(this._table,"left")),this.findBlockInside({block:"awesome-icon",modName:"type",modVal:"scroll-right"}).bindTo("click",this._table.scrollTable.bind(this._table,"right"))}}),BEM.DOM.decl("b-grid-table-editors",{onSetMod:{js:function(){this._table=this.findBlockOutside("b-grid-table"),this._interval=setInterval(this.updateEditors.bind(this),this.__self.UPDATE_INTERVAL),this.updateEditors()}},destruct:function(t){this._request&&this._request.abort(),clearInterval(this._interval),this.__base(t)},updateEditors:function(){!document.hidden&&this._table._gridData&&(this._request=BEM.create("wi-api-request",{apiPath:"/"+this.params.supertag+"/.changes/"+this._table._gridData.version,path:"",urlParams:!1}),this._request.run().then(this._onGetCurrentEditors.bind(this),this._onGetCurrentEditorsFail.bind(this)))},_onGetCurrentEditors:function(t){this.setMod("invisible","yes"),setTimeout(this._updateEditors.bind(this,t.data.editors),200)},_updateEditors:function(t){this._editors=t,BEM.DOM.update(this.domElem,BEMHTML.apply(this.__self._getEditorsBEMJSON(this._editors))),this.delMod("invisible")},_onGetCurrentEditorsFail:function(t){console.log(BEM.I18N("b-grid-table-editors","cant_load_editors")+" :",t)}},{UPDATE_INTERVAL:15e3,_getEditorsBEMJSON:function(t){var e=t.slice(0,3),i=t.slice(3,t.length);return[{block:"b-grid-table-editors",elem:"viewed",content:e.map(function(t){return this._getEditorBEMJSON(t)},this)},i.length>0?{block:"b-grid-table-editors",elem:"hidden",content:[{block:"b-grid-table-editors",elem:"count",content:"+"+i.length},i.map(function(t){return this._getEditorBEMJSON(t)},this)]}:""]}}),BEM.DOM.decl("b-grid-table-editors",{},{_getEditorBEMJSON:function(t){return{block:"b-grid-table-editors",elem:"editor",user:t}}}),BEM.DOM.decl("b-grid-table-options-item",{onSetMod:{js:function(){this._table=this.findBlockOutside("b-grid-table"),this.hasMod("disabled","true")||this.bindTo("click",this._onClick),this._gridUrl="/"+this._table.params.supertag}},_getPopup:function(){return this._popup||(this._popup=this.findBlockOutside({block:"popup2",modName:"role",modVal:"table-options"})),this._popup},_onClick:function(t){switch(this._getPopup().delMod("visible"),this.getMod("action")){case"export":location.href=this._gridUrl+"/.xls";break;case"parent":keymaster.command||keymaster.ctrl||2===t.which?window.open(this._gridUrl,"_blank").focus():location.href=this._gridUrl}}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"copy"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._bPage=BEM.blocks["i-global"].getbPage(),this._path=this.params.source||BEM.blocks["wi-history"].getCorrectPath(),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-copy",this._run,this)}},destruct:function(){BEM.channel("common").un("w-action.create-copy"),this.__base.apply(this,arguments)},_run:function(t,e){this.__base.apply(this,arguments)&&(this._showOutside(t,".copy")||(this._pushState(e,".copy"),this._copyWidget||(BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"page-copy","page-copy":this.params.type},js:{type:this.params.type}})),this._copyWidget=this._bPage.findBlockInside({block:"b-widget",modName:"page-copy",modVal:this.params.type}),this._copyWidget.params.data={},this._copyWidget.params.ajaxPath=this._path),this._copyWidget.show()))}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"import"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._path=this.params.source||BEM.blocks["wi-history"].getCorrectPath(),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-import",this._run,this)}},destruct:function(){BEM.channel("common").un("w-action.create-import"),this.__base.apply(this,arguments)},_run:function(t,e){this.__base.apply(this,arguments)&&(this._showOutside(t,".import")||(this._pushState(e,".import"),this._importWidget||(this._importWidget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"page-import","page-import":this.params.type},js:{type:this.params.type,fieldsCount:this.params.fieldsCount}})).bem("b-widget"),this._importWidget.params.data={},this._importWidget.params.ajaxPath=this._path),this._importWidget.show()))}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"authorship"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-request-authorship",this._run,this)}},destruct:function(){BEM.channel("common").un("w-action.create-request-authorship"),this.__base.apply(this,arguments)},_run:function(t,e){this.__base.apply(this,arguments)&&(this.params.isAction?location.href=this.params.source+"/.requestauthorship":this._widget?(this._widget.show(),this._pushState(e,".requestauthorship")):(this._widget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"authorship"}})).bem("b-widget"),this._widget.show(),this._pushState(e,".requestauthorship")))}}),BEM.DOM.decl({block:"w-translate-content",modName:"type",modVal:"grid"},{_resetTranslate:function(t){this.hasMod("lang-selected")&&!this.hasMod("progress")&&(this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".grid",path:"/"+this.params.supertag,urlParams:["format=json"]}).run().then(this._onSuccessSkipTranslate.bind(this,t),this._onErrorSkipTranslate.bind(this)).always(function(){this.delMod("progress")}.bind(this)))},_request:function(t){return BEM.create("wi-api-request",{apiPath:".translate/"+t,method:"GET",urlParams:!1,path:"/"+this.params.supertag}).run()},_updateContent:function(t){this.channel("content").trigger("update",t)}}),BEM.DOM.decl("w-authors",{onSetMod:{js:{inited:function(){this._getAuthors();var t=BEM.WISTORE.get("page");t&&t.on("change:authors",this._onAuthorsChange,this)}}},destruct:function(){this._button.un("click"),this.__base.apply(this,arguments)},_onAuthorsChange:function(){this._updateAuthors(BEM.WISTORE.get("page").get("authors"))},_getAuthors:function(){var t=BEM.WISTORE.get("page");t?this._updateAuthors(t.get("authors")):this._loadAuthors()},_loadAuthors:function(){var t=this.findBlockInside("spin2").setMod("progress","yes"),e=BEM.blocks["wi-history"].getPath();BEM.create("wi-api-request",{apiPath:".authors",method:"GET",urlParams:!1,path:"/"===e?"/homepage":e}).run().then(this._onLoadAuthorsSuccess.bind(this),this._onLoadAuthorsFail.bind(this)).always(function(){t.delMod("progress")})},_updateAuthors:function(t){var e=this.params.visibleCount,i=t.length>e,n=t.slice(0,e).map(function(t){return{block:this.__self.getName(),elem:"author",elemMods:{inline:this.params.inline,"with-photo":this.params.withPhoto},author:t}},this);i&&n.push({block:this.__self.getName(),elem:"button",count:t.length-e}),BEM.DOM.update(this.domElem,BEMHTML.apply(n)),i&&(this._button=this.findBlockInside("button2").on("click",this._onButtonClick,this)),this._authors=t,this._allAuthorsShown=!1},_onLoadAuthorsSuccess:function(t){this._updateAuthors(t.data.authors)},_onLoadAuthorsFail:function(){BEM.channel("notification").trigger("error",BEM.I18N("w-authors","cant_load_authors"))},_onButtonClick:function(){this._allAuthorsShown?this._hideAuthors():this._showAuthors()},_getHiddenAuthors:function(){return this._hiddenAuthors||(this._hiddenAuthors=this._authors.slice(this.params.visibleCount).map(function(t){return BEM.DOM.before(this._button.domElem,BEMHTML.apply({block:this.__self.getName(),elem:"author",elemMods:{inline:this.params.inline,"with-photo":this.params.withPhoto},author:t}))},this)),this._hiddenAuthors},_showAuthors:function(){this._getHiddenAuthors().forEach(function(t){this.delMod(t,"hidden")},this),this._button.setText(BEM.I18N("w-authors","hide")),this._allAuthorsShown=!0},_hideAuthors:function(){this._getHiddenAuthors().forEach(function(t){this.setMod(t,"hidden")},this),this._button.setText(BEM.I18N("w-authors","more",{count:this._hiddenAuthors.length})),this._allAuthorsShown=!1}}),BEM.DOM.decl("b-readonly",{onSetMod:{js:function(){var t=this;this._localStorage=BEM.blocks["mi-storage"],this.READ_ONLY_TIMEOUT=3e4,this.READ_ONLY_TIMEOUT_WAIT=5e3,BEM.channel("readonly").on("enable",function(){t.setMod("visibility","visible")}),BEM.channel("readonly").on("disable",function(){t.delMod("visibility")}),"closed"==this._localStorage.getItem("readonly")&&this.setMod("close","yes"),Visibility.onVisible(function(){setTimeout(function(){t.afterCurrentEvent(t._isReadOnlyRequest),t._checkReadOnlyStatus(t.READ_ONLY_TIMEOUT)},5e3)}),Visibility.change(function(t,e){"hidden"===e?this._timer&&clearInterval(this._timer):this._checkReadOnlyStatus(this.READ_ONLY_TIMEOUT)}.bind(this))}},_checkReadOnlyStatus:function(t){this._timer&&clearInterval(this._timer),this._timer=setInterval(this._isReadOnlyRequest.bind(this),t)},_isReadOnlyRequest:function(){BEM.create("wi-api-request",{apiPath:".is_readonly",path:""}).run().then(this._onIsReadOnly.bind(this),this._onIsReadOnlyError.bind(this))},_onIsReadOnly:function(t){t.data.service_is_readonly?this._readOnlyStatus||(this._readOnlyStatus=!0,BEM.channel("readonly").trigger("enable"),this._checkReadOnlyStatus(this.READ_ONLY_TIMEOUT_WAIT)):this._readOnlyStatus&&(this._readOnlyStatus=!1,BEM.channel("readonly").trigger("disable"),this._checkReadOnlyStatus(this.READ_ONLY_TIMEOUT))},_onIsReadOnlyError:function(t){console.error("Проблемы с readonly: ",t)}},{live:function(){return this.liveBindTo("icon","click",function(){this.delMod("close"),this._localStorage.removeItem("readonly")}),this.liveBindTo("close","click",function(){this.setMod("close","yes"),this._localStorage.setItem("readonly","closed")}),!1}}),BEM.DOM.decl("b-footer",{_cancelForceDesktop:function(){$.cookie("force-desktop","",{path:"/"}),location.reload()}},{live:function(){this.liveBindTo("mobile-link","click",function(){this._cancelForceDesktop()})}}),BEM.DOM.decl("wf-switcher",{_onWfChange:function(t){this._link||(this._link=this.findBlockInside("link").domElem);var e=t?"old":"new",i=new URL(location.origin+this._link.attr("href"));i.searchParams.set("wf",e),BEM.DOM.update(this._link,BEM.I18N("wf-switcher","with_"+e+"_wf")),this._link.attr("href",i.pathname+i.search)}},{live:function(){this.liveInitOnStoreEvent("page","change:withNewWf",function(t,e){this._onWfChange(e)})}}),BEM.DOM.decl("w-user-settings",{onSetMod:{js:function(){this._initBlocks(),this._subscribe()},progress:function(t,e){var i="yes"===e;this._submitButton.setMod("disabled",i?"yes":""),this._spinner.setMod("progress",i?"yes":"")}},_initBlocks:function(){this._languageRadioButton=this.findBlockInside({block:"radio-button",modName:"type",modVal:"language"}),this._translateRadioButton=this.findBlockInside({block:"radio-button",modName:"type",modVal:"show-translate"}),this._useFullWidthContent=this.findBlockInside({block:"tumbler",modName:"type",modVal:"use_full_width_content"}),this._submitButton=this.findBlockInside({block:"button2",modName:"role",modVal:"submit"}),this._spinner=this.findBlockInside("spin2")},_subscribe:function(){this._submitButton.on("click",this._submitForm,this)},_submitForm:function(){this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".settings",method:"POST",data:this._getDataForSubmit(),urlParams:!1,path:""}).run().then(this._onSuccessSave.bind(this),this._onFailedSave.bind(this))},_getDataForSubmit:function(){return{language:this._languageRadioButton.val(),propose_content_translation:"true"===this._translateRadioButton.val(),use_full_width_content:"true"!==this._useFullWidthContent.val()}},_onSuccessSave:function(){this.delMod("progress")},_onFailedSave:function(){this.delMod("progress"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this._submitButton.domElem,BEM.I18N("w-user-settings","save_error")))}}),BEM.DOM.decl("w-user-settings",{_initBlocks:function(){this._useFullWidthContent=this.findBlockInside({block:"tumbler",modName:"type",modVal:"use_full_width_content"}),this._submitButton=this.findBlockInside({block:"button2",modName:"role",modVal:"submit"}),this._spinner=this.findBlockInside("spin2")},_getDataForSubmit:function(){return{use_full_width_content:"true"!==this._useFullWidthContent.val()}}}),BEM.decl("wi-copytracker",{onSetMod:{js:function(){keymaster("ctrl+c, command+c",this._onCopy.bind(this))}},_onCopy:function(){var t=this._getSelectionText();t&&BEM.create("wi-api-request",{apiPath:".stats",method:"POST",data:{source:location.protocol+"//"+location.host+location.pathname,symbols:t.length,text:t},urlParams:!1,path:""}).run()},_getSelectionText:function(){var t="",e=BEM.DOM.win[0],i=BEM.DOM.doc[0];return e.getSelection?t=e.getSelection().toString():i.selection&&"Control"!==i.selection.type&&(t=i.selection.createRange().text),t}}),function(t,e,i){var n=i.Model.extend({constructor:function(t,e){i.Model.apply(this,arguments),this.trigger("init",this)}},{});t.WISTORE={_decls:null,models:{BaseModel:n},stores:{},decl:function(t,e,i){var n=null;for(var s in(n="string"==typeof t?{model:t}:{model:t.model})._modelDecl={defaults:{}},n._fields={},e)if(e.hasOwnProperty(s)){var o=e[s];"function"==typeof o?n._modelDecl[s]=o:("string"==typeof o&&(o={type:o}),n._fields[s]=o,"id"===o.type&&(n._modelDecl.idAttribute=s),n._modelDecl.defaults[s]=o.def)}return this._decls||(this._decls={}),this._decls[n.model]=n,this.models[n.model]=this.models.BaseModel.extend(n._modelDecl,i),this.models[n.model]._name=n.model,this.models[n.model]._decl=n,this.models[n.model]},create:function(t,e){"string"==typeof t&&(t={model:t});var i=this.models[t.model];if(void 0===i)throw Error('model with name "'+t.model+'" is not declared');return new i(e)},get:function(t){return this.stores[t]}}}(BEM,$,Backbone),BEM.DOM.decl("wi-store",{onSetMod:{js:function(){var t=this.params.model||"BaseModel",e=this.params.id||this.params.uniqId,i=this.params.data||{};BEM.WISTORE.stores[e]=BEM.WISTORE.create({model:t},i)}}},{}),BEM.WISTORE.decl("page",{type:"string",tag:"string",superTag:"string",url:"string",version:"number",userSubscription:"string",translation:"string",redirect:"boolean",redirectedFrom:"string",title:"string",comments:"boolean",authors:"array",currentUser:"object",withNewWf:"boolean",modifiedAt:"string",isOld:"boolean",isOfficial:"boolean",access:"object",isFav:"boolean",isReadonly:"boolean",canEdit:"boolean",raw:"string"},{}),BEM.WISTORE.decl("session",{sidebarState:{type:"string",def:"close"},sidebarTab:"string"},{}),BEM.DOM.decl("wiki-session",{onSetMod:{js:function(){this._onSessionChangeDebounce=$.debounce(this._onSessionChange,100,this),BEM.WISTORE.get("session")&&BEM.WISTORE.get("session").on("change",this._onSessionChangeDebounce,this)}},destruct:function(){BEM.WISTORE.get("session").off("change",this._onSessionChangeDebounce,this),this.__base.apply(this,arguments)},_onSessionChange:function(t){var e=t.attributes;Object.keys(e).forEach(function(t){e[t]?$.cookie("w-"+t,e[t],{path:"/"}):$.cookie("w-"+t,null,{path:"/"})})}},{}),BEM.decl("i-magiclinks",{},{ERROR_PREFIX:"MAGICLINKS",DEFAULT_TTL:10800,REMOVE_FROM_CACHE_TTL_FACTOR:1.1,_DEBOUNCE_REQUEST_TIME:500,_STORAGE_OPTS:{db:"magiclinks",store:"links",version:2},_LINK_STATUS:{init:1,requested_from_cache:2,requested_from_api:3,need_request_from_api:4,unresolved:5,resolved:6},_CACHE_CHECK_INTERVAL:15e3,_CACHE_CLEAR_INTERVAL:6e5,_sessionCacheStorage:{},_apiUrl:"",init:function(){this.initStore(),BEM.channel("magiclink").on("update",this._onUpdate,this),this._requestFromApi=$.debounce(this._requestFromApiImplementation,this._DEBOUNCE_REQUEST_TIME,this),document.addEventListener("visibilitychange",this._toggleTimers.bind(this))},initStore:function(){var t=this;if(!window.indexedDB)return t._persistentCacheDb=!1,!1;var e=window.indexedDB.open(this._STORAGE_OPTS.db,this._STORAGE_OPTS.version);t._persistentCacheDb=null,e.onsuccess=function(e){var i=e.target.result;t._persistentCacheDb=i,t._toggleTimers(),0===document.location.hash.toLowerCase().indexOf("#wf:magiclinks_drop_cache")&&(t._dropCache(),document.location.hash="")},e.onerror=function(){t._persistentCacheDb=!1},e.onupgradeneeded=function(e){var i=e.target.result,n=t._STORAGE_OPTS.store;i.objectStoreNames.contains(n)&&i.deleteObjectStore(n),i.createObjectStore(n,{keyPath:"_requestedUrl"}).createIndex("expire","expire",{unique:!1})}},getUriFromBlock:function(t){var e=t.domElem.attr("href"),i=t.domElem.text();return t.hasMod("hidden","yes")?i!==decodeURIComponent(e.split("/?")[1])&&(e=!1):t.hasMod("interwiki","yes")||i===e||(e=!1),e},getUriFromTicketBlock:function(t){return t.elem("issue").attr("href")},processServerResponse:function(t,e){return t&&(t.ttl=void 0===t.ttl?this.DEFAULT_TTL:t.ttl,-1===t.ttl)?(this._removeLinkFromCache(e),null):t},_onUpdate:function(t,e){var i=this;i._apiUrl=e.apiUrl,null===i._persistentCacheDb?setTimeout(function(){i._findLinksInBlock(e.block)},i._DEBOUNCE_REQUEST_TIME):i._findLinksInBlock(e.block)},_toggleTimers:function(){if(document.hidden)this._cacheCheckInterval=clearInterval(this._cacheCheckInterval),this._removeFromCacheInterval=clearInterval(this._removeFromCacheInterval);else if(this._cacheCheckInterval||(this._cacheCheckInterval=setInterval(this._cacheInvalidation.bind(this),this._CACHE_CHECK_INTERVAL)),this._persistentCacheDb&&!this._removeFromCacheInterval){var t=this._removeExpiredLinksFromCache.bind(this);t(),this._removeFromCacheInterval=setInterval(t,this._CACHE_CLEAR_INTERVAL)}},_sessionCache:function(t){return this._sessionCacheStorage[t]||(this._sessionCacheStorage[t]={blocks:[],html:"",status:this._LINK_STATUS.init,data:null,expire:0}),this._sessionCacheStorage[t]},_findLinksInBlock:function(t){var e=this;t.findBlocksInside({block:"wiki-ticket"}).forEach(function(t){var i=e.getUriFromTicketBlock(t);i&&e._renderLinkInBlock(i,t)}),t.findBlocksInside({block:"wiki-ref",modName:"magiclink",modVal:"yes"}).forEach(function(t){var i=e.getUriFromBlock(t);i&&e._renderLinkInBlock(i,t)}),this._requestFromApi()},_request:function(t,e){return $.ajax({type:"POST",url:t,data:JSON.stringify(e),contentType:"application/json",dataType:"json",crossDomain:!0,processData:!1,cache:!1,xhrFields:{withCredentials:!0}})},_now:function(){return Math.floor(Date.now()/1e3)},_requestFromApiImplementation:function(){var t=this,e=t._getLinksUrlsWithStatus(t._LINK_STATUS.need_request_from_api),i=t._getLinksUrlsWithStatus(t._LINK_STATUS.requested_from_api).length>0;e.length>0&&(i?setTimeout(this._requestFromApi,this._DEBOUNCE_REQUEST_TIME):(e.forEach(function(e){t._sessionCache(e).status=t._LINK_STATUS.requested_from_api}),t._request(t._apiUrl,{links:e,referer:document.location.toString()}).then(function(i){t._processRawResponseFromApi(e,i)}).fail(function(i,n,s){if(e.forEach(function(e){t._sessionCache(e).status=t._LINK_STATUS.need_request_from_api}),!(Ya&&Ya.Rum&&Ya.Rum.logError))throw new Error(t.ERROR_PREFIX+" request failed: "+s);Ya.Rum.logError({message:t.ERROR_PREFIX+" request failed",level:"error",additional:{wf:"old"}},s)})))},_processRawResponseFromApi:function(t,e){var i=this,n=e.data||{},s=e.drop_client_cache;s&&i._dropCache(),t.forEach(function(t){var e=i.processServerResponse(n[t],t);if(e){e.expire=i._now()+e.ttl,e._requestedUrl=t;var o=/(st|tracker)\.(test\.)?yandex(-team)?\.ru(.*)(#.+)$/.exec(t);if(o){var r=o[5];e.value&&e.value.push({type:"string",value:r,color:"gray"})}!s&&e.ttl>=300&&i._putToPersistentCache(e),i._putToPageCache(t,e)}else i._sessionCache(t).status=i._LINK_STATUS.unresolved})},_persistentCacheDbStore:function(t){var e=this._STORAGE_OPTS.store;return this._persistentCacheDb.transaction([e],t).objectStore(e)},_putToPersistentCache:function(t){this._persistentCacheDb&&this._persistentCacheDbStore("readwrite").put(t)},_getFromPersistentCache:function(t){var e=this,i=this._sessionCache(t),n=function(){i.status=e._LINK_STATUS.need_request_from_api,e._requestFromApi()};if(e._persistentCacheDb){i.status=e._LINK_STATUS.requested_from_cache;var s=this._persistentCacheDbStore("readonly").get(t);s.onsuccess=function(i){i.target&&i.target.result?e._putToPageCache(t,i.target.result):n()},s.onerror=n}else n()},_putToPageCache:function(t,e){var i=this,n=this._sessionCache(t);n.data=e,n.expire=e.expire,n.status=this._LINK_STATUS.resolved;var s=n.blocks[0].findBlockOutside("wiki-doc"),o=this._convertToHtml(e,s);n.html!==o&&(this._sessionCache(t).html=o,n.blocks.forEach(function(e){i._renderBlock(e,t)}))},_renderLinkInBlock:function(t,e){var i=this._sessionCache(t);e.hasMod("magiclink_status")||(e.setMod("magiclink_status","inited"),i.blocks.push(e),i.html?this._renderBlock(e,t):i.status===this._LINK_STATUS.init&&this._getFromPersistentCache(t))},_getLinksUrlsWithStatus:function(t){var e=this;return Object.keys(this._sessionCacheStorage).filter(function(i){return e._sessionCache(i).status===t})},_convertToHtml:function(t,e){return t.block="wiki-magiclink",$(BEMHTML.apply({block:"wiki-doc","wiki-attrs":e.params["wiki-attrs"],content:t})).html()},_renderBlock:function(t,e){t.domElem=BEM.DOM.replace(t.domElem,this._sessionCache(e).html)},_isExpired:function(t){return t<this._now()},_cacheInvalidation:function(){var t=this;Object.keys(this._sessionCacheStorage).forEach(function(e){var i=t._sessionCache(e);t._isExpired(i.expire)&&i.status===t._LINK_STATUS.resolved&&(t._sessionCache(e).status=t._LINK_STATUS.need_request_from_api)}),t._requestFromApi()},_dropCache:function(){this._persistentCacheDbStore("readwrite").clear()},_isDieInCache:function(t){return this._isExpired((this.REMOVE_FROM_CACHE_TTL_FACTOR-1)*t.ttl+t.expire)},_removeExpiredLinksFromCache:function(){var t=this,e=this._persistentCacheDbStore("readwrite");e&&(e.index("expire").openCursor(IDBKeyRange.upperBound(this._now(),!1),"prev").onsuccess=function(i){var n=i.target.result;n&&(n.value&&t._isDieInCache(n.value)&&(console.warn("Delete from cache",n.value._requestedUrl),e.delete(n.value._requestedUrl)),n.continue())})},_removeLinkFromCache:function(t){this._persistentCacheDb&&this._persistentCacheDbStore("readwrite").delete(t)}}),BEM.blocks["i-magiclinks"].init(),BEM.DOM.decl("wiki-magiclink-action",{onSetMod:{js:function(){var t=this;if(t.params.type&&"halfscreenpreview"===t.params.type){var e=t.params.url;t.bindTo("click",function(i){t.__self.doNotHide=!0,i.metaKey||i.ctrlKey||2===i.which||(i.preventDefault(),t.__self.hidden||t.__self.lastUrl!==e?e&&t.__self.showPopup(e):t.__self.closePopup())})}}}},{iframe:null,popup:null,lastUrl:null,hidden:!0,doNotHide:!1,showPopup:function(t){var e=this;this.popup||(this.popup=this._getPopup(),this.popup.appendTo("body"),this.iframe=this._getIframe(),this.popup.append(this.iframe),$(document).on("click",function(){e.hidden||e.doNotHide||e.closePopup(),e.doNotHide=!1}),this.popup.find(".wiki-magiclink-action__close").on("click",function(){e.closePopup()})),this.lastUrl!==t&&(this.clearIframe(),this.lastUrl=t,this.iframe.attr("src",t)),this.trigger("open",{url:t}),this.popup.show(),this.hidden=!1},closePopup:function(){this.trigger("close"),this.popup.hide(),this.hidden=!0},_getPopup:function(){return $(BEMHTML.apply({block:"wiki-magiclink-action",elem:"card",content:{elem:"close",content:"×"}}))},clearIframe:function(){$(window).off("message");var t=this._getIframe();this.iframe.replaceWith(t),this.iframe=t},_getIframe:function(){return $(BEMHTML.apply({block:"wiki-magiclink-action",elem:"iframe",tag:"iframe"}))}}),BEM.DOM.decl({name:"wiki-ref",modName:"type",modVal:"docviewer"},{_docviewer:{},onSetMod:{js:function(){this._getDocviewer(),this.bindTo(this.domElem,"click",this.docviewerTrigger)}},_getDocviewer:function(){this._docviewer=this.findBlockOutside("wiki-doc").findBlockInside("wiki-docviewer")},docviewerTrigger:function(t){t.preventDefault(),this._docviewer.toggle(this.domElem,this.params)}}),BEM.DOM.decl("wiki-docviewer",{_links:[],_popupa:{},_owner:{},onSetMod:{js:function(){this._getLinks(),this._popupa=this.findBlockOn("b-popupa")}},_getLinks:function(){this._links=this.findBlocksInside("b-link")},_setContent:function(t){for(var e=this._links,i=0;i<e.length;i++){var n=e[i];"view"==n.getMod("type")?n.domElem.attr("href",t.docviewer):n.domElem.attr("href",t.url)}},toggle:function(t,e){this._popupa._isShowed&&this._popupa.hide(),this._owner!==t&&(this._owner=t,this._setContent(e)),this._popupa.toggle(t)}}),function(t){var e=["down-right","down","down-left","up","up-right","up-left","right-down","right","right-up","left-down","left","left-up"];BEM.DOM.decl("b-popupa",{onSetMod:{js:{inited:function(){this._owner=null,this._isShowed=!1,this._direction=this.getMod("direction")||"down",this._lastDirection=null,this._hasTail=Boolean(this.elem("tail").length),this._hasTail||Object.keys(this.params).forEach(function(t){0===t.indexOf("tail")&&(this.params[t]=0)},this)}}},show:function(t){return this._isShowed&&this._owner===t||(this._owner=t,this._getUnder().show({left:-1e4,top:-1e4}),this.pos(),this._getUnder().setMod("animate","yes")),this},hide:function(){return this._isShowed&&this._getUnder().hide(),this},toggle:function(t){return this.isShowed()?this.hide():this.show(t)},_pos:function(){var t=this._calcParams(this._owner);return this._hasTail&&this.elem("tail").css(t.tailOffsets),this.setMod("direction",t.direction)._getUnder().show(t.offsets),this},pos:function(){return this._isShowed?this._pos():this},isShowed:function(){return this._isShowed},setDirection:function(t){this._direction!==t&&(this._direction=t,this.isShowed()&&this.pos())},setContent:function(t,e,i){return BEM.DOM.update(this.elem("content"),t,e,i),this.isShowed()?this.pos():this},_isOwnerNode:function(){return Boolean(this._owner&&this._owner.jquery)},_calcDimensions:function(){var t=this._getUnder().domElem,e=this._getUnder()._getUnder(),i=this.__self.win,n=this._owner,s=this._isOwnerNode(),o=s?n.offset():n,r=s?n.outerWidth():0,a=s?n.outerHeight():0,c=i.scrollLeft(),l=i.scrollTop(),d=this.__self.getWindowSize(),h=parseInt(this.elem("content").css("border-top-width"),10);return{ownerWidth:r,ownerHeight:a,ownerLeft:o.left,ownerTop:o.top,ownerRight:o.left+r,ownerBottom:o.top+a,ownerHorizMiddle:o.left+r/2,ownerVertMiddle:o.top+a/2,posWidth:t.outerWidth(),posHeight:t.outerHeight(),underWidth:e.outerWidth(),underHeight:e.outerHeight(),borderWidth:isNaN(h)?0:h,windowLeft:c,windowRight:c+d.width,windowTop:l,windowBottom:l+d.height}},_calcParams:function(){var e=this._calcDimensions();if(this.hasMod("adjustable","no"))return this.calcDirectionParams(this._direction,e);var i={},n=this.params.directions,s=t.inArray(this._direction,n);s>-1||(s=0);var o,r,a=s;do{if(!(r=i[o=n[s]]=this.calcDirectionParams(o,e)).factor)return this._lastDirection=o,r;++s===n.length&&(s=0)}while(s!==a);return i[this._lastDirection||n[0]]},calcDirectionParams:function(t,e){var i=this.params,n={top:0,left:0},s={marginLeft:0,marginTop:0},o=t.split("-")[0],r=this._hasTail&&e.ownerWidth<i.tailWidthVertical?(i.tailWidthVertical-e.ownerWidth)/2:0,a=this._hasTail&&e.ownerHeight<i.tailHeightHorizontal?(i.tailHeightHorizontal-e.ownerHeight)/2:0;switch(t){case"up":case"down":n.left=e.ownerHorizMiddle-e.posWidth/2,n.top="down"===t?e.ownerBottom+i.tailHeightVertical:e.ownerTop-e.posHeight-i.tailHeightVertical,s.marginLeft=e.posWidth/2-i.tailWidthVertical/2,s.marginTop="down"===t?0-i.tailHeightVertical:0;break;case"up-left":case"up-right":case"down-left":case"down-right":n.left="down-right"===t||"up-right"===t?e.ownerLeft-r:e.ownerRight-e.posWidth+r,n.top="down"===o?e.ownerBottom+i.tailHeightVertical:e.ownerTop-e.posHeight-i.tailHeightVertical,s.marginLeft=e.ownerWidth>e.posWidth?e.posWidth/2-i.tailWidthVertical/2:e.ownerHorizMiddle-n.left-i.tailWidthVertical/2,s.marginTop="down"===o?e.borderWidth-i.tailHeightVertical:0-e.borderWidth;break;case"left-down":case"right-down":n.left="left-down"===t?e.ownerLeft-e.posWidth-i.tailWidthHorizontal:e.ownerRight+i.tailWidthHorizontal,n.top=e.ownerTop-a,s.marginLeft="left-down"===t?0-e.borderWidth:e.borderWidth-i.tailWidthHorizontal,s.marginTop=e.ownerHeight<e.posHeight?e.ownerVertMiddle-n.top-i.tailHeightHorizontal/2:e.posHeight/2-i.tailHeightHorizontal/2;break;case"left":case"right":n.left="left"===t?e.ownerLeft-e.posWidth-i.tailWidthHorizontal:e.ownerRight+i.tailWidthHorizontal,n.top=e.ownerVertMiddle-e.posHeight/2,s.marginLeft="left"===t?0-e.borderWidth:e.borderWidth-i.tailWidthHorizontal,s.marginTop=e.posHeight/2-i.tailHeightHorizontal/2;break;case"left-up":case"right-up":n.left="left-up"===t?e.ownerLeft-e.posWidth-i.tailWidthHorizontal:e.ownerRight+i.tailWidthHorizontal,n.top=e.ownerBottom-e.posHeight+a,s.marginLeft="left"===o?0-e.borderWidth:e.borderWidth-i.tailWidthHorizontal,s.marginTop=e.ownerHeight>e.posHeight?e.posHeight/2-i.tailHeightHorizontal/2:e.ownerVertMiddle-n.top-i.tailHeightHorizontal/2}return{direction:o,factor:this.calcInWindowFactor(n,e),offsets:n,tailOffsets:s}},calcInWindowFactor:function(t,e){var i=0;return e.windowTop>t.top&&(i+=e.windowTop-t.top),t.top+e.underHeight>e.windowBottom&&(i+=t.top+e.underHeight-e.windowBottom),e.windowLeft>t.left&&(i+=e.windowLeft-t.left),t.left+e.underWidth>e.windowRight&&(i+=t.left+e.underWidth-e.windowRight),i},getDefaultParams:function(){return{tailOffset:19,tailWidthHorizontal:9,tailWidthVertical:19,tailHeightHorizontal:19,tailHeightVertical:10,shadowSize:7,directions:e}},destruct:function(){var t=this._under;t?this._destructing||(this._destructing=!0,this.hide(),BEM.DOM.destruct(!1,t.domElem),this.__base(!0)):this.__base.apply(this,arguments)},_getUnder:function(){if(!this._under){var e=t(BEM.HTML.build({block:"i-popup",zIndex:this.params.zIndex,mods:{autoclosable:this.getMod("autoclosable")||"yes",fixed:this.hasMod("direction","fixed")&&"yes"},underMods:this.params.underMods,underMix:[{block:"b-popupa",elem:"under"}]}));(this._under=this.findBlockOn(e,"i-popup")).on({show:this._onUnderShowed,hide:this._onUnderHidden,"outside-click":this._onUnderOutsideClicked},this).elem("content").append(this.domElem)}return this._under},_onUnderShowed:function(){this._isShowed=!0,this.bindToWin("resize",this.pos)._isOwnerNode()&&this.bindToDomElem(this._owner.parents().add(this.__self.win),"scroll",this.pos),this.trigger("show")},_onUnderHidden:function(){this._isShowed=!1,this.unbindFromWin("resize")._isOwnerNode()&&this.unbindFromDomElem(this._owner.parents().add(this.__self.win),"scroll"),this.trigger("hide")},_onUnderOutsideClicked:function(){this.trigger.apply(this,arguments)}},{live:function(){this.liveBindTo("close","pointerclick",function(){this.hide()})}}),BEM.HTML.decl("b-popupa",{onBlock:function(e){var i=!1;t.each(e.param("content"),function(t,e){return!(i="close"===e.elem)}),e.mods({theme:"ffffff",direction:"down","has-close":i&&"yes"}).js(!0).afterContent({elem:"shadow"})},onElem:{content:function(t){t.wrap({elem:"wrap-cell",tag:"td"}).wrap({tag:"tr"}).wrap({elem:"wrap",tag:"table"})},close:function(t){t.tag("i")},shadow:function(t){t.tag("i")},tail:function(t){t.tag("i").wrapContent({elem:"tail-i",tag:"i"})}}})}(jQuery),function(t){var e,i=[],n=BEM.blocks["i-ua"],s=n.ie<9,o=n.ie>=9,r=window.ActiveXObject,a=Object(navigator.mimeTypes),c=function(){if(r)try{return Boolean(new r("ShockwaveFlash.ShockwaveFlash"))}catch(t){return!1}return Boolean(Object(a["application/x-shockwave-flash"]).enabledPlugin)}();function l(){return i.length?i.shift():e?e.clone():e=t(c?"<iframe"+(s?' frameborder="0"':"")+">":"<div>")}BEM.DOM.decl("i-popup",{onSetMod:{js:{inited:function(){o&&(this.domElem[0].onresize=function(){this.className+=""})}},visibility:{visible:function(){var t=this._getUnder(),e=t.parent();this.hasMod(t,"type","paranja")?e.is("body")||t.appendTo("body"):e[0]!==this.domElem[0]&&t.prependTo(this.domElem),this._inBody=this._inBody||Boolean(this.domElem.appendTo("body")),this.trigger("show")},"":function(){var t=this._getUnder();this.hasMod(t,"type","paranja")&&t.remove(),this._putUnder(),this.trigger("hide")}}},_getUnder:function(){return this._under||(this._under=l().attr("class",this._underClass||(this._underClass=this.findElem("under").remove().attr("class"))))},_putUnder:function(){var t;t=this._under,i.push(t),delete this._under},show:function(t){return t&&this.domElem.css(t),this.setMod("visibility","visible")},hide:function(){return this.delMod("animate").delMod("visibility")}},{live:!0})}(jQuery),BEM.HTML.decl("i-popup",{onBlock:function(t){t.mod("autoclosable","yes").js(!0).wrapContent({elem:"content"}).afterContent({elem:"under",mods:t.param("underMods"),mix:t.param("underMix")}).param("zIndex")&&t.attr("style","z-index:"+(32700+t.param("zIndex")))}}),BEM.DOM.decl("wiki-widget-action",{onSetMod:{js:function(){$.ajax({type:"GET",url:this.params.data.url_with_data,success:this._onGotData.bind(this),error:this._onGotDataError.bind(this)})}},_onGotData:function(t){BEM.DOM.replace(this.domElem,BEMHTML.apply({block:"b-wiki-"+this.params.data.action_name,js:{data:this.params.data.params,totalData:t.data}}))},_onGotDataError:function(t){BEM.DOM.update(this.domElem,BEMHTML.apply({block:"wiki-widget-action",elem:"error",message:this.__self._getWidgetActionErrorMessage(t)}))}},{_getWidgetActionErrorMessage:function(t){var e="";try{JSON.parse(t.responseText).error.message.forEach(function(t){e+=t+"\n"})}catch(t){e=BEM.I18N("wiki-widget-action","error")}return e}}),BEM.DOM.decl("wiki-widget-action",{_onGotData:function(t){this.setMod("loaded","yes"),this.__base.apply(this,arguments),BEM.channel("common").trigger("reset-hash")},_onGotDataError:function(t){this.setMod("loaded","yes"),this.__base.apply(this,arguments),this.channel("common").trigger("reset-hash")}}),BEM.DOM.decl("wiki-cut",{onSetMod:{js:{inited:function(){keymaster("ctrl+f, command+f",function(){this.setMod("type","expanded")}.bind(this)),BEM.channel("cuts").on("expand",function(){this.setMod("type","expanded")},this),this.bindTo(this._getToggler(),"click",this.toggle)}},type:function(){this.hasMod("loaded","yes")||(BEM.DOM.update(this.findElem("cbody"),$(BEMHTML.apply({block:"wiki-doc","wiki-attrs":this.findBlockOutside("wiki-doc").params["wiki-attrs"],content:JSON.parse(BEM.blocks["i-helpers"].unescapifyHTML(this.params.body))})).contents()),BEM.blocks["i-highlight"]&&BEM.blocks["i-highlight"].highlight(this.findElem("cbody").find("code")),this.setMod("loaded","yes"))},loaded:{yes:function(){this.trigger("content-loaded")}}},destruct:function(){keymaster.unbind("ctrl+f, command+f"),BEM.channel("cuts").un("expand"),this.__base.apply(this,arguments)},_getToggler:function(){return this.findBlockInside({blockName:"link",modName:"pseudo",modVal:"yes"}).domElem},recursiveExpand:function(){"expanded"!==this.getMod("type")&&this.toggle();var t=this.findBlockOutside("wiki-cut__cbody");t&&t.findBlockOutside("wiki-cut").recursiveExpand()},toggle:function(){this.toggleMod("type","expanded")}}),BEM.decl("i-helpers",{},{unescapifyHTML:function(t){return $("<div/>").html(t).text()}}),BEM.DOM.decl("wiki-err",{onSetMod:{js:{inited:function(){this.bindTo(this._getToggler(),"click",this.toggle)}}},_getToggler:function(){return this.findElem("more")},recursiveExpand:function(){"expanded"!=this.getMod("type")&&this.toggle()},toggle:function(){this.toggleMod("type","expanded")}}),BEM.DOM.decl({block:"b-link",modName:"pseudo",modVal:"yes"},{_onClick:function(t){t.preventDefault(),this.hasMod("disabled","yes")||this.afterCurrentEvent(function(){this.domElem&&this.trigger("click")})}},{live:function(){return this.liveBindTo({modName:"pseudo",modVal:"yes"},"pointerclick",function(t){this._onClick(t)}),this.__base()}}),BEM.DOM.decl("wiki-footnote",{onSetMod:{js:function(){this._link=this.findBlockInside("b-link"),this._name=this._link.domElem[0].name,this._anchor=this._link.domElem[0].hash.slice(1),this.__self.footnotes||this._findFootnotes(),this._link.bindTo("click",this._onClick.bind(this))}},_onClick:function(t){t.preventDefault(),this._goToFootnote(this._anchor)},_goToFootnote:function(t){location.hash="#"+t;var e=this.__self.footnotes[t].domElem.offset().top;window.scrollTo(0,e-$(".w-page-panel").outerHeight()-10)},_findFootnotes:function(){this.__self.footnotes={},this.__self.footnotes=this.findBlockOutside("wiki-doc").findBlocksInside("wiki-footnote").reduce(function(t,e){return t[e._name]=e,t},{})}}),BEM.DOM.decl("wiki-head",{onSetMod:{js:function(){var t=this;this.__self._bPage||(this.__self._bPage=this.findBlockOutside("b-page")),this.__base.apply(this,arguments),this._editLink=this.findElem("link","type","edit"),this.bindTo(this._editLink,"click",function(e){var i,n,s=this._editLink.attr("href"),o=/(?:\/)(\.\S+)/g.exec(s);e.preventDefault(),o&&o[1]&&(o=o[1]),i=t._getQueryParameters(o),(n=/(.+)\/\.\w+\?/.exec(this._editLink.attr("href")))&&(i.path=n[1]),BEM.blocks["wi-history"].pushState(o),BEM.channel("common").trigger("w-action.open-editor",{params:i})}),BEM.channel("common").on("created",function(e,i){var n;"editor"==i.type&&(n=t.__self._bPage.findBlockInside("b-editor-save-button"),keymaster("ctrl+enter, command+enter",n._onClick.bind(n)))})}},_getQueryParameters:function(t){return t.replace(/(.+\?)/,"").split("&").map(function(t){return this[(t=t.split("="))[0]]=t[1],this}.bind({}))[0]}}),BEM.DOM.decl("wiki-headcut",{onSetMod:{js:{inited:function(){keymaster("ctrl+f, command+f",function(){this.setMod("visibility","visible")}.bind(this)),BEM.channel("cuts").on("expand",function(){this.setMod("visibility","visible")},this),this.bindTo(this._getChead(),"click",this._toggle)}},visibility:function(){this.hasMod("loaded","yes")||(BEM.DOM.update(this.findElem("cbody"),$(BEMHTML.apply({block:"wiki-doc","wiki-attrs":this.findBlockOutside("wiki-doc").params["wiki-attrs"],content:JSON.parse(BEM.blocks["i-helpers"].unescapifyHTML(this.params.body))})).contents()),BEM.blocks["i-highlight"]&&BEM.blocks["i-highlight"].highlight(this.findElem("cbody").find("code")),this.setMod("loaded","yes"))},loaded:{yes:function(){this.trigger("content-loaded")}}},destruct:function(){keymaster.unbind("ctrl+f, command+f"),BEM.channel("cuts").un("expand"),this.__base.apply(this,arguments)},_getChead:function(){return this.elem("head").eq(0)},_toggle:function(){this.toggleMod("visibility","visible")}}),BEM.DOM.decl("wiki-tocitem",{onSetMod:{js:function(){var t=this.elemParams(this.domElem).anchor,e=this.findBlockInside("b-link");this._wikiToc=this.findBlockOutside("wiki-toc"),e&&e.bindTo("click",function(e){"#"===$(e.target).attr("href")[0]&&(e.preventDefault(),this._wikiToc.tryGoToHeader(t))}.bind(this))}}}),BEM.DOM.decl("wiki-warnholder",{onSetMod:{js:function(){var t=this;this.bindTo("click",function(){var e=$(".wiki-doc .wiki-warnset").eq(0),i=$(".wiki-doc").bem("wiki-doc");if(i.toggleMod("show-warnsets","yes",""),i.hasMod("show-warnsets","yes")){var n=e.bem("wiki-warnset").findBlocksOutside("wiki-cut"),s=e.bem("wiki-warnset").findBlocksOutside("wiki-headcut");n.forEach(function(t){t.hasMod("type","expanded")||jQuery.contains(t._getToggler().get(0),e.get(0))||t.toggle()}),s.forEach(function(t){t.hasMod("visibility","visible")||jQuery.contains(t._getChead().get(0),e.get(0))||t._toggle()}),t.destruct(),$("html, body").animate({scrollTop:e.offset().top},1e3,function(){t._notDestructed&&(e.bem("wiki-warnset")._getIco().domElem.trigger("mouseover"),t._notDestructed=!1)})}else e.bem("wiki-warnset")._getIco().domElem.trigger("mouseout")})}},_notDestructed:!0}),BEM.DOM.decl("wiki-warnset",{timeoutId:!1,warns:!1,popupa:!1,isContent:!1,onSetMod:{js:function(){this._getPopupa(),this.bindTo(this._getIco().domElem,"mouseover mouseout",this.popupaTrigger)}},_getPopupa:function(){this.popupa=this.findBlockInside("b-popupa")},_getIco:function(){return this.findBlockInside("b-icon")},popupaTrigger:function(t){var e=this;this._popupaSetContent(),"mouseover"==t.type?(this.timeoutId=setTimeout(function(){e.popupa.show(e._getIco().domElem),e.setMod("state","hover")},1e3),this.status(this.warns.join(", "))):(clearTimeout(this.timeoutId),this.delMod("state",""),this.popupa.hide(),this.status())},_popupaSetContent:function(){this.isContent||(this.warns=this.elemParams(this.domElem),this.popupa.setContent(this.popupa.findElem("content").html()+this.renderWarningList(this.warns)),this.isContent=!0)},renderWarningList:function(){var t=this;return BEM.HTML.build([{block:"wiki-list",tag:"ul",content:function(){for(var e=[],i=0,n=t.warns.length;i<n;i++)e.push({block:"wiki-li",tag:"li",content:[t.warns[i]]});return e}()}])},status:function(t){window.status=t||""}}),BEM.DOM.decl("wiki-math",{onSetMod:{js:function(){this.init(),this._loadLib(),this.__self._libLoaded&&this._startRender()}},destruct:function(){BEM.blocks["wiki-math"].un("lib-loaded",this.loaded,this),this.__base.apply(this,arguments)},init:function(){},loaded:function(){},_startRender:function(){this.__self._renderTimer&&window.clearTimeout(this.__self._renderTimer),this.__self._renderTimer=window.setTimeout(function(){MathJax.Hub.Queue(["Typeset",MathJax.Hub],function(){BEM.blocks["wiki-math"].trigger("lib-loaded")})},this.__self._beforeRenderTimeout)},_loadLib:function(){this.__self._libLoading||this.__self._libLoaded||(this._libUrl=this._getLibraryUrl(),this.__self._setUpMathJax(),this.__self._getCachedScript(this._libUrl).done(this.__self._onLibLoaded.bind(this.__self)),this.__self._libLoading=!0),BEM.blocks["wiki-math"].on("lib-loaded",this.loaded,this)},_getLibraryUrl:function(){return this.__self._libUrl||(this.__self._libUrl=this.params.staticHost+this.__self._staticUrl),this.__self._libUrl}},{_staticUrl:"/tools-wf/1.0.2/MathJax/MathJax.js",_libUrl:"",_libLoading:!1,_libLoaded:!1,_renderTimer:null,_beforeRenderTimeout:25,_onLibLoaded:function(){this._libLoaded=!0,this._libLoading=!1,BEM.blocks["wiki-math"].trigger("lib-loaded")},_getCachedScript:function(t,e){return e=$.extend(e||{},{dataType:"script",cache:!0,url:t}),$.ajax(e)},_setUpMathJax:function(){window.MathJax={extensions:["tex2jax.js","Safe.js"],jax:["input/TeX","output/SVG"],showProcessingMessages:!1,messageStyle:"none",imageFont:"null",showMathMenu:!1,tex2jax:{processEnvironments:!0,inlineMath:[["$$(inline)","$$"]],displayMath:[["$$(outline)","$$"]],preview:"none",processEscapes:!0}}}}),BEM.DOM.decl("wiki-math",{_anchor:null,_ready:!1,destruct:function(){this._anchor&&this._anchor.is(this.__self._currentAnchor)&&this.__self._getPopup().setAnchor(BEM.DOM.scope),this.__base.apply(this,arguments)},loaded:function(){this._ready||(this.afterCurrentEvent(function(){MathJax.Hub.Queue(function(){this._anchor=this.__self._getAnchor(this.domElem),this.bindTo(this._anchor,"click",this._onTexShow.bind(this))}.bind(this))}),this._ready=!0)},_onTexShow:function(){var t=this.__self._getPopup(),e=this._getTexContent(this.params.tex);t.setContent(e),t.setAnchor(this._anchor),t.hasMod("visible","yes")&&this._anchor.is(this.__self._currentAnchor)?t.setMod("visible",""):t.setMod("visible","yes"),this.__self._currentAnchor=this._anchor},_getTexContent:function(t){if(!this._texContent){var e=BEMHTML.apply({block:"wiki-math",elem:"tex-view",content:this.params.tex});this._texContent=$(e),hljs&&hljs.highlightBlock&&hljs.highlightBlock(this._texContent.get(0))}return this._texContent}},{_popup:null,_currentAnchor:null,_getAnchor:function(t){var e=t,i=t.find(".MathJax_SVG");return i.length&&(e=i).attr("data-bem","{}"),e},_getPopup:function(){if(!this._popup){var t=BEMHTML.apply(this._getPopupJson());this._popup=$(t).bem("popup2"),this._popup.on("beforeClose",this._onBeforePopupClose,this)}return this._popup},_onBeforePopupClose:function(){this.afterCurrentEvent(function(){this._popup.setAnchor(BEM.DOM.scope)},this)},_getPopupJson:function(){return{block:"popup2",mods:{target:"anchor",autoclosable:"yes",theme:"normal"},directions:["right-top","left-top","bottom-left","bottom-right","top-left","top-right"],content:""}}}),function(t){var e="object"==typeof window&&window||"object"==typeof self&&self;"undefined"!=typeof exports?t(exports):e&&(e.hljs=t({}),"function"==typeof define&&define.amd&&define([],function(){return e.hljs}))}(function(t){function e(t){return t.replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;")}function i(t){return t.nodeName.toLowerCase()}function n(t,e){var i=t&&t.exec(e);return i&&0==i.index}function s(t){return/^(no-?highlight|plain|text)$/i.test(t)}function o(t,e){var i,n={};for(i in t)n[i]=t[i];if(e)for(i in e)n[i]=e[i];return n}function r(t){var e=[];return function t(n,s){for(var o=n.firstChild;o;o=o.nextSibling)3==o.nodeType?s+=o.nodeValue.length:1==o.nodeType&&(e.push({event:"start",offset:s,node:o}),s=t(o,s),i(o).match(/br|hr|img|input/)||e.push({event:"stop",offset:s,node:o}));return s}(t,0),e}function a(t,n,s){function o(){return t.length&&n.length?t[0].offset!=n[0].offset?t[0].offset<n[0].offset?t:n:"start"==n[0].event?t:n:t.length?t:n}function r(t){d+="<"+i(t)+Array.prototype.map.call(t.attributes,function(t){return" "+t.nodeName+'="'+e(t.value)+'"'}).join("")+">"}function a(t){d+="</"+i(t)+">"}function c(t){("start"==t.event?r:a)(t.node)}for(var l=0,d="",h=[];t.length||n.length;){var u=o();if(d+=e(s.substr(l,u[0].offset-l)),l=u[0].offset,u==t){h.reverse().forEach(a);do{c(u.splice(0,1)[0]),u=o()}while(u==t&&u.length&&u[0].offset==l);h.reverse().forEach(r)}else"start"==u[0].event?h.push(u[0].node):h.pop(),c(u.splice(0,1)[0])}return d+e(s.substr(l))}function c(t){function e(t){return t&&t.source||t}function i(i,n){return new RegExp(e(i),"m"+(t.cI?"i":"")+(n?"g":""))}!function n(s,r){if(!s.compiled){if(s.compiled=!0,s.k=s.k||s.bK,s.k){var a={},c=function(e,i){t.cI&&(i=i.toLowerCase()),i.split(" ").forEach(function(t){var i=t.split("|");a[i[0]]=[e,i[1]?Number(i[1]):1]})};"string"==typeof s.k?c("keyword",s.k):Object.keys(s.k).forEach(function(t){c(t,s.k[t])}),s.k=a}s.lR=i(s.l||/\w+/,!0),r&&(s.bK&&(s.b="\\b("+s.bK.split(" ").join("|")+")\\b"),s.b||(s.b=/\B|\b/),s.bR=i(s.b),s.e||s.eW||(s.e=/\B|\b/),s.e&&(s.eR=i(s.e)),s.tE=e(s.e)||"",s.eW&&r.tE&&(s.tE+=(s.e?"|":"")+r.tE)),s.i&&(s.iR=i(s.i)),void 0===s.r&&(s.r=1),s.c||(s.c=[]);var l=[];s.c.forEach(function(t){t.v?t.v.forEach(function(e){l.push(o(t,e))}):l.push("self"==t?s:t)}),s.c=l,s.c.forEach(function(t){n(t,s)}),s.starts&&n(s.starts,r);var d=s.c.map(function(t){return t.bK?"\\.?("+t.b+")\\.?":t.b}).concat([s.tE,s.i]).map(e).filter(Boolean);s.t=d.length?i(d.join("|"),!0):{exec:function(){return null}}}}(t)}function l(t,i,s,o){function r(t,e){for(var i=0;i<e.c.length;i++)if(n(e.c[i].bR,t))return e.c[i]}function a(t,e){if(n(t.eR,e)){for(;t.endsParent&&t.parent;)t=t.parent;return t}return t.eW?a(t.parent,e):void 0}function h(t,e){return!s&&n(e.iR,t)}function u(t,e){var i=y.cI?e[0].toLowerCase():e[0];return t.k.hasOwnProperty(i)&&t.k[i]}function m(t,e,i,n){var s='<span class="'+(n?"":f.classPrefix);return(s+=t+'">')+e+(i?"":"</span>")}function g(){x+=void 0!==w.sL?function(){var t="string"==typeof w.sL;if(t&&!_[w.sL])return e(E);var i=t?l(w.sL,E,!0,M[w.sL]):d(E,w.sL.length?w.sL:void 0);return w.r>0&&(B+=i.r),t&&(M[w.sL]=i.top),m(i.language,i.value,!1,!0)}():function(){if(!w.k)return e(E);var t="",i=0;w.lR.lastIndex=0;for(var n=w.lR.exec(E);n;){t+=e(E.substr(i,n.index-i));var s=u(w,n);s?(B+=s[1],t+=m(s[0],e(n[0]))):t+=e(n[0]),i=w.lR.lastIndex,n=w.lR.exec(E)}return t+e(E.substr(i))}(),E=""}function b(t,e){x+=t.cN?m(t.cN,"",!0):"",w=Object.create(t,{parent:{value:w}})}function v(t,e){if(E+=t,void 0===e)return g(),0;var i=r(e,w);if(i)return i.skip?E+=e:(i.eB&&(E+=e),g(),i.rB||i.eB||(E=e)),b(i),i.rB?0:e.length;var n=a(w,e);if(n){var s=w;s.skip?E+=e:(s.rE||s.eE||(E+=e),g(),s.eE&&(E=e));do{w.cN&&(x+="</span>"),w.skip||(B+=w.r),w=w.parent}while(w!=n.parent);return n.starts&&b(n.starts),s.rE?0:e.length}if(h(e,w))throw new Error('Illegal lexeme "'+e+'" for mode "'+(w.cN||"<unnamed>")+'"');return E+=e,e.length||1}var y=p(t);if(!y)throw new Error('Unknown language: "'+t+'"');c(y);var k,w=o||y,M={},x="";for(k=w;k!=y;k=k.parent)k.cN&&(x=m(k.cN,"",!0)+x);var E="",B=0;try{for(var I,S,C=0;w.t.lastIndex=C,I=w.t.exec(i);)S=v(i.substr(C,I.index-C),I[0]),C=I.index+S;for(v(i.substr(C)),k=w;k.parent;k=k.parent)k.cN&&(x+="</span>");return{r:B,value:x,language:t,top:w}}catch(t){if(-1!=t.message.indexOf("Illegal"))return{r:0,value:e(i)};throw t}}function d(t,i){i=i||f.languages||Object.keys(_);var n={r:0,value:e(t)},s=n;return i.filter(p).forEach(function(e){var i=l(e,t,!1);i.language=e,i.r>s.r&&(s=i),i.r>n.r&&(s=n,n=i)}),s.language&&(n.second_best=s),n}function h(t){return f.tabReplace&&(t=t.replace(/^((<[^>]+>|\t)+)/gm,function(t,e){return e.replace(/\t/g,f.tabReplace)})),f.useBR&&(t=t.replace(/\n/g,"<br>")),t}function u(t){var e=function(t){var e,i,n,o=t.className+" ";if(o+=t.parentNode?t.parentNode.className:"",i=/\blang(?:uage)?-([\w-]+)\b/i.exec(o))return p(i[1])?i[1]:"no-highlight";for(e=0,n=(o=o.split(/\s+/)).length;n>e;e++)if(p(o[e])||s(o[e]))return o[e]}(t);if(!s(e)){var i;f.useBR?(i=document.createElementNS("http://www.w3.org/1999/xhtml","div")).innerHTML=t.innerHTML.replace(/\n/g,"").replace(/<br[ \/]*>/g,"\n"):i=t;var n=i.textContent,o=e?l(e,n,!0):d(n),c=r(i);if(c.length){var u=document.createElementNS("http://www.w3.org/1999/xhtml","div");u.innerHTML=o.value,o.value=a(c,r(u),n)}o.value=h(o.value),t.innerHTML=o.value,t.className=function(t,e,i){var n=e?g[e]:i,s=[t.trim()];return t.match(/\bhljs\b/)||s.push("hljs"),-1===t.indexOf(n)&&s.push(n),s.join(" ").trim()}(t.className,e,o.language),t.result={language:o.language,re:o.r},o.second_best&&(t.second_best={language:o.second_best.language,re:o.second_best.r})}}function m(){if(!m.called){m.called=!0;var t=document.querySelectorAll("pre code");Array.prototype.forEach.call(t,u)}}function p(t){return t=(t||"").toLowerCase(),_[t]||_[g[t]]}var f={classPrefix:"hljs-",tabReplace:null,useBR:!1,languages:void 0},_={},g={};return t.highlight=l,t.highlightAuto=d,t.fixMarkup=h,t.highlightBlock=u,t.configure=function(t){f=o(f,t)},t.initHighlighting=m,t.initHighlightingOnLoad=function(){addEventListener("DOMContentLoaded",m,!1),addEventListener("load",m,!1)},t.registerLanguage=function(e,i){var n=_[e]=i(t);n.aliases&&n.aliases.forEach(function(t){g[t]=e})},t.listLanguages=function(){return Object.keys(_)},t.getLanguage=p,t.inherit=o,t.IR="[a-zA-Z]\\w*",t.UIR="[a-zA-Z_]\\w*",t.NR="\\b\\d+(\\.\\d+)?",t.CNR="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",t.BNR="\\b(0b[01]+)",t.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",t.BE={b:"\\\\[\\s\\S]",r:0},t.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[t.BE]},t.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[t.BE]},t.PWM={b:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|like)\b/},t.C=function(e,i,n){var s=t.inherit({cN:"comment",b:e,e:i,c:[]},n||{});return s.c.push(t.PWM),s.c.push({cN:"doctag",b:"(?:TODO|FIXME|NOTE|BUG|XXX):",r:0}),s},t.CLCM=t.C("//","$"),t.CBCM=t.C("/\\*","\\*/"),t.HCM=t.C("#","$"),t.NM={cN:"number",b:t.NR,r:0},t.CNM={cN:"number",b:t.CNR,r:0},t.BNM={cN:"number",b:t.BNR,r:0},t.CSSNM={cN:"number",b:t.NR+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",r:0},t.RM={cN:"regexp",b:/\//,e:/\/[gimuy]*/,i:/\n/,c:[t.BE,{b:/\[/,e:/\]/,r:0,c:[t.BE]}]},t.TM={cN:"title",b:t.IR,r:0},t.UTM={cN:"title",b:t.UIR,r:0},t.METHOD_GUARD={b:"\\.\\s*"+t.UIR,r:0},t.registerLanguage("1c",function(t){var e="[a-zA-Zа-яА-Я][a-zA-Z0-9_а-яА-Я]*",i={b:'""'},n={cN:"string",b:'"',e:'"|$',c:[i]},s={cN:"string",b:"\\|",e:'"|$',c:[i]};return{cI:!0,l:e,k:{keyword:"возврат дата для если и или иначе иначеесли исключение конецесли конецпопытки конецпроцедуры конецфункции конеццикла константа не перейти перем перечисление по пока попытка прервать продолжить процедура строка тогда фс функция цикл число экспорт",built_in:"ansitooem oemtoansi ввестивидсубконто ввестидату ввестизначение ввестиперечисление ввестипериод ввестиплансчетов ввестистроку ввестичисло вопрос восстановитьзначение врег выбранныйплансчетов вызватьисключение датагод датамесяц датачисло добавитьмесяц завершитьработусистемы заголовоксистемы записьжурналарегистрации запуститьприложение зафиксироватьтранзакцию значениевстроку значениевстрокувнутр значениевфайл значениеизстроки значениеизстрокивнутр значениеизфайла имякомпьютера имяпользователя каталогвременныхфайлов каталогиб каталогпользователя каталогпрограммы кодсимв командасистемы конгода конецпериодаби конецрассчитанногопериодаби конецстандартногоинтервала конквартала конмесяца коннедели лев лог лог10 макс максимальноеколичествосубконто мин монопольныйрежим названиеинтерфейса названиенабораправ назначитьвид назначитьсчет найти найтипомеченныенаудаление найтиссылки началопериодаби началостандартногоинтервала начатьтранзакцию начгода начквартала начмесяца начнедели номерднягода номерднянедели номернеделигода нрег обработкаожидания окр описаниеошибки основнойжурналрасчетов основнойплансчетов основнойязык открытьформу открытьформумодально отменитьтранзакцию очиститьокносообщений периодстр полноеимяпользователя получитьвремята получитьдатута получитьдокументта получитьзначенияотбора получитьпозициюта получитьпустоезначение получитьта прав праводоступа предупреждение префиксавтонумерации пустаястрока пустоезначение рабочаядаттьпустоезначение рабочаядата разделительстраниц разделительстрок разм разобратьпозициюдокумента рассчитатьрегистрына рассчитатьрегистрыпо сигнал симв символтабуляции создатьобъект сокрл сокрлп сокрп сообщить состояние сохранитьзначение сред статусвозврата стрдлина стрзаменить стрколичествострок стрполучитьстроку  стрчисловхождений сформироватьпозициюдокумента счетпокоду текущаядата текущеевремя типзначения типзначениястр удалитьобъекты установитьтана установитьтапо фиксшаблон формат цел шаблон"},c:[t.CLCM,t.NM,n,s,{cN:"function",b:"(процедура|функция)",e:"$",l:e,k:"процедура функция",c:[{b:"экспорт",eW:!0,l:e,k:"экспорт",c:[t.CLCM]},{cN:"params",b:"\\(",e:"\\)",l:e,k:"знач",c:[n,s]},t.CLCM,t.inherit(t.TM,{b:e})]},{cN:"meta",b:"#",e:"$"},{cN:"number",b:"'\\d{2}\\.\\d{2}\\.(\\d{2}|\\d{4})'"}]}}),t.registerLanguage("actionscript",function(t){var e={cN:"rest_arg",b:"[.]{3}",e:"[a-zA-Z_$][a-zA-Z0-9_$]*",r:10};return{aliases:["as"],k:{keyword:"as break case catch class const continue default delete do dynamic each else extends final finally for function get if implements import in include instanceof interface internal is namespace native new override package private protected public return set static super switch this throw try typeof use var void while with",literal:"true false null undefined"},c:[t.ASM,t.QSM,t.CLCM,t.CBCM,t.CNM,{cN:"class",bK:"package",e:"{",c:[t.TM]},{cN:"class",bK:"class interface",e:"{",eE:!0,c:[{bK:"extends implements"},t.TM]},{cN:"meta",bK:"import include",e:";",k:{"meta-keyword":"import include"}},{cN:"function",bK:"function",e:"[{;]",eE:!0,i:"\\S",c:[t.TM,{cN:"params",b:"\\(",e:"\\)",c:[t.ASM,t.QSM,t.CLCM,t.CBCM,e]},{b:":\\s*([*]|[a-zA-Z_$][a-zA-Z0-9_$]*)"}]},t.METHOD_GUARD],i:/#/}}),t.registerLanguage("apache",function(t){var e={cN:"number",b:"[\\$%]\\d+"};return{aliases:["apacheconf"],cI:!0,c:[t.HCM,{cN:"section",b:"</?",e:">"},{cN:"attribute",b:/\w+/,r:0,k:{nomarkup:"order deny allow setenv rewriterule rewriteengine rewritecond documentroot sethandler errordocument loadmodule options header listen serverroot servername"},starts:{e:/$/,r:0,k:{literal:"on off all"},c:[{cN:"meta",b:"\\s\\[",e:"\\]$"},{cN:"variable",b:"[\\$%]\\{",e:"\\}",c:["self",e]},e,t.QSM]}}],i:/\S/}}),t.registerLanguage("applescript",function(t){var e=t.inherit(t.QSM,{i:""}),i={cN:"params",b:"\\(",e:"\\)",c:["self",t.CNM,e]},n=t.C("--","$"),s=[n,t.C("\\(\\*","\\*\\)",{c:["self",n]}),t.HCM];return{aliases:["osascript"],k:{keyword:"about above after against and around as at back before beginning behind below beneath beside between but by considering contain contains continue copy div does eighth else end equal equals error every exit fifth first for fourth from front get given global if ignoring in into is it its last local me middle mod my ninth not of on onto or over prop property put ref reference repeat returning script second set seventh since sixth some tell tenth that the|0 then third through thru timeout times to transaction try until where while whose with without",literal:"AppleScript false linefeed return pi quote result space tab true",built_in:"alias application boolean class constant date file integer list number real record string text activate beep count delay launch log offset read round run say summarize write character characters contents day frontmost id item length month name paragraph paragraphs rest reverse running time version weekday word words year"},c:[e,t.CNM,{cN:"built_in",b:"\\b(clipboard info|the clipboard|info for|list (disks|folder)|mount volume|path to|(close|open for) access|(get|set) eof|current date|do shell script|get volume settings|random number|set volume|system attribute|system info|time to GMT|(load|run|store) script|scripting components|ASCII (character|number)|localized string|choose (application|color|file|file name|folder|from list|remote application|URL)|display (alert|dialog))\\b|^\\s*return\\b"},{cN:"literal",b:"\\b(text item delimiters|current application|missing value)\\b"},{cN:"keyword",b:"\\b(apart from|aside from|instead of|out of|greater than|isn't|(doesn't|does not) (equal|come before|come after|contain)|(greater|less) than( or equal)?|(starts?|ends|begins?) with|contained by|comes (before|after)|a (ref|reference)|POSIX file|POSIX path|(date|time) string|quoted form)\\b"},{bK:"on",i:"[${=;\\n]",c:[t.UTM,i]}].concat(s),i:"//|->|=>|\\[\\["}}),t.registerLanguage("bash",function(t){var e={cN:"variable",v:[{b:/\$[\w\d#@][\w\d_]*/},{b:/\$\{(.*?)}/}]},i={cN:"string",b:/"/,e:/"/,c:[t.BE,e,{cN:"variable",b:/\$\(/,e:/\)/,c:[t.BE]}]};return{aliases:["sh","zsh"],l:/-?[a-z\.]+/,k:{keyword:"if then else elif fi for while in do done case esac function",literal:"true false",built_in:"break cd continue eval exec exit export getopts hash pwd readonly return shift test times trap umask unset alias bind builtin caller command declare echo enable help let local logout mapfile printf read readarray source type typeset ulimit unalias set shopt autoload bg bindkey bye cap chdir clone comparguments compcall compctl compdescribe compfiles compgroups compquote comptags comptry compvalues dirs disable disown echotc echoti emulate fc fg float functions getcap getln history integer jobs kill limit log noglob popd print pushd pushln rehash sched setcap setopt stat suspend ttyctl unfunction unhash unlimit unsetopt vared wait whence where which zcompile zformat zftp zle zmodload zparseopts zprof zpty zregexparse zsocket zstyle ztcp",_:"-ne -eq -lt -gt -f -d -e -s -l -a"},c:[{cN:"meta",b:/^#![^\n]+sh\s*$/,r:10},{cN:"function",b:/\w[\w\d_]*\s*\(\s*\)\s*\{/,rB:!0,c:[t.inherit(t.TM,{b:/\w[\w\d_]*/})],r:0},t.HCM,i,{cN:"string",b:/'/,e:/'/},e]}}),t.registerLanguage("clojure",function(t){var e="a-zA-Z_\\-!.?+*=<>&#'",i="["+e+"]["+e+"0-9/;:]*",n={b:i,r:0},s={cN:"number",b:"[-+]?\\d+(\\.\\d+)?",r:0},o=t.inherit(t.QSM,{i:null}),r=t.C(";","$",{r:0}),a={cN:"literal",b:/\b(true|false|nil)\b/},c={b:"[\\[\\{]",e:"[\\]\\}]"},l={cN:"comment",b:"\\^"+i},d=t.C("\\^\\{","\\}"),h={cN:"symbol",b:"[:]"+i},u={b:"\\(",e:"\\)"},m={eW:!0,r:0},p={k:{"builtin-name":"def defonce cond apply if-not if-let if not not= = < > <= >= == + / * - rem quot neg? pos? delay? symbol? keyword? true? false? integer? empty? coll? list? set? ifn? fn? associative? sequential? sorted? counted? reversible? number? decimal? class? distinct? isa? float? rational? reduced? ratio? odd? even? char? seq? vector? string? map? nil? contains? zero? instance? not-every? not-any? libspec? -> ->> .. . inc compare do dotimes mapcat take remove take-while drop letfn drop-last take-last drop-while while intern condp case reduced cycle split-at split-with repeat replicate iterate range merge zipmap declare line-seq sort comparator sort-by dorun doall nthnext nthrest partition eval doseq await await-for let agent atom send send-off release-pending-sends add-watch mapv filterv remove-watch agent-error restart-agent set-error-handler error-handler set-error-mode! error-mode shutdown-agents quote var fn loop recur throw try monitor-enter monitor-exit defmacro defn defn- macroexpand macroexpand-1 for dosync and or when when-not when-let comp juxt partial sequence memoize constantly complement identity assert peek pop doto proxy defstruct first rest cons defprotocol cast coll deftype defrecord last butlast sigs reify second ffirst fnext nfirst nnext defmulti defmethod meta with-meta ns in-ns create-ns import refer keys select-keys vals key val rseq name namespace promise into transient persistent! conj! assoc! dissoc! pop! disj! use class type num float double short byte boolean bigint biginteger bigdec print-method print-dup throw-if printf format load compile get-in update-in pr pr-on newline flush read slurp read-line subvec with-open memfn time re-find re-groups rand-int rand mod locking assert-valid-fdecl alias resolve ref deref refset swap! reset! set-validator! compare-and-set! alter-meta! reset-meta! commute get-validator alter ref-set ref-history-count ref-min-history ref-max-history ensure sync io! new next conj set! to-array future future-call into-array aset gen-class reduce map filter find empty hash-map hash-set sorted-map sorted-map-by sorted-set sorted-set-by vec vector seq flatten reverse assoc dissoc list disj get union difference intersection extend extend-type extend-protocol int nth delay count concat chunk chunk-buffer chunk-append chunk-first chunk-rest max min dec unchecked-inc-int unchecked-inc unchecked-dec-inc unchecked-dec unchecked-negate unchecked-add-int unchecked-add unchecked-subtract-int unchecked-subtract chunk-next chunk-cons chunked-seq? prn vary-meta lazy-seq spread list* str find-keyword keyword symbol gensym force rationalize"},l:i,cN:"name",b:i,starts:m},f=[u,o,l,d,r,h,c,s,a,n];return u.c=[t.C("comment",""),p,m],m.c=f,c.c=f,{aliases:["clj"],i:/\S/,c:[u,o,l,d,r,h,c,s,a]}}),t.registerLanguage("cmake",function(t){return{aliases:["cmake.in"],cI:!0,k:{keyword:"add_custom_command add_custom_target add_definitions add_dependencies add_executable add_library add_subdirectory add_test aux_source_directory break build_command cmake_minimum_required cmake_policy configure_file create_test_sourcelist define_property else elseif enable_language enable_testing endforeach endfunction endif endmacro endwhile execute_process export find_file find_library find_package find_path find_program fltk_wrap_ui foreach function get_cmake_property get_directory_property get_filename_component get_property get_source_file_property get_target_property get_test_property if include include_directories include_external_msproject include_regular_expression install link_directories load_cache load_command macro mark_as_advanced message option output_required_files project qt_wrap_cpp qt_wrap_ui remove_definitions return separate_arguments set set_directory_properties set_property set_source_files_properties set_target_properties set_tests_properties site_name source_group string target_link_libraries try_compile try_run unset variable_watch while build_name exec_program export_library_dependencies install_files install_programs install_targets link_libraries make_directory remove subdir_depends subdirs use_mangled_mesa utility_source variable_requires write_file qt5_use_modules qt5_use_package qt5_wrap_cpp on off true false and or equal less greater strless strgreater strequal matches"},c:[{cN:"variable",b:"\\${",e:"}"},t.HCM,t.QSM,t.NM]}}),t.registerLanguage("coffeescript",function(t){var e={keyword:"in if for while finally new do return else break catch instanceof throw try this switch continue typeof delete debugger super then unless until loop of by when and or is isnt not",literal:"true false null undefined yes no on off",built_in:"npm require console print module global window document"},i="[A-Za-z$_][0-9A-Za-z$_]*",n={cN:"subst",b:/#\{/,e:/}/,k:e},s=[t.BNM,t.inherit(t.CNM,{starts:{e:"(\\s*/)?",r:0}}),{cN:"string",v:[{b:/'''/,e:/'''/,c:[t.BE]},{b:/'/,e:/'/,c:[t.BE]},{b:/"""/,e:/"""/,c:[t.BE,n]},{b:/"/,e:/"/,c:[t.BE,n]}]},{cN:"regexp",v:[{b:"///",e:"///",c:[n,t.HCM]},{b:"//[gim]*",r:0},{b:/\/(?![ *])(\\\/|.)*?\/[gim]*(?=\W|$)/}]},{b:"@"+i},{b:"`",e:"`",eB:!0,eE:!0,sL:"javascript"}];n.c=s;var o=t.inherit(t.TM,{b:i}),r="(\\(.*\\))?\\s*\\B[-=]>",a={cN:"params",b:"\\([^\\(]",rB:!0,c:[{b:/\(/,e:/\)/,k:e,c:["self"].concat(s)}]};return{aliases:["coffee","cson","iced"],k:e,i:/\/\*/,c:s.concat([t.C("###","###"),t.HCM,{cN:"function",b:"^\\s*"+i+"\\s*=\\s*"+r,e:"[-=]>",rB:!0,c:[o,a]},{b:/[:\(,=]\s*/,r:0,c:[{cN:"function",b:r,e:"[-=]>",rB:!0,c:[a]}]},{cN:"class",bK:"class",e:"$",i:/[:="\[\]]/,c:[{bK:"extends",eW:!0,i:/[:="\[\]]/,c:[o]},o]},{b:i+":",e:":",rB:!0,rE:!0,r:0}])}}),t.registerLanguage("cpp",function(t){var e={cN:"keyword",b:"\\b[a-z\\d_]*_t\\b"},i={cN:"string",v:[t.inherit(t.QSM,{b:'((u8?|U)|L)?"'}),{b:'(u8?|U)?R"',e:'"',c:[t.BE]},{b:"'\\\\?.",e:"'",i:"."}]},n={cN:"number",v:[{b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},{b:t.CNR}],r:0},s={cN:"meta",b:"#",e:"$",k:{"meta-keyword":"if else elif endif define undef warning error line pragma ifdef ifndef"},c:[{b:/\\\n/,r:0},{bK:"include",e:"$",k:{"meta-keyword":"include"},c:[t.inherit(i,{cN:"meta-string"}),{cN:"meta-string",b:"<",e:">",i:"\\n"}]},i,t.CLCM,t.CBCM]},o=t.IR+"\\s*\\(",r={keyword:"int float while private char catch export virtual operator sizeof dynamic_cast|10 typedef const_cast|10 const struct for static_cast|10 union namespace unsigned long volatile static protected bool template mutable if public friend do goto auto void enum else break extern using class asm case typeid short reinterpret_cast|10 default double register explicit signed typename try this switch continue inline delete alignof constexpr decltype noexcept static_assert thread_local restrict _Bool complex _Complex _Imaginary atomic_bool atomic_char atomic_schar atomic_uchar atomic_short atomic_ushort atomic_int atomic_uint atomic_long atomic_ulong atomic_llong atomic_ullong",built_in:"std string cin cout cerr clog stdin stdout stderr stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap array shared_ptr abort abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc realloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf endl initializer_list unique_ptr",literal:"true false nullptr NULL"};return{aliases:["c","cc","h","c++","h++","hpp"],k:r,i:"</",c:[e,t.CLCM,t.CBCM,n,i,s,{b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:r,c:["self",e]},{b:t.IR+"::",k:r},{bK:"new throw return else",r:0},{cN:"function",b:"("+t.IR+"[\\*&\\s]+)+"+o,rB:!0,e:/[{;=]/,eE:!0,k:r,i:/[^\w\s\*&]/,c:[{b:o,rB:!0,c:[t.TM],r:0},{cN:"params",b:/\(/,e:/\)/,k:r,r:0,c:[t.CLCM,t.CBCM,i,n]},t.CLCM,t.CBCM,s]}]}}),t.registerLanguage("cs",function(t){var e="abstract as base bool break byte case catch char checked const continue decimal dynamic default delegate do double else enum event explicit extern false finally fixed float for foreach goto if implicit in int interface internal is lock long null when object operator out override params private protected public readonly ref sbyte sealed short sizeof stackalloc static string struct switch this true try typeof uint ulong unchecked unsafe ushort using virtual volatile void while async protected public private internal ascending descending from get group into join let orderby partial select set value var where yield",i=t.IR+"(<"+t.IR+">)?";return{aliases:["csharp"],k:e,i:/::/,c:[t.C("///","$",{rB:!0,c:[{cN:"doctag",v:[{b:"///",r:0},{b:"\x3c!--|--\x3e"},{b:"</?",e:">"}]}]}),t.CLCM,t.CBCM,{cN:"meta",b:"#",e:"$",k:{"meta-keyword":"if else elif endif define undef warning error line region endregion pragma checksum"}},{cN:"string",b:'@"',e:'"',c:[{b:'""'}]},t.ASM,t.QSM,t.CNM,{bK:"class interface",e:/[{;=]/,i:/[^\s:]/,c:[t.TM,t.CLCM,t.CBCM]},{bK:"namespace",e:/[{;=]/,i:/[^\s:]/,c:[t.inherit(t.TM,{b:"[a-zA-Z](\\.?\\w)*"}),t.CLCM,t.CBCM]},{bK:"new return throw await",r:0},{cN:"function",b:"("+i+"\\s+)+"+t.IR+"\\s*\\(",rB:!0,e:/[{;=]/,eE:!0,k:e,c:[{b:t.IR+"\\s*\\(",rB:!0,c:[t.TM],r:0},{cN:"params",b:/\(/,e:/\)/,eB:!0,eE:!0,k:e,r:0,c:[t.ASM,t.QSM,t.CNM,t.CBCM]},t.CLCM,t.CBCM]}]}}),t.registerLanguage("csp",function(t){return{cI:!1,l:"[a-zA-Z][a-zA-Z0-9_-]*",k:{keyword:"base-uri child-src connect-src default-src font-src form-action frame-ancestors frame-src img-src media-src object-src plugin-types report-uri sandbox script-src style-src"},c:[{cN:"string",b:"'",e:"'"},{cN:"attribute",b:"^Content",e:":",eE:!0}]}}),t.registerLanguage("css",function(t){var e={b:/[A-Z\_\.\-]+\s*:/,rB:!0,e:";",eW:!0,c:[{cN:"attribute",b:/\S/,e:":",eE:!0,starts:{eW:!0,eE:!0,c:[{b:/[\w-]+\(/,rB:!0,c:[{cN:"built_in",b:/[\w-]+/},{b:/\(/,e:/\)/,c:[t.ASM,t.QSM]}]},t.CSSNM,t.QSM,t.ASM,t.CBCM,{cN:"number",b:"#[0-9A-Fa-f]+"},{cN:"meta",b:"!important"}]}}]};return{cI:!0,i:/[=\/|'\$]/,c:[t.CBCM,{cN:"selector-id",b:/#[A-Za-z0-9_-]+/},{cN:"selector-class",b:/\.[A-Za-z0-9_-]+/},{cN:"selector-attr",b:/\[/,e:/\]/,i:"$"},{cN:"selector-pseudo",b:/:(:)?[a-zA-Z0-9\_\-\+\(\)"'.]+/},{b:"@(font-face|page)",l:"[a-z-]+",k:"font-face page"},{b:"@",e:"[{;]",i:/:/,c:[{cN:"keyword",b:/\w+/},{b:/\s/,eW:!0,eE:!0,r:0,c:[t.ASM,t.QSM,t.CSSNM]}]},{cN:"selector-tag",b:"[a-zA-Z-][a-zA-Z0-9_-]*",r:0},{b:"{",e:"}",i:/\S/,c:[t.CBCM,e]}]}}),t.registerLanguage("d",function(t){var e="(0|[1-9][\\d_]*)",i="("+e+"|0[bB][01_]+|0[xX]([\\da-fA-F][\\da-fA-F_]*|_[\\da-fA-F][\\da-fA-F_]*))",n="\\\\(['\"\\?\\\\abfnrtv]|u[\\dA-Fa-f]{4}|[0-7]{1,3}|x[\\dA-Fa-f]{2}|U[\\dA-Fa-f]{8})|&[a-zA-Z\\d]{2,};",s={cN:"number",b:"\\b"+i+"(L|u|U|Lu|LU|uL|UL)?",r:0},o={cN:"number",b:"\\b(((0[xX](([\\da-fA-F][\\da-fA-F_]*|_[\\da-fA-F][\\da-fA-F_]*)\\.([\\da-fA-F][\\da-fA-F_]*|_[\\da-fA-F][\\da-fA-F_]*)|\\.?([\\da-fA-F][\\da-fA-F_]*|_[\\da-fA-F][\\da-fA-F_]*))[pP][+-]?(0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d))|((0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d)(\\.\\d*|([eE][+-]?(0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d)))|\\d+\\.(0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d)(0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d)|\\.(0|[1-9][\\d_]*)([eE][+-]?(0|[1-9][\\d_]*|\\d[\\d_]*|[\\d_]+?\\d))?))([fF]|L|i|[fF]i|Li)?|"+i+"(i|[fF]i|Li))",r:0},r={cN:"string",b:"'("+n+"|.)",e:"'",i:"."},a={cN:"string",b:'"',c:[{b:n,r:0}],e:'"[cwd]?'},c=t.C("\\/\\+","\\+\\/",{c:["self"],r:10});return{l:t.UIR,k:{keyword:"abstract alias align asm assert auto body break byte case cast catch class const continue debug default delete deprecated do else enum export extern final finally for foreach foreach_reverse|10 goto if immutable import in inout int interface invariant is lazy macro mixin module new nothrow out override package pragma private protected public pure ref return scope shared static struct super switch synchronized template this throw try typedef typeid typeof union unittest version void volatile while with __FILE__ __LINE__ __gshared|10 __thread __traits __DATE__ __EOF__ __TIME__ __TIMESTAMP__ __VENDOR__ __VERSION__",built_in:"bool cdouble cent cfloat char creal dchar delegate double dstring float function idouble ifloat ireal long real short string ubyte ucent uint ulong ushort wchar wstring",literal:"false null true"},c:[t.CLCM,t.CBCM,c,{cN:"string",b:'x"[\\da-fA-F\\s\\n\\r]*"[cwd]?',r:10},a,{cN:"string",b:'[rq]"',e:'"[cwd]?',r:5},{cN:"string",b:"`",e:"`[cwd]?"},{cN:"string",b:'q"\\{',e:'\\}"'},o,s,r,{cN:"meta",b:"^#!",e:"$",r:5},{cN:"meta",b:"#(line)",e:"$",r:5},{cN:"keyword",b:"@[a-zA-Z_][a-zA-Z_\\d]*"}]}}),t.registerLanguage("delphi",function(t){var e="exports register file shl array record property for mod while set ally label uses raise not stored class safecall var interface or private static exit index inherited to else stdcall override shr asm far resourcestring finalization packed virtual out and protected library do xorwrite goto near function end div overload object unit begin string on inline repeat until destructor write message program with read initialization except default nil if case cdecl in downto threadvar of try pascal const external constructor type public then implementation finally published procedure",i=[t.CLCM,t.C(/\{/,/\}/,{r:0}),t.C(/\(\*/,/\*\)/,{r:10})],n={cN:"string",b:/'/,e:/'/,c:[{b:/''/}]},s={cN:"string",b:/(#\d+)+/},o={b:t.IR+"\\s*=\\s*class\\s*\\(",rB:!0,c:[t.TM]},r={cN:"function",bK:"function constructor destructor procedure",e:/[:;]/,k:"function constructor|10 destructor|10 procedure|10",c:[t.TM,{cN:"params",b:/\(/,e:/\)/,k:e,c:[n,s]}].concat(i)};return{aliases:["dpr","dfm","pas","pascal","freepascal","lazarus","lpr","lfm"],cI:!0,k:e,i:/"|\$[G-Zg-z]|\/\*|<\/|\|/,c:[n,s,t.NM,o,r].concat(i)}}),t.registerLanguage("diff",function(t){return{aliases:["patch"],c:[{cN:"meta",r:10,v:[{b:/^@@ +\-\d+,\d+ +\+\d+,\d+ +@@$/},{b:/^\*\*\* +\d+,\d+ +\*\*\*\*$/},{b:/^\-\-\- +\d+,\d+ +\-\-\-\-$/}]},{cN:"comment",v:[{b:/Index: /,e:/$/},{b:/=====/,e:/=====$/},{b:/^\-\-\-/,e:/$/},{b:/^\*{3} /,e:/$/},{b:/^\+\+\+/,e:/$/},{b:/\*{5}/,e:/\*{5}$/}]},{cN:"addition",b:"^\\+",e:"$"},{cN:"deletion",b:"^\\-",e:"$"},{cN:"addition",b:"^\\!",e:"$"}]}}),t.registerLanguage("xml",function(t){var e={eW:!0,i:/</,r:0,c:[{cN:"attr",b:"[A-Za-z0-9\\._:-]+",r:0},{b:/=\s*/,r:0,c:[{cN:"string",endsParent:!0,v:[{b:/"/,e:/"/},{b:/'/,e:/'/},{b:/[^\s"'=<>`]+/}]}]}]};return{aliases:["html","xhtml","rss","atom","xsl","plist"],cI:!0,c:[{cN:"meta",b:"<!DOCTYPE",e:">",r:10,c:[{b:"\\[",e:"\\]"}]},t.C("\x3c!--","--\x3e",{r:10}),{b:"<\\!\\[CDATA\\[",e:"\\]\\]>",r:10},{b:/<\?(php)?/,e:/\?>/,sL:"php",c:[{b:"/\\*",e:"\\*/",skip:!0}]},{cN:"tag",b:"<style(?=\\s|>|$)",e:">",k:{name:"style"},c:[e],starts:{e:"</style>",rE:!0,sL:["css","xml"]}},{cN:"tag",b:"<script(?=\\s|>|$)",e:">",k:{name:"script"},c:[e],starts:{e:"<\/script>",rE:!0,sL:["actionscript","javascript","handlebars","xml"]}},{cN:"meta",v:[{b:/<\?xml/,e:/\?>/,r:10},{b:/<\?\w+/,e:/\?>/}]},{cN:"tag",b:"</?",e:"/?>",c:[{cN:"name",b:/[^\/><\s]+/,r:0},e]}]}}),t.registerLanguage("django",function(t){var e={b:/\|[A-Za-z]+:?/,k:{name:"truncatewords removetags linebreaksbr yesno get_digit timesince random striptags filesizeformat escape linebreaks length_is ljust rjust cut urlize fix_ampersands title floatformat capfirst pprint divisibleby add make_list unordered_list urlencode timeuntil urlizetrunc wordcount stringformat linenumbers slice date dictsort dictsortreversed default_if_none pluralize lower join center default truncatewords_html upper length phone2numeric wordwrap time addslashes slugify first escapejs force_escape iriencode last safe safeseq truncatechars localize unlocalize localtime utc timezone"},c:[t.QSM,t.ASM]};return{aliases:["jinja"],cI:!0,sL:"xml",c:[t.C(/\{%\s*comment\s*%}/,/\{%\s*endcomment\s*%}/),t.C(/\{#/,/#}/),{cN:"template-tag",b:/\{%/,e:/%}/,c:[{cN:"name",b:/\w+/,k:{name:"comment endcomment load templatetag ifchanged endifchanged if endif firstof for endfor ifnotequal endifnotequal widthratio extends include spaceless endspaceless regroup ifequal endifequal ssi now with cycle url filter endfilter debug block endblock else autoescape endautoescape csrf_token empty elif endwith static trans blocktrans endblocktrans get_static_prefix get_media_prefix plural get_current_language language get_available_languages get_current_language_bidi get_language_info get_language_info_list localize endlocalize localtime endlocaltime timezone endtimezone get_current_timezone verbatim"},starts:{eW:!0,k:"in by as",c:[e],r:0}}]},{cN:"template-variable",b:/\{\{/,e:/}}/,c:[e]}]}}),t.registerLanguage("dockerfile",function(t){return{aliases:["docker"],cI:!0,k:"from maintainer cmd expose add copy entrypoint volume user workdir onbuild run env label",c:[t.HCM,{k:"run cmd entrypoint volume add copy workdir onbuild label",b:/^ *(onbuild +)?(run|cmd|entrypoint|volume|add|copy|workdir|label) +/,starts:{e:/[^\\]\n/,sL:"bash"}},{k:"from maintainer expose env user onbuild",b:/^ *(onbuild +)?(from|maintainer|expose|env|user|onbuild) +/,e:/[^\\]\n/,c:[t.ASM,t.QSM,t.NM,t.HCM]}]}}),t.registerLanguage("dos",function(t){var e=t.C(/^\s*@?rem\b/,/$/,{r:10});return{aliases:["bat","cmd"],cI:!0,i:/\/\*/,k:{keyword:"if else goto for in do call exit not exist errorlevel defined equ neq lss leq gtr geq",built_in:"prn nul lpt3 lpt2 lpt1 con com4 com3 com2 com1 aux shift cd dir echo setlocal endlocal set pause copy append assoc at attrib break cacls cd chcp chdir chkdsk chkntfs cls cmd color comp compact convert date dir diskcomp diskcopy doskey erase fs find findstr format ftype graftabl help keyb label md mkdir mode more move path pause print popd pushd promt rd recover rem rename replace restore rmdir shiftsort start subst time title tree type ver verify vol ping net ipconfig taskkill xcopy ren del"},c:[{cN:"variable",b:/%%[^ ]|%[^ ]+?%|![^ ]+?!/},{cN:"function",b:"^\\s*[A-Za-z._?][A-Za-z0-9_$#@~.?]*(:|\\s+label)",e:"goto:eof",c:[t.inherit(t.TM,{b:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),e]},{cN:"number",b:"\\b\\d+",r:0},e]}}),t.registerLanguage("erlang",function(t){var e="[a-z'][a-zA-Z0-9_']*",i="("+e+":"+e+"|"+e+")",n={keyword:"after and andalso|10 band begin bnot bor bsl bzr bxor case catch cond div end fun if let not of orelse|10 query receive rem try when xor",literal:"false true"},s=t.C("%","$"),o={cN:"number",b:"\\b(\\d+#[a-fA-F0-9]+|\\d+(\\.\\d+)?([eE][-+]?\\d+)?)",r:0},r={b:"fun\\s+"+e+"/\\d+"},a={b:i+"\\(",e:"\\)",rB:!0,r:0,c:[{b:i,r:0},{b:"\\(",e:"\\)",eW:!0,rE:!0,r:0}]},c={b:"{",e:"}",r:0},l={b:"\\b_([A-Z][A-Za-z0-9_]*)?",r:0},d={b:"[A-Z][a-zA-Z0-9_]*",r:0},h={b:"#"+t.UIR,r:0,rB:!0,c:[{b:"#"+t.UIR,r:0},{b:"{",e:"}",r:0}]},u={bK:"fun receive if try case",e:"end",k:n};u.c=[s,r,t.inherit(t.ASM,{cN:""}),u,a,t.QSM,o,c,l,d,h];var m=[s,r,u,a,t.QSM,o,c,l,d,h];a.c[1].c=m,c.c=m,h.c[1].c=m;var p={cN:"params",b:"\\(",e:"\\)",c:m};return{aliases:["erl"],k:n,i:"(</|\\*=|\\+=|-=|/\\*|\\*/|\\(\\*|\\*\\))",c:[{cN:"function",b:"^"+e+"\\s*\\(",e:"->",rB:!0,i:"\\(|#|//|/\\*|\\\\|:|;",c:[p,t.inherit(t.TM,{b:e})],starts:{e:";|\\.",k:n,c:m}},s,{b:"^-",e:"\\.",r:0,eE:!0,rB:!0,l:"-"+t.IR,k:"-module -record -undef -export -ifdef -ifndef -author -copyright -doc -vsn -import -include -include_lib -compile -define -else -endif -file -behaviour -behavior -spec",c:[p]},o,t.QSM,h,l,d,c,{b:/\.$/}]}}),t.registerLanguage("go",function(t){return{aliases:["golang"],k:{keyword:"break default func interface select case map struct chan else goto package switch const fallthrough if range type continue for import return var go defer bool byte complex64 complex128 float32 float64 int8 int16 int32 int64 string uint8 uint16 uint32 uint64 int uint uintptr rune",literal:"true false iota nil",built_in:"append cap close complex copy imag len make new panic print println real recover delete"},i:"</",c:[t.CLCM,t.CBCM,t.QSM,{cN:"string",b:"'",e:"[^\\\\]'"},{cN:"string",b:"`",e:"`"},{cN:"number",b:t.CNR+"[dflsi]?",r:0},t.CNM]}}),t.registerLanguage("ruby",function(t){var e="[a-zA-Z_]\\w*[!?=]?|[-+~]\\@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?",i={keyword:"and then defined module in return redo if BEGIN retry end for self when next until do begin unless END rescue else break undef not super class case require yield alias while ensure elsif or include attr_reader attr_writer attr_accessor",literal:"true false nil"},n={cN:"doctag",b:"@[A-Za-z]+"},s={b:"#<",e:">"},o=[t.C("#","$",{c:[n]}),t.C("^\\=begin","^\\=end",{c:[n],r:10}),t.C("^__END__","\\n$")],r={cN:"subst",b:"#\\{",e:"}",k:i},a={cN:"string",c:[t.BE,r],v:[{b:/'/,e:/'/},{b:/"/,e:/"/},{b:/`/,e:/`/},{b:"%[qQwWx]?\\(",e:"\\)"},{b:"%[qQwWx]?\\[",e:"\\]"},{b:"%[qQwWx]?{",e:"}"},{b:"%[qQwWx]?<",e:">"},{b:"%[qQwWx]?/",e:"/"},{b:"%[qQwWx]?%",e:"%"},{b:"%[qQwWx]?-",e:"-"},{b:"%[qQwWx]?\\|",e:"\\|"},{b:/\B\?(\\\d{1,3}|\\x[A-Fa-f0-9]{1,2}|\\u[A-Fa-f0-9]{4}|\\?\S)\b/}]},c={cN:"params",b:"\\(",e:"\\)",endsParent:!0,k:i},l=[a,s,{cN:"class",bK:"class module",e:"$|;",i:/=/,c:[t.inherit(t.TM,{b:"[A-Za-z_]\\w*(::\\w+)*(\\?|\\!)?"}),{b:"<\\s*",c:[{b:"("+t.IR+"::)?"+t.IR}]}].concat(o)},{cN:"function",bK:"def",e:"$|;",c:[t.inherit(t.TM,{b:e}),c].concat(o)},{b:t.IR+"::"},{cN:"symbol",b:t.UIR+"(\\!|\\?)?:",r:0},{cN:"symbol",b:":(?!\\s)",c:[a,{b:e}],r:0},{cN:"number",b:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",r:0},{b:"(\\$\\W)|((\\$|\\@\\@?)(\\w+))"},{cN:"params",b:/\|/,e:/\|/,k:i},{b:"("+t.RSR+")\\s*",c:[s,{cN:"regexp",c:[t.BE,r],i:/\n/,v:[{b:"/",e:"/[a-z]*"},{b:"%r{",e:"}[a-z]*"},{b:"%r\\(",e:"\\)[a-z]*"},{b:"%r!",e:"![a-z]*"},{b:"%r\\[",e:"\\][a-z]*"}]}].concat(o),r:0}].concat(o);r.c=l,c.c=l;var d=[{b:/^\s*=>/,starts:{e:"$",c:l}},{cN:"meta",b:"^([>?]>|[\\w#]+\\(\\w+\\):\\d+:\\d+>|(\\w+-)?\\d+\\.\\d+\\.\\d(p\\d+)?[^>]+>)",starts:{e:"$",c:l}}];return{aliases:["rb","gemspec","podspec","thor","irb"],k:i,i:/\/\*/,c:o.concat(d).concat(l)}}),t.registerLanguage("haml",function(t){return{cI:!0,c:[{cN:"meta",b:"^!!!( (5|1\\.1|Strict|Frameset|Basic|Mobile|RDFa|XML\\b.*))?$",r:10},t.C("^\\s*(!=#|=#|-#|/).*$",!1,{r:0}),{b:"^\\s*(-|=|!=)(?!#)",starts:{e:"\\n",sL:"ruby"}},{cN:"tag",b:"^\\s*%",c:[{cN:"selector-tag",b:"\\w+"},{cN:"selector-id",b:"#[\\w-]+"},{cN:"selector-class",b:"\\.[\\w-]+"},{b:"{\\s*",e:"\\s*}",c:[{b:":\\w+\\s*=>",e:",\\s+",rB:!0,eW:!0,c:[{cN:"attr",b:":\\w+"},t.ASM,t.QSM,{b:"\\w+",r:0}]}]},{b:"\\(\\s*",e:"\\s*\\)",eE:!0,c:[{b:"\\w+\\s*=",e:"\\s+",rB:!0,eW:!0,c:[{cN:"attr",b:"\\w+",r:0},t.ASM,t.QSM,{b:"\\w+",r:0}]}]}]},{b:"^\\s*[=~]\\s*"},{b:"#{",starts:{e:"}",sL:"ruby"}}]}}),t.registerLanguage("haskell",function(t){var e={v:[t.C("--","$"),t.C("{-","-}",{c:["self"]})]},i={cN:"meta",b:"{-#",e:"#-}"},n={cN:"meta",b:"^#",e:"$"},s={cN:"type",b:"\\b[A-Z][\\w']*",r:0},o={b:"\\(",e:"\\)",i:'"',c:[i,n,{cN:"type",b:"\\b[A-Z][\\w]*(\\((\\.\\.|,|\\w+)\\))?"},t.inherit(t.TM,{b:"[_a-z][\\w']*"}),e]};return{aliases:["hs"],k:"let in if then else case of where do module import hiding qualified type data newtype deriving class instance as default infix infixl infixr foreign export ccall stdcall cplusplus jvm dotnet safe unsafe family forall mdo proc rec",c:[{bK:"module",e:"where",k:"module where",c:[o,e],i:"\\W\\.|;"},{b:"\\bimport\\b",e:"$",k:"import qualified as hiding",c:[o,e],i:"\\W\\.|;"},{cN:"class",b:"^(\\s*)?(class|instance)\\b",e:"where",k:"class family instance where",c:[s,o,e]},{cN:"class",b:"\\b(data|(new)?type)\\b",e:"$",k:"data family type newtype deriving",c:[i,s,o,{b:"{",e:"}",c:o.c},e]},{bK:"default",e:"$",c:[s,o,e]},{bK:"infix infixl infixr",e:"$",c:[t.CNM,e]},{b:"\\bforeign\\b",e:"$",k:"foreign import export ccall stdcall cplusplus jvm dotnet safe unsafe",c:[s,t.QSM,e]},{cN:"meta",b:"#!\\/usr\\/bin\\/env runhaskell",e:"$"},i,n,t.QSM,t.CNM,s,t.inherit(t.TM,{b:"^[_a-z][\\w']*"}),e,{b:"->|<-"}]}}),t.registerLanguage("http",function(t){var e="HTTP/[0-9\\.]+";return{aliases:["https"],i:"\\S",c:[{b:"^"+e,e:"$",c:[{cN:"number",b:"\\b\\d{3}\\b"}]},{b:"^[A-Z]+ (.*?) "+e+"$",rB:!0,e:"$",c:[{cN:"string",b:" ",e:" ",eB:!0,eE:!0},{b:e},{cN:"keyword",b:"[A-Z]+"}]},{cN:"attribute",b:"^\\w",e:": ",eE:!0,i:"\\n|\\s|=",starts:{e:"$",r:0}},{b:"\\n\\n",starts:{sL:[],eW:!0}}]}}),t.registerLanguage("ini",function(t){var e={cN:"string",c:[t.BE],v:[{b:"'''",e:"'''",r:10},{b:'"""',e:'"""',r:10},{b:'"',e:'"'},{b:"'",e:"'"}]};return{aliases:["toml"],cI:!0,i:/\S/,c:[t.C(";","$"),t.HCM,{cN:"section",b:/^\s*\[+/,e:/\]+/},{b:/^[a-z0-9\[\]_-]+\s*=\s*/,e:"$",rB:!0,c:[{cN:"attr",b:/[a-z0-9\[\]_-]+/},{b:/=/,eW:!0,r:0,c:[{cN:"literal",b:/\bon|off|true|false|yes|no\b/},{cN:"variable",v:[{b:/\$[\w\d"][\w\d_]*/},{b:/\$\{(.*?)}/}]},e,{cN:"number",b:/([\+\-]+)?[\d]+_[\d_]+/},t.NM]}]}]}}),t.registerLanguage("java",function(t){var e=t.UIR+"(<"+t.UIR+"(\\s*,\\s*"+t.UIR+")*>)?",i="false synchronized int abstract float private char boolean static null if const for true while long strictfp finally protected import native final void enum else break transient catch instanceof byte super volatile case assert short package default double public try this switch continue throws protected public private module requires exports",n={cN:"number",b:"\\b(0[bB]([01]+[01_]+[01]+|[01]+)|0[xX]([a-fA-F0-9]+[a-fA-F0-9_]+[a-fA-F0-9]+|[a-fA-F0-9]+)|(([\\d]+[\\d_]+[\\d]+|[\\d]+)(\\.([\\d]+[\\d_]+[\\d]+|[\\d]+))?|\\.([\\d]+[\\d_]+[\\d]+|[\\d]+))([eE][-+]?\\d+)?)[lLfF]?",r:0};return{aliases:["jsp"],k:i,i:/<\/|#/,c:[t.C("/\\*\\*","\\*/",{r:0,c:[{b:/\w+@/,r:0},{cN:"doctag",b:"@[A-Za-z]+"}]}),t.CLCM,t.CBCM,t.ASM,t.QSM,{cN:"class",bK:"class interface",e:/[{;=]/,eE:!0,k:"class interface",i:/[:"\[\]]/,c:[{bK:"extends implements"},t.UTM]},{bK:"new throw return else",r:0},{cN:"function",b:"("+e+"\\s+)+"+t.UIR+"\\s*\\(",rB:!0,e:/[{;=]/,eE:!0,k:i,c:[{b:t.UIR+"\\s*\\(",rB:!0,r:0,c:[t.UTM]},{cN:"params",b:/\(/,e:/\)/,k:i,r:0,c:[t.ASM,t.QSM,t.CNM,t.CBCM]},t.CLCM,t.CBCM]},n,{cN:"meta",b:"@[A-Za-z]+"}]}}),t.registerLanguage("javascript",function(t){return{aliases:["js","jsx"],k:{keyword:"in of if for while finally var new function do return void else break catch instanceof with throw case default try this switch continue typeof delete let yield const export super debugger as async await static import from as",literal:"true false null undefined NaN Infinity",built_in:"eval isFinite isNaN parseFloat parseInt decodeURI decodeURIComponent encodeURI encodeURIComponent escape unescape Object Function Boolean Error EvalError InternalError RangeError ReferenceError StopIteration SyntaxError TypeError URIError Number Math Date String RegExp Array Float32Array Float64Array Int16Array Int32Array Int8Array Uint16Array Uint32Array Uint8Array Uint8ClampedArray ArrayBuffer DataView JSON Intl arguments require module console window document Symbol Set Map WeakSet WeakMap Proxy Reflect Promise"},c:[{cN:"meta",r:10,b:/^\s*['"]use (strict|asm)['"]/},{cN:"meta",b:/^#!/,e:/$/},t.ASM,t.QSM,{cN:"string",b:"`",e:"`",c:[t.BE,{cN:"subst",b:"\\$\\{",e:"\\}"}]},t.CLCM,t.CBCM,{cN:"number",v:[{b:"\\b(0[bB][01]+)"},{b:"\\b(0[oO][0-7]+)"},{b:t.CNR}],r:0},{b:"("+t.RSR+"|\\b(case|return|throw)\\b)\\s*",k:"return throw case",c:[t.CLCM,t.CBCM,t.RM,{b:/</,e:/(\/\w+|\w+\/)>/,sL:"xml",c:[{b:/<\w+\/>/,skip:!0},{b:/<\w+/,e:/(\/\w+|\w+\/)>/,skip:!0,c:["self"]}]}],r:0},{cN:"function",bK:"function",e:/\{/,eE:!0,c:[t.inherit(t.TM,{b:/[A-Za-z$_][0-9A-Za-z$_]*/}),{cN:"params",b:/\(/,e:/\)/,eB:!0,eE:!0,c:[t.CLCM,t.CBCM]}],i:/\[|%/},{b:/\$[(.]/},t.METHOD_GUARD,{cN:"class",bK:"class",e:/[{;=]/,eE:!0,i:/[:"\[\]]/,c:[{bK:"extends"},t.UTM]},{bK:"constructor",e:/\{/,eE:!0}],i:/#(?!!)/}}),t.registerLanguage("json",function(t){var e={literal:"true false null"},i=[t.QSM,t.CNM],n={e:",",eW:!0,eE:!0,c:i,k:e},s={b:"{",e:"}",c:[{cN:"attr",b:/"/,e:/"/,c:[t.BE],i:"\\n"},t.inherit(n,{b:/:/})],i:"\\S"},o={b:"\\[",e:"\\]",c:[t.inherit(n)],i:"\\S"};return i.splice(i.length,0,s,o),{c:i,k:e,i:"\\S"}}),t.registerLanguage("lisp",function(t){var e="[a-zA-Z_\\-\\+\\*\\/\\<\\=\\>\\&\\#][a-zA-Z0-9_\\-\\+\\*\\/\\<\\=\\>\\&\\#!]*",i="\\|[^]*?\\|",n="(\\-|\\+)?\\d+(\\.\\d+|\\/\\d+)?((d|e|f|l|s|D|E|F|L|S)(\\+|\\-)?\\d+)?",s={cN:"literal",b:"\\b(t{1}|nil)\\b"},o={cN:"number",v:[{b:n,r:0},{b:"#(b|B)[0-1]+(/[0-1]+)?"},{b:"#(o|O)[0-7]+(/[0-7]+)?"},{b:"#(x|X)[0-9a-fA-F]+(/[0-9a-fA-F]+)?"},{b:"#(c|C)\\("+n+" +"+n,e:"\\)"}]},r=t.inherit(t.QSM,{i:null}),a=t.C(";","$",{r:0}),c={b:"\\*",e:"\\*"},l={cN:"symbol",b:"[:&]"+e},d={b:e,r:0},h={b:i},u={c:[o,r,c,l,{b:"\\(",e:"\\)",c:["self",s,r,o,d]},d],v:[{b:"['`]\\(",e:"\\)"},{b:"\\(quote ",e:"\\)",k:{name:"quote"}},{b:"'"+i}]},m={v:[{b:"'"+e},{b:"#'"+e+"(::"+e+")*"}]},p={b:"\\(\\s*",e:"\\)"},f={eW:!0,r:0};return p.c=[{cN:"name",v:[{b:e},{b:i}]},f],f.c=[u,m,p,s,o,r,a,c,l,h,d],{i:/\S/,c:[o,{cN:"meta",b:"^#!",e:"$"},s,r,a,u,m,p,d]}}),t.registerLanguage("lua",function(t){var e="\\[=*\\[",i="\\]=*\\]",n={b:e,e:i,c:["self"]},s=[t.C("--(?!"+e+")","$"),t.C("--"+e,i,{c:[n],r:10})];return{l:t.UIR,k:{keyword:"and break do else elseif end false for if in local nil not or repeat return then true until while",built_in:"_G _VERSION assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall coroutine debug io math os package string table"},c:s.concat([{cN:"function",bK:"function",e:"\\)",c:[t.inherit(t.TM,{b:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),{cN:"params",b:"\\(",eW:!0,c:s}].concat(s)},t.CNM,t.ASM,t.QSM,{cN:"string",b:e,e:i,c:[n],r:5}])}}),t.registerLanguage("makefile",function(t){var e={cN:"variable",b:/\$\(/,e:/\)/,c:[t.BE]};return{aliases:["mk","mak"],c:[t.HCM,{b:/^\w+\s*\W*=/,rB:!0,r:0,starts:{e:/\s*\W*=/,eE:!0,starts:{e:/$/,r:0,c:[e]}}},{cN:"section",b:/^[\w]+:\s*$/},{cN:"meta",b:/^\.PHONY:/,e:/$/,k:{"meta-keyword":".PHONY"},l:/[\.\w]+/},{b:/^\t+/,e:/$/,r:0,c:[t.QSM,e]}]}}),t.registerLanguage("markdown",function(t){return{aliases:["md","mkdown","mkd"],c:[{cN:"section",v:[{b:"^#{1,6}",e:"$"},{b:"^.+?\\n[=-]{2,}$"}]},{b:"<",e:">",sL:"xml",r:0},{cN:"bullet",b:"^([*+-]|(\\d+\\.))\\s+"},{cN:"strong",b:"[*_]{2}.+?[*_]{2}"},{cN:"emphasis",v:[{b:"\\*.+?\\*"},{b:"_.+?_",r:0}]},{cN:"quote",b:"^>\\s+",e:"$"},{cN:"code",v:[{b:"^```w*s*$",e:"^```s*$"},{b:"`.+?`"},{b:"^( {4}|\t)",e:"$",r:0}]},{b:"^[-\\*]{3,}",e:"$"},{b:"\\[.+?\\][\\(\\[].*?[\\)\\]]",rB:!0,c:[{cN:"string",b:"\\[",e:"\\]",eB:!0,rE:!0,r:0},{cN:"link",b:"\\]\\(",e:"\\)",eB:!0,eE:!0},{cN:"symbol",b:"\\]\\[",e:"\\]",eB:!0,eE:!0}],r:10},{b:"^\\[.+\\]:",rB:!0,c:[{cN:"symbol",b:"\\[",e:"\\]:",eB:!0,eE:!0,starts:{cN:"link",e:"$"}}]}]}}),t.registerLanguage("matlab",function(t){var e=[t.CNM,{cN:"string",b:"'",e:"'",c:[t.BE,{b:"''"}]}],i={r:0,c:[{b:/'['\.]*/}]};return{k:{keyword:"break case catch classdef continue else elseif end enumerated events for function global if methods otherwise parfor persistent properties return spmd switch try while",built_in:"sin sind sinh asin asind asinh cos cosd cosh acos acosd acosh tan tand tanh atan atand atan2 atanh sec secd sech asec asecd asech csc cscd csch acsc acscd acsch cot cotd coth acot acotd acoth hypot exp expm1 log log1p log10 log2 pow2 realpow reallog realsqrt sqrt nthroot nextpow2 abs angle complex conj imag real unwrap isreal cplxpair fix floor ceil round mod rem sign airy besselj bessely besselh besseli besselk beta betainc betaln ellipj ellipke erf erfc erfcx erfinv expint gamma gammainc gammaln psi legendre cross dot factor isprime primes gcd lcm rat rats perms nchoosek factorial cart2sph cart2pol pol2cart sph2cart hsv2rgb rgb2hsv zeros ones eye repmat rand randn linspace logspace freqspace meshgrid accumarray size length ndims numel disp isempty isequal isequalwithequalnans cat reshape diag blkdiag tril triu fliplr flipud flipdim rot90 find sub2ind ind2sub bsxfun ndgrid permute ipermute shiftdim circshift squeeze isscalar isvector ans eps realmax realmin pi i inf nan isnan isinf isfinite j why compan gallery hadamard hankel hilb invhilb magic pascal rosser toeplitz vander wilkinson"},i:'(//|"|#|/\\*|\\s+/\\w+)',c:[{cN:"function",bK:"function",e:"$",c:[t.UTM,{cN:"params",v:[{b:"\\(",e:"\\)"},{b:"\\[",e:"\\]"}]}]},{b:/[a-zA-Z_][a-zA-Z_0-9]*'['\.]*/,rB:!0,r:0,c:[{b:/[a-zA-Z_][a-zA-Z_0-9]*/,r:0},i.c[0]]},{b:"\\[",e:"\\]",c:e,r:0,starts:i},{b:"\\{",e:/}/,c:e,r:0,starts:i},{b:/\)/,r:0,starts:i},t.C("^\\s*\\%\\{\\s*$","^\\s*\\%\\}\\s*$"),t.C("\\%","$")].concat(e)}}),t.registerLanguage("nginx",function(t){var e={cN:"variable",v:[{b:/\$\d+/},{b:/\$\{/,e:/}/},{b:"[\\$\\@]"+t.UIR}]},i={eW:!0,l:"[a-z/_]+",k:{literal:"on off yes no true false none blocked debug info notice warn error crit select break last permanent redirect kqueue rtsig epoll poll /dev/poll"},r:0,i:"=>",c:[t.HCM,{cN:"string",c:[t.BE,e],v:[{b:/"/,e:/"/},{b:/'/,e:/'/}]},{b:"([a-z]+):/",e:"\\s",eW:!0,eE:!0,c:[e]},{cN:"regexp",c:[t.BE,e],v:[{b:"\\s\\^",e:"\\s|{|;",rE:!0},{b:"~\\*?\\s+",e:"\\s|{|;",rE:!0},{b:"\\*(\\.[a-z\\-]+)+"},{b:"([a-z\\-]+\\.)+\\*"}]},{cN:"number",b:"\\b\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}(:\\d{1,5})?\\b"},{cN:"number",b:"\\b\\d+[kKmMgGdshdwy]*\\b",r:0},e]};return{aliases:["nginxconf"],c:[t.HCM,{b:t.UIR+"\\s+{",rB:!0,e:"{",c:[{cN:"section",b:t.UIR}],r:0},{b:t.UIR+"\\s",e:";|{",rB:!0,c:[{cN:"attribute",b:t.UIR,starts:i}],r:0}],i:"[^\\s\\}]"}}),t.registerLanguage("objectivec",function(t){var e=/[a-zA-Z@][a-zA-Z0-9_]*/,i="@interface @class @protocol @implementation";return{aliases:["mm","objc","obj-c"],k:{keyword:"int float while char export sizeof typedef const struct for union unsigned long volatile static bool mutable if do return goto void enum else break extern asm case short default double register explicit signed typename this switch continue wchar_t inline readonly assign readwrite self @synchronized id typeof nonatomic super unichar IBOutlet IBAction strong weak copy in out inout bycopy byref oneway __strong __weak __block __autoreleasing @private @protected @public @try @property @end @throw @catch @finally @autoreleasepool @synthesize @dynamic @selector @optional @required",literal:"false true FALSE TRUE nil YES NO NULL",built_in:"BOOL dispatch_once_t dispatch_queue_t dispatch_sync dispatch_async dispatch_once"},l:e,i:"</",c:[{cN:"built_in",b:"(AV|CA|CF|CG|CI|MK|MP|NS|UI|XC)\\w+"},t.CLCM,t.CBCM,t.CNM,t.QSM,{cN:"string",v:[{b:'@"',e:'"',i:"\\n",c:[t.BE]},{b:"'",e:"[^\\\\]'",i:"[^\\\\][^']"}]},{cN:"meta",b:"#",e:"$",c:[{cN:"meta-string",v:[{b:'"',e:'"'},{b:"<",e:">"}]}]},{cN:"class",b:"("+i.split(" ").join("|")+")\\b",e:"({|$)",eE:!0,k:i,l:e,c:[t.UTM]},{b:"\\."+t.UIR,r:0}]}}),t.registerLanguage("perl",function(t){var e="getpwent getservent quotemeta msgrcv scalar kill dbmclose undef lc ma syswrite tr send umask sysopen shmwrite vec qx utime local oct semctl localtime readpipe do return format read sprintf dbmopen pop getpgrp not getpwnam rewinddir qqfileno qw endprotoent wait sethostent bless s|0 opendir continue each sleep endgrent shutdown dump chomp connect getsockname die socketpair close flock exists index shmgetsub for endpwent redo lstat msgctl setpgrp abs exit select print ref gethostbyaddr unshift fcntl syscall goto getnetbyaddr join gmtime symlink semget splice x|0 getpeername recv log setsockopt cos last reverse gethostbyname getgrnam study formline endhostent times chop length gethostent getnetent pack getprotoent getservbyname rand mkdir pos chmod y|0 substr endnetent printf next open msgsnd readdir use unlink getsockopt getpriority rindex wantarray hex system getservbyport endservent int chr untie rmdir prototype tell listen fork shmread ucfirst setprotoent else sysseek link getgrgid shmctl waitpid unpack getnetbyname reset chdir grep split require caller lcfirst until warn while values shift telldir getpwuid my getprotobynumber delete and sort uc defined srand accept package seekdir getprotobyname semop our rename seek if q|0 chroot sysread setpwent no crypt getc chown sqrt write setnetent setpriority foreach tie sin msgget map stat getlogin unless elsif truncate exec keys glob tied closedirioctl socket readlink eval xor readline binmode setservent eof ord bind alarm pipe atan2 getgrent exp time push setgrent gt lt or ne m|0 break given say state when",i={cN:"subst",b:"[$@]\\{",e:"\\}",k:e},n={b:"->{",e:"}"},s={v:[{b:/\$\d/},{b:/[\$%@](\^\w\b|#\w+(::\w+)*|{\w+}|\w+(::\w*)*)/},{b:/[\$%@][^\s\w{]/,r:0}]},o=[t.BE,i,s],r=[s,t.HCM,t.C("^\\=\\w","\\=cut",{eW:!0}),n,{cN:"string",c:o,v:[{b:"q[qwxr]?\\s*\\(",e:"\\)",r:5},{b:"q[qwxr]?\\s*\\[",e:"\\]",r:5},{b:"q[qwxr]?\\s*\\{",e:"\\}",r:5},{b:"q[qwxr]?\\s*\\|",e:"\\|",r:5},{b:"q[qwxr]?\\s*\\<",e:"\\>",r:5},{b:"qw\\s+q",e:"q",r:5},{b:"'",e:"'",c:[t.BE]},{b:'"',e:'"'},{b:"`",e:"`",c:[t.BE]},{b:"{\\w+}",c:[],r:0},{b:"-?\\w+\\s*\\=\\>",c:[],r:0}]},{cN:"number",b:"(\\b0[0-7_]+)|(\\b0x[0-9a-fA-F_]+)|(\\b[1-9][0-9_]*(\\.[0-9_]+)?)|[0_]\\b",r:0},{b:"(\\/\\/|"+t.RSR+"|\\b(split|return|print|reverse|grep)\\b)\\s*",k:"split return print reverse grep",r:0,c:[t.HCM,{cN:"regexp",b:"(s|tr|y)/(\\\\.|[^/])*/(\\\\.|[^/])*/[a-z]*",r:10},{cN:"regexp",b:"(m|qr)?/",e:"/[a-z]*",c:[t.BE],r:0}]},{cN:"function",bK:"sub",e:"(\\s*\\(.*?\\))?[;{]",eE:!0,r:5,c:[t.TM]},{b:"-\\w\\b",r:0},{b:"^__DATA__$",e:"^__END__$",sL:"mojolicious",c:[{b:"^@@.*",e:"$",cN:"comment"}]}];return i.c=r,n.c=r,{aliases:["pl"],k:e,c:r}}),t.registerLanguage("php",function(t){var e={b:"\\$+[a-zA-Z_-ÿ][a-zA-Z0-9_-ÿ]*"},i={cN:"meta",b:/<\?(php)?|\?>/},n={cN:"string",c:[t.BE,i],v:[{b:'b"',e:'"'},{b:"b'",e:"'"},t.inherit(t.ASM,{i:null}),t.inherit(t.QSM,{i:null})]},s={v:[t.BNM,t.CNM]};return{aliases:["php3","php4","php5","php6"],cI:!0,k:"and include_once list abstract global private echo interface as static endswitch array null if endwhile or const for endforeach self var while isset public protected exit foreach throw elseif include __FILE__ empty require_once do xor return parent clone use __CLASS__ __LINE__ else break print eval new catch __METHOD__ case exception default die require __FUNCTION__ enddeclare final try switch continue endfor endif declare unset true false trait goto instanceof insteadof __DIR__ __NAMESPACE__ yield finally",c:[t.HCM,t.C("//","$",{c:[i]}),t.C("/\\*","\\*/",{c:[{cN:"doctag",b:"@[A-Za-z]+"}]}),t.C("__halt_compiler.+?;",!1,{eW:!0,k:"__halt_compiler",l:t.UIR}),{cN:"string",b:/<<<['"]?\w+['"]?$/,e:/^\w+;?$/,c:[t.BE,{cN:"subst",v:[{b:/\$\w+/},{b:/\{\$/,e:/\}/}]}]},i,e,{b:/(::|->)+[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/},{cN:"function",bK:"function",e:/[;{]/,eE:!0,i:"\\$|\\[|%",c:[t.UTM,{cN:"params",b:"\\(",e:"\\)",c:["self",e,t.CBCM,n,s]}]},{cN:"class",bK:"class interface",e:"{",eE:!0,i:/[:\(\$"]/,c:[{bK:"extends implements"},t.UTM]},{bK:"namespace",e:";",i:/[\.']/,c:[t.UTM]},{bK:"use",e:";",c:[t.UTM]},{b:"=>"},n,s]}}),t.registerLanguage("profile",function(t){return{c:[t.CNM,{b:"[a-zA-Z_][\\da-zA-Z_]+\\.[\\da-zA-Z_]{1,3}",e:":",eE:!0},{b:"(ncalls|tottime|cumtime)",e:"$",k:"ncalls tottime|10 cumtime|10 filename",r:10},{b:"function calls",e:"$",c:[t.CNM],r:10},t.ASM,t.QSM,{cN:"string",b:"\\(",e:"\\)$",eB:!0,eE:!0,r:0}]}}),t.registerLanguage("python",function(t){var e={cN:"meta",b:/^(>>>|\.\.\.) /},i={cN:"string",c:[t.BE],v:[{b:/(u|b)?r?'''/,e:/'''/,c:[e],r:10},{b:/(u|b)?r?"""/,e:/"""/,c:[e],r:10},{b:/(u|r|ur)'/,e:/'/,r:10},{b:/(u|r|ur)"/,e:/"/,r:10},{b:/(b|br)'/,e:/'/},{b:/(b|br)"/,e:/"/},t.ASM,t.QSM]},n={cN:"number",r:0,v:[{b:t.BNR+"[lLjJ]?"},{b:"\\b(0o[0-7]+)[lLjJ]?"},{b:t.CNR+"[lLjJ]?"}]},s={cN:"params",b:/\(/,e:/\)/,c:["self",e,n,i]};return{aliases:["py","gyp"],k:{keyword:"and elif is global as in if from raise for except finally print import pass return exec else break not with class assert yield try while continue del or def lambda async await nonlocal|10 None True False",built_in:"Ellipsis NotImplemented"},i:/(<\/|->|\?)/,c:[e,n,i,t.HCM,{v:[{cN:"function",bK:"def",r:10},{cN:"class",bK:"class"}],e:/:/,i:/[${=;\n,]/,c:[t.UTM,s,{b:/->/,eW:!0,k:"None"}]},{cN:"meta",b:/^[\t ]*@/,e:/$/},{b:/\b(print|exec)\(/}]}}),t.registerLanguage("rust",function(t){var e="([uif](8|16|32|64|size))?",i=t.inherit(t.CBCM);i.c.push("self");var n="alignof as be box break const continue crate do else enum extern false fn for if impl in let loop match mod mut offsetof once priv proc pub pure ref return self Self sizeof static struct super trait true type typeof unsafe unsized use virtual while where yield move int i8 i16 i32 i64 uint u8 u32 u64 float f32 f64 str char bool",s="Copy Send Sized Sync Drop Fn FnMut FnOnce drop Box ToOwned Clone PartialEq PartialOrd Eq Ord AsRef AsMut Into From Default Iterator Extend IntoIterator DoubleEndedIterator ExactSizeIterator Option Result SliceConcatExt String ToString Vec assert! assert_eq! bitflags! bytes! cfg! col! concat! concat_idents! debug_assert! debug_assert_eq! env! panic! file! format! format_args! include_bin! include_str! line! local_data_key! module_path! option_env! print! println! select! stringify! try! unimplemented! unreachable! vec! write! writeln! macro_rules!";return{aliases:["rs"],k:{keyword:n,literal:"true false Some None Ok Err",built_in:s},l:t.IR+"!?",i:"</",c:[t.CLCM,i,t.inherit(t.QSM,{b:/b?"/,i:null}),{cN:"string",v:[{b:/r(#*)".*?"\1(?!#)/},{b:/b?'\\?(x\w{2}|u\w{4}|U\w{8}|.)'/}]},{cN:"symbol",b:/'[a-zA-Z_][a-zA-Z0-9_]*/},{cN:"number",v:[{b:"\\b0b([01_]+)"+e},{b:"\\b0o([0-7_]+)"+e},{b:"\\b0x([A-Fa-f0-9_]+)"+e},{b:"\\b(\\d[\\d_]*(\\.[0-9_]+)?([eE][+-]?[0-9_]+)?)"+e}],r:0},{cN:"function",bK:"fn",e:"(\\(|<)",eE:!0,c:[t.UTM]},{cN:"meta",b:"#\\!?\\[",e:"\\]",c:[{cN:"meta-string",b:/"/,e:/"/}]},{cN:"class",bK:"type",e:";",c:[t.inherit(t.UTM,{endsParent:!0})],i:"\\S"},{cN:"class",bK:"trait enum struct",e:"{",c:[t.inherit(t.UTM,{endsParent:!0})],i:"[\\w\\d]"},{b:t.IR+"::",k:{built_in:s}},{cN:"params",b:/\|/,e:/\|/,k:n},{b:"->"}]}}),t.registerLanguage("scala",function(t){var e={cN:"subst",v:[{b:"\\$[A-Za-z0-9_]+"},{b:"\\${",e:"}"}]},i={cN:"string",v:[{b:'"',e:'"',i:"\\n",c:[t.BE]},{b:'"""',e:'"""',r:10},{b:'[a-z]+"',e:'"',i:"\\n",c:[t.BE,e]},{cN:"string",b:'[a-z]+"""',e:'"""',c:[e],r:10}]},n={cN:"type",b:"\\b[A-Z][A-Za-z0-9_]*",r:0},s={cN:"title",b:/[^0-9\n\t "'(),.`{}\[\]:;][^\n\t "'(),.`{}\[\]:;]+|[^0-9\n\t "'(),.`{}\[\]:;=]/,r:0},o={cN:"class",bK:"class object trait type",e:/[:={\[\n;]/,eE:!0,c:[{bK:"extends with",r:10},{b:/\[/,e:/\]/,eB:!0,eE:!0,r:0,c:[n]},{cN:"params",b:/\(/,e:/\)/,eB:!0,eE:!0,r:0,c:[n]},s]},r={cN:"function",bK:"def",e:/[:={\[(\n;]/,eE:!0,c:[s]};return{k:{literal:"true false null",keyword:"type yield lazy override def with val var sealed abstract private trait object if forSome for while throw finally protected extends import final return else break new catch super class case package default try this match continue throws implicit"},c:[t.CLCM,t.CBCM,i,{cN:"symbol",b:"'\\w[\\w\\d_]*(?!')"},n,r,o,t.CNM,{cN:"meta",b:"@[A-Za-z]+"}]}}),t.registerLanguage("smalltalk",function(t){var e="[a-z][a-zA-Z0-9_]*",i={cN:"string",b:"\\$.{1}"},n={cN:"symbol",b:"#"+t.UIR};return{aliases:["st"],k:"self super nil true false thisContext",c:[t.C('"','"'),t.ASM,{cN:"type",b:"\\b[A-Z][A-Za-z0-9_]*",r:0},{b:e+":",r:0},t.CNM,n,i,{b:"\\|[ ]*"+e+"([ ]+"+e+")*[ ]*\\|",rB:!0,e:/\|/,i:/\S/,c:[{b:"(\\|[ ]*)?"+e}]},{b:"\\#\\(",e:"\\)",c:[t.ASM,i,t.CNM,n]}]}}),t.registerLanguage("sql",function(t){var e=t.C("--","$");return{cI:!0,i:/[<>{}*#]/,c:[{bK:"begin end start commit rollback savepoint lock alter create drop rename call delete do handler insert load replace select truncate update set show pragma grant merge describe use explain help declare prepare execute deallocate release unlock purge reset change stop analyze cache flush optimize repair kill install uninstall checksum restore check backup revoke",e:/;/,eW:!0,l:/[\w\.]+/,k:{keyword:"abort abs absolute acc acce accep accept access accessed accessible account acos action activate add addtime admin administer advanced advise aes_decrypt aes_encrypt after agent aggregate ali alia alias allocate allow alter always analyze ancillary and any anydata anydataset anyschema anytype apply archive archived archivelog are as asc ascii asin assembly assertion associate asynchronous at atan atn2 attr attri attrib attribu attribut attribute attributes audit authenticated authentication authid authors auto autoallocate autodblink autoextend automatic availability avg backup badfile basicfile before begin beginning benchmark between bfile bfile_base big bigfile bin binary_double binary_float binlog bit_and bit_count bit_length bit_or bit_xor bitmap blob_base block blocksize body both bound buffer_cache buffer_pool build bulk by byte byteordermark bytes cache caching call calling cancel capacity cascade cascaded case cast catalog category ceil ceiling chain change changed char_base char_length character_length characters characterset charindex charset charsetform charsetid check checksum checksum_agg child choose chr chunk class cleanup clear client clob clob_base clone close cluster_id cluster_probability cluster_set clustering coalesce coercibility col collate collation collect colu colum column column_value columns columns_updated comment commit compact compatibility compiled complete composite_limit compound compress compute concat concat_ws concurrent confirm conn connec connect connect_by_iscycle connect_by_isleaf connect_by_root connect_time connection consider consistent constant constraint constraints constructor container content contents context contributors controlfile conv convert convert_tz corr corr_k corr_s corresponding corruption cos cost count count_big counted covar_pop covar_samp cpu_per_call cpu_per_session crc32 create creation critical cross cube cume_dist curdate current current_date current_time current_timestamp current_user cursor curtime customdatum cycle data database databases datafile datafiles datalength date_add date_cache date_format date_sub dateadd datediff datefromparts datename datepart datetime2fromparts day day_to_second dayname dayofmonth dayofweek dayofyear days db_role_change dbtimezone ddl deallocate declare decode decompose decrement decrypt deduplicate def defa defau defaul default defaults deferred defi defin define degrees delayed delegate delete delete_all delimited demand dense_rank depth dequeue des_decrypt des_encrypt des_key_file desc descr descri describ describe descriptor deterministic diagnostics difference dimension direct_load directory disable disable_all disallow disassociate discardfile disconnect diskgroup distinct distinctrow distribute distributed div do document domain dotnet double downgrade drop dumpfile duplicate duration each edition editionable editions element ellipsis else elsif elt empty enable enable_all enclosed encode encoding encrypt end end-exec endian enforced engine engines enqueue enterprise entityescaping eomonth error errors escaped evalname evaluate event eventdata events except exception exceptions exchange exclude excluding execu execut execute exempt exists exit exp expire explain export export_set extended extent external external_1 external_2 externally extract failed failed_login_attempts failover failure far fast feature_set feature_value fetch field fields file file_name_convert filesystem_like_logging final finish first first_value fixed flash_cache flashback floor flush following follows for forall force form forma format found found_rows freelist freelists freepools fresh from from_base64 from_days ftp full function general generated get get_format get_lock getdate getutcdate global global_name globally go goto grant grants greatest group group_concat group_id grouping grouping_id groups gtid_subtract guarantee guard handler hash hashkeys having hea head headi headin heading heap help hex hierarchy high high_priority hosts hour http id ident_current ident_incr ident_seed identified identity idle_time if ifnull ignore iif ilike ilm immediate import in include including increment index indexes indexing indextype indicator indices inet6_aton inet6_ntoa inet_aton inet_ntoa infile initial initialized initially initrans inmemory inner innodb input insert install instance instantiable instr interface interleaved intersect into invalidate invisible is is_free_lock is_ipv4 is_ipv4_compat is_not is_not_null is_used_lock isdate isnull isolation iterate java join json json_exists keep keep_duplicates key keys kill language large last last_day last_insert_id last_value lax lcase lead leading least leaves left len lenght length less level levels library like like2 like4 likec limit lines link list listagg little ln load load_file lob lobs local localtime localtimestamp locate locator lock locked log log10 log2 logfile logfiles logging logical logical_reads_per_call logoff logon logs long loop low low_priority lower lpad lrtrim ltrim main make_set makedate maketime managed management manual map mapping mask master master_pos_wait match matched materialized max maxextents maximize maxinstances maxlen maxlogfiles maxloghistory maxlogmembers maxsize maxtrans md5 measures median medium member memcompress memory merge microsecond mid migration min minextents minimum mining minus minute minvalue missing mod mode model modification modify module monitoring month months mount move movement multiset mutex name name_const names nan national native natural nav nchar nclob nested never new newline next nextval no no_write_to_binlog noarchivelog noaudit nobadfile nocheck nocompress nocopy nocycle nodelay nodiscardfile noentityescaping noguarantee nokeep nologfile nomapping nomaxvalue nominimize nominvalue nomonitoring none noneditionable nonschema noorder nopr nopro noprom nopromp noprompt norely noresetlogs noreverse normal norowdependencies noschemacheck noswitch not nothing notice notrim novalidate now nowait nth_value nullif nulls num numb numbe nvarchar nvarchar2 object ocicoll ocidate ocidatetime ociduration ociinterval ociloblocator ocinumber ociref ocirefcursor ocirowid ocistring ocitype oct octet_length of off offline offset oid oidindex old on online only opaque open operations operator optimal optimize option optionally or oracle oracle_date oradata ord ordaudio orddicom orddoc order ordimage ordinality ordvideo organization orlany orlvary out outer outfile outline output over overflow overriding package pad parallel parallel_enable parameters parent parse partial partition partitions pascal passing password password_grace_time password_lock_time password_reuse_max password_reuse_time password_verify_function patch path patindex pctincrease pctthreshold pctused pctversion percent percent_rank percentile_cont percentile_disc performance period period_add period_diff permanent physical pi pipe pipelined pivot pluggable plugin policy position post_transaction pow power pragma prebuilt precedes preceding precision prediction prediction_cost prediction_details prediction_probability prediction_set prepare present preserve prior priority private private_sga privileges procedural procedure procedure_analyze processlist profiles project prompt protection public publishingservername purge quarter query quick quiesce quota quotename radians raise rand range rank raw read reads readsize rebuild record records recover recovery recursive recycle redo reduced ref reference referenced references referencing refresh regexp_like register regr_avgx regr_avgy regr_count regr_intercept regr_r2 regr_slope regr_sxx regr_sxy reject rekey relational relative relaylog release release_lock relies_on relocate rely rem remainder rename repair repeat replace replicate replication required reset resetlogs resize resource respect restore restricted result result_cache resumable resume retention return returning returns reuse reverse revoke right rlike role roles rollback rolling rollup round row row_count rowdependencies rowid rownum rows rtrim rules safe salt sample save savepoint sb1 sb2 sb4 scan schema schemacheck scn scope scroll sdo_georaster sdo_topo_geometry search sec_to_time second section securefile security seed segment select self sequence sequential serializable server servererror session session_user sessions_per_user set sets settings sha sha1 sha2 share shared shared_pool short show shrink shutdown si_averagecolor si_colorhistogram si_featurelist si_positionalcolor si_stillimage si_texture siblings sid sign sin size size_t sizes skip slave sleep smalldatetimefromparts smallfile snapshot some soname sort soundex source space sparse spfile split sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_small_result sql_variant_property sqlcode sqldata sqlerror sqlname sqlstate sqrt square standalone standby start starting startup statement static statistics stats_binomial_test stats_crosstab stats_ks_test stats_mode stats_mw_test stats_one_way_anova stats_t_test_ stats_t_test_indep stats_t_test_one stats_t_test_paired stats_wsr_test status std stddev stddev_pop stddev_samp stdev stop storage store stored str str_to_date straight_join strcmp strict string struct stuff style subdate subpartition subpartitions substitutable substr substring subtime subtring_index subtype success sum suspend switch switchoffset switchover sync synchronous synonym sys sys_xmlagg sysasm sysaux sysdate sysdatetimeoffset sysdba sysoper system system_user sysutcdatetime table tables tablespace tan tdo template temporary terminated tertiary_weights test than then thread through tier ties time time_format time_zone timediff timefromparts timeout timestamp timestampadd timestampdiff timezone_abbr timezone_minute timezone_region to to_base64 to_date to_days to_seconds todatetimeoffset trace tracking transaction transactional translate translation treat trigger trigger_nestlevel triggers trim truncate try_cast try_convert try_parse type ub1 ub2 ub4 ucase unarchived unbounded uncompress under undo unhex unicode uniform uninstall union unique unix_timestamp unknown unlimited unlock unpivot unrecoverable unsafe unsigned until untrusted unusable unused update updated upgrade upped upper upsert url urowid usable usage use use_stored_outlines user user_data user_resources users using utc_date utc_timestamp uuid uuid_short validate validate_password_strength validation valist value values var var_samp varcharc vari varia variab variabl variable variables variance varp varraw varrawc varray verify version versions view virtual visible void wait wallet warning warnings week weekday weekofyear wellformed when whene whenev wheneve whenever where while whitespace with within without work wrapped xdb xml xmlagg xmlattributes xmlcast xmlcolattval xmlelement xmlexists xmlforest xmlindex xmlnamespaces xmlpi xmlquery xmlroot xmlschema xmlserialize xmltable xmltype xor year year_to_month years yearweek",literal:"true false null",built_in:"array bigint binary bit blob boolean char character date dec decimal float int int8 integer interval number numeric real record serial serial8 smallint text varchar varying void"},c:[{cN:"string",b:"'",e:"'",c:[t.BE,{b:"''"}]},{cN:"string",b:'"',e:'"',c:[t.BE,{b:'""'}]},{cN:"string",b:"`",e:"`",c:[t.BE]},t.CNM,t.CBCM,e]},t.CBCM,e]}}),t.registerLanguage("swift",function(t){var e={keyword:"__COLUMN__ __FILE__ __FUNCTION__ __LINE__ as as! as? associativity break case catch class continue convenience default defer deinit didSet do dynamic dynamicType else enum extension fallthrough false final for func get guard if import in indirect infix init inout internal is lazy left let mutating nil none nonmutating operator optional override postfix precedence prefix private protocol Protocol public repeat required rethrows return right self Self set static struct subscript super switch throw throws true try try! try? Type typealias unowned var weak where while willSet",literal:"true false nil",built_in:"abs advance alignof alignofValue anyGenerator assert assertionFailure bridgeFromObjectiveC bridgeFromObjectiveCUnconditional bridgeToObjectiveC bridgeToObjectiveCUnconditional c contains count countElements countLeadingZeros debugPrint debugPrintln distance dropFirst dropLast dump encodeBitsAsWords enumerate equal fatalError filter find getBridgedObjectiveCType getVaList indices insertionSort isBridgedToObjectiveC isBridgedVerbatimToObjectiveC isUniquelyReferenced isUniquelyReferencedNonObjC join lazy lexicographicalCompare map max maxElement min minElement numericCast overlaps partition posix precondition preconditionFailure print println quickSort readLine reduce reflect reinterpretCast reverse roundUpToAlignment sizeof sizeofValue sort split startsWith stride strideof strideofValue swap toString transcode underestimateCount unsafeAddressOf unsafeBitCast unsafeDowncast unsafeUnwrap unsafeReflect withExtendedLifetime withObjectAtPlusZero withUnsafePointer withUnsafePointerToObject withUnsafeMutablePointer withUnsafeMutablePointers withUnsafePointer withUnsafePointers withVaList zip"},i=t.C("/\\*","\\*/",{c:["self"]}),n={cN:"subst",b:/\\\(/,e:"\\)",k:e,c:[]},s={cN:"number",b:"\\b([\\d_]+(\\.[\\deE_]+)?|0x[a-fA-F0-9_]+(\\.[a-fA-F0-9p_]+)?|0b[01_]+|0o[0-7_]+)\\b",r:0},o=t.inherit(t.QSM,{c:[n,t.BE]});return n.c=[s],{k:e,c:[o,t.CLCM,i,{cN:"type",b:"\\b[A-Z][\\w']*",r:0},s,{cN:"function",bK:"func",e:"{",eE:!0,c:[t.inherit(t.TM,{b:/[A-Za-z$_][0-9A-Za-z$_]*/,i:/\(/}),{b:/</,e:/>/,i:/>/},{cN:"params",b:/\(/,e:/\)/,endsParent:!0,k:e,c:["self",s,o,t.CBCM,{b:":"}],i:/["']/}],i:/\[|%/},{cN:"class",bK:"struct protocol class extension enum",k:e,e:"\\{",eE:!0,c:[t.inherit(t.TM,{b:/[A-Za-z$_][0-9A-Za-z$_]*/})]},{cN:"meta",b:"(@warn_unused_result|@exported|@lazy|@noescape|@NSCopying|@NSManaged|@objc|@convention|@required|@noreturn|@IBAction|@IBDesignable|@IBInspectable|@IBOutlet|@infix|@prefix|@postfix|@autoclosure|@testable|@available|@nonobjc|@NSApplicationMain|@UIApplicationMain)"},{bK:"import",e:/$/,c:[t.CLCM,i]}]}}),t.registerLanguage("tex",function(t){var e={cN:"tag",b:/\\/,r:0,c:[{cN:"name",v:[{b:/[a-zA-Zа-яА-я]+[*]?/},{b:/[^a-zA-Zа-яА-я0-9]/}],starts:{eW:!0,r:0,c:[{cN:"string",v:[{b:/\[/,e:/\]/},{b:/\{/,e:/\}/}]},{b:/\s*=\s*/,eW:!0,r:0,c:[{cN:"number",b:/-?\d*\.?\d+(pt|pc|mm|cm|in|dd|cc|ex|em)?/}]}]}}]};return{c:[e,{cN:"formula",c:[e],r:0,v:[{b:/\$\$/,e:/\$\$/},{b:/\$/,e:/\$/}]},t.C("%","$",{r:0})]}}),t.registerLanguage("vbscript",function(t){return{aliases:["vbs"],cI:!0,k:{keyword:"call class const dim do loop erase execute executeglobal exit for each next function if then else on error option explicit new private property let get public randomize redim rem select case set stop sub while wend with end to elseif is or xor and not class_initialize class_terminate default preserve in me byval byref step resume goto",built_in:"lcase month vartype instrrev ubound setlocale getobject rgb getref string weekdayname rnd dateadd monthname now day minute isarray cbool round formatcurrency conversions csng timevalue second year space abs clng timeserial fixs len asc isempty maths dateserial atn timer isobject filter weekday datevalue ccur isdate instr datediff formatdatetime replace isnull right sgn array snumeric log cdbl hex chr lbound msgbox ucase getlocale cos cdate cbyte rtrim join hour oct typename trim strcomp int createobject loadpicture tan formatnumber mid scriptenginebuildversion scriptengine split scriptengineminorversion cint sin datepart ltrim sqr scriptenginemajorversion time derived eval date formatpercent exp inputbox left ascw chrw regexp server response request cstr err",literal:"true false null nothing empty"},i:"//",c:[t.inherit(t.QSM,{c:[{b:'""'}]}),t.C(/'/,/$/,{r:0}),t.CNM]}}),t.registerLanguage("yql",function(t){return{cI:!0,c:[{b:"",e:/;/,eW:!0,l:/\w+/,k:{keyword:"abort and as asc ast attach auth avg between case cast cli update clusters coalesce columns compile count delete desc describe distinct drop else end explain fields file filecontent filepath from full join get group by having help history inner insert into is join left length limit max median meta min not null offset on open operations optimize or order by parse percentile pragma preview process progress put queries query quickstart reduce remove replace into restart results right join run running schema scheme select show status sum table tables then use using validate values version when where with yamr yt true false null",literal:"true false",built_in:"avg cast coalesce filecontent filepath length max median count count_if min percentile sum min_by max_by min_of max_of stddev variance stddev_sample stddev_population variance_sample variance_population bool_and bool_or bit_and bit_or bit_xor some list unique string byte double float int32 uint32 int64 uint64 bool",symbol:"sakura betula banach smith hegel aristotle plato quine marx freud hahn cedar hume"},c:[{cN:"variable",b:"\\$",e:"[^a-z0-9_]",eE:!0},{cN:"name",b:"[a-zA-Z0-9]+::",e:"[ \\(]",eE:!0},{cN:"symbol",b:"\\[",e:"\\]"},{cN:"string",b:"'",e:"'",c:[t.BE,{b:"''"}]},{cN:"string",b:'"',e:'"',c:[t.BE,{b:'""'}]},{cN:"string",b:"@@",e:"@@"},{cN:"string",b:"`",e:"`",c:[t.BE]},t.CNM,t.CBCM,t.C("--","$")]}]}}),t}),"undefined"!=typeof exports)var hljs=exports;BEM.decl("i-highlight",{},{highlight:function(t){t.each(function(t,e){hljs.highlightBlock(e)})}}),BEM.DOM.decl({block:"wf-doc"},{onSetMod:{js:{inited:function(){this._includesLoadedCheckInterval=setInterval(this._checkIsIncludesLoaded.bind(this),300)}}},_checkIsIncludesLoaded:function(){var t=this.findBlocksInside("wiki-action-include").some(function(t){return!t.getMods().loaded}),e=this.findBlocksInside("wiki-sanitizer").some(function(t){return!t.getMods().loaded});t||e||(Ya&&Ya.Rum&&Ya.Rum.logError&&Ya.Rum.logError({message:"includes_rendered",level:"info",additional:{supertag:BEM.WISTORE.get("page").get("superTag"),count:Ya.FormatterViewPort.BEM.blocks["wiki-action-include"].loaded}}),clearInterval(this._includesLoadedCheckInterval),this.findBlocksInside("wf-head").filter(function(t){return!t.hasMod("include-title")}).forEach(function(t,e){t.activateEditLink(e+1)}),BEM.DOM.init(this.domElem))}}),BEM.DOM.decl({block:"wf-grid"},{onSetMod:{js:{inited:function(){var t=this.params.data;t.url&&!t.page&&(t.page=t.url,delete t.url),BEM.DOM.replace(this.domElem,BEMHTML.apply({block:"b-wiki-grid",newWF:!0,readonly:this.params.readonly,js:{data:this.params.data}}))}}}}),BEM.DOM.decl({block:"wf-head"},{onSetMod:{js:{inited:function(){this.params=JSON.parse(this.domElem.attr("data-wf")),this._formatter=Ya.FormatterViewPort.getInstance(this.domElem[0]),this._config=this._formatter.getConfig(),this._editLink=BEM.DOM.append(this.findBlockOn(this.domElem,"wiki-head").findElem("anchor-link"),BEMHTML.apply({block:"link",mods:{theme:"normal",role:"edit"},mix:{block:"wf-head",elem:"edit-link"},text:BEM.I18N("wf-head","edit"),url:"#"}))}}},activateEditLink:function(t){if(this.params.section_local){var e=Boolean(this.params.includesPath.length),i=e?this.params.includesPath[this.params.includesPath.length-1]:this._config.page_path;i+="/.edit";var n={section:this.params.section_local,goanchor:"h-"+t};e&&(n.gopage=this._config.page_path);var s=BEM.blocks["wi-history"].formURL({pathname:i,search:n});this._editLink.attr("href",s),this.setMod("active","yes")}},_onEditLinkClick:function(t){var e,i,n=this._editLink.attr("href"),s=/(?:\/)(\.\S+)/g.exec(n);t.preventDefault(),s&&s[1]&&(s=s[1]),e=this.__self._getQueryParameters(s),(i=/(.+)\/\.\w+\?/.exec(this._editLink.attr("href")))&&(e.path=i[1]),BEM.blocks["wi-history"]&&BEM.blocks["wi-history"].pushState(s),BEM.channel("common").trigger("w-action.open-editor",{params:e})}},{_getQueryParameters:function(t){return t.replace(/(.+\?)/,"").split("&").map(function(t){return this[(t=t.split("="))[0]]=t[1],this}.bind({}))[0]},live:function(){this.liveBindTo("edit-link","click",function(t){this._onEditLinkClick(t)})}}),BEM.DOM.decl("w-breadcrumbs",{onSetMod:{js:function(){"complete"===BEM.DOM.doc[0].readyState?this.init():this.bindToWin("load",this.init,this)}},init:function(){this._contentWidth=this.findElem("content").width(),this.bindToWin("resize",this._onPageLayoutChanged,this),BEM.channel("layout").on("change",this._onPageLayoutChanged,this),this.setMod("roll",this._isNeedRoll()?"yes":"")},destruct:function(){BEM.channel("layout").un("change",this._onPageLayoutChanged,this),this.unbindFromWin("resize",this._onPageLayoutChanged,this),this.__base.apply(this,arguments)},_onPageLayoutChanged:function(){var t=this.hasMod("roll");this._isNeedRoll()?t||this.setMod("roll","yes"):t&&this.delMod("roll")},_isNeedRoll:function(){return this.domElem.width()<=this._contentWidth}}),BEM.DOM.decl("wi-history",{},{getPath:function(){return this.getCorrectPath()},getCorrectPath:function(){var t=window.location.pathname,e=window.location.pathname.split("/"),i=e.pop();return/^\./.test(i)&&(t=e.join("/")),t.lastIndexOf("/")!==t.length-1&&(t+="/"),t},pushState:function(t){var e=this.parseURL();history.pushState({url:e.path+t+this._getRedirectParam()},null,e.path+t+this._getRedirectParam()),e.handler&&this.channel("wiki-states").trigger("replace-state",{from:e.handler,to:t}),BEM.WISTORE.get("app").set({action:t.slice(1)})},removeState:function(){var t=this.parseURL();history.pushState({url:t.path+this._getRedirectParam()},null,t.path+this._getRedirectParam()),BEM.WISTORE.get("app").set({action:"view"})},_getRedirectParam:function(){var t=BEM.WISTORE.get("page"),e="";return t&&t.get("redirect")&&(e="?noredirect"),e},parseURL:function(t){var e=void 0!==t?this._nativeParseHref(t):null,i=e?e.pathname:window.location.pathname,n=/\/(\.[^\?]+)(\?.+)?$/.exec(i),s=null;return n&&n[1]&&(s=n[1],i=i.replace("/"+s,"/")),"/"!==i[i.length-1]&&(i+="/"),{path:i,breadcrumbs:i.split("/").filter(function(t){return""!==t}),handler:s,params:e?this.parseQueryParams(e.search):this.parseQueryParams()}},formURL:function(t){return(t.pathname||"/")+(t.handler||"")+(t.search?"?"+Object.keys(t.search).map(function(e){return e+"="+t.search[e]}).join("&"):"")},_nativeParseHref:function(t){var e=document.createElement("a");return e.href=t,{pathname:e.pathname,search:e.search,hash:e.hash}},parseQueryParams:function(t){var e={};return(t="string"==typeof t?t.substr(1):window.location.search.substr(1))?(t.split("&").forEach(function(t){var i=t.split("=");e[i[0]]=decodeURIComponent(i[1])}),e):null},_clearUrl:function(){this.pushState("")},getRoute:function(){var t=window.location.pathname,e=/.+\/(\..+)$/.exec(t);return!!e&&{route:e[1],params:this.parseQueryParams()}},getSuperTag:function(t){var e,i=t||window.location.pathname,n=this.parseQueryParams(),s=i,o={};n&&(n.section&&(o.section=n.section),n.originpath&&(s=decodeURIComponent(n.originpath)),e=$.param(o));var r=s.split("/"),a=r.pop();return/^\./.test(a)&&(s=r.join("/")+"/"),s.lastIndexOf("/")!==s.length-1&&(s+="/"),e&&(s+="?"+e),s}}),window,jQuery,$(window).on("load",function(){history.replaceState({url:location.pathname+location.search+location.hash},null,location.pathname+location.search+location.hash),setTimeout(function(){$(window).on("popstate",function(t){t.originalEvent&&history.state&&history.state.url&&(window.location.href=history.state.url)})},500)}),BEM.DOM.decl("b-widget",{onSetMod:{js:function(){this._bPage=this.findBlockOutside("b-page")}},show:function(){var t;$(document).on("keydown.widget",this._onKeyUp.bind(this)),(t=this._bPage.findBlockInside({block:"b-widget",modName:"visibility",modVal:"yes"}))&&t.delMod("visibility"),(t=this._bPage.findBlockInside({block:"b-favs-widget",modName:"visibility",modVal:"yes"}))&&t.hide(),this.setMod("visibility","yes"),this.trigger("show"),this._bPage.setMod("scroll","disable"),$(document).scrollTop(0)},hide:function(t){$(document).off("keydown.widget"),this.delMod("visibility"),this.trigger("hide"),this._bPage.delMod("scroll"),t||BEM.blocks["wi-history"].removeState()},_onKeyUp:function(t){27===t.keyCode&&this.hide()}}),BEM.DOM.decl("b-request-access",{onSetMod:{js:function(){this.bPage=this.findBlockOutside("b-page"),this.bWidget=this.findBlockOutside("b-widget"),this.requestID=this.bWidget.params&&this.bWidget.params.data&&this.bWidget.params.data.id,this.requestAction=this.bWidget.params&&this.bWidget.params.data&&this.bWidget.params.data.action,this.requestID?(this.accessData={},this.getData()):this._onGetError({code:"500",message:[BEM.I18N("b-request-access","no_id_for_request")]})}},getData:function(){this.findBlockOutside("i-global"),BEM.create("wi-api-request",{apiPath:".requestaccess/"+this.requestID,path:BEM.blocks["wi-history"].getCorrectPath(),urlParams:["format=json"]}).run().then(this._onGetSuccess.bind(this),this._onGetError.bind(this))},_onGetSuccess:function(t){var e="";switch(this.delMod("type"),this.accessData=t.data,this.accessStatus=this.accessData.status,this.accessStatus){case"pending":this.accessAction="allow_groups","allow"===this.requestAction&&"#grant_access_only_to"===location.hash?this.accessAction="allow_applicant":"deny"===this.requestAction&&(this.accessAction="deny"),BEM.DOM.update(this.elem("content"),BEMHTML.apply(this._getAccessBEMJSON()),this._onShowAccessSuccess,this);break;case"processed":e=BEM.I18N("b-request-access","request_processed"),this.accessData.granted?e+=BEM.I18N("b-request-access","access_granted"):e+=BEM.I18N("b-request-access","access_denied"),BEM.DOM.update(this.elem("content"),e);break;case"obsolete":e=BEM.I18N("b-request-access","request_irrelevant"),BEM.DOM.update(this.elem("content"),e);break;default:e=BEM.I18N("b-request-access","wrong_status"),BEM.DOM.update(this.elem("content"),e)}BEM.DOM.update(this.elem("buttons"),BEMHTML.apply(this._getAccessButtonsBEMJSON()),this._onShowAccessButtonsSuccess,this)},_getAccessBEMJSON:function(){return[{block:"w-username",user:this.accessData.applicant},BEM.I18N("b-request-access","ask_access"),{block:"b-request-access",elem:"reason",content:this.accessData.reason},{block:"b-request-access",elem:"access-action",content:{block:"radio-button",mods:{size:"m",type:"access-action",theme:"normal"},name:"access-action",value:this.accessAction,content:[{elem:"radio",controlAttrs:{value:"allow_groups"},content:BEM.I18N("b-request-access","access_group")},{elem:"radio",controlAttrs:{value:"allow_applicant"},content:BEM.I18N("b-request-access","access_employee")},{elem:"radio",controlAttrs:{value:"deny"},content:BEM.I18N("b-request-access","reject")}]}},{block:"b-request-access",elem:"access-action-unique",content:this._getAccessActionBEMJSON()}]},_getAccessActionBEMJSON:function(){var t={};switch(this.accessAction){case"allow_groups":t=[{block:"wiki-p",content:BEM.I18N("b-request-access","use_this",{login:this.accessData.applicant.login})},{block:"wiki-p",content:BEM.I18N("b-request-access","groups_include",{name:this.accessData.applicant.display})},{block:"allow-groups",content:[{block:"allow-groups-services",content:[{elem:"title",content:BEM.I18N("b-request-access","services")},{elem:"list",content:this._getUserGroups(this.accessData.applicant_services)}]},{block:"allow-groups-departments",content:[{elem:"title",content:BEM.I18N("b-request-access","division")},{elem:"list",content:this._getUserGroups(this.accessData.applicant_departments)}]}]},this.__self._getMSuggestBEMJSON(),{block:"b-request-access",elem:"groups-list"}];break;case"allow_applicant":t=[{block:"wiki-p",content:BEM.I18N("b-request-access","access_will_take")+this.accessData.applicant.display+". "+BEM.I18N("b-request-access","use_this",{login:this.accessData.applicant.login})+"."}];break;case"deny":t=[{block:"wiki-p",content:BEM.I18N("b-request-access","you_want_reject_access")},{block:"input",mods:{type:"textarea",size:"s"},content:{elem:"control",controlAttrs:{placeholder:BEM.I18N("b-request-access","why_you_dont_give_access")}}}]}return{block:"b-request-access",elem:this.accessAction,content:t}},_getUserGroups:function(t){return t.map(function(t){return{block:"checkbox",mods:{size:"m",theme:"normal"},js:{id:t.id},text:t.name}})},_onShowAccessSuccess:function(){this.accessActionsButton=this.findBlockInside("radio-button"),this.accessActionsButton.on("change",this._onAccessActionChange,this),this._initBlock()},_initBlock:function(){var t=this;switch(this.accessAction){case"allow_groups":this.departmentCheckboxes=this.findBlockInside("allow-groups-departments").findBlocksInside("checkbox"),this.departmentCheckboxes.forEach(function(e){e.on("change",t._onCheckboxChange,t)}),this.otherGroups=[],this.groupsList=this.elem("groups-list"),this.groupsSuggest=this.findBlockInside({block:"m-suggest"}),this.groupsSuggest.on("select",this._onGroupsSuggestSelect,this)}},_onAccessActionChange:function(){var t;this.accessAction=this.accessActionsButton.val(),t=this.findElem(this.accessAction),this.elem("access-action-unique").children().hide(),t.length?t.show():(BEM.DOM.append(this.elem("access-action-unique"),BEMHTML.apply(this._getAccessActionBEMJSON())),this._initBlock())},_onCheckboxChange:function(t,e){var i=this,n=null;t.target.isDisabled()||(e.checked?(this.currentDepartmentCheckbox=t.target,this.departmentCheckboxes.forEach(function(t,e){t!==i.currentDepartmentCheckbox?null!==n&&n<e&&t.setMod("checked","yes").setMod("disabled","yes"):n=e})):this.departmentCheckboxes.forEach(function(t){t.delMod("disabled"),t.delMod("checked")}))},_onGroupsSuggestSelect:function(t,e){var i=e.entityData;this.otherGroups.includes(i.id)||(this.otherGroups.push(i.id),BEM.DOM.append(this.groupsList,BEMHTML.apply(this._groupBEMJSON(i)))),this.groupsSuggest.clearData()},_groupBEMJSON:function(t){return{block:"b-user-group",mods:{type:"request-access"},js:{id:t.id},content:[t.name,{block:"b-user-group",elem:"remove",content:{block:"awesome-icon",mods:{icon:"remove"}}}]}},_getAccessButtonsBEMJSON:function(t){var e=[],i=BEM.I18N("b-request-access","close");return t||"pending"!==this.accessStatus||(i=BEM.I18N("b-request-access","cancel")),e.push({block:"button2",mods:{size:"m",role:"cancel",theme:"normal"},text:i}),t||"pending"!==this.accessStatus||e.push({block:"button2",mix:[{block:"b-readonly-item",js:!0}],mods:{theme:"action",size:"m",role:"save"},text:BEM.I18N("b-request-access","save")}),e},_onShowAccessButtonsSuccess:function(){this.bCancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}),this.bCancelButton&&this.bCancelButton.on("click",this._closePopup,this),this.bSaveButton=this.findBlockInside({block:"button2",modName:"role",modVal:"save"}),this.bSaveButton&&this.bSaveButton.on("click",this._saveChanges,this)},_closePopup:function(){this.bWidget.hide()},_saveChanges:function(){var t=[],e={action:this.accessAction},i="",n=this.findElem("error");switch(n.length&&n.remove(),this.accessAction){case"allow_groups":if(this.findBlocksInside("checkbox").forEach(function(e){e.isChecked()&&!e.isDisabled()&&t.push(e.params.id)}),!(t=t.concat(this.otherGroups)).length)return i={block:"b-request-access",elem:"error",content:BEM.I18N("b-request-access","no_group_selected")},void BEM.DOM.append(this.elem("allow_groups"),BEMHTML.apply(i));e.groups=t;break;case"allow_applicant":break;case"deny":if(e.verdict_reason=this.findBlockInside("input").val(),i={block:"b-request-access",elem:"error",content:BEM.I18N("b-request-access","reason_is_required_field")},""===e.verdict_reason)return void BEM.DOM.append(this.findBlockInside("input").domElem,BEMHTML.apply(i))}this._sendApprove(e)},_sendApprove:function(t){BEM.create("wi-api-request",{apiPath:".requestaccess/"+this.requestID,path:"",method:"POST",data:t,urlParams:!1}).run().then(this._onSendSuccess.bind(this),this._onGetError.bind(this))},_onSendSuccess:function(){BEM.DOM.update(this.elem("content"),BEM.I18N("b-request-access","access_was_processed")),BEM.DOM.update(this.elem("buttons"),BEMHTML.apply(this._getAccessButtonsBEMJSON(!0)),this._onShowAccessButtonsSuccess,this)},_onGetError:function(t){var e=[{block:"b-request-access",elem:"error",content:BEM.I18N("b-request-access","error")},{block:"wiki-p",content:t.message[0]}];this.delMod("type"),BEM.DOM.update(this.elem("content"),BEMHTML.apply(e)),BEM.DOM.update(this.elem("buttons"),BEMHTML.apply(this._getAccessButtonsBEMJSON(!0)),this._onShowAccessButtonsSuccess,this)}},{_getMSuggestBEMJSON:function(){return{block:"m-suggest",js:{addRequestParams:{limit:40},maxPopupHeight:250},mods:{size:"m",type:"multicomplete"},hint:BEM.I18N("b-request-access","another_group"),types:["group"]}}}),BEM.DOM.decl("b-request-access",{_initBlock:function(){var t=this;switch(this.accessAction){case"allow_groups":this.groupCheckboxes=this.findBlockInside("allow-groups-services").findBlocksInside("checkbox"),this.departmentCheckboxes=this.findBlockInside("allow-groups-departments").findBlocksInside("checkbox"),this.departmentCheckboxes.forEach(function(e){e.on("change",t._onCheckboxChange,t)}),this.otherGroups=[],this.otherDepartments=[],this.groupsList=this.elem("groups-list"),this.groupsSuggest=this.findBlockInside({block:"m-suggest"}),this.groupsSuggest.on("select",this._onGroupsSuggestSelect,this)}},_groupBEMJSON:function(t){return{block:"b-user-group",mods:{type:"request-access"},js:{id:t.id,type:t.type},content:[t.title,{block:"b-user-group",elem:"remove",content:{block:"awesome-icon",mods:{icon:"remove"}}}]}},_onGroupsSuggestSelect:function(t,e){var i=e.entityData;if(this.groupsSuggest.clearData(),"groups"!==i.layer||this.otherGroups.includes(i.id)){if("groups"===i.layer||this.otherDepartments.includes(i.id))return;i.type="department",this.otherDepartments.push(i.id)}else i.type="group",this.otherGroups.push(i.id);BEM.DOM.append(this.groupsList,BEMHTML.apply(this._groupBEMJSON(i)))},_saveChanges:function(){var t=[],e=[],i={action:this.accessAction},n="",s=this.findElem("error");switch(s.length&&s.remove(),this.accessAction){case"allow_groups":if(this.groupCheckboxes.forEach(function(e){e.isChecked()&&!e.isDisabled()&&t.push(e.params.id)}),this.departmentCheckboxes.forEach(function(t){t.isChecked()&&!t.isDisabled()&&e.push(t.params.id)}),t=t.concat(this.otherGroups),e=e.concat(this.otherDepartments),!t.length&&!e.length)return n={block:"b-request-access",elem:"error",content:BEM.I18N("b-request-access","no_group_selected")},void BEM.DOM.append(this.elem("allow_groups"),BEMHTML.apply(n));i.groups=t,i.departments=e;break;case"allow_applicant":break;case"deny":if(i.verdict_reason=this.findBlockInside("input").val(),n={block:"b-request-access",elem:"error",content:BEM.I18N("b-request-access","reason_is_required_field")},""===i.verdict_reason)return void BEM.DOM.append(this.findBlockInside("input").domElem,BEMHTML.apply(n))}this._sendApprove(i)}},{_getMSuggestBEMJSON:function(){return{block:"m-suggest",js:{layers:"departments,groups",addRequestParams:{"departments.order":1,"groups.order":2},maxPopupHeight:250},mods:{type:"b2b",multicomplete:"yes",role:"groups"},url:BEM.blocks["i-global"].param("hosts").suggest.url,input:{block:"input",mods:{size:"m",theme:"normal"},placeholder:BEM.I18N("b-request-access","another_group"),content:{elem:"control",attrs:{name:"text",autocomplete:"off"}}}}}}),BEM.DOM.decl({name:"b-user-group",modName:"type",modVal:"request-access"},{onSetMod:{js:function(){this.bRequestAccess=this.findBlockOutside("b-request-access")}},_onRemoveClick:function(){var t=this.params.id,e=this.bRequestAccess.otherGroups.indexOf(t);this.bRequestAccess.otherGroups.splice(e,1),this.destruct()}},{live:function(){this.liveBindTo("remove","click",function(t){this._onRemoveClick(t)})}}),BEM.DOM.decl({name:"b-user-group",modName:"type",modVal:"request-access"},{_onRemoveClick:function(){var t,e=this.params.id;"group"===this.params.type?(t=this.bRequestAccess.otherGroups.indexOf(e),this.bRequestAccess.otherGroups.splice(t,1)):"department"===this.params.type&&(t=this.bRequestAccess.otherDepartments.indexOf(e),this.bRequestAccess.otherDepartments.splice(t,1)),this.destruct()}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"page-access"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._hasChange=this.params.canChange,this._initTempData(),this._initBlocks()},"show-users":{yes:function(){this._focusRestrictedSuggestInput()},"":function(){this._restrictedSuggest.clearData()}},progress:{yes:function(){this._saveAccessSpinner.setMod("progress","yes"),this._bSaveButton.setMod("disabled","yes")},"":function(){this._saveAccessSpinner.delMod("progress"),this._bSaveButton.delMod("disabled")}}},show:function(){var t=this._savedData||this.params.data;this.__base.apply(this,arguments),this._accessType.val(t.type),this._drawRestricted(t),this._initTempData(),this.elem("parent-access").text("("+this.__self._getType(t.parent_access||t.type).text+")"),this.hasMod("show-users","yes")&&this._focusRestrictedSuggestInput()},_initAccessData:function(t){this._accessData={groups:[],users:[],departments:[],robots:[],type:t}},_initTempData:function(){var t=this._savedData||this.params.data,e=t.authors.map(function(t){return t.uid});this._initAccessData(t.type),t.restrictions&&(t.restrictions.users=t.restrictions.users.filter(function(t){return-1===e.indexOf(t.uid)}),this._accessData.groups=_.map(t.restrictions.groups,"id"),this._accessData.users=_.map(t.restrictions.users,"uid")),"inherited"===t.type?this._inheritedAccessData=this._accessData:this._inheritedAccessData={type:"inherited"}},_initBlocks:function(){this._restrictedSuggest=this.findBlockInside("m-suggest"),this._restrictedSuggestInput=this._restrictedSuggest.findBlockInside("textinput"),this._bGroupsList=this.findBlockInside("b-groups-list"),this._bServiceList=this.findBlockInside("b-services-list"),this._bWikiList=this.findBlockInside("b-wiki-list"),this._multiSelect=this.findBlockInside("m-suggest").on("select",this._onSuggestItemSelect,this),this._saveAccessSpinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"save-access"}),this._bSaveButton=this.findBlockInside({block:"button2",modName:"role",modVal:"save"}).on("click",this._saveAccess,this),this._bCancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}).on("click",this._onCancelClick,this),this._actionLoadSpinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"action-load"}),this._accessType=this.findBlockInside("radiobox").on("change",this._onAccessTypeChange,this),this.bindTo("content","click",this._removeItem.bind(this)),BEM.blocks.link.on(this.elem("restricted-groups"),"click",this._onRestrictedLinkClick,this)},_onCancelClick:function(){this.hide()},_saveAccess:function(){this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".access",method:"POST",headers:{"Content-Type":"application/json"},data:"inherited"===this._accessData.type?this._inheritedAccessData:this._accessData,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath(),timeout:this.__self.REQUEST_TIMEOUT}).run().then(this._onSaveAccessData.bind(this),BEM.blocks["wi-notification"].errorHandler(this._bSaveButton.domElem,BEM.I18N("w-access-button","cant_save_changes"))).always(function(){this.delMod("progress")}.bind(this))},_onSaveAccessData:function(t){this.trigger("access-change",t.data),this._savedData=t.data,this.hide(),t.data.rejects&&(t.data.rejects.users.length||t.data.rejects.groups.length)&&BEM.channel("common").trigger("w-action.create-approve-rejected-access",{rejects:t.data.rejects,request_role_url:t.data.request_role_url})},_isAuthor:function(t){return(this._savedData||this.params.data).authors.some(function(e){return e.uid===t.uid})},_onSuggestItemSelect:function(t){var e,i,n,s;if(this._selectedItem=t.block.getData(),i=this._selectedItem.type,"staff"!==this._selectedItem._type||-1!==this._accessData.users.indexOf(parseInt(this._selectedItem.uid))||this._isAuthor(this._selectedItem)){if("group"===this._selectedItem._type&&-1===this._accessData.groups.indexOf(parseInt(this._selectedItem.id))){switch(this._accessData.groups.push(parseInt(this._selectedItem.id)),n=BEMHTML.apply(this._getGroupBEMJSON(this._selectedItem,!1)),i){case 0:s=this._bWikiList,this._addHeaderToDom(this._bWikiList,BEM.I18N("w-access-button","wiki-groups"));break;case 2:s=this._bServiceList,this._addHeaderToDom(this._bServiceList,BEM.I18N("w-access-button","services"));break;default:s=this._bGroupsList,this._addHeaderToDom(this._bGroupsList,BEM.I18N("w-access-button","division"))}BEM.DOM.append(s.domElem,n),this._accessData.type="restricted"}}else this._accessData.users.push(parseInt(this._selectedItem.uid)),e=BEMHTML.apply(this._getUserBEMJSON(this._selectedItem)),BEM.DOM.append(this.elem("users-list"),e),this._accessData.type="restricted";this._multiSelect.clearData()},_removeItem:function(t){var e,i,n=$(t.target);-1!==n.attr("class").indexOf("b-acess-remove")&&(this._removeBlock=n.parent().bem("b-acess-remove"),e=parseInt(this._removeBlock.params.id),"user"===this._removeBlock.params.type?-1!==(i=this._accessData.users.indexOf(e))&&this._accessData.users.splice(i,1):"group"===this._removeBlock.params.type&&-1!==(i=this._accessData.groups.indexOf(e))&&this._accessData.groups.splice(i,1),this._accessData.users.length||this._accessData.groups.length?this._accessData.type="restricted":this._accessData.type="owner","user"===this._removeBlock.params.type?this._removeBlock.domElem.closest(".b-widget__user").remove():"group"!==this._removeBlock.params.type&&"department"!==this._removeBlock.params.type||this._removeBlock.domElem.closest(".b-widget__group").remove())},_onRestrictedLinkClick:function(t){t.block.hasMod("group","yes")&&this._showGroupUsers(t.block)},_showGroupUsers:function(t){this._currentGroupLink=t,this._currentGroup=this._currentGroupLink.findBlockOutside("b-access-group"),this._currentGroupList=this._currentGroup.findBlockInside("b-acess-group-users"),this._openedGroupUsersList&&this._openedGroupUsersList.delMod("visibility"),this._currentGroupList.hasMod("filled")?this._openedGroupUsersList!==this._currentGroup?(this._currentGroup.setMod("visibility","yes"),this._openedGroupUsersList=this._currentGroup):(this._currentGroup.delMod("visibility"),this._openedGroupUsersList=null):(BEM.DOM.after(this._currentGroupLink.domElem,this._actionLoadSpinner.domElem),this._actionLoadSpinner.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".groups/"+this._currentGroupLink.params.id,method:"GET",data:!1,urlParams:!1,path:""}).run().then(this._onGetGroupData.bind(this),BEM.blocks["wi-notification"].errorHandler(null,BEM.I18N("w-access-button","cant_get_list"))).always(function(){this._actionLoadSpinner.delMod("progress")}.bind(this)))},_onGetGroupData:function(t){var e=this,i=[];t.data.users.data.forEach(function(t){i.push(e._getUserBEMJSON(t,!1,!0))}),BEM.DOM.append(this._currentGroupList.domElem,BEMHTML.apply(i)),this._openedGroupUsersList=this._currentGroup,this._currentGroup.setMod("visibility","yes"),this._currentGroupList.setMod("filled","yes")},_resetRestricted:function(){var t=this._savedData||this.params.data,e=[this._getUserBEMJSON(t.authors,"author")];this._cleanRestricted(),BEM.DOM.append(this.elem("users-list"),BEMHTML.apply(e))},_cleanRestricted:function(){[this.elem("users-list"),this._bWikiList.domElem,this._bGroupsList.domElem,this._bServiceList.domElem].forEach(function(t){BEM.DOM.update(t,"")})},_drawRestricted:function(t){var e=this,i=[this._getUserBEMJSON(t.authors,"author")];this._cleanRestricted(),"restricted"===t.type?(t.restrictions&&t.restrictions.users.forEach(function(t){i.push(e._getUserBEMJSON(t))}),BEM.DOM.append(this.elem("users-list"),BEMHTML.apply(i)),t.restrictions&&t.restrictions.groups.forEach(function(t){switch(t.type){case 0:e._addHeaderToDom(e._bWikiList,BEM.I18N("w-access-button","wiki-groups")),BEM.DOM.append(e._bWikiList.domElem,BEMHTML.apply(e._getGroupBEMJSON(t,!0)));break;case 2:e._addHeaderToDom(e._bServiceList,BEM.I18N("w-access-button","services")),BEM.DOM.append(e._bServiceList.domElem,BEMHTML.apply(e._getGroupBEMJSON(t,!0)));break;default:e._addHeaderToDom(e._bGroupsList,BEM.I18N("w-access-button","division")),BEM.DOM.append(e._bGroupsList.domElem,BEMHTML.apply(e._getGroupBEMJSON(t,!0)))}})):BEM.DOM.append(this.elem("users-list"),BEMHTML.apply(i))},_onAccessTypeChange:function(t){var e=t.block.val();this.setMod("show-users","restricted"===e?"yes":""),"restricted"===e?(this._initAccessData(e),this._resetRestricted()):this._accessData.type=e},_focusRestrictedSuggestInput:function(){this.afterCurrentEvent(function(){this._restrictedSuggestInput.elem("control").focus()},this)},_getUserBEMJSON:function(t,e,i){var n=this;return t instanceof Array||(t=[t]),t.map(function(t){return{block:"b-widget",elem:"user",content:[{block:"m-username",mods:{dismissed:t.is_dismissed?"yes":""},mix:[{block:"mi-staff-card",js:{user:t.login}}],url:"//staff.yandex-team.ru/"+t.login,content:t.first_name+" "+t.last_name},(t.is_external_employee||"external"===t.affiliation)&&{block:"awesome-icon",mods:{icon:"warning",type:"external"},attrs:{title:BEM.I18N("w-access-button","external_user")}},"author"===e?{elem:"owner",content:{html:"&nbsp;("+BEM.I18N("b-widget","author")+")"}}:!i&&n._hasChange?{block:"b-acess-remove",js:{id:t.uid,type:"user"},content:[{elem:"close"},{elem:"text",content:BEM.I18N("w-access-button","delete")}]}:void 0]}})},_getGroupBEMJSON:function(t,e){var i;return i=e?t.name+" ("+t.users_total+")":t.name,{block:"b-widget",elem:"group",mix:{block:"b-access-group"},content:[{elem:"group-status"},{block:"link",mods:{pseudo:"yes",type:"black",group:"yes",theme:"pseudo"},js:{id:t.id},content:i},t.externals_count>0&&{block:"awesome-icon",mods:{icon:"warning",type:"external"},attrs:{title:BEM.I18N("w-access-button","external_group")}},this._hasChange&&{block:"b-acess-remove",js:{id:t.id,type:"group"},content:[{elem:"close"}]},{block:"b-acess-group-users"}]}},_addHeaderToDom:function(t,e){t.findBlockInside("b-groups-header")||BEM.DOM.append(t.domElem,BEMHTML.apply({block:"b-groups-header",content:e}))}},{REQUEST_TIMEOUT:4e4,_getType:function(t){switch(t){case"owner":return{type:"lock",text:BEM.I18N("b-widget","lock")};case"restricted":return{type:"key",text:BEM.I18N("b-widget","restricted")};case"common":return{type:"unlock",text:BEM.I18N("b-widget","common")}}}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"page-access"},{_initBlocks:function(){this._bDepartmentsList=this.findBlockInside("b-departments-list"),this.__base.apply(this,arguments)},_isAuthor:function(t){return(this._savedData||this.params.data).authors.some(function(e){return e.uid==t.id})},_onSuggestItemSelect:function(t,e){var i,n,s;if(this._selectedItem=e.entityData,"people"===this._selectedItem.layer)this._selectedItem.login=this._selectedItem.fields.find(function(t){return"login"===t.type}).value,this._selectedItem.is_dismissed=this._selectedItem.fields.find(function(t){return"is_dismissed"===t.type}).value,-1!==this._accessData.users.indexOf(parseInt(this._selectedItem.id))||this._isAuthor(this._selectedItem)||(this._accessData.users.push(parseInt(this._selectedItem.id)),i=BEMHTML.apply(this._getUserBEMJSON(this._selectedItem)),BEM.DOM.append(this.elem("users-list"),i)),this._accessData.type="restricted";else if(this._selectedItem.title&&-1===this._accessData.groups.indexOf(parseInt(this._selectedItem.id))){switch(this._selectedItem.dir_id=this._selectedItem.id,delete this._selectedItem.id,this._selectedItem.layer){case"departments":s=this._bDepartmentsList,this._addHeaderToDom(this._bDepartmentsList,BEM.I18N("w-access-button","departments")),this._selectedItem.type="department",this._accessData.departments.push(this._selectedItem.dir_id);break;case"groups":s=this._bGroupsList,this._addHeaderToDom(this._bGroupsList,BEM.I18N("w-access-button","b2b_groups")),this._selectedItem.type="group",this._accessData.groups.push(this._selectedItem.dir_id)}n=BEMHTML.apply(this._getGroupBEMJSON(this._selectedItem,!1)),BEM.DOM.append(s.domElem,n),this._accessData.type="restricted"}this._multiSelect.clearData()},_initTempData:function(){var t=this._savedData||this.params.data,e=t.authors.map(function(t){return t.uid});this._accessData={groups:[],users:[],departments:[],robots:[],type:t.type},t.restrictions&&(this._accessData.groups=_.map(t.restrictions.groups.filter(function(t){return"group"===t.type}),"dir_id"),this._accessData.departments=_.map(t.restrictions.groups.filter(function(t){return"department"===t.type}),"dir_id"),t.restrictions.users=t.restrictions.users.filter(function(t){return-1===e.indexOf(t.uid)}),this._accessData.users=_.map(t.restrictions.users,"uid")),"inherited"===t.type?this._inheritedAccessData=this._accessData:this._inheritedAccessData={type:"inherited"}},_removeItem:function(t){var e,i,n=$(t.target);-1!==n.attr("class").indexOf("b-acess-remove")&&(this._removeBlock=n.parent().bem("b-acess-remove"),"user"===this._removeBlock.params.type?(e=parseInt(this._removeBlock.params.id),-1!==(i=this._accessData.users.indexOf(e))&&this._accessData.users.splice(i,1)):"group"===this._removeBlock.params.type&&(e=this._removeBlock.params.dir_id,this._accessData.groups=this._accessData.groups.filter(function(t){return t!=e})),"department"===this._removeBlock.params.type&&(e=this._removeBlock.params.dir_id,this._accessData.departments=this._accessData.departments.filter(function(t){return t!=e})),this._accessData.users.length||this._accessData.groups.length||this._accessData.departments.length?this._accessData.type="restricted":this._accessData.type="owner","user"===this._removeBlock.params.type?this._removeBlock.domElem.closest(".b-widget__user").remove():"group"!==this._removeBlock.params.type&&"department"!==this._removeBlock.params.type||this._removeBlock.domElem.closest(".b-widget__group").remove())},_drawRestricted:function(t){var e=this,i=[this._getUserBEMJSON(t.authors,"author")];[this.elem("users-list"),this._bDepartmentsList.domElem,this._bWikiList.domElem,this._bGroupsList.domElem,this._bServiceList.domElem].forEach(function(t){t.html("")}),"restricted"===t.type?(t.restrictions&&t.restrictions.users.forEach(function(t){i.push(e._getUserBEMJSON(t))}),BEM.DOM.append(this.elem("users-list"),BEMHTML.apply(i)),t.restrictions&&t.restrictions.groups.forEach(function(t){var i;switch(t.type){case"group":i=e._bGroupsList,e._addHeaderToDom(e._bGroupsList,BEM.I18N("w-access-button","b2b_groups"));break;case"department":i=e._bDepartmentsList,e._addHeaderToDom(e._bDepartmentsList,BEM.I18N("w-access-button","departments"))}BEM.DOM.append(i.domElem,BEMHTML.apply(e._getGroupBEMJSON(t,!0)))})):BEM.DOM.append(this.elem("users-list"),BEMHTML.apply(i))},_getUserBEMJSON:function(t,e,i){var n=this;return t instanceof Array||(t=[t]),t.map(function(t){var s=t.title;return t.first_name&&t.last_name&&(s=t.first_name+" "+t.last_name),{block:"b-widget",elem:"user",content:[{block:"m-username",mods:{dismissed:t.is_dismissed?"yes":""},login:t.login,content:s||t.login},"author"===e?{elem:"owner",content:" ("+BEM.I18N("b-widget","author")+")"}:!i&&n._hasChange?{block:"b-acess-remove",js:{id:t.id||t.uid,type:"user"},content:[{elem:"close"},{elem:"text",content:BEM.I18N("w-access-button","delete")}]}:void 0]}})},_getGroupBEMJSON:function(t,e){var i;return i=e?t.title+" ("+t.users_total+")":t.title,{block:"b-widget",elem:"group",mix:{block:"b-access-group"},content:[{elem:"group-status"},{block:"link",mods:{theme:"pseudo",type:"black",group:"yes",pseudo:"yes"},js:{wiki_id:t.id||null,dir_id:t.dir_id||null,type:t.type},content:i},this._hasChange&&{block:"b-acess-remove",js:{wiki_id:t.id||null,dir_id:t.dir_id||null,type:t.type},content:[{elem:"close"},{elem:"text",content:BEM.I18N("w-access-button","delete")}]},{block:"b-acess-group-users"}]}},_showGroupUsers:function(t){this._currentGroupLink=t,this._currentGroup=this._currentGroupLink.findBlockOutside("b-access-group"),this._currentGroupList=this._currentGroup.findBlockInside("b-acess-group-users"),this._openedGroupUsersList&&this._openedGroupUsersList.delMod("visibility"),this._currentGroupList.hasMod("filled")?this._openedGroupUsersList!==this._currentGroup?(this._currentGroup.setMod("visibility","yes"),this._openedGroupUsersList=this._currentGroup):(this._currentGroup.delMod("visibility"),this._openedGroupUsersList=null):(BEM.DOM.after(this._currentGroupLink.domElem,this._actionLoadSpinner.domElem),this._actionLoadSpinner.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".groups/"+this._currentGroupLink.params.dir_id,method:"GET",data:!1,urlParams:"department"===this._currentGroupLink.params.type&&["is_department=true"],path:""}).run().then(this._onGetGroupData.bind(this),BEM.blocks["wi-notification"].errorHandler(null,BEM.I18N("w-access-button","cant_get_list"))).always(function(){this._actionLoadSpinner.delMod("progress")}.bind(this)))}},{_getType:function(t){switch(t){case"owner":return{type:"lock",text:BEM.I18N("b-widget","access_lock")};case"restricted":return{type:"key",text:BEM.I18N("b-widget","restricted")};case"common":return{type:"unlock",text:BEM.I18N("b-widget","school-common")}}}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"page-move"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.findBlockInside({block:"checkbox",modName:"type",modVal:"page-title"}).on("change",this._onCheckboxChange,this),this._subpages=this.findBlockInside("b-cluster-subpages"),this._suggest=this.findBlockInside({block:"m-suggest"}),this._checkbox=this.findBlockInside({block:"checkbox",modName:"type",modVal:"clusters"}),this._moveButton=this.findBlockInside({block:"button2",modName:"role",modVal:"move-cluster"}),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"move-cluster-cancel"}),this._pageRenameInput=this.findBlockInside({block:"input",modName:"type",modVal:"page-title"}),this._spin=this.findBlockInside({block:"spin2",modName:"type",modVal:"move-load"}),this.on("show",this._onWidgetShow,this),this._cancelButton.bindTo("click",function(){this.hide()}.bind(this)),this._moveButton.bindTo("click",this._onMoveButtonClick.bind(this)),this._pageRenameInput.bindTo("input",this._onRenameFieldChange.bind(this)),this._pageRenameInput.on("change",this._onRenameInputClear,this)}},_onRenameInputClear:function(t){t.block.val()||(this.elem("new-url-page").text(""),this._newUrl="/")},_onRenameFieldChange:function(){var t=this._newUrl.split("/"),e=this._pageRenameInput.elem("control").val();t.pop(),this.pageSlug=e,-1!==e.indexOf("/")&&(this.pageSlug=e.replace(/\//g,""),this._pageRenameInput.elem("control").val(this.pageSlug)),this._newUrl=t.concat(this.pageSlug).join("/"),this.elem("new-url-page").text(this._newUrl)},_onCheckboxChange:function(t,e){e.checked?(this.setMod("page-title","visible"),this._pageRenameInput.val(this._pageName.slice(1))):(this.delMod("page-title"),this.elem("new-url-page").text(this._pageName),this._newUrl=this._pageName)},_onMoveButtonClick:function(){var t;this._movedUrl?(t=this._movedUrl,"/"===this._movedUrl.slice(-1)?t+=this._newUrl.substr(1):t+=this._newUrl):t=this._newUrl,t=this._сutUnusedSlashes(t),this._updatedUrl=t,this._spin.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".move",method:"PUT",data:{destination:t,move_cluster:this._checkbox.isChecked()},urlParams:!1,path:this.params.ajaxPath}).run().then(this._onPageMove.bind(this),BEM.blocks["wi-notification"].errorHandler(this._moveButton.domElem,BEM.I18N("b-widget","cant_move_cluster"))).always(function(){this._spin.delMod("progress")}.bind(this))},"_сutUnusedSlashes":function(t){var e;return/(http?\w+:).+/.exec(t)?((e=(t=t.replace(/^\/+/,"")).split(":"))[1]=e[1].replace(/\/+/g,"/"),t=e.join(":/")):t=t.replace(/\/+/g,"/"),t},_onWidgetShow:function(){this._fillWidgetWithData(),this._setNewPageHTML(),this._clusterPath=this._getClusterPath(),this._newUrl=this.pageSlug,this._pageName=this.pageSlug,this._movedUrl=this._clusterPath,this._suggest.val(this._clusterPath),this.elem("new-url-page").text(this.pageSlug)},_getClusterPath:function(){var t=this.tag.split("/");return t.pop(),t.join("/")},_onPageMove:function(){location.href=this._updatedUrl},_fillWidgetWithData:function(){this.tag="/"+BEM.WISTORE.get("page").get("tag"),this.splitedSupertag=this.tag.split("/"),this.params.isAction&&this.params.source&&(this.tag=this.params.source),this.pageSlug="/"+this.splitedSupertag.pop(),this.params.data.subpages_count&&(this.setMod(this.elem("current-address-subpages"),"visibility","visible"),BEM.DOM.update(this._checkbox.elem("label"),BEMHTML.apply([BEM.I18N("b-widget","move_the_cluster")+" ",{block:"link",mods:{theme:"pseudo",pseudo:"yes",type:"show-subpages"},content:BEM.I18N("b-widget","cluster_subpages",{count:2})}," ("+this.params.data.subpages_count+")"])),this.findBlockInside({block:"link",modName:"type",modVal:"show-subpages"}).on("click",this._onShowSubpagesLinkClick,this)),this.elem("current-address-url").text(location.host+this.tag+"/"),this.elem("new-url").text(location.host+this.splitedSupertag.join("/"))},_setNewPageHTML:function(){this._pageName="",this._clusterPath="",this._suggest.on("select change",function(t,e){this._updateNewUrl("select"===t.type?e.entityData.tag:e)},this)},_updateNewUrl:function(t){"/"!==t&&this.elem("new-url").text(location.host+t),this._movedUrl=t},_onShowSubpagesLinkClick:function(){this.hide(!0),BEM.channel("common").trigger("w-action.create-tree",{baseWidgetData:{showEvent:"w-action.create-move"}})}}),BEM.DOM.decl({block:"m-suggest",modName:"type",modVal:"cluster"},{_sendRequest:function(){var t=this;this._input.val()?BEM.create("wi-api-request",{apiPath:".autocomplete",method:"GET",data:!1,urlParams:["tag="+this._getInputValue4Request()+"&offset=0&limit=10"],path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(function(e){t.setState({result:e})},this._onFailRequest.bind(this)):this._popup&&this._popup.delMod("visible")},_isNotEmptyResult:function(t){return Boolean(t&&t.data&&t.data.data&&t.data.data.length)},_getItemsHTML:function(t){var e=t.data.data,i=this;return BEMHTML.apply(e.map(function(t){return t.tag="/"+t.tag,i._getItemBEMJSON("cluster",t)}))},_selectItem:function(t,e){this.val(t,!0),this.__base.apply(this,arguments),this._items[this._curItemIndex]&&this._items[this._curItemIndex].delMod("hovered"),this._curItemIndex=-1,this._popup.delMod("visible")}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"subscribe"},{_subscribeUsersUids:[],onSetMod:{js:function(){this.__base.apply(this,arguments),this._suggestBlock=this.findBlockInside("m-suggest"),this._commentBlock=this.findBlockInside({block:"input",modName:"subscribe",modVal:"comment"}),this._cancel=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}),this._close=this.findBlockInside({block:"button2",modName:"role",modVal:"close"}),this._save=this.findBlockInside({block:"button2",modName:"role",modVal:"save"}),this._spinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"subscribe-load"}),this._tabsMenu=this.findBlockInside("tabs-menu").on("change",this._onTabChange,this),this._tabs=this.findBlockInside("tabs"),this._suggestBlock.on("select unselect",this._onSuggestChange,this),this._cancel.on("click",this._onCancelClick,this),this._close.on("click",this._onCancelClick,this),this._save.on("click",this._onSave,this),this._subscribers=this.params.subscribers}},show:function(t,e,i){this.__base.apply(this,arguments),this._suggestBlock._input.val("").elem("control").focus(),this._commentBlock.clearInput(),this._save.setMod("disabled","yes"),this._updateSubscribers(e),this._tabs.activate(i?1:0)},hide:function(){this.__base.apply(this,arguments),this._clearData(),this.delMod("status"),BEM.blocks["wi-history"].removeState()},_onCancelClick:function(){this.hide()},_updateSubscribers:function(t){t&&(this._subscribers=t),this.findBlockInside(this._tabsMenu.findElem("tab","type","subscribers"),"link").domElem.text(BEM.I18N("b-widget","subscribers")+(this._subscribers.length?" "+this._subscribers.length:"")),BEM.DOM.update(this.elem("subscribers"),BEMHTML.apply(this._subscribers.length?this._subscribers.map(function(t){return{block:"b-widget",elem:"subscriber",content:{block:"m-username",mods:{dismissed:t.is_dismissed?"yes":""},mix:[{block:"mi-staff-card",js:{user:t.login}}],url:"//staff.yandex-team.ru/"+t.login,content:t.display}}}):{block:"b-widget",elem:"no-subscribers",content:BEM.I18N("b-widget","no-subscribers")}))},_clearData:function(){this._subscribeUsersUids=[],this._suggestBlock.clearData()},_onSuggestChange:function(t){this._subscribeUsersUids=t.block.getData().map(function(t){return t.fullData.uid}),this._save.setMod("disabled",this._subscribeUsersUids.length?"":"yes")},_getDataForRequest:function(){return{uids:this._subscribeUsersUids,comment:this._commentBlock.val()}},_onSave:function(){this._save.setMod("disabled","yes"),this._spinner.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".masswatch",method:"POST",data:this._getDataForRequest(),urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this.onSuccessSubscribe.bind(this),BEM.blocks["wi-notification"].errorHandler(this._save.domElem)).always(function(){this._save.delMod("disabled"),this._spinner.delMod("progress")}.bind(this))},onSuccessSubscribe:function(){this.setMod("status","subscribed");var t=this._suggestBlock.getData();t&&t.map(function(t){var e=!1;this._subscribers.forEach(function(i){i.login===t.fullData.login&&(e=!0)}),e||(t.fullData.display=t.fullData.first_name&&t.fullData.last_name?t.fullData.first_name+" "+t.fullData.last_name:t.fullData.login,this._subscribers.push(t.fullData))},this),this._suggestBlock.clearData(),this._updateSubscribers()},_onTabChange:function(t,e){this.setMod("subscribers",e.currentIndex?"yes":""),e.currentIndex||this.afterCurrentEvent(function(){this._suggestBlock._input.elem("control").focus()},this)}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"subscribe"},{_updateSubscribers:function(t){t&&(this._subscribers=t),this.findBlockInside(this._tabsMenu.findElem("tab","type","subscribers"),"link").domElem.text(BEM.I18N("b-widget","subscribers")+(this._subscribers.length?" "+this._subscribers.length:"")),BEM.DOM.update(this.elem("subscribers"),BEMHTML.apply(this._subscribers.length?this._subscribers.map(function(t){var e=t.title;return t.first_name&&t.last_name&&(e=t.first_name+" "+t.last_name),t.login||(t.login=t.fields.find(function(t){return"login"===t.type}).value,t.is_dismissed=t.fields.find(function(t){return"is_dismissed"===t.type}).value),{block:"b-widget",elem:"subscriber",content:{block:"m-username",mods:{dismissed:t.is_dismissed?"yes":""},login:t.login,content:e||t.login}}}):{block:"b-widget",elem:"no-subscribers",content:BEM.I18N("b-widget","no-subscribers")}))},_onSuggestChange:function(t){this._subscribeUsersUids=t.block.getData().map(function(t){return t.fullData.id}),this._save.setMod("disabled",this._subscribeUsersUids.length?"":"yes")}}),BEM.DOM.decl("tabs-panes",{onElemSetMod:{pane:{active:{yes:function(t,e,i){var n=this.findPane("active","yes");n.attr("aria-expanded",!1),t.attr("aria-expanded",!0),this.delMod(n,"active")}}}},_onControlChange:function(t,e){-1!==e.currentIndex?this.setMod(this.findPane().eq(e.currentIndex),"active","yes"):this.delMod(this.findPane().eq(e.prevIndex),"active")},findPane:function(t,e){return this.domElem.children(this.buildSelector("pane",t,e))}},{getSupportedControls:function(){return["tabs"]},live:function(){this.getSupportedControls().forEach(function(t){BEM.blocks[t]&&this.liveInitOnBlockEvent("change",t,function(t,e){this._onControlChange(t,e)})},this)}}),BEM.DOM.decl("tabs-menu",{onSetMod:{js:{inited:function(){this._linksCache=[],this._isSwitching=!1}}},onElemSetMod:{tab:{active:{yes:function(t){if(this.hasMod(t,"outer"))return!1;var e=this.getActive();this._isSwitching=!0,this.delMod(e,"active"),this._isSwitching=!1,this.trigger("change",{current:t,prev:e,currentIndex:this.indexOfTab(t),prevIndex:this.indexOfTab(e)})},"":function(t){this._isSwitching||this.trigger("change",{current:$(),prev:t,currentIndex:-1,prevIndex:this.indexOfTab(t)})}},disabled:function(t,e,i){var n=this._getLink(t).setMod("disabled",i);this.hasMod(t,"interactive","yes")&&(n.domElem.removeAttr("tabindex"),i?t.attr("aria-disabled",!0):t.removeAttr("aria-disabled"))}}},getActive:function(){return this.findElem("tab","active","yes")},getTab:function(t){return this.elem("tab","interactive","yes").eq(t)},indexOfTab:function(t){return $.inArray(t.get(0),this.elem("tab","interactive","yes"))},_getTabByElem:function(t){return t.closest(this.buildSelector("tab"))},_getLink:function(t){var e=$.inArray(t.get(0),this.elem("tab"));return this._linksCache[e]||(this._linksCache[e]=this.findBlockInside(t,"link"))},_activateRelative:function(t){var e=this.elem("tab","interactive","yes").not(this.findElem("tab","disabled","yes")),i=$.inArray(this.getActive().get(0),e)+t;i<0||i>e.length||this.setMod(e.eq(i),"active","yes")},_onTabClick:function(t){this.setMod(this._getTabByElem($(t.target)),"active","yes")},_onTabKeyDown:function(t){if(!(t.shiftKey||t.ctrlKey||t.altKey||t.metaKey)){var e=BEM.blocks.keycodes;e.is(t.keyCode,"RIGHT","DOWN")?(t.preventDefault(),this._activateRelative(1)):e.is(t.keyCode,"LEFT","UP")&&(t.preventDefault(),this._activateRelative(-1))}}},{live:function(){this.liveBindTo("tab","pointerclick",function(t){this.hasMod($(t.data.domElem),"disabled")||this._onTabClick(t)}).liveBindTo("tab","keydown",function(t){this._onTabKeyDown(t)})}}),BEM.DOM.decl("tabs-menu",{onElemSetMod:{tab:{active:{yes:function(t){var e=this.getActive();if(!1===this.__base.apply(this,arguments))return!1;t.attr("tabindex",0),t.focus(),e.removeAttr("tabindex")}},disabled:function(t,e,i){this.__base.apply(this,arguments),i&&this.hasMod(t,"active")?t.attr("tabindex",0):t.removeAttr("tabindex")}}},_onTabEnter:function(t,e){this.setMod(t,"hovered","yes")},_onTabLeave:function(t,e){this.delMod(t,"hovered")}},{live:function(){return this.liveBindTo("tab","pointerover pointerout",function(t){var e=t.data.domElem;this.hasMod(e,"disabled")||e[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onTabEnter(e,t):this._onTabLeave(e,t))}),this.__base()}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"unsubscribe"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}).on("click",this._onCancelClick,this),this._unsubscribeButton=this.findBlockInside({block:"button2",modName:"role",modVal:"unsubscribe"}).on("click",this._unsubscribe,this),this._unsubscribeSpinner=this.findBlockInside("spin2")}},_unsubscribe:function(){this._unsubscribeButton.setMod("disabled","yes"),this._unsubscribeSpinner.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".massunwatch",method:"POST",urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onSuccessUnsubscribe.bind(this),BEM.blocks["wi-notification"].errorHandler(this._unsubscribeButton.domElem)).always(function(){this._unsubscribeButton.delMod("disabled"),this._unsubscribeSpinner.delMod("progress")}.bind(this))},_onSuccessUnsubscribe:function(){BEM.WISTORE.get("page").set("userSubscription","none"),this.hide()},_onCancelClick:function(){this.hide()}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"page-settings"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._settings=this.findBlocksInside("w-page-setting"),BEM.blocks["w-page-setting"].on(this.domElem,"activate",this._onSettingActivate,this),BEM.blocks["w-page-setting"].on(this.domElem,"change",this._onSettingChange,this),BEM.blocks["w-page-setting"].on(this.domElem,"hide",this.hide,this),this._readonlyCheckbox=this.findBlockInside({block:"checkbox",modName:"role",modVal:"readonly"}).on("change",this._onReadonlyChange,this),this._dialog=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"modal",mods:{theme:"normal",autoclosable:"yes","agree-settings":"yes"},content:[{block:"b-widget",elem:"header",content:BEM.I18N("b-widget","confirmation-text")},{block:"button2",mods:{size:"s",theme:"action"},mix:{block:"b-widget",elem:"agree-button"},text:BEM.I18N("b-widget","confirm")}]})).bem("modal").on("beforeOpen",this._onDialogShow,this).on("afterClose",this._onDialogHide,this),this._dialog.findBlockInside("button2").on("click",this._onAgreeButtonClick,this)}},show:function(t){this.__base.apply(this,arguments),this.afterCurrentEvent(function(){this.afterCurrentEvent(function(){this.bindToDoc("pointerclick",this._reloadRequest)})},this),this._settings.forEach(function(e){t&&e.getMod("type")===t&&this.params.canEdit?e.setMod("active","yes"):e.delMod("active")},this),BEM.DOM.update(this.elem("redirected-from"),BEMHTML.apply(this._getRedirectedFromMessage())),this._dataChanged=!1},hide:function(){this.__base.apply(this,arguments),this.unbindFromDoc("pointerclick",this._reloadRequest)},_onReadonlyChange:function(t,e){if(this._preventReadonlyChange)this._preventReadonlyChange=!1;else{this._readonlyCheckbox.setMod("disabled","yes");var i=this;BEM.create("wi-api-request",{apiPath:".readonly",method:"POST",data:{is_readonly:e.checked,for_cluster:!1},urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(function(){i._readonlyCheckbox.delMod("disabled"),BEM.WISTORE.get("page").set("isReadonly",i._readonlyCheckbox.hasMod("checked","yes"))},function(){i._preventReadonlyChange=!0,i._readonlyCheckbox.delMod("disabled").toggleMod("checked","yes","")})}},_getRedirectedFromMessage:function(){var t=BEM.WISTORE.stores.page&&BEM.WISTORE.stores.page.get("redirectedFrom");return t?[BEM.I18N("b-widget","redirected_from")+" ",{block:"link",url:t,content:t}]:""},_onDialogShow:function(){this.unbindFromDoc("pointerclick",this._reloadRequest),$(document).off("keydown.widget")},_onDialogHide:function(){this.bindToDoc("pointerclick",this._reloadRequest),$(document).on("keydown.widget",this._onKeyUp.bind(this))},_onSettingActivate:function(t){this._settings.forEach(function(e){t.block!==e&&e.delMod("active")})},_onSettingChange:function(t){-1===["keywords","comments","authors"].indexOf(t.block.getMod("type"))&&(this._dataChanged=!0)},_reloadRequest:function(t){t&&($(t.target).is(this.elem("content"))||this.elem("content").find(t.target).length||this.__self._inPopup($(t.target)))||(this._dataChanged?this._dialog.setMod("visible","yes"):this.hide())},_onAgreeButtonClick:function(){location.href=this.params.ajaxPath},_onKeyUp:function(t){27===t.keyCode&&this._reloadRequest()}},{_inPopup:function(t){for(var e=!1;t.length;){if(t.hasClass("m-suggest-item")||t.hasClass("m-suggest-group")||t.hasClass("menu__text")||t.hasClass("select2__menu")){e=!0;break}t=t.parent()}return e}}),BEM.DOM.decl("w-page-setting",{onSetMod:{js:function(){this.bindTo("click",this._onClick.bind(this)),this._data=this.params.data,this._initBlocks()},progress:function(t,e){this._spinner.setMod("progress","yes"===e?"yes":"")},active:function(t,e){this.domElem.attr({title:"yes"===e?null:this._title})}},_initBlocks:function(){this._spinner=this.findBlockInside("spin2")},_onClick:function(){this.hasMod("active")||this.setMod("active","yes").trigger("activate")}}),BEM.DOM.decl({block:"w-page-setting",modName:"type",modVal:"authors"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._title=BEM.I18N("w-page-setting","setup-authors")},progress:function(t,e){this.__base.apply(this,arguments),this._suggest.setMod("disabled",e),this._saveButton.setMod("disabled",e)}},_initBlocks:function(){this.__base.apply(this,arguments),this._suggest=this.findBlockInside("multiple-suggest"),this._suggest.init({staff:this._data.authors}),this._saveButton=this.findBlockInside({block:"button2",modName:"role",modVal:"save-authors"}).on("click",this._onSaveButtonClick,this),this._massAuthorChangeLink=this.findBlockInside({block:"link",modName:"type",modVal:"mass-change-author"}),this._massAuthorChangeLink.bindTo("click",this._onMassAuthorChangeLinkClick.bind(this)),this._getAuthorshipButton=this.findBlockInside(this.findElem("get-authorship"),"button2"),this._getAuthorshipButton&&this._getAuthorshipButton.on("click",this._onGetAuthorshipButtonClick,this)},_onGetAuthorshipButtonClick:function(){this.trigger("hide"),BEM.channel("common").trigger("w-action.create-request-authorship")},_onMassAuthorChangeLinkClick:function(){this.trigger("hide"),BEM.channel("common").trigger("w-action.create-subpages-change-author",{authors:this._data.authors,path:this.params.path,baseWidgetData:{showEvent:"w-action.create-settings",showData:{tab:"authors"}}})},_onClick:function(t){var e=this.findBlockInside(this.findElem("data-preview"),"button2");e&&$(t.target).is(e.domElem)||this.__base.apply(this,arguments)},_onSaveButtonClick:function(){this._data.authors=this._suggest.get("staff"),this._save(this._data.authors.map(function(t){return Number(t.uid)}))},_save:function(t){t.length?(this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".authors",method:"POST",path:this.params.path,data:{authors:t}}).run().then(this._onDataSave.bind(this),this._onDataSaveError.bind(this)).always(function(){this.delMod("progress")}.bind(this))):BEM.channel("notification").trigger("error",BEM.I18N("w-page-setting","no_authors_error"))},_onDataSave:function(){BEM.WISTORE.get("page").set({authors:_.clone(this._data.authors)}),this.trigger("change")},_onDataSaveError:function(){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("w-page-setting","cant_set_author")))}}),BEM.DOM.decl({block:"w-page-setting",modName:"type",modVal:"authors"},{_initBlocks:function(){this._spinner=this.findBlockInside("spin2"),this._suggest=this.findBlockInside("multiple-suggest"),this._suggest.init({people:this._data.authors}),this._saveButton=this.findBlockInside({block:"button2",modName:"role",modVal:"save-authors"}).on("click",this._onSaveButtonClick,this),this._getAuthorshipButton=this.findBlockInside(this.findElem("get-authorship"),"button2"),this._getAuthorshipButton&&this._getAuthorshipButton.on("click",this._onGetAuthorshipButtonClick,this),this._massAuthorChangeLink=this.findBlockInside({block:"link",modName:"type",modVal:"mass-change-author"}),this._massAuthorChangeLink.bindTo("click",this._onMassAuthorChangeLinkClick.bind(this))},_onSaveButtonClick:function(){this._data.authors=this._suggest.get("people"),this._save(this._data.authors.map(function(t){return Number(t.uid||t.id)}))}}),BEM.DOM.decl("multiple-suggest",{onSetMod:{js:{inited:function(){this._data={},this.params.types.forEach(function(t){this._data[t]=[]},this),this._suggest=this.findBlockInside("m-suggest").on("select",this._onSuggestItemSelect,this),BEM.blocks["multiple-suggest-item"].on("remove",this._onItemRemove,this)}},disabled:function(t,e){this._suggest.setMod("disabled",e)}},_list:{},destruct:function(){this._suggest.un("select"),BEM.blocks["multiple-suggest-item"].un("remove")},init:function(t){Object.keys(t).forEach(function(e){t[e].forEach(function(t){this._addItem(t,e)},this)},this)},get:function(t){return this._data[t]},_onSuggestItemSelect:function(t,e){var i=this._getItemType(e.entityData),n=this.__self._transformData(e.entityData,i);this._addItem(n,i),this._suggest.clearData()},_getList:function(t){return this._list[t]||(this._list[t]=BEM.DOM.append(this.domElem,BEMHTML.apply({block:"multiple-suggest-list",mods:{type:t},content:[this.params.listHeaders&&{elem:"header",content:BEM.I18N("multiple-suggest",t)},{elem:"items"}]})).bem("multiple-suggest-list")),this._list[t]},_getItemID:function(t){return Number(t.uid||t.id)},_getItemType:function(t){return t._type},_addItem:function(t,e){var i=this._getItemID(t);-1===this._data[e].map(this._getItemID).indexOf(i)&&(BEM.DOM.append(this._getList(e).findElem("items"),BEMHTML.apply({block:"multiple-suggest-item",mods:{type:e},js:{id:i},data:t,active:this.params.active})),this._data[e].push(t))},_onItemRemove:function(t,e){var i=e.type,n=this._data[i].map(this._getItemID).indexOf(e.id);-1!==n&&(this._data[i].splice(n,1),t.target.destruct())}},{_transformData:function(t,e){return"staff"===e&&(t.first_name&&t.last_name?t.display=t.first_name+" "+t.last_name:t.display=t.login),t}}),BEM.DOM.decl("multiple-suggest",{_getItemType:function(t){return t.layer}},{_transformData:function(t,e){return t.fields.forEach(function(e){t[e.type]=e.value}),"people"===e&&(t.display=t.title),t}}),BEM.DOM.decl("multiple-suggest-item",{_onClick:function(t){t.stopPropagation(),this.trigger("remove",{id:this.params.id,type:this.getMod("type")})}},{live:function(){this.liveBindTo("remove","click",this.prototype._onClick)}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"subpages-change-author"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-subpages-change-author",this._run,this)}},_run:function(t,e){this.__base.apply(this,arguments)&&(this._pushState(e,".subpages-change-author"),e.baseWidgetData&&(this._baseWidgetData=e.baseWidgetData),this._widget||(this._widget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"subpages-change-author"},authors:BEM.WISTORE.get("page").get("authors"),currentUser:BEM.WISTORE.get("page").get("currentUser"),baseWidgetData:this._baseWidgetData||null})).bem("b-widget")),this._widget.show())}}),BEM.DOM.decl({block:"w-page-setting",modName:"type",modVal:"keywords"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._title=BEM.I18N("w-page-setting","setup-keywords")},progress:function(t,e){this.__base.apply(this,arguments),[this._tagsInput].concat(this.findBlocksInside("w-baloon")).forEach(function(t){t.setMod("disabled","yes"===e?"yes":"")}),this._addTagsButton.setMod("disabled","yes"!==e&&this._tagsInput.val()?"":"yes")},active:function(t,e){this.__base.apply(this,arguments),"yes"===e&&(this._tagsInput.val(""),this._addTagsButton.setMod("disabled","yes"))}},_initBlocks:function(){this.__base.apply(this,arguments),this._tagsInput=this.findBlockInside("input").on("change",this._onTagsInputChange,this),this._tagsInput.bindTo(this._tagsInput.elem("box"),"keyup",this._onTagsInputKeyDown.bind(this)),this._addTagsButton=this.findBlockInside("button2").on("click",this._addTags,this),BEM.blocks["w-baloon"].on(this.domElem,"clear-click",this._onBaloonClearClick,this)},_onBaloonClearClick:function(t,e){var i,n=this._data.indexOf(e);(i=this._data.slice()).splice(n,1),this.setMod("progress","yes"),this._save(i)},_save:function(t){BEM.create("wi-api-request",{apiPath:".keywords",method:"PUT",path:this.params.path,data:{keywords:t}}).run().then(this._onDataSave.bind(this,t),this._onDataSaveError.bind(this))},_onTagsInputChange:function(t){this._addTagsButton.setMod("disabled",""===t.block.val()?"yes":"")},_onTagsInputKeyDown:function(t){13===t.keyCode&&this._addTags()},_addTags:function(){var t,e=this.__self._processInputValue(this._tagsInput.val());1===e.length&&""===e[0]&&(e=[]),t=this._data.concat(e),this.setMod("progress","yes"),this._save(t)},_onDataSave:function(t){this._data=t,this.delMod("progress"),this._tagsInput.val(""),BEM.DOM.update(this.elem("keywords"),BEMHTML.apply(t.map(function(t){return{block:"w-baloon",text:t}},this))),this.elem("data-preview").text(this._data.join(", ")||BEM.I18N("w-page-setting","no-keywords")),this._tagsInput.elem("control").focus(),this.trigger("change")},_onDataSaveError:function(){this.delMod("progress"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this._addTagsButton.domElem,BEM.I18N("w-page-setting","cant_set_keywords")))}},{_processInputValue:function(t){return t.replace(/ {2}/g,"").replace(/( , )|( ,)|(, )/g,",").split(",")}}),BEM.DOM.decl("i-ua",{},{placeholder:"placeholder"in document.createElement("input")}),BEM.DOM.decl("w-baloon",{onSetMod:{js:function(){this._subscribe()},disabled:function(t,e){"yes"===e?this._unsubscribe():this._subscribe()}},_subscribe:function(){this.bindTo(this.elem("clear"),"click",this._onClearClick.bind(this))},_unsubscribe:function(){this.unbindFrom(this.elem("clear"),"click")},_onClearClick:function(){this.trigger("clear-click",this.params.text)}}),BEM.DOM.decl({block:"w-page-setting",modName:"type",modVal:"comments"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._title=BEM.I18N("w-page-setting","setup-comments")},progress:function(t,e){this.__base.apply(this,arguments),this._enabledSelect.setMod("disabled",e),this._setWithSubpagesCheckboxMod("disabled",e)}},_initBlocks:function(){this.__base.apply(this,arguments),this._enabledSelect=this.findBlockInside("select2").on("change",this._onElabledSelectChange,this),this._withSubpagesCheckbox=this.findBlockInside("checkbox"),this._withSubpagesCheckbox&&this._withSubpagesCheckbox.on("change",this._onWithSubpagesCheckboxChange,this),this._saveButton=this.findBlockInside({block:"button2",modName:"role",modVal:"save-comments"}).on("click",this._onSaveButtonClick,this)},_onElabledSelectChange:function(t){this._saveButton.delMod("disabled"),this._withSubpagesCheckbox&&this._withSubpagesCheckbox.setMod("checked","yes")},_onSaveButtonClick:function(){this.setMod("progress","yes");var t="off"===this._enabledSelect.getVal();BEM.create("wi-api-request",{apiPath:".comments/status",method:"POST",path:this.params.path,data:{disabled:t,for_cluster:!!this._withSubpagesCheckbox&&this._withSubpagesCheckbox.isChecked()},urlParams:!1}).run().then(this._onDataSave.bind(this,t),this._onDataSaveError.bind(this))},_onDataSave:function(t,e){this.delMod("progress"),this._data=e,this._saveButton.setMod("disabled","yes"),BEM.WISTORE.get("page").set("comments",!t),this.trigger("change")},_onDataSaveError:function(t){this.delMod("progress"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("w-page-setting","cant_set_comments")))},_onWithSubpagesCheckboxChange:function(){this._saveButton.delMod("disabled")},_getWithSubpagesCheckboxVal:function(){return!!this._withSubpagesCheckbox&&this._withSubpagesCheckbox.isChecked()},_setWithSubpagesCheckboxMod:function(t,e){this._withSubpagesCheckbox&&this._withSubpagesCheckbox.setMod(t,e)}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"approve-rejected-access"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}).on("click",function(){this.hide()},this)}}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"authorship"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}).on("click",this._onCancelClick,this),this._sendButton=this.findBlockInside({block:"button2",modName:"role",modVal:"send"}).on("click",this._sendMessage,this),this._messageInput=this.findBlockInside("input"),this._sendSpinner=this.findBlockInside("spin2")},progress:function(t,e){var i=e?"yes":"";this._sendSpinner.setMod("progress",i),this._sendButton.setMod("disabled",i),this._cancelButton.setMod("disabled",i)}},show:function(){this.__base.apply(this,arguments),this._messageInput.elem("control").focus()},_onCancelClick:function(){this.hide()},_sendMessage:function(){this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".request_page_author",method:"PUT",data:{reason:this._messageInput.val()},path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onRequestSuccess.bind(this),this._onRequestFail.bind(this)).always(function(){this.delMod("progress")}.bind(this))},_onRequestSuccess:function(t){var e;t.data.new_author&&((e=_.clone(BEM.WISTORE.get("page").get("authors"))).push(t.data.new_author),BEM.WISTORE.get("page").set("authors",e),this.hide(),location.reload()),this.hide()},_onRequestFail:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,t))}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"page-copy"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._copyDataCheckbox=this.findBlockInside({block:"checkbox",modName:"type",modVal:"copy-data"}),this._renameCheckbox=this.findBlockInside({block:"checkbox",modName:"type",modVal:"page-title"}).on("change",this._onRenameCheckboxChange,this),this._pageRenameInput=this.findBlockInside({block:"input",modName:"type",modVal:"page-title"}).on("change",this._onRenameInputChange,this),this._suggest=this.findBlockInside({block:"m-suggest"}),this._copyButton=this.findBlockInside({block:"button2",modName:"role",modVal:"copy-cluster"}),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"copy-cluster-cancel"}),this._spin=this.findBlockInside({block:"spin2",modName:"type",modVal:"copy-load"}),this.on("show",this._onWidgetShow,this),this._cancelButton.on("click",this._onCancelClick,this),this._copyButton.on("click",this._onCopyButtonClick,this)}},_onCancelClick:function(){this.hide()},_onRenameInputChange:function(t){var e=this._newUrl.split("/"),i=this._pageRenameInput.elem("control").val();e.pop(),this.pageSlug=i,-1!=i.indexOf("/")&&(this.pageSlug=i.replace(/\//g,""),this._pageRenameInput.elem("control").val(this.pageSlug)),this._newUrl=e.concat(this.pageSlug).join("/"),this.elem("new-url-page").text(this._newUrl)},_onRenameCheckboxChange:function(t,e){e.checked?(this.setMod("page-title","visible"),this._pageRenameInput.val(this._pageName.slice(1))):(this.delMod("page-title"),this.elem("new-url-page").html(this._pageName),this._newUrl=this._pageName)},_onCopyButtonClick:function(){var t;this._copiedUrl?(t=this._copiedUrl,"/"==this._copiedUrl.slice(-1)?t+=this._newUrl.substr(1):t+=this._newUrl):t=this._newUrl,t=this.__self._сutUnusedSlashes(t),this._spin.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".grid/clone",method:"POST",data:{destination:t,with_data:this._copyDataCheckbox.isChecked()},urlParams:!1,path:this.params.ajaxPath}).run().then(this._onPageCopy.bind(this,t),BEM.blocks["wi-notification"].errorHandler(this._copyButton.domElem,BEM.I18N("b-widget","cant_copy_cluster"))).always(function(){this._spin.delMod("progress")}.bind(this))},_onWidgetShow:function(){this._fillWidgetWithData(),this._setNewPageHTML(),this._clusterPath=this._getClusterPath(),this._newUrl=this.pageSlug,this._pageName=this.pageSlug,this._copiedUrl=this._clusterPath,this._suggest.val(this._clusterPath),this.elem("new-url-page").html(this.pageSlug)},_getClusterPath:function(){var t=this.tag.split("/");return t.pop(),t.join("/")},_onPageCopy:function(t){location.href=t},_fillWidgetWithData:function(){this.tag="/"+BEM.WISTORE.get("page").get("tag"),this.splitedSupertag=this.tag.split("/"),this.params.isAction&&this.params.source&&(this.tag=this.params.source),this.pageSlug="/"+this.splitedSupertag.pop(),this.elem("current-address-url").html(location.host+this.tag+"/"),this.elem("new-url").html(location.host+this.splitedSupertag.join("/"))},_setNewPageHTML:function(){this._pageName="",this._clusterPath="",this._suggest.on("select change",function(t,e){this._updateNewUrl("select"===t.type?e.entityData.tag:e)},this)},_updateNewUrl:function(t){"/"!=t&&this.elem("new-url").html(location.host+t),this._copiedUrl=t}},{"_сutUnusedSlashes":function(t){var e;return/(http?\w+:).+/.exec(t)?((e=(t=t.replace(/^\/+/,"")).split(":"))[1]=e[1].replace(/\/+/g,"/"),t=e.join(":/")):t=t.replace(/\/+/g,"/"),t}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"page-delete"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}).on("click",this._onCancelClick,this),this._pageRemoveButton=this.findBlockInside({block:"button2",modName:"role",modVal:"page-delete"}).on("click",this._removePage,this),this._pageRemoveSpinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"page-delete"})},progress:{yes:function(){this._pageRemoveSpinner.setMod("progress","yes"),this._pageRemoveButton.setMod("disabled","yes"),this._cancelButton.setMod("disabled","yes")},"":function(){this._pageRemoveSpinner.delMod("progress"),this._pageRemoveButton.delMod("disabled"),this._cancelButton.delMod("disabled")}}},_onCancelClick:function(){this.hide()},_removePage:function(){this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:"",method:"DELETE",data:!1,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onPageDelete.bind(this),this._onPageDeleteError.bind(this)).always(function(){this.delMod("progress")}.bind(this))},_onPageDelete:function(){var t=null,e=this.params.breadcrumbs;e&&e.forEach(function(i,n){n!==e.length-1&&!0===i.is_active&&(t=i.url)}),window.location.pathname=t||"/"},_onPageDeleteError:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this._pageRemoveButton.domElem,BEM.I18N("b-widget","cant_delete_page"),t))}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"page-export"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._typeRadioButton=this.findBlockInside({block:"radio-button",modName:"role",modVal:"export-type"}).on("change",this._updateFileType,this),this._countRadioBox=this.findBlockInside({block:"radiobox",modName:"role",modVal:"export-count"}),this._countRadioBox&&this._countRadioBox.on("change",this._updateFileType,this);var t=this.findBlockInside({block:"link",modName:"role",modVal:"tree"});t&&t.bindTo("click",this._showTree.bind(this)),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}).on("click",this._onCancelClick,this),this._downloadButton=this.findBlockInside({block:"button2",modName:"role",modVal:"download"}).on("click",this._onDownloadClick,this),this._downloadSpinner=this.findBlockInside({block:"spin2",modName:"role",modVal:"download"})},progress:function(t,e){this._cancelButton.setMod("disabled",e),this._downloadButton.setMod("disabled",e),this._typeRadioButton.setMod("disabled",e),this._countRadioBox&&this._countRadioBox.setMod("disabled",e),this._downloadSpinner.setMod("progress",e)}},_showTree:function(){this.hide(!0),BEM.channel("common").trigger("w-action.create-tree",{baseWidgetData:{showEvent:"w-action.create-export"}})},_onCancelClick:function(){this.hide()},_updateFileType:function(){var t="."+(this._withSubpages()?"zip":this._typeRadioButton.val());BEM.DOM.update(this.elem("file-type"),t),this.elem("file").attr("title",this._getFilename())},_getFilename:function(){var t="."+(this._withSubpages()?"zip":this._typeRadioButton.val());return this.params.filename+t},_onDownloadClick:function(){var t=["ext="+this._typeRadioButton.val()];this._withSubpages()&&t.push("with_subpages=True"),this.setMod("progress","yes"),BEM.create("wi-long-task-requester",{callForResultParams:{apiPath:".export",method:"GET",urlParams:t,download:!0,path:BEM.blocks["wi-history"].getCorrectPath(),timeout:0},hideProgressBarCallback:function(){this.delMod("progress")}.bind(this)}).run().then(function(t){var e=new Uint8Array(t),i=new Blob([e],{type:"octet/stream"});saveAs(i,this._getFilename())}.bind(this),function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,t))})},_withSubpages:function(){return this._countRadioBox&&"with-subpages"===this._countRadioBox.val()}},{}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"page-import"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._attach=this.findBlockInside("attach").on("change",this._onFileChange,this).on("reset",this._onFileReset,this),this._importTooltip=this.findBlockInside({block:"tooltip",modName:"type",modVal:"import"}),this._fieldsSeparatorSelect=this.findBlockInside({block:"select2",modName:"role",modVal:"fields-separator"}).on("change",this._onFormParamsChange,this),this._rowsSeparatorSelect=this.findBlockInside({block:"select2",modName:"role",modVal:"rows-separator"}).on("change",this._onFormParamsChange,this),this._importHeadCheckbox=this.findBlockInside({block:"checkbox",modName:"type",modVal:"import-head"}).on("change",this._onFormParamsChange,this),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"import-cancel"}).on("click",this._onCancelClick,this),this._loadButton=this.findBlockInside({block:"button2",modName:"role",modVal:"load"}).on("click",this._load,this),this._importButton=this.findBlockInside({block:"button2",modName:"role",modVal:"import"}).on("click",this._import,this),this._loadAnotherFileButton=this.findBlockInside({block:"button2",modName:"role",modVal:"load-another-file"}).on("click",this._resetForm,this),this._spinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"file-load"})}},show:function(){this.__base.apply(this,arguments),this._resetForm()},hide:function(){this.__base.apply(this,arguments),this._resetForm()},_onCancelClick:function(){this.hide()},_onFileChange:function(){this._abortRequest();var t=new FormData;t.append("file",this._attach.elem("control")[0].files[0]),t.append("delimiter",this._fieldsSeparatorSelect.getVal()),t.append("quotechar",this._rowsSeparatorSelect.getVal()),t.append("omit_first",this._importHeadCheckbox.isChecked()),this._disableFirstForm(),this._spinner.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:"/.import/grid/upload",method:"POST",data:t,path:"",timeout:this.__self.REQUEST_TIMEOUT}).run().then(this._onUploadSuccess.bind(this),this._onUploadError.bind(this))},_onFormParamsChange:function(){this._cacheKey&&(this._abortRequest(),this._disableFirstForm(),this._spinner.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".import/grid/parse",method:"GET",urlParams:["key="+this._cacheKey+"&omit_first="+this._importHeadCheckbox.isChecked()+"&delimiter="+this._fieldsSeparatorSelect.getVal()+"&quotechar="+this._rowsSeparatorSelect.getVal()],path:"",timeout:this.__self.REQUEST_TIMEOUT}).run().then(this._onUploadSuccess.bind(this),this._onUploadError.bind(this)))},_onFileReset:function(){this._cacheKey=null,this._abortRequest(),this._resetForm()},_onUploadSuccess:function(t){this._currentRequest=null,this._spinner.delMod("progress"),this._enableFirstForm(),t.data&&BEM.DOM.update(this.elem("preview"),BEMHTML.apply(this.__self._getPreviewBEMJSON(t.data))),this._loadButton.delMod("disabled").delMod("visibility"),this._importButton.setMod("disabled","yes").setMod("visibility","hidden"),this._cacheKey=t.data.cache_key},_onUploadError:function(t){this._currentRequest=null,BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this._attach.elem("reset"),BEM.I18N("b-widget","file_upload_fail"),t)),this._cacheKey=null,this._enableFirstForm(),this._loadButton.delMod("visibility").setMod("disabled","yes"),this._importButton.setMod("disabled","yes").setMod("visibility","hidden"),this._spinner.delMod("progress"),BEM.DOM.update(this.elem("preview"),"")},_disableFirstForm:function(){[this._fieldsSeparatorSelect,this._rowsSeparatorSelect,this._importHeadCheckbox,this._importButton,this._loadButton].forEach(function(t){t.setMod("disabled","yes")})},_enableFirstForm:function(){[this._fieldsSeparatorSelect,this._rowsSeparatorSelect,this._importHeadCheckbox].forEach(function(t){t.delMod("disabled")})},_load:function(){this._spinner.setMod("progress","yes"),this._loadButton.setMod("disabled","yes"),this._currentRequest=BEM.create("wi-api-request",{apiPath:".grid/import",method:"GET",urlParams:["key="+this._cacheKey+"&omit_first="+this._importHeadCheckbox.isChecked()+"&delimiter="+this._fieldsSeparatorSelect.getVal()+"&quotechar="+this._rowsSeparatorSelect.getVal()],path:this.params.ajaxPath,timeout:this.__self.REQUEST_TIMEOUT}),this._currentRequest.run().then(this._onSuccessGreatePreviewLoad.bind(this),this._onErrorGreatPreviewLoad.bind(this))},_onSuccessGreatePreviewLoad:function(t){this._currentRequest=null,this._spinner.delMod("progress"),this._loadButton.delMod("disabled"),this._greatPreviewCacheData=t.data,this._importTooltip.delMod("shown"),BEM.DOM.update(this.elem("preview"),BEMHTML.apply({block:"w-grid-preview",mods:{great:"yes"},data:t.data})),this._greatPreview=this.findBlockInside({block:"w-grid-preview",modNam:"greate",modVal:"yes"}).on("change",this._onGreatPreviewChange,this),this.setMod(this.elem("configs"),"visibility","hidden"),this._loadAnotherFileButton.delMod("visibility"),this._loadButton.setMod("visibility","hidden"),this._importButton.delMod("disabled").delMod("visibility")},_resetForm:function(){this.delMod(this.elem("configs"),"visibility"),this._loadAnotherFileButton.setMod("visibility","hidden"),this._attach.un("reset"),this._attach.un("change"),this._attach.resetFile(),this._attach.on("change",this._onFileChange,this),this._attach.on("reset",this._onFileReset,this),this._abortRequest(),this._loadButton.setMod("disabled","yes").delMod("visibility"),this._importButton.setMod("disabled","yes").setMod("visibility","hidden"),[this._fieldsSeparatorSelect,this._rowsSeparatorSelect,this._importHeadCheckbox].forEach(function(t){t.delMod("disabled")}),BEM.DOM.update(this.elem("preview"),""),this._cacheKey=null,this._greatPreviewCacheData=null,this._cleanError(),this._cleanTooltips(),this._spinner.delMod("progress")},_onErrorGreatPreviewLoad:function(){this._currentRequest=null,this._spinner.delMod("progress"),this._loadButton.delMod("disabled"),this._importTooltip.setOwner(this._loadButton.domElem).setMod("shown","yes")},_onGreatPreviewChange:function(t,e){this._greatPreview.disable(),this._importButton.setMod("disabled","yes"),this._spinner.setMod("progress","yes"),this._currentRequest=BEM.create("wi-api-request",{apiPath:".grid/import",method:"GET",urlParams:["key="+this._cacheKey+"&omit_first="+this._importHeadCheckbox.isChecked()+"&delimiter="+this._fieldsSeparatorSelect.getVal()+"&quotechar="+this._rowsSeparatorSelect.getVal()+this.__self._transformDataToGETParams(e.columns)],path:this.params.ajaxPath,timeout:this.__self.REQUEST_TIMEOUT}),this._currentRequest.run().then(this._onSuccessGreatPreviewUpdate.bind(this),this._onErrorGreatPreviewUpdate.bind(this))},_onSuccessGreatPreviewUpdate:function(t){this._spinner.delMod("progress"),this._greatPreviewCacheData=t.data,this._cleanError(),this._greatPreviewCacheData.fields.length&&this._importButton.delMod("disabled"),this._greatPreview.enable(),this._greatPreview.updateContent(t.data)},_onErrorGreatPreviewUpdate:function(t){var e,i={newCol:[],merge:[]};t&&"CLIENT_SENT_INVALID_DATA"===t.id?t.meta?(Object.keys(t.meta).forEach(function(e){var n=t.meta[e];1===n.length?i.newCol.push("'"+n[0]+"'"):i.merge.push("'"+n[1]+"'")},this),e=BEM.I18N("b-widget","incompatible_data_types")+i.newCol.join(", "),i.newCol.length?i.merge.length?e+=","+BEM.I18N("b-widget","and_on_cols_that_imports")+i.merge.join(", ")+".":e+=".":i.merge.length?e+=BEM.I18N("b-widget","cols_that_imports")+i.merge.join(", ")+".":e=BEM.I18N("b-widget","update_preview_error")):e=BEM.I18N("b-widget","update_preview_error")+" "+BEM.blocks["wi-notification"].createErrorMessage(t):e=BEM.I18N("b-widget","update_preview_error"),this._spinner.delMod("progress"),this._showError(e),this._greatPreview.enable(),this._importButton.setMod("disabled","yes")},_showError:function(t){this.delMod(this.elem("errors"),"visibility"),BEM.DOM.update(this.elem("errors"),t)},_cleanError:function(){this.setMod(this.elem("errors"),"visibility","hidden"),BEM.DOM.update(this.elem("errors"),"")},_cleanTooltips:function(){this._importTooltip.delMod("shown")},_import:function(){this._importButton.setMod("disabled","yes"),this._spinner.setMod("progress","yes"),this._currentRequest=BEM.create("wi-api-request",{apiPath:".grid/import",data:$.extend({key:this._cacheKey,delimiter:this._fieldsSeparatorSelect.getVal(),quotechar:this._rowsSeparatorSelect.getVal(),omit_first:this._importHeadCheckbox.isChecked()},this._greatPreview.getData().columns),method:"POST",urlParams:!1,path:this.params.ajaxPath,timeout:this.__self.REQUEST_TIMEOUT}),this._currentRequest.run().then(this._onFinalImportSuccess.bind(this),this._onFinalImportError.bind(this))},_onFinalImportSuccess:function(){this._currentRequest=null,this._spinner.delMod("progress"),this._importTooltip.delMod("shown"),this.hide(),location.reload()},_onFinalImportError:function(){this._currentRequest=null,this._spinner.delMod("progress"),this._importButton.delMod("disabled"),this._importTooltip.setOwner(this._importButton.domElem).setMod("shown","yes")},_abortRequest:function(){this._currentRequest&&(this._currentRequest.abortRequest?this._currentRequest.abortRequest():this._currentRequest.abort&&this._currentRequest.abort(),this._currentRequest=null)}},{REQUEST_TIMEOUT:12e4,_getPreviewBEMJSON:function(t){var e,i=[];for(e=1;e<=t.column_count;e++)i.push(BEM.I18N("b-widget","col")+" "+e);return{block:"w-grid-preview",content:[{block:"w-grid-preview",elem:"head",content:{block:"w-grid-preview",elem:"row",content:i.map(function(t){return{block:"w-grid-preview",elem:"col",content:t}},this)}},t.rows.map(function(t){return{block:"w-grid-preview",elem:"row",content:t.map(function(t){return{block:"w-grid-preview",elem:"col",content:t}},this)}},this)]}},_transformDataToGETParams:function(t){var e="";return Object.keys(t).forEach(function(i){e+="&"+i+"="+t[i]}),e}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"referrers"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"close"}).on("click",this._onCancelClick,this)}},_onCancelClick:function(){this.hide()}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"request-page-author"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}).on("click",this._onCancelClick,this),this._addButton=this.findBlockInside({block:"button2",modName:"role",modVal:"add"}).on("click",this._addAuthor,this),this._addSpinner=this.findBlockInside("spin2")},progress:function(t,e){this._cancelButton.setMod("disabled",e),this._addButton.setMod("disabled",e),this._addSpinner.setMod("progress",e)}},_addAuthor:function(){this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".request_page_author",method:"POST",urlParams:!1,data:{new_author:this.params.request_login},path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onSuccessAdd.bind(this),BEM.blocks["wi-notification"].errorHandler(this._addButton.domElem)).always(function(){this.delMod("progress")}.bind(this))},_onSuccessAdd:function(t){var e=_.clone(BEM.WISTORE.get("page").get("authors"));e.push(t.data.new_author),BEM.WISTORE.get("page").set("authors",e),this.hide(),location.reload()},_onCancelClick:function(){this.hide()}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"subpages-change-author"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._fromSuggest=this.findBlockInside({block:"m-suggest",modName:"role",modVal:"from"}),this._fromSuggestIsDisabled=this._fromSuggest.getMod("disabled"),this._toSuggest=this.findBlockInside({block:"m-suggest",modName:"role",modVal:"to"}),this._backButton=this.findBlockInside({block:"button2",modName:"role",modVal:"back"}),this._backButton&&this._backButton.on("click",this._goBack,this),this._cancelButton=this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}),this._cancelButton&&this._cancelButton.on("click",this._cancel,this),this._saveButton=this.findBlockInside({block:"button2",modName:"role",modVal:"save"}).on("click",this._save,this),this._saveSpin=this.findBlockInside({block:"spin2",modName:"role",modVal:"save"}),this._canEditFromSuggest=this.params.currentUser.is_admin||this.params.authors.find(function(t){return t.login===this.params.currentUser.login}.bind(this)),this._fromSuggestValue=this._canEditFromSuggest?null:this.params.currentUser,this._toSuggestValue=null,this._fromSuggest.on("select",this._onFromSuggestSelect,this).on("change",this._onFromSuggestChange,this),this._toSuggest.on("select",this._onToSuggestSelect,this).on("change",this._onToSuggestChange,this),this._updateTree()},progress:function(t,e){var i=e?"yes":"";!this._fromSuggestIsDisabled&&this._fromSuggest.setMod("disabled",i),this._toSuggest.setMod("disabled",i),this._backButton&&this._backButton.setMod("disabled",i),this._cancelButton&&this._cancelButton.setMod("disabled",i),this._saveButton.setMod("disabled",i),this._saveSpin.setMod("progress",i)}},_onFromSuggestChange:function(){this._fromSuggestChangePrevent?this._fromSuggestChangePrevent=!1:(this._fromSuggestValue=null,this._updateTree(),this._updateSaveButton())},_onToSuggestChange:function(){this._toSuggestChangePrevent?this._toSuggestChangePrevent=!1:(this._toSuggestValue=null,this._updateSaveButton())},_onFromSuggestSelect:function(t,e){e.entityData.login=this._getSelectedItemField(e.entityData,"login"),e.entityData.uid=this._getSelectedItemField(e.entityData,"uid"),this._compare(e.entityData,this._toSuggestValue)?this.afterCurrentEvent(function(){this._toSuggest.clearData()},this):(this._fromSuggestValue=e.entityData,this._fromSuggestChangePrevent=!0,this._updateTree(),this._updateSaveButton())},_getSelectedItemField:function(t,e){var i=t.fields.filter(function(t){return t.type===e})[0];return i?i.value:null},_onToSuggestSelect:function(t,e){e.entityData.login=this._getSelectedItemField(e.entityData,"login"),e.entityData.uid=this._getSelectedItemField(e.entityData,"uid"),this._compare(e.entityData,this._fromSuggestValue)?this.afterCurrentEvent(function(){this._toSuggest.clearData()},this):(this._toSuggestValue=e.entityData,this._toSuggestChangePrevent=!0,this._updateSaveButton())},_compare:function(t,e){return!(!t||!e)&&t.uid===e.uid},_updateSaveButton:function(){this._saveButton.setMod("disabled",this._fromSuggestValue&&this._toSuggestValue?"":"yes")},_getFromSuggestLogin:function(){return this._fromSuggestValue?this._fromSuggestValue.login:""},_updateTree:function(){this._fromSuggestValue?(BEM.DOM.update(this.elem("tree"),BEMHTML.apply({block:"spin2",mods:{size:"m",progress:"yes"}})),this._getTreeRequest=BEM.create("wi-api-request",{apiPath:".tree",method:"GET",data:!1,urlParams:["depth=3","show_redirects=True","show_grids=True","show_titles=True","nomark=True","authors="+this._getFromSuggestLogin()],path:BEM.blocks["wi-history"].getCorrectPath()}),this._getTreeRequest.run().then(this._onGetTreeData.bind(this),this._onFailGetTreeData.bind(this))):this._getTreeRequest&&(this._getTreeRequest.abort(),this._getTreeRequest=null,this._getTreeRequestAborted=!0)},_onGetTreeData:function(t){BEM.DOM.update(this.elem("tree"),BEMHTML.apply([{block:"b-widget",elem:"subpages-list",content:BEM.I18N("b-widget","subpages_list")},{block:"b-wiki-tree",js:{totalData:t.data,data:{nomark:!0}}}]))},_onFailGetTreeData:function(){this._getTreeRequestAborted?this._getTreeRequestAborted=!1:BEM.DOM.update(this.elem("tree"),"")},_goBack:function(){this.hide(),this.params.baseWidgetData&&this.afterCurrentEvent(function(){BEM.channel("common").trigger(this.params.baseWidgetData.showEvent,this.params.baseWidgetData.showData||{})})},_cancel:function(){this.hide()},_save:function(){this.setMod("progress"),BEM.create("wi-api-request",{apiPath:".authors",method:"POST",data:{with_subpages:!0,replace_authors:[this._fromSuggestValue.uid],authors:[this._toSuggestValue.uid]},urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath(),timeout:6e4}).run().then(this._onSuccessSave.bind(this),this._onFailSave.bind(this)).always(function(){this.delMod("progress")}.bind(this))},_onSuccessSave:function(){this.hide(),this.afterCurrentEvent(function(){location.reload()})},_onFailSave:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,t))}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"subpages-change-author"},{_compare:function(t,e){return!(!t||!e)&&t.id===e.id},_getFromSuggestLogin:function(){return this._fromSuggestValue?this._fromSuggestValue.fields.filter(function(t){return"login"===t.type})[0].value:""},_save:function(){this.setMod("progress"),BEM.create("wi-api-request",{apiPath:".authors",method:"POST",data:{with_subpages:!0,replace_authors:[this._fromSuggestValue.id],authors:[this._toSuggestValue.id]},urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onSuccessSave.bind(this),this._onFailSave.bind(this)).always(function(){this.delMod("progress")}.bind(this))}}),BEM.DOM.decl("b-wiki-tree",{onSetMod:{js:function(){this._expandAllButton=this.findBlockInside({block:"button2",modName:"role",modVal:"expand-all"}),this._updateTreeSpinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"update-tree"}),this._expandAllButton&&this._expandAllButton.on("click",this._expandAll,this)},"tree-loading":{yes:function(){this._updateTreeSpinner.setMod("progress","yes"),this._expandAllButton.setMod("disabled","yes")},"":function(){this._updateTreeSpinner.delMod("progress"),this._expandAllButton.delMod("disabled")}}},_expandAll:function(){this.setMod("tree-loading","yes"),$.ajax({url:this.params.totalData.expand_all_url,success:this._onSuccessLoad.bind(this),error:this._onFailLoad.bind(this)})},_onSuccessLoad:function(t){this.delMod("tree-loading"),t.data?(BEM.DOM.update(this.elem("expand-all"),BEMHTML.apply({block:"b-wiki-tree",elem:"full-loaded"})),BEM.DOM.update(this.elem("tree"),BEMHTML.apply(t.data.subpages.map(BEM.blocks["b-wiki-tree-page"].getPageBEMJSON)))):this._onFailLoad()},_onFailLoad:function(){this.delMod("tree-loading"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-wiki-tree","cant_get_tree")))}}),BEM.DOM.decl("b-wiki-tree-page",{onSetMod:{js:function(){this._cacheBlocks(),this._subscribe()},progress:{yes:function(){this._expandSpinner.setMod("progress","yes")},"":function(){this._expandSpinner.delMod("progress")}}},_cacheBlocks:function(){this._expandIcon=this.findBlockInside(this.findElem("expand").eq(0),{block:"awesome-icon",modName:"type",modVal:"expand"}),this._unexpandIcon=this.findBlockInside(this.findElem("expand").eq(0),{block:"awesome-icon",modName:"type",modVal:"unexpand"}),this._expandSpinner=this.findBlockInside(this.findElem("expand").eq(0),{block:"spin2",modName:"type",modVal:"expand"})},_subscribe:function(){this.findBlockInside(this.findElem("self"),"link").bindTo("click",function(){yaCounter&&yaCounter.reachGoal("from_tree")}),this._expandIcon&&this._expandIcon.bindTo("click",this._onExpandIconClick.bind(this)),this._unexpandIcon&&this._unexpandIcon.bindTo("click",this._onUnexpandIconClick.bind(this))},_onExpandIconClick:function(){this.hasMod("data-loaded","yes")?this.setMod("expanded","yes"):(this.setMod("progress","yes"),$.ajax({url:this.params.data.expand_url,success:this._onSuccessLoadBranch.bind(this),error:this._onFailLoadBranch.bind(this),complete:this._onLoadBranchComplete.bind(this)}))},_onUnexpandIconClick:function(){this.delMod("expanded")},_onSuccessLoadBranch:function(t){t.data?(BEM.DOM.update(this.findElem("children"),BEMHTML.apply(t.data.subpages.map(this.__self.getPageBEMJSON))),this.setMod("data-loaded","yes"),this.setMod("expanded","yes")):this._onFailLoadBranch()},_onFailLoadBranch:function(){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-wiki-tree-page","cant_get_branch")))},_onLoadBranchComplete:function(){this.delMod("progress")}},{getPageBEMJSON:function(t){return{block:"b-wiki-tree-page",mods:{expandable:t.expand_url||t.subpages.length?"yes":"",expanded:t.subpages.length?"yes":"","data-loaded":t.subpages.length?"yes":"",type:t.page.type.toLowerCase()},data:t}}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"tree"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.findBlockInside({block:"button2",modName:"role",modVal:"back"}).on("click",this._onBackClick,this),this.findBlockInside({block:"button2",modName:"role",modVal:"close"}).on("click",this._onCloseClick,this)}},show:function(t){this.__base.apply(this,arguments),this.afterCurrentEvent(function(){this.bindToDoc("pointerclick",this._onDocClick)},this),t&&t.baseWidgetData?(this._baseWidgetData=t.baseWidgetData,this.setMod("show-back","yes")):this.delMod("show-back")},hide:function(){this.__base.apply(this,arguments),this.unbindFromDoc("pointerclick"),this.delMod("show-back")},_onCloseClick:function(){this.hide()},_onDocClick:function(t){$(t.target).is(this.elem("content"))||this.elem("content").find(t.target).length||this.hide()},_onBackClick:function(){this.hide(!0),this._baseWidgetData&&BEM.channel("common").trigger(this._baseWidgetData.showEvent,this._baseWidgetData.showData||{})}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"redirect-message"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.findBlockInside({block:"button2",modName:"role",modVal:"cancel"}).on("click",this._onCancelClick,this),this.findBlockInside({block:"button2",modName:"role",modVal:"settings"}).on("click",this._showSettingsWidget,this)}},_onCancelClick:function(){this.hide()},_showSettingsWidget:function(){var t=BEM.blocks["i-routes"].actions[".settings"];BEM.channel("common").trigger(t.block+"."+t.event)}}),BEM.DOM.decl("w-page-info",{onSetMod:{js:function(){var t=this.findBlockInside({block:"awesome-icon",mods:{type:"hide"}});t&&t.bindTo("click",this.hide.bind(this))}},hide:function(){BEM.DOM.destruct(this.domElem)}}),BEM.DOM.decl({block:"w-page-info",modName:"type",modVal:"redirect"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.findBlockInside({block:"button2",modName:"role",modVal:"settings"}).on("click",this._showSettings,this)}},_showSettings:function(){var t=BEM.blocks["i-routes"].actions[".settings"];BEM.channel("common").trigger(t.block+"."+t.event)}}),BEM.DOM.decl({block:"w-page-info",modName:"type",modVal:"redirected-from"},{hide:function(){this.__base.apply(this,arguments),BEM.blocks["wi-history"].removeState()}}),BEM.DOM.decl("b-wiki-form",{_files:[],onSetMod:{js:function(){var t=BEM.WISTORE.get("page");t&&Ya&&Ya.Rum&&Ya.Rum.logError&&Ya.Rum.logError({message:"old_form_page",level:"info",additional:{supertag:t.get("superTag")}});var e=this,i=[],n=this._formBEMJSON(i);this._requiredFields=[],this._formId=this.params.attrs&&this.params.attrs.number_local,this._form_source_page=this.params.data&&this.params.data.form_source_page,this._bPage=this.findBlockOutside("b-page"),this._formatter=this.findBlockOutside("wiki-formatter"),this._formatter&&BEM.DOM.prepend(this._formatter.domElem,BEMHTML.apply({block:"wf-form",js:{start:this._formatter.params.attrs.pos_start,end:this._formatter.params.attrs.pos_end}})),this._mainDoc=this._getMainDoc(),this.params.data&&this.params.data.title&&i.push({elem:"title",content:this.params.data.title}),this.params.data&&this.params.data.fields?(this.params.data.fields.forEach(function(t){e["_"+t.type+"BEMJSON"]?i.push(e["_"+t.type+"BEMJSON"](t)):(BEM.channel("notification").trigger("error",{message:"Новый элемент формы. Или переименовали тип. "+t.type}),console.error("Новый элемент формы. Или переименовали тип.",t.type,t))}),i.push(this._submit(this.params.data.submit)),BEM.DOM.append(this.domElem,BEMHTML.apply(n)),this._button=this.findBlockInside({block:"button2",modName:"role",modVal:"form-submit"}),this._spinner=this.findBlockInside("spin"),this._button.bindTo("click",this._submitForm.bind(this)),BEM.channel("wiki-form").on("error",this._onFormFieldError,this)):(this.params.data&&i.push(this._formRenderError(this.params.data)),BEM.DOM.append(this.domElem,BEMHTML.apply(n)))}},destruct:function(){BEM.channel("wiki-form").un("error",this._onFormFieldError,this),this.__base.apply(this,arguments)},_onFormFieldError:function(t,e){this.channel("notification").trigger("error",this._getErrorData(e.node,{message:[e.text]}))},_formRenderError:function(t,e){var i,n=t.message||t.arg||t.wikiform_error_code,s=this.__self._getErrorTypes(t.wikiform_error_code);return"MISSING_PAGE"===t.wikiform_error_code&&(n=t.arg),i=s?s.replace("%s",n):n,e?i:{block:"b-wiki-form-field",mods:{type:"form-error"},content:i}},_formBEMJSON:function(t){return{block:"b-wiki-form",elem:"form",content:t}},_infoBEMJSON:function(t){return{block:"b-wiki-form",elem:"info",content:[{elem:"label",content:t.title},{elem:"info-text",content:t.text}]}},_stringBEMJSON:function(t){var e=this._fieldWrapper(t,[{block:"input",mods:{size:"s",assigned:"form"},mix:[{block:"b-form-field-getter"}],name:t.name,value:t.value,js:{required:t.attrs.required},content:[{elem:"control"}]}]);return this._extendFields(t,e),this._isRequired(t,e),e},_textBEMJSON:function(t){var e=this._fieldWrapper(t,[{block:"input",mods:{type:"textarea",size:"s",assigned:"form"},mix:[{block:"b-form-field-getter"}],js:{required:t.attrs.required},name:t.name,value:t.value,content:[{elem:"control"}]}]);return this._extendFields(t,e),this._isRequired(t,e),e},_selectBEMJSON:function(t){var e,i=t.params.options.map(function(t){return{elem:"option",attrs:{value:t.key},content:t.value}});return i[0]&&(i[0].attrs.selected="selected"),e=t.attrs.multiple?this._fieldWrapper(t,[{block:"select-multiple",name:t.name,mods:{assigned:"form"},js:{required:t.attrs.required},mix:[{block:"b-form-field-getter"}],content:i}]):this._fieldWrapper(t,[{block:"select",name:t.name,mods:{size:"m",layout:"content",theme:"normal",assigned:"form"},js:{required:t.attrs.required},mix:[{block:"b-form-field-getter"}],content:[{block:"button",content:i[0]&&i[0].content},{elem:"control",content:i}]}]),this._extendFields(t,e),this._isRequired(t,e),e},_staffBEMJSON:function(t){var e;return t.mods={special:"suggest"},e=this._fieldWrapper(t,[{block:"m-suggest",mix:[{block:"b-form-field-getter"}],mods:{type:"multicomplete",size:"m",assigned:"form"},inputAttrs:{name:t.name,value:t.value||""},multiple:t.params.multiple,js:{required:t.attrs.required},types:[{name:"staff",maxCount:10}]}]),this._extendFields(t,e),this._isRequired(t,e),e},_serviceBEMJSON:function(t){var e;return t.mods={special:"suggest"},e=this._fieldWrapper(t,[{block:"m-suggest",mix:[{block:"b-form-field-getter"}],mods:{type:"service",size:"m",assigned:"form"},inputAttrs:{name:t.name,value:t.value||""},multiple:t.params.multiple,js:{required:t.attrs.required},types:[{name:"service",maxCount:10}]}]),this._extendFields(t,e),this._isRequired(t,e),e},_groupBEMJSON:function(t){var e;return t.mods={special:"suggest"},e=this._fieldWrapper(t,[{block:"m-suggest",mix:[{block:"b-form-field-getter"}],mods:{type:"groups",size:"m",assigned:"form"},inputAttrs:{name:t.name,value:t.value||""},multiple:t.params.multiple,js:{required:t.attrs.required},types:t.params.group}]),this._extendFields(t,e),this._isRequired(t,e),e},_checkboxBEMJSON:function(t){var e=1==t.value||1==t.value?"yes":void 0,i=this._fieldWrapper(t,[{block:"checkbox",mods:{size:"m",assigned:"form",checked:e,theme:"normal"},mix:[{block:"b-form-field-getter"}],checkboxAttrs:{name:t.name},value:t.value,js:{required:t.attrs.required}}]);return this._extendFields(t,i),this._isRequired(t,i),i},_dateBEMJSON:function(t){var e=1e3*t.value,i=t.value?BEM.blocks["mi-helpers"].getHumanStringFromDate({date:new Date(e)}):"",n=this._fieldWrapper(t,[{block:"m-calendar",mods:{toggler:"input",type:"month",assigned:"form"},mix:[{block:"b-form-field-getter"}],js:{defaultText:BEM.I18N("b-wiki-form","choose_date"),required:t.attrs.required,value:i,autoclose:!0},attrs:{name:t.name},size:"m",theme:"grey"}]);return this._extendFields(t,n),this._isRequired(t,n),n},_numberBEMJSON:function(t){var e=this._fieldWrapper(t,[{block:"input",name:t.name,mods:{size:"s",type:"number",assigned:"form"},js:{required:t.attrs.required},value:t.value,mix:[{block:"b-form-field-getter"}],content:[{elem:"control"}]}]);return this._extendFields(t,e),this._isRequired(t,e),e},_fileBEMJSON:function(t){var e=this._fieldWrapper(t,[{block:"m-uploader",mods:{type:"form",assigned:"form"},js:{autoupload:"yes",url:"/.upload",dropzone:"no",holder:!0,controls:["close"],required:t.attrs.required},name:t.name}]);return this._extendFields(t,e),this._isRequired(t,e),e},_submit:function(t){return{elem:"buttons",content:[{block:"spin",js:!0,mods:{theme:"gray-16"}},{block:"button2",mods:{size:"m",theme:"action",type:"submit",role:"form-submit"},text:t||BEM.I18N("b-wiki-form","send")}]}},_submitForm:function(t){t.preventDefault(),this._fields||(this._fields=this.findBlocksInside("b-wiki-form-field")),this._clearErrors(),this._validateOnRequired()&&(this._spinner.setMod("progress","yes"),this._button.setMod("disabled","yes"),BEM.create("wi-api-request",{apiPath:".form",method:"POST",data:{__formId:this._formId,fields:this._getFieldsData(),files:this._files,form_source_page:this._form_source_page},urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath(),timeout:this.__self.REQUEST_TIMEOUT}).run().then(this._onGotData.bind(this),this._onFailedData.bind(this)))},_validateOnRequired:function(){var t,e=!0;return this._requiredFields.forEach(function(i){switch(i.__self.getName()){case"select":t=i.findBlockInside("select").val();break;case"select-multiple":t=i.domElem.val()[0];break;case"m-suggest":t=i.val();break;case"m-calendar":t=i.findBlockInside("input").val();break;case"m-uploader":t=i.findBlockInside("attach").val();break;case"checkbox":t=i.isChecked();break;default:t=i.elem("control").val()}t||(i._formField||(i._formField=i.findBlockOutside("b-wiki-form-field")),i._formField.setMod("validation","error"),e=!1)}),e||this.channel("notification").trigger("error",{elem:this._button.domElem,message:"ru"===BEM.I18N.lang()?"Не все обязательные поля формы заполнены":"Not all fields are required"}),e},_clearErrors:function(){this._unbindValidationEvents(),this._fields.forEach(function(t){t.delMod("validation")})},_getFieldsData:function(){var t,e,i,n=[];return this._blockGetters||(this._blockGetters=this.findBlocksInside("b-form-field-getter")),this._blockGetters.forEach(function(s){var o,r,a,c;if(o=s.findBlockOn("input")||s.findBlockOn("b-form-input"))o.hasMod("type","number")&&o.val(o.val().replace(",",".")),a=o.name(),c=o.val();else if(o=s.findBlockOn("m-suggest"))if(o.hasMod("type","groups"))a=o._input.name(),c=o.val();else if(o.hasMod("type","service")){var l=o.getData();a=o._input.name(),c=l?l._id:o.val()}else t=o.getData(),e=o._input.name(),i=[],t?(t.length||(t=[t]),t.forEach(function(t){i.push(t.login)}),a=e+"__login",c=i.join()):o.val()&&(a=e+"__login",c=o.val());else(o=s.findBlockOn("select-multiple"))?(a=o.domElem.attr("name"),c=o.domElem.val()):(o=s.findBlockOn("select"))?(a=o.elem("control").attr("name"),c=o.val()):(o=s.findBlockOn("checkbox"))?(a=o.elem("control").attr("name"),c=o.isChecked()):(o=s.findBlockOn("m-calendar"))&&(r=BEM.blocks["mi-helpers"].getHumanStringFromDate({date:o.getDate()}))&&(a=o.findBlockInside("input").elem("control").attr("name"),c=r);a&&c&&n.push({name:a,value:c})}),n},_onGotData:function(t){var e;this.channel("errors").trigger("errorHide"),t.data.bemjson?(e=this._findCurrentFormInNode(t.data.bemjson.content),this.params.data.again?this._setPropertyToPath(t.data.bemjson.content,e.formatter.road,[e.formatter.node,{block:"b-wiki-form-success",content:this.params.data.success||BEM.I18N("b-wiki-form","data_successfully_send")}]):this._setPropertyToPath(t.data.bemjson.content,e.action.road,{block:"b-wiki-form-success",content:e.action.node.content[0]["wiki-attrs"].data.success||BEM.I18N("b-wiki-form","data_successfully_send")}),BEM.DOM.update(this._mainDoc.domElem,BEMHTML.apply(t.data.bemjson))):(BEM.DOM.after(this.domElem,BEMHTML.apply({block:"b-wiki-form-success",content:this.params.data.success||BEM.I18N("b-wiki-form","data_successfully_send")})),this.params.data.again?this._button.delMod("disabled"):BEM.DOM.destruct(this.domElem),this._spinner.delMod("progress"))},_onFailedData:function(t){var e,i=this;t.meta?Object.keys(t.meta).forEach(function(n){(e=i.findBlockInside({block:"b-wiki-form-field",modName:"name",modVal:n}))&&(e.setMod("validation","error"),e.errorMessage="",t.meta[n]&&t.meta[n].forEach(function(t){e.errorMessage+=t+"."}))}):t.message=this._formRenderError(t,!0),this.channel("notification").trigger("error",this._getErrorData(null,t)),this._spinner.delMod("progress"),this._button.delMod("disabled")},_findCurrentFormInNode:function(t,e){var i,n=null;return e||(e=[]),t instanceof Array?t.forEach(function(t,s){(i=this._findCurrentFormInNode(t,e.concat(s)))&&(n=i)},this):t.content&&("wiki-formatter"===t.block?t.content.forEach(function(i,s){i["wiki-attrs"]&&i["wiki-attrs"].number_local===this._formId&&i.content[0]["wiki-attrs"].data.form_source_page===this._form_source_page&&(n={action:{road:e.concat("content",s),node:i},formatter:{road:e,node:t}})},this):(i=this._findCurrentFormInNode(t.content,e.concat("content")))&&(n=i)),n},_setPropertyToPath:function(t,e,i){var n,s=[],o=_.clone(t);if(e.forEach(function(t){o=o[t],s.push(o)}),s[s.length-1]=i,s.length>1)for(n=s.length-2;n>=0;n--)s[n][e[n+1]]=s[n+1];return t[e[0]]=s[0],t},_getErrorData:function(t,e){return{elem:t||this._button.domElem,message:[{block:"b-wiki-form",elem:"error-head",content:BEM.I18N("b-wiki-form","cant_save_form")},{block:"b-wiki-form",elem:"error-body",content:BEM.blocks["wi-notification"].createErrorMessage(e)}]}},_fieldWrapper:function(t,e){var i={name:t.name};return i=$.extend(i,t.mods),e.push({block:"b-wiki-form-field",elem:"error"}),{block:"b-wiki-form-field",mods:i,content:e}},_extendFields:function(t,e){t.title?(e.content.unshift({block:"b-wiki-form",elem:"label",content:t.title}),t.top&&(e.mods.position="top")):e.mods.label="no",this._setComment(t,e.content)},_isRequired:function(t,e){t.attrs.required&&(e.mods.required="yes")},_unbindValidationEvents:function(){this._formBlocks&&this._formBlocks.length&&this._formBlocks.forEach(function(t){t.un("focus")})},_setComment:function(t,e){t.text&&e&&e.push({block:"b-wiki-form",elem:"description",content:t.text})}},{REQUEST_TIMEOUT:6e4,_getErrorTypes:function(t){return{UNKNOWN:BEM.I18N("b-wiki-form","unknown_error")+" %s",YAML:BEM.I18N("b-wiki-form","yaml_error")+" %s",INVALID_TARGET_ENTRY:BEM.I18N("b-wiki-form","error_in_target")+" %s",TARGET_FIELD_NOT_FOUND:BEM.I18N("b-wiki-form","missing_field_in_target")+'"%s"',MISSING_PAGE:BEM.I18N("b-wiki-form","unknown_page")+' "%s"',GENERIC:BEM.I18N("b-wiki-form","form_send_error")+" %s"}[t]}}),BEM.DOM.decl("b-wiki-form",{_getMainDoc:function(){return this._bContent=this._bPage.findBlockInside("b-content"),this._bContent&&this._bContent.findBlockInside({block:"wiki-doc",modName:"status",modVal:"main"})}}),BEM.DOM.decl({block:"input",modName:"type",modVal:"number"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.bindTo("input",BEM.blocks["mi-helpers"].validateNumberOnlyInput)}}}),function(){var t="background-position",e="0 -",i=!1,n="animation";!function(){var s=document.createElement("img");void 0!==s.style["background-position-y"]&&(t="background-position-y",e="-");var o="Webkit Moz O ms Khtml".split(" ");if(void 0!==s.style.animationName)i=!0;else for(var r=0;r<o.length;r++){var a=o[r];if(void 0!==s.style[a+"AnimationName"]){n="-"+a.toLowerCase()+"-animation",i=!0;break}}}(),BEM.DOM.decl("spin",{getDefaultParams:function(){return{animation:"transform",startDelay:0,frameAngle:10,frameTime:27,frames:36}},onSetMod:{js:{inited:function(){i||(this.params.animation="sprite"),"sprite"===this.params.animation&&(this._size=parseInt(this.getMod("size")||/[\d]+/.exec(this.getMod("theme"))[0],10),this._height=this._size*this.params.frames,this._curFrame=0,this.setMod("support-transforms","no")),this.hasMod("progress","yes")&&this._startSpin()}},progress:{yes:function(){this._startSpin()},"":function(){this._stopSpin()}}},_startSpin:function(){var t=function(){if(this.hasMod("progress","yes")&&!this._interval)switch(this.params.animation){case"transform":var t="islands-spin "+Math.floor(360*this.params.frameTime/this.params.frameAngle)+"ms infinite linear";this.elem("icon").css(n,t);break;case"sprite":this._interval=setInterval(this._switchFrame.bind(this),this.params.frameTime)}}.bind(this);this._delayTimeout=setTimeout(t,this.params.startDelay)},_stopSpin:function(){this._delayTimeout&&(clearTimeout(this._delayTimeout),delete this._delayTimeout),this._interval&&(clearInterval(this._interval),delete this._interval)},_switchFrame:function(){var i=++this._curFrame*this._size;i>=this._height&&(this._curFrame=i=0),this.elem("icon").css(t,e+i+"px")},destruct:function(){this._stopSpin(),this.__base.apply(this,arguments)}})}(),BEM.DOM.decl("popup",{getDefaultParams:function(){return{zIndexGroupLevel:0,directions:[{to:"bottom",axis:"center",tail:{axis:"center"}},{to:"top",axis:"center",tail:{axis:"center"}},{to:"right",axis:"middle",tail:{axis:"middle"}},{to:"left",axis:"middle",tail:{axis:"middle"}}],tail:{width:24.04,height:12.02,offset:{left:15,right:15,top:15,bottom:15}},duration:150}},onSetMod:{js:{inited:function(){this._cache={},this._viewport=BEM.DOM.win,this._scope=BEM.DOM.scope,this._channel=BEM.channel("popups"),this._inContainer=!1,this._isParentFixed=!1,this._owner=null,this._destructor=null,this._userPosition=null,this._parent=null,this._childs=[],this._isShown=!1,this._isHiding=!1,this._positions={},this._currPos={},this._visibilityFactor=null,this._direction=!1,this._directions={};var t=this.getDefaultParams(),e=this.params,i=this._repackDirParams(t.directions),n=e.generateDirections?this._generateDirections:e.directions,s=this._repackDirParams(n);e.tail&&(this.params.tail=this._mergeParams(t.tail,e.tail)),this._order=s.keys.map(function(t){var e=s.directions[t],n=i.directions[t];return n||(n=i.directions[e.to]),this._directions[t]=this._mergeParams(n,e,{tail:this._tailParamsHook}),t},this),this._zIndex=null,this._zIndexGroupLevel=null}},visibility:{visible:function(){this._onShown()},"":function(){this._onHidden()}}},show:function(t){var e;if(t instanceof BEM)e=t.domElem.eq(0);else if(t instanceof $)e=t;else if(!t)return;if(e){if(this._owner&&e[0]!==this._owner[0]&&this.delMod("visibility"),this._owner=e,e.length){var i="_"+this.__self.getName()+"-destructor";this._destructor=e.addClass("i-bem "+i).bem(i)}var n=this._findParent(e);n&&this.setParent(n)}else this._userPosition=t;return this.setMod("visibility","outside").repaint()},hide:function(t){if(this._isHiding)return this;if(this._isShown){var e=$.Event("before-hide");if(this.trigger(e,t),e.isDefaultPrevented())return this;if(this._isHiding=!0,this._childs.forEach(function(t){t.hide&&t.hide(),t.delMod("visible")}),this.hasMod("animate","yes")&&!this.hasMod("fade-out","no")){var i=this;return this.beforeHide(function(){i.domElem&&i.delMod("visibility")}),this}}return this.delMod("visibility")},toggle:function(t,e){return this._isShown&&!this._isHiding?this.hide(e):this.show(t||this._owner)},repaint:function(){this._moveToContainer();var t=this._pickDirection();return this.setMod("to",t.to)._show(this._positions[t.key],this._tailPos&&this._tailPos[t.key]),this},getCurrPos:function(){return this._currPos},getCurrDirection:function(){return this._direction},setScope:function(t){return this._scope=t,this._inContainer=!1,this},setContent:function(t){return BEM.DOM.update(this.elem("content"),t),this._resetDefault(),this._isShown&&this.repaint(),this},isShown:function(){return this._isShown},setParent:function(t){return this._parent=t,this._isParentFixed=t.hasMod("position","fixed"),t.addChild&&t.addChild(this),this},addChild:function(t){for(var e=this._childs,i=e.length,n=0;n<i;n++)if(e[n]._uniqId===t._uniqId)return;t.on("hide",function(){this.removeChild(t)},this),t.on("beforeClose",function(){this.afterCurrentEvent(function(){this.removeChild(t)})},this),e.push(t)},_getParentPopup:function(){return this._parent},removeChild:function(t){for(var e=this._childs,i=e.length,n=0;n<i;n++)if(e[n]._uniqId===t._uniqId)return void e.splice(n,1)},setSize:function(t){return t&&(this._resetDefault(),this.domElem.css(t),this._isShown&&!this._isHiding&&this.repaint()),this},_show:function(t,e){return this._currPos=t,e&&this.elem("tail").removeAttr("style").css(e),this.domElem.css(t),(!this._isShown||this._isHiding)&&this.hasMod("animate","yes")&&!this.hasMod("fade-in","no")&&this.afterShow(),this._isHiding=!1,this.setMod("visibility","visible"),this},_onShown:function(){this._isShown||this._bindCompatibility(),this.bindToDoc("keydown",function(t){t.which===BEM.blocks.keycodes.ESC&&0===this._childs.length&&this.hide({source:"esc-key"})}),this._attachRepaintOnResize(),this._bindFocusEvents(),this._attachUnder(),this._isShown=!0,this.hasMod("autoclosable","yes")&&this.afterCurrentEvent(function(){this.domElem&&this._enableAutoclosable()}),this.hasMod("adaptive","yes")&&this._enableAdaptive(),this._channel.on("hide",this.hide,this),this.trigger("show")},_bindCompatibility:function(){this._captureZIndex(),this.__self._visiblePopupsStack.unshift(this),this.trigger("beforeOpen")},_unbindCompatibility:function(){this.trigger("beforeClose");var t=this.__self._visiblePopupsStack;t.splice(t.indexOf(this),1),this._releaseZIndex()},_onHidden:function(){this._isShown&&this._unbindCompatibility(),this.unbindFromDoc("keydown"),this._detachRepaintOnResize(),this._unbindFocusEvents(),this.hasMod("autoclosable","yes")&&this._disableAutoclosable(),this.hasMod("adaptive","yes")&&this._disableAdaptive(),this._detachUnder(),this._cache={},this._isShown=!1,this._isHiding=!1,this._channel.un("hide"),this._returnFocus(),this.trigger("hide")},_attachRepaintOnResize:function(){window.attachEvent&&this.domElem[0].attachEvent("onresize",this.__self._enforcePageRepaint)},_detachRepaintOnResize:function(){window.detachEvent&&this.domElem[0].detachEvent("onresize",this.__self._enforcePageRepaint)},_bindFocusEvents:function(){this._lastFocused=$($.dom.getActiveElement()[0]||this._scope);var t=this.__self._getFocusable(this.elem("content"));this._firstFocusable=t.first(),this._lastFocusable=t.last(),this._skipReturnFocus=!1,0!==this._firstFocusable.length?this.bindTo(this._lastFocused,"keydown",this._onLastFocusedKeyDown).bindTo(this._firstFocusable,"keydown",this._onFirstFocusableKeyDown).bindTo(this._lastFocusable,"keydown",this._onLastFocusableKeyDown):this._skipReturnFocus=!0},_unbindFocusEvents:function(){this.unbindFrom(this._firstFocusable,"keydown"),this.unbindFrom(this._lastFocusable,"keydown"),this.unbindFrom(this._lastFocused,"keydown")},_onLastFocusedKeyDown:function(t){this._lastFocused.is(this._scope)&&!this._lastFocused.is(t.target)||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this[t.shiftKey?"_lastFocusable":"_firstFocusable"].focus())},_onFirstFocusableKeyDown:function(t){t.ctrlKey||t.altKey||t.metaKey||t.shiftKey&&t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocused.focus())},_onLastFocusableKeyDown:function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocused.focus())},_returnFocus:function(){(this._parent||{})._skipReturnFocus||this._skipReturnFocus||this._lastFocused.focus()},_mergeParams:function(t,e,i){var n={},s=Object.prototype.hasOwnProperty;return i||(i={}),t&&"object"==typeof t&&Object.keys(t).forEach(function(e){n[e]=t[e]}),Object.keys(e).forEach(function(o){var r=s.call(i,o)?i[o].call(this,t[o],e[o]):e[o];!r||"object"!=typeof r||Array.isArray(r)?n[o]=r:t[o]?n[o]=this._mergeParams(t[o],r,i):n[o]=r},this),n},_tailParamsHook:function(t,e){return e.offset||(e.offset=this.params.tail.offset),"number"==typeof e.offset?{offset:{left:e.offset,top:e.offset}}:e},_generateDirections:function(){if(this.__self._generateDirectionsCache)return this.__self._generateDirectionsCache;for(var t=[["bottom","top"],["left","right"]],e=[["center","left","right"],["middle","top","bottom"]],i=e,n=t.length,s=[],o=0;o<n;o++)for(var r=t[o],a=r.length,c=0;c<a;c++)for(var l=e[o],d=l.length,h=0;h<d;h++)for(var u=i[o],m=u.length,p=0;p<m;p++)s.push({direction:r[c],axis:l[h],tail:{axis:u[p]}});return this.__self._generateDirectionsCache=s,s},_repackDirParams:function(t){var e,i={};return("string"==typeof t||$.isPlainObject(t))&&(t=[t]),e=t.map(function(t){if("string"==typeof t){var e=t.split("-");t={to:e[0],tail:{}},e[1]&&(t.axis=e[1]),e[2]&&(t.tail.axis=e[2])}var n=t.to;return i[n]||(i[n]=t),t.axis&&(n+="-"+t.axis),t.key=n,i[n]=t,n},this),{directions:i,keys:e}},setViewport:function(t){return this._viewport=t,this},_pickDirection:function(){var t,e=this._order,i=this.hasMod("adaptive","yes")?e.length:1;for(this._visibilityFactor=0,t=0;t<i;t++){var n=e[t],s=this._directions[n];this._resetPos(n)._pushPos(n,this._calcPos(s))._pushPos(n,this._calcOffsets(s)),this._hasTail()&&this._resetTailPos(n)._pushTailPos(n,this._calcTailPos(s))._pushTailPos(n,this._calcTailOffset(s))._pushPos(n,this._calcOffsetByTail(s)),this._pushPos(n,this._getParentOffset());var o=this._calcVisibilityFactor(s);if((o>this._visibilityFactor||!this._direction)&&(this._visibilityFactor=o,this._direction=this._directions[n],this.size=this.getPlacingSize(),100===o))break}return this._direction},_getParentOffset:function(){var t=this.domElem.offsetParent().offset();return t.left*=-1,t.top*=-1,t},_calcPos:function(t){this._calcPlacingSize(t);var e=this.getOwnerPos(),i=this.getOwnerSize(),n=this.getPlacingSize(),s=t.axis,o=this.params.position||{},r={},a=Object.prototype.hasOwnProperty;switch(t.to){case"bottom":r={top:a.call(o,"top")?o.top:e.top+i.height,left:a.call(o,"left")?o.left:this._calcLeft(s)};break;case"top":r={top:a.call(o,"top")?o.top:e.top-n.height,left:a.call(o,"left")?o.left:this._calcLeft(s)};break;case"left":r={top:a.call(o,"top")?o.top:this._calcTop(s),left:a.call(o,"left")?o.left:e.left-n.width};break;case"right":r={top:a.call(o,"top")?o.top:this._calcTop(s),left:a.call(o,"left")?o.left:e.left+i.width}}return r},_calcTop:function(t){var e=0,i=this.getPlacingSize(),n=this.getOwnerPos(),s=this.getOwnerSize();return"top"===t?e+=n.top:"middle"===t?e+=n.top+s.height/2-i.height/2:"bottom"===t&&(e+=n.top+s.height-i.height),e},_calcLeft:function(t){var e=0,i=this.getPlacingSize(),n=this.getOwnerPos(),s=this.getOwnerSize();return"left"===t?e+=n.left:"center"===t?e+=n.left+s.width/2-i.width/2:"right"===t&&(e+=n.left+s.width-i.width),e},getPlacingSize:function(){return this.getPopupSize()},_calcOffsets:function(t){var e,i=this._cache.offset||(this._cache.offset={}),n=t.key,s=t.offset;if(i[n])return i[n];if(!s)return!1;if(e={left:0,top:0},"number"==typeof s)switch(n){case"left":e.left+=s;break;case"right":e.left-=s;break;case"top":e.top+=s;break;case"bottom":e.top-=s}else s.left&&(e.left+=s.left),s.right&&(e.left-=s.right),s.top&&(e.top+=s.top),s.bottom&&(e.top-=s.bottom);return i[n]=e,e},_hasTail:function(){return 0!==this.elem("tail").length},_moveToContainer:function(t){if(t)this._inContainer=!1;else{if(this._isShown)return;t=this._parent?this._parent.domElem:this._scope}this.domElem.appendTo(t),this._inContainer=!0},_resetPos:function(t){return t?this._positions[t]=null:this._positions={},this},_pushPosTo:function(t,e,i){!1!==i&&("string"==typeof e?this._sum(t[e]||(t[e]={}),i):(i=e,Object.keys(t).forEach(function(e){this._sum(t[e],i)},this)))},_pushPos:function(t,e){return this._pushPosTo(this._positions,t,e),this},_sum:function(t,e){Object.keys(e).forEach(function(i){t[i]=(t[i]||0)+e[i]})},_getSizeOf:function(t){return{height:t.outerHeight(),width:t.outerWidth()}},getOwnerSize:function(){return this._owner?this._cache.ownerSize||(this._cache.ownerSize=this._getSizeOf(this._owner)):{height:0,width:0}},getPopupSize:function(){return this._getSizeOf(this.domElem)},_getPosOf:function(t){return t.offset()||{left:0,top:0}},getOwnerPos:function(){var t;return this._owner&&(t=this._getPosOf(this._owner),"pageYOffset"in window&&(t.top-=window.pageYOffset-(document.documentElement.scrollTop||document.body.scrollTop),t.left-=window.pageXOffset-(document.documentElement.scrollLeft||document.body.scrollLeft))),t||this._userPosition},_calcVisibilityFactor:function(t){var e,i,n=this._viewport,s=this._getSizeOf(n),o=this.getPopupSize(),r=this._positions[t.key],a=this._parent&&this._isParentFixed?this._parent.domElem.offset():{top:0,left:0},c=this.hasMod("position","fixed")?{top:0,left:0}:{top:n.scrollTop(),left:n.scrollLeft()},l=r.top+a.top-c.top,d=r.left+a.left-c.left,h=d+o.width-s.width,u=l+o.height-s.height,m={height:o.height,width:o.width},p=100;return u>0&&(m.height-=u),l<0&&(m.height+=l),d<0&&(m.width+=d),h>0&&(m.width-=h),m.height<0||m.width<0?p=0:(i=Math.abs(m.height*m.width),(e=o.height*o.width)!==i&&(p=i/e*100)),p},_findParent:function(t){var e=t.closest(".popup, .popup2");return this.findBlockOn(e,"popup")||this.findBlockOn(e,"popup2")},destruct:function(){return this._childs.forEach(function(t){t.domElem&&BEM.DOM.destruct(t.domElem)}),this.setMod("fade-out","no"),this.hide(),this._isShown&&this._unbindCompatibility(),this.__base.apply(this,arguments)},_calcZIndexGroupLevel:function(){var t=this.params.zIndexGroupLevel,e=this._getParentPopup();return e&&(t+=e._zIndexGroupLevel),this._destructor?this._destructor.findBlocksOutside("z-index-group").reduce(function(t,e){return t+Number(e.getMod("level"))},t):t},_captureZIndex:function(){null===this._zIndexGroupLevel&&(this._zIndexGroupLevel=this._calcZIndexGroupLevel());var t=this.__self._visiblePopupsZIndexes,e=this._zIndexGroupLevel,i=t[e],n=this._zIndex;return i||(i=t[e]=[(e+1)*this.__self.ZINDEX_FACTOR]),this._zIndex=i[i.length-1]+1,i.push(this._zIndex),this._zIndex!==n&&this.domElem.css("z-index",this._zIndex),this},_releaseZIndex:function(){var t=this.__self._visiblePopupsZIndexes[this._zIndexGroupLevel];return t.splice(t.indexOf(this._zIndex),1),this},_resetDefault:function(){},_calcPlacingSize:function(){}},{live:function(){this.liveBindTo("close","pointerclick",function(){this.hide({source:"close-click"})})},_visiblePopupsStack:(BEM.blocks.popup2||{})._visiblePopupsStack||[],_visiblePopupsZIndexes:(BEM.blocks.popup2||{})._visiblePopupsZIndexes||{},ZINDEX_FACTOR:1e3,_getFocusable:function(t){var e=$.data(t,"popup-getFocusable-id");e||(e=$.identify(),$.data(t,"popup-getFocusable-id",e)),e='*[data-popup-getFocusable-id="'+e+'"]';var i="a[href], link, ";return BEM.blocks["i-ua"].opera<13&&(i=""),t.find(i+'*[tabindex], button, input:not([type="hidden"]), textarea, select, menuitem').filter(function(){var t=$(this),i=!0;return!(parseInt(t.prop("tabindex"),10)<0||"hidden"===t.css("visibility"))&&($(this).parentsUntil(e).each(function(){if("none"===$(this).css("display"))return i=!1}),i)})},_enforcePageRepaint:function(){document.body.className+=""},_generateDirectionsCache:null}),BEM.DOM.decl("popup",{onSetMod:{js:{inited:function(){this.__base.call(this);var t=this.findElem("under").first();this._underClassAttr=t.attr("class"),this.isDivEnough()?this._under=t:(t.remove(),this._under=null),this._underInPool=!1}}},isDivEnough:function(){return!0},_createUnder:function(){return $('<iframe frameBorder="0" tabindex="-1" src="about:blank"/>')},_getUnder:function(){if(this._under)return this._under;var t=this.__self._underPool.pop();return t&&(this._underInPool=!1),this._under=t,t||this._createUnder()},_attachUnder:function(){var t=this._under=this._getUnder();t.attr("class",this._underClassAttr),this.hasMod(t,"type","paranja")?t.detach().insertBefore(this.domElem).css("z-index",this._zIndex):t.prependTo(this.domElem)},_detachUnder:function(){var t=this._under;t.removeAttr("style"),this.__self._underPool.push(t.detach()),this._under=null,this._underInPool=!0},destruct:function(){var t=this.__base.apply(this,arguments);return this._underInPool&&this.__self._underPool.pop(),this._under&&this._under.remove(),t}},{_underPool:[]}),BEM.DOM.decl({block:"m-suggest",modName:"type",modVal:"groups"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._requestSettings={type:this.__self.REQUEST_TYPE,url:"//center.yandex-team.ru/api/autocomplete/groups/",dataType:this.__self.REQUEST_DATA_TYPE,timeout:this.__self.REQUEST_TIMEOUT}}},_prepareRequestData:function(t){var e,i="";return this.params.types.forEach(function(n,s){e=0===s?"":"|","object"==typeof n?(!n.symbolsToSend||n.symbolsToSend<=t.length)&&(i+=e+n.name):i+=e+n}),$.extend({},this._requestSettings,{data:$.extend({q:t,type:i},this.params.addRequestParams)})},_getItemsHTML:function(t){var e=this;return BEMHTML.apply({block:"m-suggest-group",content:$.map(t.slice(0,e.params.maxCount),function(t){return e._getItemBEMJSON("department",t)})})},_toggleItem:function(t){this.__base.apply(this,arguments),this._items[this._curItemIndex]&&this.val(this._items[this._curItemIndex],!0)},_selectItem:function(t,e){this.val(t,!0),this.__base.apply(this,arguments),this._items[this._curItemIndex]&&this._items[this._curItemIndex].delMod("hovered"),this._curItemIndex=-1,this._popup.hide()}}),BEM.DOM.decl({block:"m-suggest",modName:"type",modVal:"service"},{onSetMod:{js:function(){this._suggestUrl=BEM.blocks["i-global"].param("hosts").planner.suggest,this.__base.apply(this,arguments)}},_sendRequest:function(){var t=this;this._input.val()?$.ajax(this._suggestUrl,{crossDomain:!0,xhrFields:{withCredentials:!0},dataType:"jsonp",data:{types:"service",q:this._getInputValue4Request()},success:function(e){t.setState({result:e})},error:this._onFailRequest.bind(this)}):this._popup&&this._popup.delMod("visible")},_getItemsHTML:function(t){var e=t;return BEMHTML.apply(e.map(function(t){return this._getItemBEMJSON("service",t)},this))},_selectItem:function(t,e){this.val(t,!0),this.__base.apply(this,arguments),this._items[this._curItemIndex]&&this._items[this._curItemIndex].delMod("hovered"),this._curItemIndex=-1,this._popup.delMod("visible")}}),BEM.DOM.decl("b-wiki-forms",{onSetMod:{js:function(){this._spinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"load"}),this._onIframeMessageHandler=this._onIframeMessage.bind(this),BEM.DOM.win.on("message",this._onIframeMessageHandler),this.findElem("form").attr("src",this._formUrl(this.params.path))},loaded:{yes:function(){this._spinner.delMod("progress")}}},destruct:function(t){BEM.DOM.win.off("message",this._onIframeMessageHandler),this.__base(t)},_formUrl:function(t){return BEM.blocks["i-global"].param("hosts").forms+t},_onIframeMessage:function(t){var e=t.originalEvent.data;try{e=JSON.parse(e)}catch(t){}e&&e["iframe-height"]&&this.params.name===e.name&&(this.findElem("form").css("height",e["iframe-height"]),this.setMod("loaded","yes"))}},{}),BEM.DOM.decl("b-head",{onSetMod:{js:function(){this.__base.apply(this,arguments),this._newPageButton=this._getNewPageButton(),this._newPageButton&&this._newPageButton.bindTo("mouseup",function(t){yaCounter&&yaCounter.reachGoal("create"),keymaster.command||keymaster.ctrl||2===t.which?window.open(BEM.blocks["wi-history"].getCorrectPath()+".create","_blank").focus():this.openCreatePageWidget("cluster")}.bind(this)),this._bPage=this.findBlockOutside("b-page"),BEM.channel("common").on("b-head.newPageCreate",function(t,e){this.openCreatePageWidget("sub",e&&e.initial)},this)}},_getNewPageButton:function(){return this.findBlockInside({block:"button2",modName:"type",modVal:"new-page"})},openCreatePageWidget:function(t){var e=BEM.blocks["wi-history"].parseURL().params;t=this.params.error?"root":t,this._widget||this._createWidget(),this._widget.open(t,_.unescape(e&&e.title)||null,Boolean(this.params.error)),BEM.blocks["wi-history"].pushState(".create")},_createWidget:function(){BEM.DOM.append(this._bPage.domElem,BEMHTML.apply({block:"b-widget",mods:{type:"new-page"}})),this._widget=this._bPage.findBlockInside({block:"b-widget",modName:"type",modVal:"new-page"})},destruct:function(){BEM.channel("common").un("m-head.newPageCreate"),this.__base.apply(this,arguments)}}),BEM.DOM.decl("b-head",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._servicesDropdown=this.findBlockInside({block:"dropdown2",modName:"role",modVal:"services"}),this.findBlockInside("logo").bindTo("click",this._toggleDropdown.bind(this)),this.bindTo(this.elem("search-button"),"click",this._onSearchIconClick.bind(this)),this._fill()}}},_toggleDropdown:function(){this._servicesDropdown.toggleMod("opened","yes","")},_onSearchIconClick:function(){this.findBlockInside("search2").domElem.submit()},_fill:function(){$.ajax({type:"GET",url:"/_get-services/"}).success(function(t){var e=this._servicesDropdown.getPopup().findBlockInside("services-table");t.services&&BEM.DOM.update(e.domElem,BEMHTML.apply(t.services.map(function(t){return{block:"services-table",elem:"item",content:{block:"service",service:t.slug,name:t.name,url:t.url,icon:t.icon,iconMods:{color:"56"}}}}))),t.company_logo&&(BEM.DOM.replace(this.findBlockInside("logo").domElem,BEMHTML.apply({block:"b-head",elem:"org-logo",src:t.company_logo})),this.bindTo(this.elem("org-logo"),"click",this._toggleDropdown.bind(this)))}.bind(this)).error(function(t){console.error(t)})}},{_dataKey:"header-data",_compareDate:function(t){var e=new Date;if(new Date(e.getFullYear(),e.getMonth(),e.getDate()).valueOf()==t)return!0},_saveDataToLS:function(t,e){var i={data:t,version:1},n=new Date,s=new Date(n.getFullYear(),n.getMonth(),n.getDate()).valueOf();i.login=BEM.blocks["i-global"].param("login"),i.lastCallDate=s,BEM.blocks["mi-storage"].setItem(e,JSON.stringify(i))}}),BEM.DOM.decl("b-favs",{onSetMod:{js:function(){this.bPage=this.findBlockOutside("b-page"),this.defaultFolderName=["__INBOX__",BEM.I18N("b-favs","favorite")],this.autoFolders={__OWNER__:BEM.I18N("b-favs","i_am_author"),__WATCHER__:BEM.I18N("b-favs","i_am_observer"),__LAST_EDIT__:BEM.I18N("b-favs","editerd_by_me")},this.linksCache=[],this._initWidget()},mode:{opened:function(){this._showFavsWidget(),this.bPage.setMod("favorites","visible")},"":function(){this._hideFavsWidget(),this.bOptionsButton.delMod("mode"),this.bPage.delMod("favorites")}}},_onClick:function(t){t.preventDefault(),this.toggleMod("mode","opened")},_initWidget:function(){BEM.DOM.append(this.bPage.domElem,BEMHTML.apply({block:"b-favs-widget"})),this.bWidget=this.bPage.findBlockInside("b-favs-widget"),this.bWidget.on("hide",this._onWidgetHide,this),this.bFolders=this.bWidget.findBlockInside("b-favs-folders"),this.bLinks=this.bWidget.findBlockInside("b-favs-links"),this.bOptionsButton=this.bWidget.findBlockInside("b-favs-options-button")},_showFavsWidget:function(){this.bWidget&&this.bWidget.show()},_hideFavsWidget:function(){this.bWidget&&this.bWidget.hide()},_onWidgetHide:function(){this.delMod("mode")},clearLinksCache:function(t){null!==this.linksCache[t]&&void 0!==this.linksCache[t]&&delete this.linksCache[t]},removeLinkCacheFromCurrentFolder:function(t){var e=null;this.currentFolder&&this.currentFolder.params.name&&(this.linksCache[this.currentFolder.params.name].data.forEach(function(i,n){i.id===t&&(e=n)},this),null!==e&&(this.linksCache[this.currentFolder.params.name].data.splice(e,1),this.linksCache[this.currentFolder.params.name].html=BEMHTML.apply(this.bLinks.__self.getLinksBEMJSON(this.linksCache[this.currentFolder.params.name].data))))},moveLinkInCurrentFolderCache:function(t,e){var i,n=null,s=null;this.currentFolder&&this.currentFolder.params.name&&(this.linksCache[this.currentFolder.params.name].data.forEach(function(o,r){o.id===t&&(n=r,i=o),o.id===e&&(s=r)},this),null!==n&&(this.linksCache[this.currentFolder.params.name].data.splice(n,1),this.linksCache[this.currentFolder.params.name].data.splice(s,0,i),this.linksCache[this.currentFolder.params.name].html=BEMHTML.apply(this.bLinks.__self.getLinksBEMJSON(this.linksCache[this.currentFolder.params.name].data))))},renameLinkInCurFolderCache:function(t,e){this.currentFolder&&this.currentFolder.params.name&&this.linksCache[this.currentFolder.params.name].data.forEach(function(i){i.id===t&&(i.title=e)},this)},clearCurrentLinksCache:function(){this.currentFolder&&this.currentFolder.params.name&&this.clearLinksCache(this.currentFolder.params.name)},changeFolderCount:function(t,e){t.params.count+=e,t.elem("count").html(t.params.count)},changeCurrentFolderCount:function(t){this.currentFolder&&this.changeFolderCount(this.currentFolder,t)},refreshFavs:function(){this.linksCache=[],this.bFolders.initBlock(),this.bLinks.initBlock()}},{live:function(){this.liveBindTo("click",function(t){this._onClick(t)})},foldersTypes:{F:"favorites",A:"autofolders",C:"custom"}}),BEM.DOM.decl("b-favs-widget",{onSetMod:{js:function(){this._bPage=this.findBlockOutside("b-page")}},show:function(){var t,e=this;this.hasMod("visibility","yes")||($(document).on("keyup.favs-widget",function(t){27===t.keyCode&&e.hide()}),(t=this._bPage.findBlockInside({block:"b-widget",modName:"visibility",modVal:"yes"}))&&t.hide(),this.setMod("visibility","yes"),this._bPage.setMod("scroll","disable"),$(document).scrollTop(0),setTimeout(function(){e.setMod("animate","yes")},100))},hide:function(){var t=this;this.hasMod("visibility","yes")&&(this.delMod("animate"),setTimeout(function(){$(document).off("keyup.favs-widget"),t.delMod("visibility"),t._bPage.delMod("scroll"),t.trigger("hide")},400))},_onClick:function(){this.hide()}},{live:function(){this.liveBindTo("paranja","click",function(t){this._onClick(t)})}}),BEM.DOM.decl("b-favs-folders",{onSetMod:{js:function(){this.bPage=this.findBlockOutside("b-page"),this.bFavs=this.bPage.findBlockInside("b-favs"),this.foldersSpinner=this.findBlockInside("spin2"),this.initBlock()},mode:{edited:function(){this._setFoldersDraggable("true")},"":function(){this._setFoldersDraggable("false")}}},initBlock:function(){this._getFolders(),this.findBlockInside("scroll").elem("native").on("scroll",this.closeErrorPopup.bind(this))},_getFolders:function(){this._showSpinner(),BEM.create("wi-api-request",{apiPath:".favorites/folders",path:"",urlParams:["format=json"]}).run().then(this._onGotData.bind(this),BEM.blocks["wi-notification"].errorHandler()).always(function(){this._hideSpinner()}.bind(this))},_onGotData:function(t){var e;t.data.forEach(function(t){t.type=this.bFavs.__self.foldersTypes[t.type]},this),e=BEMHTML.apply(this._getFoldersBEMJSON(t.data)),BEM.DOM.update(this.elem("list"),e,this._onShowFoldersSuccess,this)},_onShowFoldersSuccess:function(){var t=this.findBlocksInside("b-favs-folder");t.length&&(null!=this.bFavs.currentFolderIndex?this.bFavs.currentFolder=t[this.bFavs.currentFolderIndex]||t[0]:this.bFavs.currentFolder=t[0],this.bFavs.currentFolder&&this.bFavs.currentFolder.setMod("current","true"),this.bFavs.currentFolderIndex=null,this.hasMod("mode","edited")&&this._setFoldersDraggable("true"))},_getFoldersBEMJSON:function(t){var e=[],i=this,n=!0;return t.forEach(function(t){"autofolders"==t.type&&n&&(e.push(i._getNewFolderBEMJSON()),n=!1),e.push(i._getFolderBEMJSON(t))}),e},_getFolderBEMJSON:function(t){var e="folder",i=t.name,n="custom";return"favorites"==t.type&&(e="bookmark",i=this.bFavs.defaultFolderName[1],n="default"),"autofolders"==t.type&&(n="auto",i=this.bFavs.autoFolders[t.name]||t.name),{block:"b-favs-folders",elem:"item",mix:[{block:"b-favs-folder",js:{name:t.name,type:t.type,count:t.favorites_count},mods:{type:n}}],content:[{block:"b-favs-folder",elem:"icon",mix:[{block:"awesome-icon",mods:{icon:e}}]},{block:"b-favs-folder",elem:"move",content:{block:"awesome-icon",mods:{icon:"ellipsis-v"}}},{block:"b-favs-folder",elem:"content",content:[{block:"b-favs-folder",elem:"name",content:i},{block:"b-favs-folder",elem:"count",content:t.favorites_count}]},{block:"b-favs-folder",elem:"remove",content:{block:"awesome-icon",mods:{icon:"remove"}}}]}},_getNewFolderBEMJSON:function(){return{block:"b-favs-folders",elem:"item",mix:[{block:"b-favs-folder",mods:{type:"new-folder"}},{block:"b-favs-new-folder",js:!0}],content:[{block:"b-favs-folder",elem:"icon",mix:[{block:"awesome-icon",mods:{icon:"plus-square"}}]},{block:"b-favs-folder",elem:"name",content:BEM.I18N("b-favs-folders","new_folder")}]}},_showSpinner:function(){this.foldersSpinner.setMod("show","yes"),this.foldersSpinner.setMod("progress","yes"),this.elem("list").hide()},_hideSpinner:function(){this.foldersSpinner.setMod("show","no"),this.foldersSpinner.delMod("progress"),this.elem("list").show()},_setFoldersDraggable:function(t){this.findBlocksInside({block:"b-favs-folder",modName:"type",modVal:"custom"}).forEach(function(e){e.domElem.attr("draggable",t)})},closeErrorPopup:function(){this.channel("errors").trigger("errorHide")}}),BEM.DOM.decl("b-favs-folder",{onSetMod:{js:function(){this.__self.bPage||(this.__self.bPage=this.findBlockOutside("b-page")),this.__self.bFavs||(this.__self.bFavs=this.__self.bPage.findBlockInside("b-favs"))},mode:{edited:function(){this.hasMod("type","custom")&&this.domElem.attr("draggable","false")},"":function(){this.hasMod("type","custom")&&this.__self.bFavs.bFolders.hasMod("mode","edited")&&this.domElem.attr("draggable","true")}}},_onNameClick:function(){this._isEditable()&&(this.folderTitle||(this.folderTitleElem=this.findElem("name"),this.folderTitle=this.folderTitleElem.text(),BEM.DOM.after(this.folderTitleElem,BEMHTML.apply({block:"input",js:{autoFocus:"yes"},mods:{size:"s"},value:this.folderTitle,content:{elem:"control"}})),this.folderNameInput=this.findBlockInside("input"),this.folderNameInput.on("blur",this._closeInput,this),this.folderNameInput.bindTo("keypress",this._onInputKeypress.bind(this))),this.setMod("mode","edited"),this.folderNameInput.elem("control").focus(),this.__self.bFavs.bFolders.closeErrorPopup())},_onInputKeypress:function(t){13===t.keyCode&&this.folderNameInput.elem("control").blur()},_closeInput:function(){var t=this.folderNameInput.val();this.delMod("mode"),t!==this.folderTitle&&(this.folderTitleElem.text(t),this._renameFolder(t))},_renameFolder:function(t){BEM.create("wi-api-request",{apiPath:".favorites/folders/"+encodeURIComponent(this.params.name),path:"",method:"POST",data:{new_name:t},urlParams:!1}).run().then(this._onRenameSuccess.bind(this,t),this._onRenameError.bind(this))},_onRenameSuccess:function(t){this.folderTitle=t,this.params.name=t},_onRenameError:function(t){this.folderTitleElem.text(this.params.name),this.folderNameInput.val(this.params.name),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this.domElem,BEM.I18N("b-favs-folder","cant_rename_folder"),t))},_onClick:function(){this.hasMod("current","true")||this.hasMod("type","new-folder")||(this.__self.bFavs.currentFolder.delMod("current"),this.setMod("current","true"),this.__self.bFavs.currentFolder=this,this.__self.bFavs.bOptionsButton.hasMod("mode","edited")&&(this.hasMod("type","auto")?this.__self.bFavs.bLinks.delMod("mode"):this.__self.bFavs.bLinks.setMod("mode","edited")),this.__self.bFavs.bLinks.getLinks(this.params))},_getFolderPrevName:function(){return this.domElem.prev().length&&this.domElem.prev().bem("b-favs-folder").params.name||null},_onDragStart:function(t){var e=t.originalEvent.dataTransfer;if(!this.__self.bFavs.bFolders.hasMod("mode","edited"))return!1;this.setMod("mode","dragging"),this.__self.bFavs.bFolders.setMod("moving","yes"),this.__self.bFavs.draggingFolder=this,this.__self.bFavs.draggingFolderPrevName=this._getFolderPrevName(),e.setData("text/plain",""),e.effectAllowed="move",e.dropEffect="move"},_onDragEnd:function(t){var e=this.__self.bFavs.draggingFolder.params.name,i=this._getFolderPrevName();t.preventDefault(),this.hasMod("mode","dragging")&&this.delMod("mode"),this.__self.bFavs.bFolders.delMod("moving"),this.__self.bFavs.draggingFolderPrevName!==i&&this._dragBookmarkFolder(e,i),this.__self.bFavs.draggingFolder=!1,this.__self.bFavs.draggingFolderPrevName=null},_dragBookmarkFolder:function(t,e){BEM.create("wi-api-request",{apiPath:".favorites/folders/"+encodeURIComponent(t)+"/drag",path:"",method:"POST",data:{after:e},urlParams:!1}).run().then(this._onDragFolderSuccess.bind(this),BEM.blocks["wi-notification"].errorHandler())},_onDragFolderSuccess:function(){},_isEditable:function(){return this.__self.bFavs.bFolders.hasMod("mode","edited")&&this.hasMod("current","true")&&this.hasMod("type","custom")},_isDroppable:function(){return this.__self.bFavs.bFolders.hasMod("dragging","yes")&&!this.hasMod("current","true")&&!this.hasMod("type","auto")&&!this.hasMod("type","new-folder")},_onDragEnter:function(){return this._isDroppable()?(this.setMod("dragging","over"),!1):(!this.__self.bFavs.bFolders.hasMod("moving","yes")||this.__self.bFavs.draggingFolder===this)&&void 0},_onDragLeave:function(){return this._isDroppable()?(this.delMod("dragging"),!1):(!this.__self.bFavs.bFolders.hasMod("moving","yes")||this.__self.bFavs.draggingFolder===this)&&void 0},_onDragOver:function(t){return this._isDroppable()?(t.preventDefault(),!1):this.__self.bFavs.bFolders.hasMod("moving","yes")&&this.__self.bFavs.draggingFolder!==this?(t.preventDefault(),t.originalEvent.target.draggable&&(e=t.target.getBoundingClientRect(),i=(t.originalEvent.clientY-e.top)/(e.bottom-e.top)>.5,this.__self.bFavs.bFolders.elem("list")[0].insertBefore(this.__self.bFavs.draggingFolder.domElem[0],i&&t.originalEvent.target.nextSibling||t.originalEvent.target)),!1):void 0;var e,i},_onDrop:function(){var t,e;this._isDroppable()&&(e=(t=this.__self.bFavs.draggingLink).params.id,this.delMod("dragging"),this.__self.bFavs.isDropped=!0,t.setMod("mode","moving"),this._moveBookmark(e,this))},_moveBookmark:function(t,e){BEM.create("wi-api-request",{apiPath:".favorites/bookmarks/"+t+"/move",path:"",method:"POST",data:{target_folder_name:e.params.name},urlParams:!1}).run().then(this._onMoveSuccess.bind(this,e,t),this._onMoveError.bind(this))},_onMoveSuccess:function(t,e){var i=this;setTimeout(function(){i.__self.bFavs.draggingLink.domElem.hide(200),i.__self.bFavs.draggingLink=!1},10),this.__self.bFavs.changeCurrentFolderCount(-1),this.__self.bFavs.changeFolderCount(t,1),this.__self.bFavs.removeLinkCacheFromCurrentFolder(e),this.__self.bFavs.clearLinksCache(t.params.name)},_onMoveError:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,t)),this.__self.bFavs.draggingLink.delMod("mode"),this.__self.bFavs.draggingLink=!1},_onRemoveClick:function(t){t.stopPropagation(),this.setMod("mode","removing"),BEM.create("wi-api-request",{apiPath:".favorites/folders/"+encodeURIComponent(this.params.name),path:"",method:"DELETE",urlParams:!1}).run().then(this._onRemoveSuccess.bind(this),BEM.blocks["wi-notification"].errorHandler(this.domElem,BEM.I18N("b-favs-folder","cant_delete_folder"))).always(function(){this.delMod("mode")}.bind(this))},_onRemoveSuccess:function(){var t=this.__self.bPage.findBlockInside("b-favs-folder");this.domElem.hide(300),this.__self.bFavs.changeFolderCount(t,this.params.count),this.__self.bFavs.clearLinksCache(this.params.name),this.__self.bFavs.clearLinksCache(t.params.name),this.__self.bFavs.currentFolder===this&&t.domElem.trigger("click")}},{live:function(){this.liveBindTo("name","click",function(){this._onNameClick()}),this.liveBindTo("remove","click",function(t){this._onRemoveClick(t)}),this.liveBindTo("click",function(){this._onClick()}),this.liveBindTo("dragstart",function(t){this._onDragStart(t)}),this.liveBindTo("dragend",function(t){this._onDragEnd(t)}),this.liveBindTo("dragenter",function(t){this._onDragEnter(t)}),this.liveBindTo("dragleave",function(t){this._onDragLeave(t)}),this.liveBindTo("dragover",function(t){this._onDragOver(t)}),this.liveBindTo("drop",function(t){this._onDrop(t)})}}),BEM.DOM.decl("b-favs-new-folder",{onSetMod:{js:function(){this.bPage=this.findBlockOutside("b-page"),this.bFavs=this.bPage.findBlockInside("b-favs")}},_onClick:function(){this.folderBlock=this.findBlockOn("b-favs-folder"),this.folderTitleElem=this.folderBlock.findElem("name"),BEM.DOM.after(this.folderTitleElem,BEMHTML.apply({block:"input",js:{autoFocus:"yes"},mods:{size:"s"},value:BEM.I18N("b-favs-new-folder","new_folder"),content:{elem:"control"}})),BEM.DOM.destruct(this.folderBlock.elem("name")),this.folderNameInput=this.findBlockInside("input"),this.folderNameInput.on("blur",this._closeInput,this),this.folderNameInput.bindTo("keypress",this._onInputKeypress.bind(this)),this.folderBlock.setMod("mode","edited"),this.folderNameInput.elem("control").focus()},_onInputKeypress:function(t){this.bFavs.bFolders.closeErrorPopup(),13===t.keyCode&&this.folderNameInput.elem("control").blur()},_closeInput:function(){var t=this.folderNameInput.val();this.setMod("mode","creating"),this._createNewFolder(t)},_createNewFolder:function(t){BEM.create("wi-api-request",{apiPath:".favorites/folders/"+encodeURIComponent(t),path:"",method:"PUT",urlParams:!1}).run().then(this._onCreateSuccess.bind(this,t),this._onCreateError.bind(this)).always(function(){this.delMod("mode")}.bind(this))},_onCreateSuccess:function(){this.bFavs.currentFolderIndex=this.bFavs.currentFolder.domElem.index(),this.bFavs.bFolders._getFolders()},_onCreateError:function(t){this.bFavs.bFolders.hasMod("mode","edited")&&BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this.domElem,BEM.I18N("b-favs-new-folder","cant_create_folder"),t))}},{live:function(){this.liveBindTo("click",function(t){this._onClick(t)})}}),BEM.DOM.decl("b-favs-links",{onSetMod:{js:function(){this.bPage=this.findBlockOutside("b-page"),this.bFavs=this.bPage.findBlockInside("b-favs"),this.linksSpinner=this.findBlockInside("spin2"),this._filterInput=this.findBlockInside({block:"input",modName:"type",modVal:"filter"}).on("change",this._onFilterInputChange,this),this.initBlock()},mode:{edited:function(){this.findElem("item").attr("draggable","true")},"":function(){this.findElem("item").attr("draggable","false")}},"data-loaded":{yes:function(){this._filterInput.val("").elem("control").attr("placeholder",BEM.I18N("b-favs-links","search_in_folder")+" «"+this._getCurFolderName()+"»"),this.afterCurrentEvent(function(){this._filterInput.elem("control").focus()},this)}}},initBlock:function(){this.getLinks({type:"favorites",name:this.bFavs.defaultFolderName[0]})},getLinks:function(t){var e=t.name;this._curFolder=t,this.delMod("data-loaded"),this.bFavs.linksCache[e]?this._showLinks(e):(this._showSpinner(),BEM.create("wi-api-request",{apiPath:".favorites/folders/"+encodeURIComponent(e),path:"",urlParams:["format=json"]}).run().then(this._onGotData.bind(this,e),BEM.blocks["wi-notification"].errorHandler()).always(function(){this._hideSpinner()}.bind(this)))},_onFilterInputChange:function(t){this._filterItems(t.block.val())},_filterItemsCore:function(t,e,i){var n=i.title.toLowerCase(),s=this.__self._getTranslit(n),o=i.url.toLowerCase();return this.__self._removableDomains.forEach(function(t){o=o.replace(t,"")}),-1!==n.indexOf(t)||-1!==n.indexOf(e)||-1!==s.indexOf(t)||-1!==o.indexOf(t)||-1!==o.indexOf(e)},_filterItems:function(t){var e=this._curFolder?this.bFavs.linksCache[this._curFolder.name]:null,i=e?e.data:null,n=t.toLowerCase(),s=this.__self._getTranslit(n);i?(BEM.DOM.update(this.elem("list"),BEMHTML.apply(this.__self.getLinksBEMJSON(i.filter(this._filterItemsCore.bind(this,n,s))))),this.hasMod("mode","edited")&&this.findElem("item").attr("draggable","true")):(this._showSpinner(),BEM.create("wi-api-request",{apiPath:".favorites/folders/"+encodeURIComponent(this._curFolder.name),path:"",urlParams:["format=json"]}).run().then(function(e){this.bFavs.linksCache[this._curFolder.name]={data:e.data,html:BEMHTML.apply(this.__self.getLinksBEMJSON(e.data))},this._filterItems(t)}.bind(this),BEM.blocks["wi-notification"].errorHandler()).always(function(){this._hideSpinner()}.bind(this)))},_onGotData:function(t,e){this.bFavs.linksCache[t]={data:e.data,html:BEMHTML.apply(this.__self.getLinksBEMJSON(e.data))},this._showLinks(t)},_showLinks:function(t){var e=this.bFavs.linksCache[t];e&&(BEM.DOM.update(this.elem("list"),this.bFavs.linksCache[t].html),e.data.length&&this.setMod("data-loaded","yes"),this.hasMod("mode","edited")&&this.findElem("item").attr("draggable","true"))},_showSpinner:function(){this.linksSpinner.setMod("show","yes"),this.linksSpinner.setMod("progress","yes"),this.elem("list").hide()},_hideSpinner:function(){this.linksSpinner.setMod("show","no"),this.linksSpinner.delMod("progress"),this.elem("list").show()},_getCurFolderName:function(){return"favorites"===this._curFolder.type?this.bFavs.defaultFolderName[1]:"autofolders"===this._curFolder.type?this.bFavs.autoFolders[this._curFolder.name]:this._curFolder.name}},{_getTranslit:function(t){var e,i={"а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"e","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"","ы":"y","ь":"","э":"e","ю":"yu","я":"ya",a:"а",b:"б",c:"с",d:"д",e:"е",f:"ф",g:"г",h:"х",i:"и",j:"ж",k:"к",l:"л",m:"м",n:"н",o:"о",p:"п",q:"к",r:"р",s:"с",t:"т",u:"у",v:"в",w:"в",x:"кс",y:"уай",z:"з"},n="";for(e=0;e<t.length;e++)n+=void 0!==i[t[e]]?i[t[e]]:t[e];return n},_removableDomains:[window.location.origin,"http://wiki.yandex-team.ru","https://wiki-unstable.dev.yandex-team.ru"],getLinksBEMJSON:function(t){var e=this,i=[];return t.forEach(function(t){var n,s=t.url;t.title=t.title,e._removableDomains.forEach(function(t){s=s.replace(t,"")}),n={block:"b-favs-links",elem:"item",mix:[{block:"b-favs-link",js:{id:t.id}}],content:[{block:"b-favs-link",elem:"move",content:{block:"awesome-icon",mods:{icon:"ellipsis-v"}}},{block:"b-favs-link",elem:"title",content:{block:"link",url:t.url,content:t.title}},{block:"b-favs-link",elem:"url",content:s},{block:"b-favs-link",elem:"date",timestamp:t.page_modified_at},{block:"b-favs-link",elem:"remove",content:{block:"awesome-icon",mods:{icon:"remove"}}}]},i.push(n)}),i}}),BEM.DOM.decl("b-favs-links",{},{getLinksBEMJSON:function(t){var e=this,i=[];return t.forEach(function(t){t.url="ru"===BEM.blocks["i-global"].param("content-region")?t.url:t.url.replace(".yandex.ru",".yandex.com");var n,s=t.url;t.title=t.title,e._removableDomains.forEach(function(t){s=s.replace(t,"")}),n={block:"b-favs-links",elem:"item",mix:[{block:"b-favs-link",js:{id:t.id}}],content:[{block:"b-favs-link",elem:"move",content:{block:"awesome-icon",mods:{icon:"ellipsis-v"}}},{block:"b-favs-link",elem:"title",content:{block:"link",url:t.url,content:t.title}},{block:"b-favs-link",elem:"url",content:s},{block:"b-favs-link",elem:"date",timestamp:t.page_modified_at},{block:"b-favs-link",elem:"remove",content:{block:"awesome-icon",mods:{icon:"remove"}}}]},i.push(n)}),i}}),BEM.DOM.decl("b-favs-link",{onSetMod:{js:function(){this.__self.bPage||(this.__self.bPage=this.findBlockOutside("b-page")),this.__self.bFavs||(this.__self.bFavs=this.__self.bPage.findBlockInside("b-favs"))},mode:{edited:function(){this.domElem.attr("draggable","false")},"":function(){this.__self.bFavs.bLinks.hasMod("mode","edited")&&this.domElem.attr("draggable","true")}}},_onClick:function(t){this.__self.bFavs.bLinks.hasMod("mode","edited")?(t.preventDefault(),this.linkTitle||this.bLink||(this.linkTitle=this.findElem("title"),this.bLink=this.findBlockInside("title","link"),this.linkText=this.bLink.domElem.text(),BEM.DOM.append(this.linkTitle,BEMHTML.apply({block:"input",js:{autoFocus:"yes"},mods:{size:"s"},value:this.linkText,content:{elem:"control"}})),this.linkInput=this.findBlockInside("title","input"),this.linkInput.on("blur",this._closeInput,this),this.linkInput.bindTo("keypress",this._onInputKeypress.bind(this))),this.setMod("mode","edited"),this.linkInput.elem("control").focus()):yaCounter&&yaCounter.reachGoal("from_bookmarks")},_onInputKeypress:function(t){13===t.keyCode&&this.linkInput.elem("control").blur()},_closeInput:function(){var t=this.linkInput.val();this.delMod("mode"),t&&t!==this.linkText&&(this.bLink.domElem.text(t),this._renameBookmark(t))},_renameBookmark:function(t){BEM.create("wi-api-request",{apiPath:".favorites/bookmarks/"+this.params.id,path:"",method:"POST",data:{title:t},urlParams:!1}).run().then(this._onRenameSuccess.bind(this,t,this.params.id),this._onRenameError.bind(this))},_onRenameSuccess:function(t,e){this.linkText=t,this.__self.bFavs.renameLinkInCurFolderCache(e,t)},_onRenameError:function(t){this.bLink.domElem.text(this.linkText),this.linkInput.val(this.linkText),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this.linkTitle,BEM.I18N("b-favs-link","cant_rename_link"),t))},_onRemoveClick:function(){this.setMod("mode","removing"),BEM.create("wi-api-request",{apiPath:".favorites/bookmarks/"+this.params.id,path:"",method:"DELETE",urlParams:!1}).run().then(this._onRemoveSuccess.bind(this,this.params.id),this._onRemoveError.bind(this))},_onRemoveSuccess:function(t){var e=this,i=this.getLocation(this.findBlockInside("link").domElem.attr("href"));setTimeout(function(){e.domElem.hide(300)},10),this.__self.bFavs.removeLinkCacheFromCurrentFolder(t),this.__self.bFavs.changeCurrentFolderCount(-1),location.pathname+location.hash===i.pathname+i.hash&&BEM.WISTORE.get("page").set("isFav",!1)},_onRemoveError:function(t){this.delMod("mode"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this.linkTitle,BEM.I18N("b-favs-link","cant_delete_link"),t))},getLocation:function(t){var e=document.createElement("a");return e.href=t,e},_getLinkPrevID:function(){return this.domElem.prev().length&&this.domElem.prev().bem("b-favs-link").params.id||null},_onDragStart:function(t){var e=t.originalEvent.dataTransfer;if(!this.__self.bFavs.bLinks.hasMod("mode","edited"))return!1;this.setMod("mode","dragging"),this.__self.bFavs.bLinks.setMod("dragging","yes"),this.__self.bFavs.bFolders.setMod("dragging","yes"),this.__self.bFavs.draggingLink=this,this.__self.bFavs.draggingLinkPrevID=this._getLinkPrevID(),e.setData("text/plain",""),e.effectAllowed="move",e.dropEffect="move"},_onDragEnd:function(t){var e=this.__self.bFavs.draggingLink.params.id,i=this._getLinkPrevID();t.preventDefault(),this.hasMod("mode","dragging")&&this.delMod("mode"),this.__self.bFavs.bFolders.delMod("dragging"),this.__self.bFavs.bLinks.delMod("dragging"),this.__self.bFavs.isDropped||(this.__self.bFavs.draggingLinkPrevID!==i&&this._dragBookmark(e,i),this.__self.bFavs.draggingLink=!1,this.__self.bFavs.draggingLinkPrevID=null),this.__self.bFavs.isDropped=!1},_onDragEnter:function(){if(this.__self.bFavs.draggingLink!==this)return!1},_onDragLeave:function(){if(this.__self.bFavs.draggingLink!==this)return!1},_onDragOver:function(t){var e,i;return t.preventDefault(),this.__self.bFavs.bLinks.hasMod("dragging","yes")&&this.__self.bFavs.draggingLink!==this&&(e=t.target.getBoundingClientRect(),(i=(t.originalEvent.clientY-e.top)/(e.bottom-e.top)>.5)&&!t.originalEvent.target.nextSibling&&this.__self.bFavs.bLinks.elem("list")[0].appendChild(this.__self.bFavs.draggingLink.domElem[0]),this.__self.bFavs.bLinks.elem("list")[0].insertBefore(this.__self.bFavs.draggingLink.domElem[0],i&&t.originalEvent.target.nextSibling||t.originalEvent.target)),!1},_dragBookmark:function(t,e){BEM.create("wi-api-request",{apiPath:".favorites/bookmarks/"+t+"/drag",path:"",method:"POST",data:{after:e},urlParams:!1}).run().then(this._onDragSuccess.bind(this,t,e),BEM.blocks["wi-notification"].errorHandler())},_onDragSuccess:function(t,e){this.__self.bFavs.moveLinkInCurrentFolderCache(t,e)}},{live:function(){this.liveBindTo("title","click",function(t){this._onClick(t)}),this.liveBindTo("remove","click",function(t){this._onRemoveClick(t)}),this.liveBindTo("dragstart",function(t){this._onDragStart(t)}),this.liveBindTo("dragend",function(t){this._onDragEnd(t)}),this.liveBindTo("dragenter",function(t){this._onDragEnter(t)}),this.liveBindTo("dragleave",function(t){this._onDragLeave(t)}),this.liveBindTo("dragover",function(t){this._onDragOver(t)})}}),BEM.DOM.decl("b-favs-options-button",{onSetMod:{js:function(){this.bPage=this.findBlockOutside("b-page"),this.bFavs=this.bPage.findBlockInside("b-favs"),this.editButton=this.findBlockOn("button2")},mode:{edited:function(){this.editButton.elem("text").text(BEM.I18N("b-favs-options-button","complete")),this.bFavs.currentFolder.hasMod("type","auto")||this.bFavs.bLinks.setMod("mode","edited"),this.bFavs.bFolders.setMod("mode","edited")},"":function(){this.editButton.elem("text").text(BEM.I18N("b-favs-options-button","settings")),this.bFavs.bLinks.delMod("mode"),this.bFavs.bFolders.delMod("mode")}}},_onClick:function(t){this.toggleMod("mode","edited")}},{live:function(){this.liveBindTo("click",function(t){this._onClick(t)})}}),BEM.DOM.decl({block:"m-suggest",modName:"type",modVal:"intranet-suggest"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._requestSettings={type:this.__self.REQUEST_TYPE,url:"//search.yandex-team.ru/suggest",dataType:this.__self.REQUEST_DATA_TYPE,timeout:this.__self.REQUEST_TIMEOUT}}},_prepareRequestData:function(t){var e=[];return this.params.types.forEach(function(i){"object"==typeof i?(!i.symbolsToSend||i.symbolsToSend<=t.length)&&e.push(i.name.replace("staff","people")):e.push(i.replace("staff","people"))}),$.extend({},this._requestSettings,{data:$.extend({text:t,s:e},this.params.addRequestParams)})},_isNotEmptyResult:function(t){var e=!1;return Object.keys(t).forEach(function(i){t[i].length&&(e=!0)}),e},_getItemsHTML:function(t){var e,i=[],n=this,s=this.params.target,o="";return Object.keys(t).forEach(function(r,a){var c=r.replace("people","staff");(e=n._getItemTypeFromOptions(c)).maxCount&&(t[r]=t[r].slice(0,e.maxCount)),o=n.params.inHeader||n.params.inSearchHeader||"staff"===c?"":c,i.push({block:"m-suggest-group",groupLabel:o,content:$.map(t[r],function(t){return s&&(t.target=s),t.valueField=e.valueField||null,n._getItemBEMJSON(c,t,!0)})})}),BEMHTML.apply(i)},_selectItem:function(t,e){this.__base.apply(this,arguments),e&&BEM.DOM.win[0].open(t.params.href,this.params.target||"_self")}}),BEM.DOM.decl({block:"m-suggest",modName:"type",modVal:"intranet-suggest"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.pathname&&(this._cluster=this.__self._getCluster(this.params.pathname)),this._requestSettings.url=this.params.url||"//search.yandex-team.ru/suggest/"}},_isNotEmptyResult:function(t){var e=!1;return Object.keys(t).forEach(function(i){t[i].length&&(e=!0)}),e||Boolean(this._cluster)},_getItemsHTML:function(t){var e,i,n=[],s=this,o=this.params.target,r="";return this._cluster&&(e=this._cluster.match(/\//g),n.push(this._getItemBEMJSON("cluster-search",{cluster:this._cluster,withoutFrom:!0,href:"//search.yandex-team.ru/wikisearch?text="+this._getInputValue4Request()+"&facet.cluster"+(e?e.length+1:1)+"="+this._cluster},!0))),Object.keys(t).forEach(function(e){if("meta"!==e){var a=e.replace("people","staff");(i=s._getItemTypeFromOptions(a)).maxCount&&(t[e]=t[e].slice(0,i.maxCount)),r=s.params.inHeader||s.params.inSearchHeader||"staff"===a?"":a,n.push({block:"m-suggest-group",groupLabel:r,content:$.map(t[e],function(t){return o&&(t.target=o),s._getItemBEMJSON(a,t,!0)})})}}),BEMHTML.apply(n)}},{_getCluster:function(t){var e,i=BEM.WISTORE.get("page");return i?i.get("superTag"):(e=decodeURIComponent(t)).substr(1,e.length-2)}}),BEM.DOM.decl("messenger",{onSetMod:{js:{inited:function(){this.afterCurrentEvent(function(){window.Ya&&window.Ya.ChatWidget?this._initWidget():this._loadWidget()}.bind(this))}}},_loadWidget:function(){window.yandexChatWidgetCallback=function(){this._initWidget(),delete window.yandexChatWidgetCallback}.bind(this);var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.async=!0,e.src=this.params.scriptUrl,t.parentNode.insertBefore(e,t)},_initWidget:function(){try{this._widget=new window.Ya.ChatWidget({badgeType:"dot",buttonIcon:"black",iframeUrl:this.params.iframeUrl,iframeUrlParams:this.params.iframeUrlParams,mountNode:this.domElem[0],theme:"legacy",unreadUrl:this.params.unreadUrl})}catch(t){}},destruct:function(){this._widget&&(this._widget.destroy(),delete this._widget)},getDefaultParams:function(){return{scriptUrl:"https://chat.s3.yandex.net/widget_ya.js"}}}),BEM.DOM.decl("w-header-settings",{onSetMod:{js:function(){this._icon=this.findBlockInside("awesome-icon"),this._icon.bindTo("click",this._onClick.bind(this))}},_onClick:function(){this._getPopup().toggleMod("visible","yes","")},_getPopup:function(){return this._popup||(this._popup=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply(this._getPopupBEMJSON())).bem("popup2").setAnchor(this._icon.domElem).on("beforeOpen",this._onPopupShow,this).on("afterClose",this._onPopupHide,this)),this._popup},_onPopupShow:function(){this.setMod("opened","yes")},_onPopupHide:function(){this.delMod("opened")},_getPopupBEMJSON:function(){return{block:"popup2",mods:{target:"anchor",theme:"normal",autoclosable:"yes"},mix:{block:"w-header-settings",elem:"popup"},directions:"bottom-center",content:[{block:"popup2",elem:"tail"},{block:"popup2",elem:"content",content:[{block:"w-header-settings",elem:"item",text:BEM.I18N("b-head","me"),url:"/~",icon:"user"},{block:"w-header-settings",elem:"item",text:BEM.I18N("b-head","options"),url:"/_settings",icon:"cog"}]}]}}}),BEM.DOM.decl("user2",{onSetMod:{js:{inited:function(){if(this._retpath=this.params._retpath,this._isAuthorized=Boolean(this.params._uid),!this._isAuthorized)return!0;this._currentAccount=this.findBlockOn("current-account","user-account"),this._popup=this.findBlockInside("light-popup"),this._menu=this.findBlockInside("menu"),this._exitItem=this.elem("menu-item","action","exit"),this._plusItem=this.elem("menu-item","action","plus"),this._addItem=this.elem("add-account"),this._accountsContainer=this.findElem(this._menu.domElem,"accounts-container"),this._menuCounter=this.findElem("menu-counter"),this.bindTo("menu-item","pointerclick",this._onMenuItemClick),this.bindTo(this._exitItem,"pointerclick",this._onLogout),BEM.blocks["user-account"].on(this._accountsContainer,"click",this._onAccountClick,this),BEM.blocks["user-account"].on(this._accountsContainer,"logout",this._processLogout,this)}},opened:{yes:function(){this.domElem.attr("aria-expanded",!0),this._popup.setMod("visible","yes").on("beforeClose",this._onPopupClose,this),this._setMaxHeight(),this.bindToWin("resize orientchange",this._setMaxHeight),this._popup.on("beforeOpen",function(){this._onPopupOpen(),this._popup.un("beforeOpen",this._onPopupOpen,this)},this)},"":function(){var t=this.trigger("beforeClose");if(t.isDefaultPrevented&&t.isDefaultPrevented())return!1;this.unbindFromWin("resize orientchange",this._setMaxHeight),this.domElem.attr("aria-expanded",!1),this._popup.delMod("visible").un("beforeClose",this._onPopupClose,this)}}},destruct:function(){return this._isAuthorized&&(BEM.blocks["user-account"].un(this._accountsContainer,"click",this._onAccountClick,this),BEM.blocks["user-account"].un(this._accountsContainer,"logout",this._processLogout,this)),this.__base.apply(this,arguments)},setUnreadCount:function(t){var e=this._menu.findBlockInside("user-account");return this._currentAccount.setCounter(t),e&&e.hasMod("has-ticker")&&e.setCounter(t),this._menuCounter&&(t>0?this.delMod(this._menuCounter,"state","empty"):this.setMod(this._menuCounter,"state","empty"),this._menuCounter[0].innerText=t),this},setRetpath:function(t){this._retpath=t;var e=encodeURIComponent(t);return $().add(this._menu&&this._menu.findElem("item")).add(this.findElem("current-account")).add(this.findElem("a11y-exit")).add(this.findElem("enter")).add(this._addItem).each(function(t,i){var n=$(i),s=n.attr("href");if(s){var o=s.replace(/([\&\?]retpath=)[^\&]*/,"$1"+e);o!==s&&n.attr("href",o)}}),this},getPopup:function(){return this._popup},getMenu:function(){return this._menu},getCurrentAccount:function(){return this._currentAccount},_changeUser:function(t){var e=this.params._passportHost+"/passport?mode=embeddedauth";$('<form method="POST" action="'+e+'"><input type="hidden" name="action"  value="change_default"><input type="hidden" name="uid"     value="'+t+'"><input type="hidden" name="retpath" value="'+this._retpath+'"><input type="hidden" name="yu"      value="'+this.params._yu+'"></form>').appendTo("body").submit()},_onCurrentAccountClick:function(t,e){t.block===this._currentAccount&&(e.domEvent.preventDefault(),this.toggleMod("opened","yes"),this.trigger("current-account-click"))},_onAccountClick:function(t,e){if(!e.isLogout){var i=this.elemParams(t.block.domElem).uid;this._changeUser(i)}},_onPopupClose:function(){this.delMod("opened")},_onPopupOpen:function(){this.trigger("beforeOpen")},_processLogout:function(t){var e=this.elemParams(t.target.domElem).uid;e&&this.trigger("logout-click",{uid:e,account:t.target})},_onMenuItemClick:function(){this.trigger("menu-item-click")},_onLogout:function(){this.trigger("logout")},_setMaxHeight:function(){var t=BEM.DOM.win,e=this.params.menuMaxHeight;e||(e=t.height()-this.domElem.offset().top+t.scrollTop()),this._menu.domElem.css("max-height",e)},getDefaultParams:function(){return{menuMaxHeight:0}}},{live:function(){this.liveInitOnBlockInsideEvent("init","user-account"),this.liveInitOnBlockInsideEvent("click","user-account",this.prototype._onCurrentAccountClick),this.liveBindTo("enter","pointerclick",function(){this.trigger("login")})}}),function(t){var e=t.innerWidth>t.innerHeight,i=t.innerWidth,n=$.throttle(function(){var n=t.innerWidth,s=t.innerHeight,o=n>s;o!==e&&n!==i&&($(t).trigger("orientchange",{landscape:o,width:n,height:s}),e=o,i=n)},400);BEM.DOM.win.bind("resize",n),BEM.DOM.decl("i-ua",{onSetMod:{js:{inited:function(){this.bindToWin("orientchange",this._onOrientChange,this).__base.apply(this,arguments)}}},_onOrientChange:function(t,e){var i=this.__self,n=document.documentElement,s=n.className,o="i-ua_orient_"+(e.landscape?"landscape":"portrait");-1===s.indexOf(o)&&(n.className=s.replace(/\bi-ua_orient_\w+\b/,o)),i.width=e.width,i.height=e.height,i.landscape=e.landscape}},{width:t.innerWidth,height:t.innerHeight,landscape:e})}(window),BEM.DOM.decl("user-account",{setCounter:function(t){var e=this.findBlockInside("ticker");e&&e.val(t)},_onClick:function(t){var e={domEvent:t};this.isLogoutClick&&(e.isLogout=!0,this.isLogoutClick=!1),this.trigger("click",e)},_onMouseOver:function(t){this.setMod("hovered","yes").bindTo("mouseleave",this._onMouseLeave)},_onMouseLeave:function(){this.delMod("hovered").unbindFrom("mouseleave")},_onFocusIn:function(t){this.trigger("focus").setMod("focused","yes").bindTo("focusout",this._onFocusOut)},_onFocusOut:function(){this.trigger("blur").delMod("focused").unbindFrom("focusout")},_onLogoutClick:function(){this.isLogoutClick=!0,this.trigger("logout")}},{live:function(){this.liveBindTo("pointerclick",this.prototype._onClick),this.liveBindTo("focusin",this.prototype._onFocusIn),this.liveBindTo("mouseover",this.prototype._onMouseOver),this.liveBindTo("logout","pointerclick",this.prototype._onLogoutClick)}}),function(t){var e=1,i=!1;if("deviceXDPI"in screen&&"logicalXDPI"in screen?e=screen.deviceXDPI/screen.logicalXDPI:"devicePixelRatio"in t&&(e=t.devicePixelRatio),"function"==typeof t.matchMedia){i=t.matchMedia("only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx), only screen and (min-resolution: 124dpi)").matches}else i=e>=1.3;BEM.DOM.decl("i-ua",{},{dpr:e,hiDpi:i})}(window),BEM.DOM.decl("user-pic",{onSetMod:{js:{inited:function(){var t=this.elem("link")[0];t&&(t.href=this.params.cameraURL+"?retpath="+encodeURIComponent(window.location.href)+"&origin="+this.params.origin)}}},getDefaultParams:function(){return{origin:"userpic",cameraURL:"https://passport.yandex.ru/profile/public"}}}),BEM.DOM.decl("ticker",{onSetMod:{js:{inited:function(){this._count=this.params.count}}},show:function(){return this.setMod("state","normal")},hide:function(){return this.setMod("state","empty")},val:function(t){if(!arguments.length)return this._count;var e=this.params.maxCount;return this._count=t,this.elem("value").attr("title",t).text(t>e?e:t),t?this.show():this.hide(),this}}),BEM.DOM.decl("light-popup",{onSetMod:{js:{inited:function(){this._moved=this.params.moved}},visible:{yes:function(){this.trigger("beforeOpen"),!this._moved&&this._moveToTarget()},"":function(){"yes"===this.getMod("animated")&&this.setMod("reverse-animation"),this.trigger("beforeClose")}}},_moveToTarget:function(){var t=this.findBlockOutside(this.params.target);this._owner=t.domElem||BEM.DOM.scope,this._owner.append(this.domElem),this._moved=!0},setContent:function(t){this._isUpdatedContent||(this._isUpdatedContent=!0,this.afterCurrentEvent(function(){delete this._isUpdatedContent}),BEM.DOM.update(this.domElem,t))},getDefaultParams:function(){return{moved:!1}}}),BEM.DOM.decl("user-organization",{_onClick:function(t){var e={domEvent:t};this.trigger("click",e)},_onMouseOver:function(){this.setMod("hovered","yes").bindTo("mouseleave",this._onMouseLeave)},_onMouseLeave:function(){this.delMod("hovered").unbindFrom("mouseleave",this._onMouseLeave)},_onFocusIn:function(){this.trigger("focus").setMod("focused","yes").bindTo("focusout",this._onFocusOut)},_onFocusOut:function(){this.trigger("blur").delMod("focused").unbindFrom("focusout",this._onFocusOut)}},{live:function(){this.liveBindTo("pointerclick",this.prototype._onClick).liveBindTo("focusin",this.prototype._onFocusIn).liveBindTo("mouseover",this.prototype._onMouseOver)}}),function(){BEM.decl("y-cookie",{},function(t){"use strict";function e(t){try{return decodeURIComponent(t)}catch(e){return t}}return t.parse=function(t){if(!t||"string"!=typeof t||!t.length)return{};/%23\d{10}/.test(t)&&(t=e(t)),t=t.split("#");for(var i,n=Date.now()/1e3,s={},o=0,r=t.length;o<r;o++)2===(i=t[o].split(".")).length?s[i[0]]=e(i[1]):i.length>2&&(isNaN(i[0])?s[i[0]]=e(i.slice(1).join(".")):i[0]>n&&(s[i[1]]={value:e(i.slice(2).join(".")),expires:new Date(Number(i[0]+"000"))}));return s},t.stringify=function(t){if(t&&"object"==typeof t){for(var e,i,n=[],s=0,o=Object.keys(t),r=o.length;s<r;s++)e=t[o[s]],i=[o[s],encodeURIComponent(e.value||e)],/\d+/.test(e.expires)&&i.unshift(e.expires),n.push(i.join("."));return n.join("#")}},t}({}))}(),BEM.DOM.decl("i-explainer",{},{uniqueLinks:[],linksTree:{},explainLinks:function(t){var e=this;this.uniqueLinks=[],this.linksTree={},t.findBlocksInside("link").forEach(function(t){e._addLink(t)}),this._sendExplainLinksRequest()},explainAllLinks:function(t){var e=this;this.uniqueLinks=[],this.linksTree={},t.findBlocksInside({block:"wiki-ref",modName:"wiki",modVal:"yes"}).forEach(function(t){t.findBlockOn("wiki-ref").hasMod("file","yes")||e._addLink(t)}),t.findBlocksInside("wiki-action").forEach(function(t){t.findBlocksInside("link").forEach(function(t){e._addLink(t)})}),this._sendExplainLinksRequest()},_addLink:function(t){var e=t.domElem.attr("data-link")||t.domElem.attr("href");e&&($.inArray(e,this.uniqueLinks)<0&&(this.uniqueLinks.push(e),this.linksTree[e]=[]),this.linksTree[e].push(t))},_sendExplainLinksRequest:function(){var t=BEM.WISTORE.get("page"),e={links:{}};e.links[t.get("superTag")]=this.uniqueLinks,this.uniqueLinks.length&&BEM.create("wi-api-request",{apiPath:".explainlinks",method:"POST",data:e,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onExplainLinksSuccess.bind(this),BEM.blocks["wi-notification"].errorHandler())},_onExplainLinksSuccess:function(t){var e=t.data.links;for(var i in e)e.hasOwnProperty(i)&&i in this.linksTree&&this.linksTree[i].forEach(function(t){var n,s;-1!==e[i]&&0!==e[i]||BEM.DOM.prepend(t.domElem,BEMHTML.apply({block:"awesome-icon",mods:{icon:-1===e[i]?"plus-circle":"lock",explainer:"yes"}})),-1===e[i]&&(s=(n=BEM.blocks["wi-history"].parseURL(t.domElem.attr("href"))).breadcrumbs.length?n.breadcrumbs.pop():"",t.domElem.attr("href",BEM.blocks["wi-history"].formURL({pathname:n.path,handler:".create",search:{title:this._getLinkTitle(t,s)}})))},this)},_getLinkTitle:function(t,e){var i=t.domElem.text();return t.domElem.attr("href")===i?_.escape(e):_.escape(i)}}),BEM.decl("wi-api-request",{onSetMod:{js:function(){this._options=_.extend({},this.__self._defaultOptions,this.params),this._options.query&&(this._options.urlParams=Object.keys(this._options.query).map(function(t){return t+"="+this._options.query[t]}.bind(this)),delete this._options.query)}},run:function(t){var e,i=new $.Deferred,n={type:"POST",url:this.__self._PATH,headers:{"csrf-token":BEM.blocks["i-global"].param("secretkey")}},s=null;return this._options.timeout&&(this._options.apiTimeout=this._options.timeout,s=this._options.timeout+1e3,delete this._options.timeout),n.timeout=s,this._options.download&&(this._options.encoding=null),this._options.data instanceof FormData?(e=this._options.data,delete this._options.data,e.append("proxySettings",JSON.stringify(this._options)),n.processData=!1,n.contentType=!1,n.data=e):n.data={handler:JSON.stringify(this._options)},this.aborted=!1,this._csrfTokenUpdated=!1,this._currentRequestObject=n,this._sendRequest(n,i),this.promise=i.promise(),this.promise},abort:function(){this._currentRequest&&this._currentRequest.abort&&(this.aborted=!0,this._currentRequest.abort())},_sendRequest:function(t,e){this._currentRequest=$.ajax(t).success(this._onSuccessResponse.bind(this,e)).error(this._onErrorResponse.bind(this,e))},_onSuccessResponse:function(t,e,i,n){var s;s=(e=e||{}).error,this.statusCode=n.status,void 0!==s?(503===s.statusCode&&BEM.channel("readonly").trigger("enable"),t.reject(s)):(this.originalResponse=e,t.resolve(e.data))},_onErrorResponse:function(t,e){403!==e.status||"Forbidden"!==e.statusText||this._csrfTokenUpdated?this._handleError(t,e):$.ajax({type:"POST",url:"/update-csrf-token/"}).success(function(e){this._currentRequestObject.headers["csrf-token"]=e["csrf-token"],this._csrfTokenUpdated=!0,this._sendRequest(this._currentRequestObject,t)}.bind(this)).error(function(i){this._handleError(t,e)}.bind(this))},_handleError:function(t,e){this.statusCode=e.status,t.reject({xhr:e})}},{_PATH:"/handlers/",_defaultOptions:{method:"GET",path:"/",apiPath:"",urlParams:!1}}),BEM.decl("wi-long-task-requester",{onSetMod:{js:function(){var t=function(){};this._request=longTaskRequester.create(this.params.progressBarCallback||t,this.params.hideProgressBarCallback||t,this._callForResult.bind(this),this._pollingCall.bind(this))}},run:function(){return this._request.run()},_callForResult:function(){var t=new $.Deferred,e=BEM.create("wi-api-request",this.params.callForResultParams);return e.run().then(this._success.bind(this,t,e)).fail(this._error.bind(this,t,e)),t.promise()},_pollingCall:function(t){var e=this;return function(){var i=new $.Deferred,n=BEM.create("wi-api-request",{apiPath:".async",method:"POST",urlParams:!1,path:"",data:{task_id:t},download:!0});return n.run().then(e._success.bind(e,i,n)).fail(e._error.bind(e,i,n)),i.promise()}},_success:function(t,e,i){202===e.statusCode&&(e.statusCode=102),t.resolve({data:i&&i.data?i.data:i,statusCode:e.statusCode})},_error:function(t,e,i){202===e.statusCode&&(e.statusCode=102),t.resolve({error:i,statusCode:e.statusCode})}}),BEM.DOM.decl("w-bug-report",{onSetMod:{js:{inited:function(){this._getModal(),this._button=this.findBlockInside("button2"),this._frame=this.findElem(this._modal.domElem,"frame"),this._spin=this.findBlockInside(this._modal.domElem,"spin2"),this._modal.on({beforeOpen:this._onBeforeModalOpen,beforeClose:this._onBeforeModalClose},this),this.bindToWin("message",this._onIframeMessage,this)}},loading:{yes:function(){this._spin.setMod("progress","yes")},"":function(){this._spin.delMod("progress")}}},_onBeforeModalOpen:function(){this.setMod("loading","yes"),this._updateFrame()},_onBeforeModalClose:function(){this._button.delMod("checked")},_onIframeMessage:function(t){var e=t.originalEvent.data;try{e=JSON.parse(e)}catch(t){}e&&e["iframe-height"]&&this.params.name===e.name&&(this.delMod("loading"),this._frame.css("height",e["iframe-height"])),e&&"sent"===e.message&&this._closeModal(5e3)},_getModal:function(){return this._modal||(this._modal=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"modal",mods:{theme:"normal",autoclosable:"yes"},content:{block:this.__self.getName(),elem:"dialog",name:this.params.name}})).bem("modal")),this._modal},_updateFrame:function(){BEM.DOM.replace(this._frame,BEMHTML.apply({block:this.__self.getName(),elem:"frame",name:this.params.name})),this._frame=this.findElem(this._modal.domElem,"frame")},_openModal:function(){this._getModal().setMod("visible","yes")},_closeModal:function(t){setTimeout(function(){this._getModal().delMod("visible")}.bind(this),t)}},{live:function(){this.liveInitOnBlockInsideEvent("check","button2",function(){this._openModal()})}}),BEM.DOM.decl("w-bug-report",{_onIframeMessage:function(t){var e=t.originalEvent.data;try{e=JSON.parse(e)}catch(t){}e&&e["iframe-height"]&&this.params.name===e.name&&(this.delMod("loading"),this._frame.css("height",e["iframe-height"]))}}),BEM.DOM.decl("w-notifier",{onSetMod:{js:{inited:function(){var t=this;this.bindTo("closer","click",function(){this.setMod("disabled","yes"),BEM.create("wi-api-request",{method:"POST",apiPath:".notification/user_status/"+this.params.notifyId,path:""}).run().then(this._onCloseSuccess.bind(this),this._onCloseFail.bind(this)).always(function(){t.delMod("disabled")})})}}},_onCloseSuccess:function(){this.setMod("hidden","yes"),this.trigger("close"),this.destruct()},_onCloseFail:function(){}}),BEM.DOM.decl("w-notifier",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.delMod("hidden")}},_onCloseFail:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,t))}}),$(function(){BEM.afterCurrentEvent(function(){BEM.DOM.init()})}),function(t){BEM.DOM.decl({block:"popup2",modName:"target",modVal:"anchor"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._anchor=null,this._destructor=null,this._fixedAnchor=void 0}},visible:{yes:function(){this.bindToDoc("documentchange",this._onWinScrollAndResize),this.__base.apply(this,arguments)},"":function(){this.__base.apply(this,arguments),this.unbindFromDoc("documentchange")}}},destruct:function(){this._unbindFromDestructor(),this.__base.apply(this,arguments)},setAnchor:function(t){var e,i;return this._unbindFromDestructor()._unbindFromParentPopup(),this._anchor=t instanceof BEM.DOM?t.domElem:t,this._destructor=(e=this._anchor,i="_"+this.__self.getName()+"-destructor",e.addClass("i-bem "+i).bem(i)),this._fixedAnchor=void 0,this._bindToDestructor(),this._setVisible(),this.hasMod("visible")?this._recaptureZIndex()._bindToParentPopup().redraw():this._zIndexGroupLevel=null,this},_calcTargetDimensions:function(){var t=this._anchor,e=this._getOffsetOf(t);return{left:e.left,top:e.top,width:t.outerWidth(),height:t.outerHeight()}},_getOffsetOf:function(t){var e=t.offset();return"pageYOffset"in window&&(e.top-=window.pageYOffset-(document.documentElement.scrollTop||document.body.scrollTop),e.left-=window.pageXOffset-(document.documentElement.scrollLeft||document.body.scrollLeft)),e},_calcDrawingCss:function(e){var i=this.__base.apply(this,arguments);if(void 0===this._fixedAnchor&&(this._fixedAnchor=this._getFirstFixedParent(this._anchor)),this._fixedAnchor){var n=0,s=0,o=this._getFirstFixedParent(this._scope);if(o){var r=o.offset();n=r.left,s=r.top}i.left-=t(window).scrollLeft()-n,i.top-=t(window).scrollTop()-s}return t.extend(i,{position:this._fixedAnchor?"fixed":""})},_getFirstFixedParent:function(e){for(e=e[0];e;){if(1===e.nodeType&&"fixed"===t(e).css("position"))return t(e);e=e.parentNode}return null},_calcZIndexGroupLevel:function(){var t=this.__base.apply(this,arguments);return this._destructor.findBlocksOutside("z-index-group").reduce(function(t,e){return t+Number(e.getMod("level"))},t)},_bindToDestructor:function(){return this._destructor.on("destruct",this._onPopupAnchorDestruct,this),this},_unbindFromDestructor:function(){return this._destructor&&this._destructor.un("destruct",this._onPopupAnchorDestruct,this),this},_onPopupAnchorDestruct:function(){this.domElem&&BEM.DOM.destruct(this.domElem)},_getParentPopup:function(){if(void 0===this._parentPopup){var t=this._anchor.closest(".popup2");this._parentPopup=this.findBlockOn(t,this.__self.getName())}return this._parentPopup}}),BEM.DOM.decl("_popup2-destructor",{destruct:function(){this.trigger("destruct"),this.__base.apply(this,arguments)}})}(jQuery),BEM.DOM.decl({block:"popup2",modName:"hiding",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._anchorParents=null,this._isAnchorVisible=void 0,this._updateIsAnchorVisible=$.throttle(this._updateIsAnchorVisible,this.__self.UPDATE_TARGET_VISIBILITY_THROTTLING_INTERVAL,this)}},visible:{yes:function(){this._anchorParents=this._getAnchorParents(),this._bindToAnchorParents(),this.__base.apply(this,arguments)},"":function(){this.__base.apply(this,arguments),this._updateIsAnchorVisible.stop(),this._unbindFromAnchorParents(),this._anchorParents=null,this._isAnchorVisible=void 0}}},_getAnchorParents:function(){for(var t,e=this;e&&e._anchor;)t=e,e=e._getParentPopup();return $(t._anchor).parents()},setAnchor:function(t){return this.__base.apply(this,arguments),this._unbindFromAnchorParents(),this._isAnchorVisible=void 0,this.hasMod("visible")?(this._anchorParents=this._getAnchorParents(),this._bindToAnchorParents()):this._anchorParents=null,this},_unbindFromDestructor:function(){return this._updateIsAnchorVisible.stop&&this._updateIsAnchorVisible.stop(),this.__base.apply(this,arguments)},_calcDrawingCss:function(t){var e=this.__base.apply(this,arguments);return void 0===this._isAnchorVisible&&(this._isAnchorVisible=this._calcIsAnchorVisible()),$.extend(e,{display:this._isAnchorVisible?"":"none"})},_calcIsAnchorVisible:function(){var t=!0;return this._anchorParents.each(function(e,i){if("BODY"===i.tagName)return!1;i=$(i);var n=/scroll|hidden|auto/,s=n.test(i.css("overflow-y")),o=n.test(i.css("overflow-x"));if(s||o){var r=this._getOffsetOf(i),a=Math.floor(r.top),c=this._anchor,l=this._getOffsetOf(c),d=this.getMod("direction"),h=Math.floor(this._checkDirection(d,"top")?l.top:l.top+c.outerHeight());if(h<a||a+i.outerHeight()<h)return t=!1,!1;var u=Math.floor(this._checkDirection(d,"left")?l.left:l.left+c.outerWidth()),m=Math.floor(r.left);return t=u>=m&&m+i.outerWidth()>=u}}.bind(this)),t},_bindToAnchorParents:function(){return this.bindTo(this._anchorParents,"scroll",this._onAnchorParentsScroll)},_unbindFromAnchorParents:function(){return this._updateIsAnchorVisible.stop(),this._anchorParents&&this.unbindFrom(this._anchorParents,"scroll"),this},_onAnchorParentsScroll:function(){this.redraw()._updateIsAnchorVisible()},_onWinScrollAndResize:function(){this.hasMod("visible")&&(this.__base.apply(this,arguments),this._updateIsAnchorVisible())},_updateIsAnchorVisible:function(){if(this.domElem){var t=this._calcIsAnchorVisible();t!==this._isAnchorVisible&&(this._isAnchorVisible=t,this.redraw())}}},{UPDATE_TARGET_VISIBILITY_THROTTLING_INTERVAL:100}),BEM.DOM.decl({block:"popup2",modName:"hiding",modVal:"yes"},{_calcIsAnchorVisible:function(){return!0}}),BEM.DOM.decl({block:"popup2",modName:"autoclosable",modVal:"yes"},{onSetMod:{visible:{yes:function(){this.__self._visiblePopupsStack.unshift(this),this.afterCurrentEvent(function(){this.domElem&&this.hasMod("visible")&&this.bindToDoc("pointerclick",this._onDocClick)}),this.__base.apply(this,arguments)},"":function(){var t=this.__self._visiblePopupsStack;t.splice(t.indexOf(this),1),this.unbindFromDoc("pointerclick").__base.apply(this,arguments)}}},_onDocClick:function(t){this.hasMod("target","anchor")&&(this._anchor[0]===t.target||this._anchor.find(t.target).length>0)||(this._preventHideByClick?this._preventHideByClick=null:this.delMod("visible"))}},{live:function(){return BEM.DOM.doc.on("keydown",this._onDocKeyPress.bind(this)),this.__base()},_visiblePopupsStack:[],_onDocKeyPress:function(t){BEM.blocks.keycodes.is(t.keyCode,"ESC")&&this._visiblePopupsStack.length&&this._visiblePopupsStack[0].delMod("visible")}}),BEM.DOM.decl({block:"popup2",modName:"theme",modVal:"normal"},{getDefaultParams:function(){return $.extend(this.__base(),{mainOffset:5,viewportOffset:5})}}),BEM.DOM.decl({block:"button2",baseBlock:"control"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments)}},pressed:{yes:function(){if(this.hasMod("disabled"))return!1;this.trigger("press")},"":function(){this.trigger("release")}},checked:{yes:function(){this.trigger("check").domElem.attr("aria-pressed","true")},"":function(){this.trigger("uncheck").domElem.attr("aria-pressed","false")}},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("pressed")}},focused:{"":function(){this.__base.apply(this,arguments),this.delMod("pressed")}},progress:{yes:function(){this.setMod("disabled","yes")},"":function(){this.delMod("disabled")}}},getText:function(){return this.elem("text").text()},setText:function(t){return this.elem("text").text(t),this},_onClick:function(t){(!this._preventClick||t.detail>0)&&this.trigger("click",this._buildClickEventData(t)),this._preventClick=!1},_processClick:function(t){this.trigger("click",this._buildClickEventData(t))},_onPointerpress:function(t){this.setMod("pressed","yes").bindToDoc("pointerrelease",this._onPointerrelease)},_onPointerrelease:function(){this.delMod("pressed").unbindFromDoc("pointerrelease")},_onKeydown:function(t){var e=t.keyCode,i=BEM.blocks.keycodes;i.is(e,this.params.pressKeys)&&(this.setMod("pressed","yes"),i.is(e,this.params.prvntKeys)&&t.preventDefault())},_onKeyup:function(t){var e=t.keyCode,i=BEM.blocks.keycodes;i.is(e,this.params.prvntKeys)&&t.preventDefault(),i.is(e,this.params.pressKeys)&&(this.delMod("pressed"),i.is(e,this.params.clickKeys)&&(this._preventClick=!0,this._processClick(t)))},_buildClickEventData:function(t){return{domEvent:t,isModKey:t.ctrlKey||t.altKey||t.metaKey||t.shiftKey}},getDefaultParams:function(){return $.extend(this.__base(),{pressKeys:["SPACE","ENTER"],prvntKeys:[],clickKeys:[]})}},{live:function(){return this.liveBindTo("pointerpress",function(t){this.hasMod("disabled")||this._onPointerpress(t)}).liveBindTo("pointerclick",function(t){this.hasMod("disabled")||this._onClick(t)}).liveBindTo("keydown",function(t){this._onKeydown(t)}).liveBindTo("keyup",function(t){this._onKeyup(t)}),this.__base()}}),BEM.DOM.decl("button2",{onSetMod:{hovered:{yes:function(){return!this.hasMod("disabled")}},disabled:{yes:function(){this.__base.apply(this,arguments),this.delMod("hovered")}}},_onPointerenter:function(){this.setMod("hovered","yes")},_onPointerleave:function(){this.delMod("hovered")},_onClick:function(){this.__base.apply(this,arguments),this._isDestructing||this.setMod("focused","yes")}},{live:function(){return this.liveBindTo("pointerover pointerout",function(t){this.hasMod("disabled")||this.domElem[0].contains(t.relatedTarget)||("pointerover"===t.type?this._onPointerenter(t):this._onPointerleave(t))}).liveBindTo("mousedown",function(t){t.preventDefault()}),this.__base()}}),BEM.DOM.decl({block:"modal",modName:"theme",modVal:"normal"},{onSetMod:{visible:{yes:function(){this.setMod("has-animation","yes").__base.apply(this,arguments)}}}}),BEM.DOM.decl({block:"modal",modName:"autoclosable",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._preventHideByClick=!1}},visible:{yes:function(){this.__base.apply(this,arguments),this.bindTo("content","pointerdown",this._onPointerDownContent).bindTo("pointerclick",this._onPointerClick)._popup.on("beforeClose",this._onPopupClose,this)},"":function(){this.__base.apply(this,arguments),this.unbindFrom("content","pointerdown").unbindFrom("pointerclick")._popup.un("beforeClose",this._onPopupClose,this)}}},_onPointerDownContent:function(t){this.isPointerDownContent=!0},_onPointerClick:function(t){var e=this._popup;$(this.buildSelector("visible","yes")).each(function(){var t=$(this).bem("popup2");t!==e&&(t._preventHideByClick=!0)}),$(t.target).closest(this.buildSelector("content")).length||this.isPointerDownContent||(this._popup._preventHideByClick=!1,this.delMod("visible")),this.isPointerDownContent=!1},_onPopupClose:function(){this.delMod("visible")}}),BEM.DOM.decl({block:"b-toc",modName:"type",modVal:"sidebar"},{onSetMod:{js:function(){this.on("ready",function(){this.channel("sidebar").trigger("tab:ready")}),this.__base.apply(this,arguments)}},_onTocGetData:function(){this.__base.apply(this,arguments),this.bindTo(this.findBlockInside("wiki-toc").domElem,"click",function(t){t.target.classList.contains("b-link")&&yaCounter&&yaCounter.reachGoal("tocitem_click")})}},{}),BEM.DOM.decl({block:"wiki-toc",modName:"type",modVal:"sidebar"},{_getWikiDoc:function(){return this.findBlockOutside("b-page").findBlockInside({block:"wiki-doc",modName:"status",modVal:"main"})||this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"editor-help",modName:"type",modVal:"sidebar"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.afterCurrentEvent(function(){this.channel("sidebar").trigger("tab:ready")})}}},{}),BEM.DOM.decl({block:"b-cluster-tree",modName:"type",modVal:"sidebar"},{onSetMod:{js:function(){this.on("ready",function(){this.channel("sidebar").trigger("tab:ready")}),this.__base.apply(this,arguments)}}}),BEM.DOM.decl({block:"select2",modName:"popup",modVal:"yes"},{onSetMod:{focused:{yes:function(){this.button.setMod("focused","yes")},"":function(){this.delMod("opened"),this.button.delMod("focused")}},opened:{"*":function(t,e){if(this.hasMod("disabled"))return!1;var i=Boolean(e);this.button.domElem.attr("aria-expanded",i),this.arrow.toggleMod("direction","top","bottom",i),this.popup.toggleMod("visible","yes",i),i&&this.popup.redraw()},yes:function(){this._setMinWidth(),this._setMaxHeight()}},disabled:{yes:function(){this.popup.delMod("visible")}}},getDefaultParams:function(){return{optionsMaxHeight:Number.POSITIVE_INFINITY}},initSelect:function(){this.menu=this.findBlockOn("menu","menu"),this.__base.apply(this,arguments),this.popup=this.findBlockOn("popup","popup2"),this.arrow=this.findBlockOn("arrow","icon"),this.initialVal=this.getVal(),this.popup.setAnchor(this.button),this.popup.on("beforeClose",this._onPopupHide,this),this.button.on({click:this._onButtonClick,focus:this._onButtonFocus},this),this.bindTo("button","blur",this._onButtonBlur),this.menu.on({change:this._onMenuChange,click:this._onMenuItemClick,"item-hover":this._onMenuItemHover},this),this._preventBlur=null,this.bindTo("menu","pointerdown",this._onMenuPointerdown),document.documentMode&&this.bindTo("menu","focusin focusout",this._preventItemFocus),this._setMaxHeight()},getVal:function(){return this.menu.getVal()},setVal:function(t){return this.menu.setVal(t),this},reset:function(){this.menu.setVal(this.initialVal)},setContent:function(t){return this.menu.setContent(t),this._setMinWidth(),this._setMaxHeight(),this.popup.redraw(),this},destruct:function(){return document.documentMode&&this.unbindFrom("menu","focusin focusout",this._preventItemFocus),this.unbindFrom("menu","pointerup",this._preventButtonBlur),this.unbindFrom("menu","pointerdown",this._onMenuPointerdown),this.unbindFrom("button","blur",this._onButtonBlur),this.__base.apply(this,arguments)},_setMinWidth:function(){this.popup.domElem.css("min-width",this.button.domElem.outerWidth())},_setMaxHeight:function(){var t=this.popup.calcPossibleDrawingParams(),e=this.menu.domElem,i=e.outerWidth(),n=0;t.forEach(function(t){t.width>=i&&t.height>n&&(n=t.height)}),n>0&&e.css("max-height",Math.min(this.params.optionsMaxHeight,n))},_onMenuChange:function(t,e){this._changeIcon(t,e),this.control&&this.control.val(e.currVal),this.trigger("change",e)},_changeIcon:function(t,e){var i,n,s=this.menu,o=this.button,r=s.getItems("checked","yes").filter(function(t){return s.elemParams(t).val===e.currVal}).shift(),a=r&&s.findBlockInside(r,"icon"),c=o.findElem("icon","side","left");a?(c.length||(o.domElem.prepend(this._buildLeftIcon()),c=o.findElem("icon","side","left")),n=o.findBlockInside(c,"icon"),delete(i=a.getMods()).js,Object.keys(i).forEach(function(t){n.setMod(t,i[t])})):c.length&&c.remove()},_buildLeftIcon:function(){return'<i class="icon button2__icon button2__icon_side_left" aria-hidden="true"/>'},_onMenuItemClick:function(t,e){this.delMod("opened")},_onMenuItemHover:function(t,e){var i=this.button.domElem,n=e.item;n?i.attr("aria-activedescendant",n.attr("id")):i.removeAttr("aria-activedescendant")},_onMenuPointerdown:function(t){this._preventBlur=!0},_onButtonClick:function(){this.toggleMod("opened","yes")},_onButtonKeydown:function(t){var e=BEM.blocks.keycodes;!this.hasMod("opened")&&e.is(t.keyCode,"UP","DOWN")&&(t.preventDefault(),this.setMod("opened","yes"))},_onButtonFocus:function(){this.setMod("focused","yes")},_onButtonBlur:function(){this._preventBlur?(this._preventBlur=null,this.bindTo("menu","pointerup",this._preventButtonBlur)):this.delMod("focused")},_onPopupHide:function(){this.delMod("opened")},_preventButtonBlur:function(t){this.unbindFrom("menu","pointerup",this._preventButtonBlur),this.button.domElem.focus()},_preventItemFocus:function(t){t.preventDefault(),t.stopPropagation()},_onControlChange:function(t){var e=this.control.val(),i=[].concat(e),n=this.menu,s=this.getVal();n.getItems().filter(function(t){return n.delMod(t,"checked"),i.indexOf(n.elemParams(t).val)>=0}).forEach(function(t){n.setMod(t,"checked","yes")}),this._onMenuChange(t,{prevVal:s,currVal:e})}}),BEM.DOM.decl({block:"select2",modName:"popup",modVal:"yes"},{onSetMod:{opened:{yes:function(t,e){var i,n=this.__base.apply(this,arguments);return!1===n?n:(this.menu.getItems("hovered","yes").length||((i=this.menu.getItems("checked","yes")).length?this.menu.hoverText(i[0].text()):this.menu.hoverNext()),n)},"":function(){return this._preventToToggleOpened=!1,this.__base.apply(this,arguments)}}},_onButtonKeydown:function(t){this.hasMod("opened","yes")?(this.menu._onKeydown(t,!0),this._keysToMenu=!0,this._preventToToggleOpened=!0):(this._keysToMenu=!1,this._preventToToggleOpened=!1,this.__base.apply(this,arguments))},_onButtonKeyup:function(t){this._keysToMenu&&(this.menu._onKeyup(t),this._keysToMenu=!1,this._preventToToggleOpened=!0)},_onButtonClick:function(){this._preventToToggleOpened?this._preventToToggleOpened=!1:this.__base.apply(this,arguments)},_onButtonKeypress:function(t){var e=BEM.blocks.keycodes;if(e.is(t.keyCode,"UP","DOWN","ENTER","SPACE")||0===t.keyCode&&t.charCode===e.SPACE)this.menu._onKeypress(t);else{var i=this.menu.getItems("hovered","yes");if(i.forEach(function(t){this.menu.delMod(t,"hovered")},this),this.menu._onKeypress(t),this.hasMod("opened"))return;(i=this.menu.getItems("hovered","yes")).length&&this.setVal(this.menu.elemParams(i[0]).val)}}},{live:function(){return this.liveBindTo("button","keyup",function(t){this._onButtonKeyup(t)}),this.__base()}}),BEM.DOM.decl({block:"select2",modName:"type",modVal:"radiocheck"},{_onMenuChange:function(){this.__base.apply(this,arguments),this.button.toggleMod("checked","yes","",this.menu.getItems("checked","yes").length>0)}}),BEM.DOM.decl({block:"menu",modName:"type",modVal:"radiocheck"},{getVal:function(){var t=this.getItems("checked","yes")[0];return t&&this.elemParams(t).val},setVal:function(t){return this.getItems().forEach(function(e){this.elemParams(e).val===t?this.setMod(e,"checked","yes"):this.delMod(e,"checked")},this),this._onChange(),this},_onItemClick:function(t,e,i){this.__base.apply(this,arguments);var n=this.elem("item","checked","yes");n.is(t)||this.delMod(n,"checked"),this.toggleMod(t,"checked","yes"),this._onChange()}}),BEM.DOM.decl({block:"select2",modName:"text",modVal:"vary"},{_onMenuChange:function(t,e){this.__base.apply(this,arguments),this.button.setText(this.getText()),this._setMinWidth()},_onControlChange:function(){this.__base.apply(this,arguments),this.button.setText(this.getText())},getText:function(){var t=this.params.checkedTexts;return this.menu?this.getTextFromMenu(t):this.control?this.getOptions().filter(function(t){return t.selected}).map(function(e){var i=e.text,n=e.value;return t[n]||i}).join(", ")||this.params.text:void 0},getTextFromMenu:function(t){var e=this.menu;return e.getItems("checked","yes").map(function(i){var n=e.elemParams(i),s=n.text||i.text(),o=n.val||i.val();return t[o]||s}).join(", ")||this.params.text}}),BEM.DOM.decl({block:"select2",modName:"type",modVal:"check"},{_onMenuChange:function(){this.__base.apply(this,arguments),this.button.toggleMod("checked","yes","",this.menu.getItems("checked","yes").length>0)},_onMenuItemClick:function(t,e){"keyboard"===e.source&&(this._preventToToggleOpened=!0)}}),BEM.DOM.decl({block:"select2",modName:"type",modVal:"check"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments)}}}}),BEM.DOM.decl({block:"b-events-log",modName:"type",modVal:"sidebar"},{onSetMod:{js:function(){this.on("ready",function(){this.channel("sidebar").trigger("tab:ready")}),this.__base.apply(this,arguments)}}},{}),BEM.DOM.decl({block:"checkbox",modName:"assigned",modVal:"form"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.required&&this.findBlockOutside("b-wiki-form")._requiredFields.push(this)}}}),BEM.DOM.decl({block:"link",modName:"pseudo",modVal:"yes"},{_onClick:function(t){t.preventDefault(),this.hasMod("disabled")||this.trigger("click",this._buildClickEventData(t))},_onKeydown:function(t){BEM.blocks.keycodes.is(t.keyCode,"ENTER","SPACE")&&(BEM.blocks.keycodes.is(t.keyCode,"SPACE")&&t.preventDefault(),this.setMod("pressed","yes"))},_onKeyup:function(t){BEM.blocks.keycodes.is(t.keyCode,"ENTER","SPACE")&&(BEM.blocks.keycodes.is(t.keyCode,"SPACE")&&this.trigger("click"),this.delMod("pressed"))},_buildClickEventData:function(t){return{domEvent:t,isModKey:t.ctrlKey||t.altKey||t.metaKey||t.shiftKey}}},{live:function(){return this.liveBindTo({modName:"pseudo",modVal:"yes"},"pointerclick",function(t){this._onClick(t)}).liveBindTo({modName:"pseudo",modVal:"yes"},"keydown",function(t){this.hasMod("disabled")||this._onKeydown(t)}).liveBindTo({modName:"pseudo",modVal:"yes"},"keyup",function(t){this.hasMod("disabled")||this._onKeyup(t)}),this.__base()}}),BEM.DOM.decl({block:"w-attachments",modName:"type",modVal:"sidebar"},{onSetMod:{js:function(){this.on("ready",function(){this.channel("sidebar").trigger("tab:ready")}),this.__base.apply(this,arguments)}}},{}),BEM.DOM.decl("w-attach",{onSetMod:{dragable:{yes:function(){this.bindTo("dragstart",this._onDragStart.bind(this)).bindTo("dragend",this._onDragEnd.bind(this)).domElem.attr("draggable","true")},"":function(){this.domElem&&this.unbindFrom("dragstart",this._onDragStart,this).unbindFrom("dragend",this._onDragEnd,this).domElem.attr("dragable","")}}},_onDragStart:function(t){var e=t.originalEvent.dataTransfer,i=this._attachWfUrl;return this.setMod("dragging","yes"),e.setData("text/plain","file:"+i),e.setDragImage(this.elem("attach-name").get(0),-10,15),!0},_onDragEnd:function(){this.setMod("dragging","")}},{}),BEM.DOM.decl({block:"m-notification",modName:"autoclosable",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.bindToDoc("pointerclick",this._onDocClick)}},destruct:function(t){this.unbindFromDoc("pointerclick",this._onDocClick),this.__base(t)},_onDocClick:function(t){this.domElem.find(t.target).length||this._remove()}}),BEM.DOM.decl({block:"m-notification",modName:"clear",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.unbindFrom("click"),this.findBlockInside({block:"awesome-icon",modName:"type",modVal:"clear"}).bindTo("click",this._onRemoveIconClick.bind(this))}},_onRemoveIconClick:function(){this._remove()}}),BEM.DOM.decl({block:"b-grid-table-code",modName:"type",modVal:"sidebar"},{onSetMod:{js:function(){this.findBlockInside("b-grid-table-code-form").on("ready",function(){this.channel("sidebar").trigger("tab:ready")},this),this.__base.apply(this,arguments)}}},{}),BEM.DOM.decl({block:"input",modName:"assigned",modVal:"form"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.required&&this.findBlockOutside("b-wiki-form")._requiredFields.push(this)},focused:{yes:function(){this.__base.apply(this,arguments),this._parentField||(this._parentField=this.findBlockOutside("b-wiki-form-field")),this._parentField.errorMessage&&(this.elem("control").on("input.formerror",function(){this._parentField.errorMessage=null,this._parentField.delMod("validation"),this.channel("errors").trigger("errorHide"),this.elem("control").off("input.formerror")}.bind(this)),BEM.channel("wiki-form").trigger("error",{text:this._parentField.errorMessage,node:this._parentField}))}}}}),BEM.DOM.decl("b-grid-table-settings",{onSetMod:{js:function(){this.on("ready",function(){this.channel("sidebar").trigger("tab:ready")},this),this.__base.apply(this,arguments)}}}),BEM.DOM.decl({block:"radio-button",baseBlock:"radiobox"},{onSetMod:{disabled:{yes:function(){this.delMod("focused"),this.__base.apply(this,arguments)}}},onElemSetMod:{radio:{pressed:{yes:function(){this.delMod(this.elem("radio","pressed","yes"),"pressed")}}}},_onPointerPress:function(t){this._pressedRadio=t.data.domElem,this.isDisabled(this._pressedRadio)||(this.setMod(this._pressedRadio,"pressed","yes"),this.bindToDoc("pointerrelease",this._onPointerRelease))},_onPointerRelease:function(t){var e=this._pressedRadio;delete this._pressedRadio,this.delMod(e,"pressed"),this.afterCurrentEvent(function(){if(this.domElem){var i=this.findElem(e,"control");i.prop("checked")||!e.is(t.target)&&!e.find(t.target).length||i.trigger("change").focus()}}),this.unbindFromDoc("pointerrelease")}},{live:function(){return this.liveBindTo("radio","pointerpress",function(t){this._onPointerPress(t)}).liveBindTo("control","focusin focusout",function(t){!this.hasMod("disabled")&&this.toggleMod("focused","yes","focusin"===t.type)}),this.__base()}}),BEM.DOM.decl({block:"w-translate-content",modName:"type",modVal:"article"},{_resetTranslate:function(t){var e=BEM.WISTORE.get("page").get("withNewWf")?".raw":".bemjson";this.hasMod("lang-selected")&&!this.hasMod("progress")&&(this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:e,method:"GET",urlParams:!1,path:"/"+this.params.supertag}).run().then(this._onSuccessSkipTranslate.bind(this,t),this._onErrorSkipTranslate.bind(this)).always(function(){this.delMod("progress")}.bind(this)))},_request:function(t){var e=$(this._bPage.getContentHTML());return this._wfAttr=e.attr("data-wf"),e.attr("data-wf",""),e=e[0].outerHTML,$.when($.ajax({type:"POST",url:BEM.blocks["i-global"].param("hosts").translateApi,data:{srv:"wiki",format:"html",text:e,lang:t}}),$.ajax({type:"GET",url:BEM.blocks["i-global"].param("hosts").translateApi,data:{srv:"wiki",format:"plain",text:this._bPage.findBlockInside("b-page-title").domElem.html(),lang:t}}))},_updateContent:function(t,e){this.channel("content").trigger("update",{data:{title:e[0].text[0],html:t[0].text[0]}})}}),BEM.DOM.decl({block:"m-popup",baseBlock:"popup2"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._popup=this.findBlockOn("popup2")}}}}),BEM.DOM.decl({block:"textinput",modName:"has-clear",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base(),this._clear=this.elem("clear"),this.on("change",this._updateClearOnInputChange)}}},_updateClearOnInputChange:function(){this.toggleMod(this._clear,"visible","yes","",Boolean(this.val()))},_onClearPointerclick:function(){this.trigger("clear").val("").setMod("focused","yes").elem("control").focus()},_onClearPointerover:function(){this.setMod(this._clear,"hovered","yes").bindTo(this._clear,"pointerout",this._onClearPointerout)},_onClearPointerout:function(){this.delMod(this._clear,"hovered").unbindFrom(this._clear,"pointerout")},_preventLosingFocus:function(t){this.hasMod("focused")&&(t.preventDefault(),t.stopPropagation())}},{live:function(){return this.liveBindTo("clear","pointerclick",function(t){this._onClearPointerclick(t)}).liveBindTo("clear","pointerover",function(t){this._onClearPointerover(t)}).liveBindTo("clear","mousedown touchend",function(t){this._preventLosingFocus(t)}),this.__base()}}),BEM.DOM.decl({block:"m-editor-popup",modName:"type",modVal:"drafts"},{onSetMod:{js:function(){this.bindTo(this.findElem("draft"),"click",function(t){this.trigger("update-text",this.params.data.drafts[t.data.domElem.data("index")].val)}.bind(this))}}}),BEM.DOM.decl({block:"m-suggest",modName:"type",modVal:"multicomplete"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._requestSettings={type:this.__self.REQUEST_TYPE,url:"//center.yandex-team.ru/api/autocomplete/multi/",dataType:this.__self.REQUEST_DATA_TYPE,timeout:this.__self.REQUEST_TIMEOUT}}},_prepareRequestData:function(t){var e,i="",n={};return this.params.types.forEach(function(s,o){e=0===o?"":"|","object"==typeof s?((!s.symbolsToSend||s.symbolsToSend<=t.length)&&(i+=e+s.name),s.fields&&(n[s.name+"_fields"]=s.fields)):i+=e+s}),$.extend({},this._requestSettings,{data:$.extend({q:t,types:i},n,this.params.addRequestParams)})},_getItemsHTML:function(t){var e,i={},n=this;return t.forEach(function(t){e=n._getItemTypeFromOptions(t._type),t.valueField=e.valueField||null,i[t._type]?(!e.maxCount||i[t._type].length<e.maxCount)&&i[t._type].push(t):i[t._type]=[t]}),BEMHTML.apply($.map(i,function(t,e){return{block:"m-suggest-group",groupLabel:!(n.params.inHeader||n.params.inSearchHeader)&&"staff"!==e&&e,content:$.map(i[e],function(t){return n._getItemBEMJSON(t._type,t)})}}))},_selectItem:function(t,e){this.val(t,!0),this.__base.apply(this,arguments),this._items[this._curItemIndex]&&this._items[this._curItemIndex].delMod("hovered"),this._curItemIndex=-1,this._popup.delMod("visible")}}),BEM.DOM.decl({block:"m-suggest",modName:"multiple",modVal:"yes"},{val:function(t,e){var i,n,s,o=this._input.val(),r=typeof t;if("undefined"===r||e||this._notSendRequest++,"string"===r)t!==o&&this._notSendRequest++,this._input.val(t);else if("object"===r){if(i=t.params.value,n=t.params.fullData,this._notSendRequest++,this._input.val(""),s={fullData:n,value:i},this._val)this._val.filter(function(t){return t.value===i}).length||(this._val.push(s),this._pushCloud(s));else this._val=[s],this._pushCloud(s)}return this._input.val()},clearData:function(){this._val=null,this._input&&this._input.val(""),BEM.DOM.destruct(this.findElem("cloud"))},getData:function(){return this._val},_pushCloud:function(t){var e=this.findElem("cloud").last();if(e.length)var i=BEM.DOM.after(e,BEMHTML.apply({block:"m-suggest",elem:"cloud",data:t}));else i=BEM.DOM.prepend(this._input.domElem,BEMHTML.apply({block:"m-suggest",elem:"cloud",data:t}));this.findBlockInside(i,"awesome-icon").bindTo("click",this._removeItem.bind(this,t))},_removeItem:function(t,e){_.remove(this._val,function(e){return e.value===t.value}),BEM.DOM.destruct($(e.target).parent()),this.trigger("unselect")},_update:function(t){var e=this._getInputValue4Request(),i=t&&"change"===t.type;i&&this.trigger("change",this._input&&this._input.val()),!this._notSendRequest&&e?(this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=setTimeout(this._sendRequest(),200),i&&(this._lastInputVal=this._input.val())):this._notSendRequest&&this._notSendRequest--}}),BEM.DOM.decl({block:"m-suggest",modName:"multiple",modVal:"yes"},{_pushCloud:function(t){var e=this.findElem("cloud").last();if(e.length)var i=BEM.DOM.after(e,BEMHTML.apply({block:"m-suggest",elem:"cloud",data:t}));else i=BEM.DOM.prepend(this._input.elem("box"),BEMHTML.apply({block:"m-suggest",elem:"cloud",data:t}));this.findBlockInside(i,"awesome-icon").bindTo("click",this._removeItem.bind(this,t))}}),BEM.DOM.decl("w-old-page-mark",{_onClick:function(){var t=this._getPopup();t.hasMod("visible","yes")?t.delMod("visible"):this._showPopup()},_showPopup:function(){this._loaded?this._getPopup().setMod("visible","yes"):(this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".actuality",path:BEM.blocks["wi-history"].getCorrectPath(),urlParams:["format=json"]}).run().then(this._onGotData.bind(this),this._onFailedData.bind(this)))},_onGotData:function(t){this.delMod("progress");var e=this._getPopup();BEM.DOM.append(e.domElem,this.__self._getPopupContentHTML(t.data)),e.findBlockInside({block:"button2",modName:"role",modVal:"unmark"}).on("click",function(){e.delMod("visible")}),e.setMod("visible","yes"),this._loaded=!0},_onFailedData:function(t){this.delMod("progress"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,t)),this._getPopup().delMod("visible")},_getPopup:function(){return this._popup?this._popup:(this._popup=BEM.DOM.append(this.domElem,BEMHTML.apply({block:"popup2",mods:{target:"anchor",theme:"normal",autoclosable:"yes",role:"old-page-mark"},directions:["bottom-left"],content:{block:"w-old-page-mark",elem:"date",content:[BEM.I18N("w-old-page-mark","last_update")+" ",{block:"m-date",format:"full",timestamp:BEM.WISTORE.get("page").get("modifiedAt")}]}})).bem("popup2"),this._popup.setAnchor(this.domElem),this._popup)}},{live:function(){this.liveBindTo("click",function(){this._onClick()})},_getPopupContentHTML:function(t){return BEMHTML.apply({block:"w-old-page-mark",elem:"popup-content",data:t})}}),BEM.DOM.decl("w-page-official",{_onClick:function(){this.__self._data?this._togglePopup():BEM.create("wi-api-request",{apiPath:".officiality",path:BEM.blocks["wi-history"].getCorrectPath(),urlParams:["format=json"]}).run().then(this._onGotData.bind(this),this._onFailedData.bind(this))},_onGotData:function(t){this.__self._data={persons:t.data.responsible_persons,groups:t.data.responsible_groups},this._togglePopup()},_onFailedData:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,null,t))},_togglePopup:function(){this.__self._getPopup(this.domElem,this.__self._data).toggleMod("visible","yes","")}},{live:function(){this.liveBindTo("click",function(){this._onClick()})},_getPopupBEMJSON:function(t){var e=t.persons,i=t.groups,n=[];return e.length&&(n.push({block:"w-page-official",elem:"user-title",content:1===e.length?BEM.I18N("w-page-official","responsible"):BEM.I18N("w-page-official","responsibles")}),e.forEach(function(t){n.push({block:"b-page-official-user",user:t})})),i.length&&(n.push({block:"w-page-official",elem:"user-title",content:1===i.length?BEM.I18N("w-page-official","responsible_group"):BEM.I18N("w-page-official","responsible_groups")}),i.forEach(function(t){n.push({block:"w-page-official",elem:"group",content:t.url?{block:"link",mods:{theme:"normal"},url:t.url,text:t.name}:t.name})})),{block:"popup2",mods:{target:"anchor",theme:"normal",autoclosable:"yes",role:"page-official"},directions:["bottom-left"],content:n}},_getPopup:function(t,e){return this._popup||(this._popup=BEM.DOM.append(t,BEMHTML.apply(this._getPopupBEMJSON(e))).bem("popup2")),this._popup.setAnchor(t),this._popup}}),BEM.DOM.decl("w-access-button",{},{live:function(){this.liveBindTo("click",function(){BEM.channel("common").trigger("w-action.create-access")})}}),BEM.DOM.decl({block:"dropdown2",modName:"switcher",modVal:"button2"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._tickerIcon=this.findBlockOn("arrow","icon")}},opened:function(t,e){this.__base.apply(this,arguments),this.hasMod("has-tick")&&this._tickerIcon.toggleMod("direction","top","bottom",Boolean(e))}}},{live:function(){return this.liveInitOnBlockInsideEvent("click","button2",function(t){this._onSwitcherClick(t)}),this.__base()}}),BEM.DOM.decl({block:"w-action",modName:"type",modVal:"access"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params&&this.params.isAction||BEM.channel("common").on("w-action.create-access",this._run,this)}},_onGetAccessData:function(t,e){this._accessWidget=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"page-access"},user:e.user,data:e.data})).bem("b-widget").on("access-change",this._onAccessChange,this),this._accessWidget.show(),this._pushState(t,".access")},_onAccessChange:function(t,e){BEM.WISTORE.get("page").set("access",e)},destruct:function(){BEM.channel("common").un("w-action.create-access"),this.__base.apply(this,arguments)},_run:function(t,e){this.__base.apply(this,arguments)&&(this.__self._isNewTabClick(t)?window.open(BEM.blocks["wi-history"].getCorrectPath()+".access","_blank").focus():this._accessWidget?(this._accessWidget.show(),this._pushState(e,".access")):(this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".access",method:"GET",data:!1,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onGetAccessData.bind(this,e),BEM.blocks["wi-notification"].errorHandler(null,BEM.I18N("w-access-button","cant_get_data"))).always(function(){this.delMod("progress")}.bind(this))))}}),BEM.DOM.decl({name:"input",modName:"suggest",modVal:"yes"},{onSetMod:{js:{inited:function(){this.params.foot&&(this.foot=this.params.foot),this._preventRequest=!0,this.__base.apply(this,arguments),this._userVal=this.val();var t=this._focused;t&&this.delMod("focused"),this.elem("control").attr("autocomplete","off"),this._preventRequest=!1,t&&this.setMod("focused","yes"),this._items=[],this._curItemIndex=-1,this._doRequest=$.debounce(this._doRequest,this.params.debounceDelay),this.bindToWin("resize",$.throttle(this._setWidth,60))}},focused:{yes:function(){this.__base();var t=this.params.showListOnFocus?this._onChange():this._onChange;this.on("change",t)},"":function(){this.__base(),this.un("change",this._onChange)._preventHide||this._getPopup().delMod("visible")}}},destruct:function(){var t=this._popup;return t&&t.domElem&&(this._popup=null,BEM.DOM.destruct(t.domElem)),this.__base.apply(this,arguments)},getDataprovider:function(){var t=this.params.dataprovider.url;return this._dataprovider||(this._dataprovider=BEM.create(this.params.dataprovider.name||this.__self.getName()+"__dataprovider",$.extend(this.params.dataprovider,{url:t,callbackCtx:this})))},_onChange:function(){return this._preventRequest||this._doRequest(),this._onChange},_onKeyDown:function(t){if(BEM.blocks.keycodes.is(t.which,"UP","DOWN")&&!t.shiftKey){t.preventDefault();var e=this._items.length,i=!1;if(e){var n=t.which-39,s=this._curItemIndex,o=0;do{i=(0===s&&-1===n||s+n>=e)&&this._onLeaveItem(this._items[s],!0),(s+=n)<0?s=e-1:s>=e&&(s=0)}while(!i&&!1===this._onEnterItem(this._items[s],!0)&&++o<e)}}},_onKeyPress:function(t){t.which===BEM.blocks.keycodes.ENTER&&this._curItemIndex>-1&&this._isCurItemEnteredByKeyboard&&(t.preventDefault(),this._onSelectItem(this._items[this._curItemIndex],!0))},_getPopup:function(){var t=this;if(!t._popup){var e=t.__self.getName(),i=[{elem:"items",tag:"ul",mix:[{block:e,elem:"popup-items"}]}],n=Array.isArray(t.params.popupMixs)?t.params.popupMixs:[],s=t.params.popupDirections||["bottom-left"];t._hasPopupFade()&&i.push({block:e,elem:"fade"}),n.push({block:e,elem:"popup",elemMods:t.params.popupMods,js:{uniqId:t._uniqId}}),t._popup=$(BEMHTML.apply({block:"popup2",mods:{autoclosable:"yes",target:"anchor",theme:"normal"},mainOffset:0,directions:s,mix:n,js:t.params.popupParams,content:{elem:"content",content:i}})).bem("popup2").on({beforeOpen:function(){t.bindTo("keypress",t._onKeyPress).bindTo("keydown",t._onKeyDown)},beforeClose:function(){t.unbindFrom("keypress keydown")._curItemIndex=-1}}),$.each({pointerover:t._onEnterItem,pointerout:t._onLeaveItem,pointerdown:t._onSelectItem,pointerup:t._onItemMouseUp},function(e,i){BEM.blocks["b-autocomplete-item"].on(t._popup.domElem,e,function(e){i.call(t,e.block)})}),BEM.DOM.init(t._popup.domElem),t._popup.setAnchor(t.elem("box"))}return t._popup},getPopup:function(){return this._getPopup()},_hasPopupFade:function(){return"yes"===(this.params.popupMods||{}).fade},_onEnterItem:function(t,e){if(t.hasMod("enterable","no"))return!1;var i=this._items,n=this._curItemIndex;n>-1&&i[n].delMod("hovered"),(n=this._getItemIndex(t))>-1&&i[n].setMod("hovered","yes"),this._curItemIndex=n,this._isCurItemEnteredByKeyboard=Boolean(e),e&&this.params.updateOnEnter&&(this._preventRequest=!0,this.val(!1!==t.enter()?t.val():this._userVal,{source:"autocomplete",itemIndex:this._curItemIndex}).del("_preventRequest"))},_onLeaveItem:function(t,e){var i=this._curItemIndex;return i>-1&&i===this._getItemIndex(t)&&(this._items[i].delMod("hovered"),this._curItemIndex=-1),e&&this.val(this._userVal),!0},_onSelectItem:function(t,e){var i=t.select(e||!1),n="object"==typeof i?i.needUpdate:!1!==i,s="object"==typeof i&&i.needEvent;this._preventRequest=!0,n&&(this._userVal=t.val(),this.val(this._userVal,{source:"autocomplete",itemIndex:this._curItemIndex})),e?this.del("_preventRequest")._getPopup().delMod("visible"):(this._returnFocus=!0,this.bindToDoc("pointerrelease",this._onDocMouseUp),n||(this._preventHide=!0),this.afterCurrentEvent(function(){this.domElem&&this.setMod("focused","yes").del("_preventRequest","_preventHide")})),(n||s)&&this.trigger("select",{item:t,byKeyboard:e})},_onItemMouseUp:function(){this._closePopupByMouseUp()},_onDocMouseUp:function(){this._closePopupByMouseUp()},_closePopupByMouseUp:function(){this.unbindFromDoc("pointerrelease").del("_returnFocus")._getPopup().delMod("visible")},_getItemIndex:function(t){return $.inArray(t,this._items)},_doRequest:function(){var t=this;t._userVal=t.val(),t.trigger("data-requested").getDataprovider().get(t.val(),function(e){t.trigger("data-received",e);var i=t._getPopup(),n=e.items||e;t.foot&&n.length&&-1===$.inArray(t.foot,n)&&n.push(t.foot),n.length?(t._curItemIndex=-1,BEM.DOM.update(i.elem("items"),t._buildItemsHtml(n),function(){i.hasMod("visible")||(i.setMod("visible","yes"),t._setWidth()),t._items=i.findBlocksInside("b-autocomplete-item"),t.trigger("update-items")})):i.delMod("visible")})},_setWidth:function(){this._hasPopupFade()&&this._getPopup().domElem.css("width",this.elem("box").outerWidth())},_buildItemsHtml:function(t){var e=this;return BEMHTML.apply($.map(t,function(t,i){var n,s={block:"b-autocomplete-item",data:t,mods:{type:$.isArray(t)?t[0]:"text"},suggestVersion:e.params.dataprovider.version||4};return $.isArray(t)&&$.isPlainObject(n=t.concat().pop())&&$.extend(s,n),s}))},setFoot:function(t){return this.foot=t,this.foot},getDefaultParams:function(){return $.extend(this.__base(),{updateOnEnter:!0,debounceDelay:50,showListOnFocus:!0})}}),BEM.decl({block:"i-request_type_ajax",baseBlock:"i-request"},{onSetMod:{js:{inited:function(){this.__base(),this._requestNumber=this._number=this._preventNumber=this._retryCount=0}}},_get:function(t,e,i,n){this._number++,this._requestNumber++,this._retryCount=n.retryCount,this.__base.apply(this,arguments)},_do:function(t,e,i,n){var s=this;if(s._number>s._preventNumber){var o=arguments,r={data:n.data?$.extend({},n.data,t):t},a=s._wrapCallback(function(i,o,r){s._onSuccess(s._buildCacheKey(t,n),t,i[0],n),s._allowCallback(o,r)&&e.apply(n.callbackCtx,i)}),c=s._wrapCallback(function(t,e,r){s._allowCallback(e,r)&&(s._retryCount-- >0?setTimeout(function(){s._do.apply(s,o)},n.retryInterval):i&&i.apply(n.callbackCtx,t))});$.each(["url","dataType","timeout","type","jsonp","jsonpCallback","xhrFields","cache"].concat(n.paramsToSettings||[]),function(t,e){r[e]=n[e]}),$.ajax(r).done(a).fail(c)}},_wrapCallback:function(t){var e=this._requestNumber,i=this._number;return function(n){null!==n&&t(arguments,e,i)}},_allowCallback:function(t,e){return e>this._preventNumber&&this._requestNumber===t},_buildCacheKey:function(t,e){return"string"==typeof t?t:this.__base(t)+e.url},abort:function(){this._preventNumber=++this._number},getDefaultParams:function(){return $.extend(this.__base(),{cache:!0,type:"GET",dataType:"jsonp",timeout:2e4,retryCount:0,retryInterval:2e3})}}),BEM.DOM.decl({block:"b-autocomplete-item",modName:"nav",modVal:"yes"},{enter:function(){return!1},select:function(t){if(t){var e=window.open();e.opener=null,e.location=this.val()}return{needEvent:!0}}},{getUrl:function(t){return(t.match(/^\w[\w-]*:\/\//g)?"":"http://")+t}}),BEM.DOM.decl({block:"m-replacer",modName:"type",modVal:"page-title"},{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.channel("common").on("update",function(t,e){"page-title"==e.type&&(this.elem("text").text(e.data),this.elem("field").length&&this.elem("field").val(e.data))},this)}}}),BEM.DOM.decl({block:"b-grid-table-cell",modName:"type",modVal:"string"},{val:function(){var t;if(this.__base.apply(this,arguments))return(t=this._textarea.val()).length?t:null},_initBlock:function(){if(this.__base.apply(this,arguments),!this._storage._table.hasMod("mode","edit")||this.hasMod("state","edit")||this.hasMod("saving","yes"))return!1;this._setEdit()},_onSaved:function(t,e){this.__base.apply(this,arguments),BEM.DOM.destruct(this.findElem("i")),BEM.DOM.prepend(this.domElem,BEMHTML.apply(BEM.blocks["b-grid-table"].getStringBEMJSON(e.data.cell,this._storage._table.domElem,this._storage._table.params.newWF,this._storage._table.params.supertag))),this._storage._table.params.newWF&&Ya.FormatterViewPort.BEM.DOM.init(this.domElem)},_setEdit:function(){this._textarea||(BEM.DOM.append(this.domElem,this._getTextarea()),this._textarea=this.findBlockInside("input"),this._textarea.val(this.params.raw||"")),this.__base.apply(this,arguments),this.afterCurrentEvent(function(){this._textarea.setMod("focused","yes").elem("control").select()})},_getTextarea:function(){return BEMHTML.apply({block:"input",mods:{type:"textarea",size:"s"},content:{elem:"control"}})},_resizeEdit:function(){this._textarea.domElem.width(this._sizes.outerWidth+1),this._textarea.elem("control").height(this._sizes.outerHeight-1)},_clearSize:function(){this._textarea.elem("box").width(""),this._textarea.elem("control").height(""),this.__base.apply(this,arguments)},_save:function(){var t=this.__base.apply(this,arguments);t.val=this.val(),t.val!==this.params.raw?this.setMod("saving","yes").trigger("save",t):(this.delMod("state"),this._clearSize())},_resetValue:function(){!1!==this.__base.apply(this,arguments)&&this.val()!==this.params.raw&&this._textarea.val(this.params.raw)}}),BEM.DOM.decl("m-calendar",{_popUpOpened:!1,onSetMod:{js:function(){this.params.value&&(this._notTriggerChange=!0,this.setDate(this.params.value))}},getDatePicker:function(){return this._datePicker||!1},setDate:function(t,e){this._datePicker&&this._popUpOpened||(this.params.value=t,this._buildDatePicker()),this._datePicker.setDate(t,!e,e)},getDate:function(){return this._datePicker||this._buildDatePicker(),this._datePicker.getDate()},clearDate:function(){this._datePicker||this._buildDatePicker(),this._datePicker.clearDate()},_onDateChange:function(t,e){this._popUpOpened&&!e.fromArrow&&this.params.autoclose&&this._datePickerPopup.delMod("visible"),!this._notTriggerChange&&this.trigger("change",this._datePicker.getDate()),this._notTriggerChange=!1},_onTogglerClick:function(){this._datePicker||this._buildDatePicker(),this._datePickerPopup.setMod("visible","yes"),this._datePicker.setSizes()},_onDatePickerPopupHide:function(){this.input._isDatePickerOpened=!1,this._popUpOpened=!1,this.trigger("hide")},_onDatePickerPopupShow:function(){this._popUpOpened=!0,this.trigger("show")},_buildDatePicker:function(){this._buildPopup(),this._datePicker=$(BEMHTML.apply(this._getDatePickerBEMJSON())).bem("m-datepicker"),this._datePicker.on("change",this._onDateChange,this),this._datePickerPopup.setContent(this._buildTail().add(this._datePicker.domElem)).setAnchor(this.elem("toggler")).on("beforeClose",this._onDatePickerPopupHide,this).on("beforeOpen",this._onDatePickerPopupShow,this)},_buildTail:function(){return $(BEMHTML.apply({block:"popup2",elem:"tail"}))},_buildPopup:function(){this._datePickerPopup||(this._datePickerPopup=$(BEMHTML.apply({block:"popup2",mix:[{block:"m-calendar",elem:"popup",elemMods:{type:this.getMod("type")}}],mods:{target:"anchor",theme:"normal",autoclosable:"yes"},content:[{elem:"tail"},{elem:"content"}]})).bem("popup2"))}},{dateFormat:BEM.blocks["mi-helpers"].dateFormat}),function(){var t,e,i=function(){for(var e,i=0;e=t[i++];)e.val(e.elem("input").val())},n=function(t){try{return t.activeElement}catch(t){}};BEM.DOM.decl("b-form-input",{onSetMod:{js:{inited:function(){var s=this,o=s.elem("input"),r=n(s.__self.doc[0]),a=s.params.autoFocus&&!(r&&$(r).is("input, textarea"));s._val=o.val(),s._input0=o[0],(r===s._input0||a)&&(s._autoFocus=!0,s.setMod("focused","yes")._focused=!0,delete s._autoFocus),e||(t=[],e=s.channel("sys").on({tick:i,idle:function(){e.un("tick",i)},wakeup:function(){e.on("tick",i)}})),s._instanceIndex=t.push(s.bindTo(o,{focus:s._onFocus,blur:s._onBlur}))-1,s.params.shortcut&&s.bindToDoc("keydown",function(t){t.ctrlKey&&t.keyCode===BEM.blocks.keycodes.UP&&!$(t.target).is("input, textarea")&&s.setMod("focused","yes")})}},disabled:function(t,e){this.elem("input").prop("disabled",e)},focused:function(t,e){if(this.hasMod("disabled"))return!1;e?this._focused||this._focus():this._focused&&this._blur(),this.afterCurrentEvent(function(){this.domElem&&this.trigger(e?"focus":"blur")})}},onElemSetMod:{message:{visibility:function(t,e,i){var n=this,s=n.getMod(t,"type");if(s){var o=!0;i||n.elem("message","type",s).each(function(){this!==t[0]&&n.hasMod($(this),"visibility","visible")&&(o=!1)}),o&&n.toggleMod("message-"+s,"yes","","visible"===i)}}}},val:function(t,e){if(void 0===t)return this._val;if(this._val!==t){var i=this.elem("input");i.val()!==t&&i.val(t),this._val=t,this.trigger("change",e)}return this},getSelectionEnd:function(){var t=this.elem("input")[0],e=0;if("number"==typeof t.selectionEnd)e=t.selectionEnd;else{var i=document.selection.createRange();if(i&&i.parentElement()===t){var n=t.value.length,s=t.createTextRange();s.moveToBookmark(i.getBookmark());var o=t.createTextRange();o.collapse(!1),e=s.compareEndPoints("EndToEnd",o)>-1?n:-s.moveEnd("character",-n)}}return e},name:function(t){return this.elem("input").attr("name")},_onFocus:function(){return this._focused=!0,this.setMod("focused","yes")},_onBlur:function(t){var e=this;if(n(document)!==e._input0)return e._preventBlur?(setTimeout(function(){e._focus()},0),e):(e._focused=!1,e.delMod("focused"))},_focus:function(){var t=this.elem("input")[0];if(t.createTextRange&&!t.selectionStart){var e=t.createTextRange();e.move("character",t.value.length),e.select()}else t.focus()},_blur:function(){this.elem("input").blur()},destruct:function(){this.__base.apply(this,arguments),this.params.shortcut&&this.unbindFromDoc("keydown"),t.splice(this._instanceIndex,1);for(var e,i=this._instanceIndex;e=t[i++];)--e._instanceIndex}}),BEM.HTML.decl("b-form-input",{onBlock:function(t){var e=t.param("id")||t.generateId();t.tag("span").tParam("id",e).tParam("has-clear",Boolean(t.mod("has-clear"))).tParam("type",t.mod("type")||"input").afterContent({elem:"box",tag:"span",content:{elem:"input",attrs:{value:t.param("value"),name:t.param("name"),id:e}}}).js(!0)},onElem:{input:function(t){t.tag(t.tParam("type"))},label:function(t){t.tag("label").attr("for",t.tParam("id"))},box:function(t){t.tParam("has-clear")&&t.afterContent({elem:"clear",tag:"span"})},hint:function(t){t.tag("label").attr("for",t.tParam("id"))}}})}(),BEM.WISTORE.decl("application",{action:"string",view:"string",debug:"boolean",contentLoaded:"boolean",sidebar:"string"},{}),BEM.DOM.decl({block:"i-popup",modName:"autoclosable",modVal:"yes"},{onSetMod:{visibility:{visible:function(){this.afterCurrentEvent(function(){if(this.domElem&&this.hasMod("visibility","visible")){var t=this._under;this.bindToDoc("pointerclick",function(t){this.containsDomElem($(t.target))||this._onOutClick(t)}).bindToDoc("keydown",function(t){t.keyCode===BEM.blocks.keycodes.ESC&&this.hide()}),t&&t.is("iframe")&&this.hasMod(t,"type","paranja")&&this.bindToDomElem($([t[0].contentWindow,t[0].contentWindow.document]),"pointerclick",this._onOutClick)}}),this.__base.apply(this,arguments)},"":function(){return this.unbindFromDoc("pointerclick keydown").__base.apply(this,arguments)}}},_onOutClick:function(t){var e=$.Event("outside-click");this.trigger(e,{domEvent:t}),e.isDefaultPrevented()||this.hide()}}),BEM.DOM.decl({block:"wiki-ref",modName:"wiki",modVal:"yes"},{onSetMod:{js:{inited:function(){this.bindTo(this.domElem,"click",function(){yaCounter&&yaCounter.reachGoal("from_text")})}}}}),BEM.DOM.decl("b-page-code",{onSetMod:{js:function(){var t=this.findBlockOutside("wiki-doc"),e=t&&t.params.user?t.params.user.codeTheme:"github";this.setMod("theme",e),BEM.blocks["i-highlight"].highlight(this.domElem.find("code"))}}},{}),BEM.DOM.decl("b-page-code",{onSetMod:{js:function(){var t=this.findBlockOutside("b-page"),e=t&&t.params.codeTheme?t.params.codeTheme:"github";this.setMod("theme",e),BEM.blocks["i-highlight"].highlight(this.domElem.find("code"))}}},{}),BEM.DOM.decl({block:"wf-ref",modName:"type",modVal:"docviewer"},{onSetMod:{js:{inited:function(){this.params=this.domElem.data("wf"),this.bindTo(this.domElem,"click",this._docviewerTrigger)}}},_docviewerTrigger:function(t){t.preventDefault();var e=this.__self._getPopup(this,this.params),i=this;e._anchor===this.domElem?e.toggleMod("visible","yes",""):e.hasMod("visible","yes")?(e.on("afterClose",function(){e.setAnchor(i).un("afterClose"),setTimeout(function(){e.setMod("visible","yes")},0)}),e.delMod("visible")):(e.setAnchor(i),setTimeout(function(){e.setMod("visible","yes")},0))}},{_getPopup:function(t,e){return this._popup?(this._popupDownloadLink.attr("href",e.url),this._popupViewLink.attr("href",e.docviewer)):(this._popup=BEM.DOM.append(t.domElem,BEMHTML.apply(this._getPopupBEMJSON(e))).bem("popup2"),this._popupDownloadLink=this._popup.findBlockInside({block:"link",modName:"role",modVal:"download"}).domElem,this._popupViewLink=this._popup.findBlockInside({block:"link",modName:"role",modVal:"view"}).domElem),this._popup},_getPopupBEMJSON:function(t){return{block:"popup2",mods:{target:"anchor",theme:"normal",autoclosable:"yes",role:"docviewer"},hasTail:!0,directions:["right-center","right-top","right-bottom","bottom-right","bottom-center","bottom-left"],content:{elem:"content",content:[{block:"link",mods:{theme:"normal",role:"download"},url:t.url,text:BEM.I18N("wf-ref","download"),target:"_blank"},{block:"link",mods:{theme:"normal",role:"view"},url:t.docviewer,text:BEM.I18N("wf-ref","view"),target:"_blank"}]}}}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"request-access"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.show()}}}),BEM.DOM.decl({block:"select2",modName:"width",modVal:"fixed"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._setMinWidth()}}},_setMinWidth:function(){this.button.domElem.css("width",this.button.domElem.outerWidth())}}),BEM.DOM.decl("tabs",{getCount:function(){return this.elem("tab").length},activate:function(t){return this},deactivate:function(){return this},getActive:function(){return-1},disable:function(t){return this},enable:function(t){return this},isDisabled:function(t){},_onControlChange:function(t,e){}},{getSupportedControls:function(){return["tabs-menu","radio-button"]},live:function(){this.getSupportedControls().forEach(function(t){BEM.blocks[t]&&this.liveInitOnBlockInsideEvent("change",t,function(t,e){this._onControlChange(t,e)})},this)}}),BEM.DOM.decl({block:"w-page-setting",modName:"type",modVal:"redirect"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._title=BEM.I18N("w-page-setting","setup-redirect"),this._data||(this._data="")},progress:function(t,e,i){this.__base.apply(this,arguments),this._suggest.setMod("disabled","yes"===e?"yes":""),this._setClusterButton.setMod("disabled","yes"===e||this._data===this._suggest.val()?"yes":"")},active:function(t,e){this.__base.apply(this,arguments),"yes"===e&&this._suggest.val(this._data)}},_initBlocks:function(){this.__base.apply(this,arguments),this._suggest=this.findBlockInside("m-suggest").on("change",this._onInputChange,this),this._setClusterButton=this.findBlockInside("button2").on("click",this._setCluster,this)},_onInputChange:function(t){this._setClusterButton.setMod("disabled",t.block.val()===this._data?"yes":"")},_setCluster:function(){var t=this._suggest.val(),e={apiPath:".redirect",method:t?"POST":"DELETE",path:this.params.path,urlParams:!1};t&&(e.data={redirect_to_tag:t}),this.setMod("progress","yes"),BEM.create("wi-api-request",e).run().then(this._onDataSave.bind(this,t),this._onDataSaveError.bind(this))},_onDataSave:function(t){this._data=t,this.delMod("progress"),BEM.DOM.update(this.findElem("data-preview"),t||BEM.I18N("w-page-setting","no-redirect")),this.trigger("change")},_onDataSaveError:function(t){this.delMod("progress"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this._setClusterButton.domElem,null,t))}}),BEM.DOM.decl("input",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),(this._hasHint=Boolean(this.elem("hint")[0]))&&this.on("change",this._updateHint)._updateHint()}},focused:function(){if(!1===this.__base.apply(this,arguments))return!1;this._hasHint&&this._updateHint()}},_updateHint:function(){this.toggleMod(this.elem("hint"),"visibility","visible",!this.val())}}),BEM.DOM.decl({block:"w-page-setting",modName:"readonly",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.unbindFrom("click")}}}),BEM.DOM.decl({block:"button2",modName:"type",modVal:"link"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._url=this.params._url||this.domElem.attr("href")}},disabled:{"":function(){this.__base.apply(this,arguments),this.domElem.attr("tabindex",this.params._tabindex).attr("href",this._url)},yes:function(){this.__base.apply(this,arguments),void 0!==this._url&&this.domElem.attr("tabindex",-1),this.domElem.removeAttr("href")}}},getUrl:function(){return this._url},setUrl:function(t){return this._url=t,this.hasMod("disabled")||this.domElem.attr("href",t),this},getDefaultParams:function(){return $.extend(this.__base(),{pressKeys:["ENTER"]})}}),BEM.DOM.decl({block:"button2",modName:"type",modVal:"link"},{},{live:function(){return this.liveBindTo("dragend",function(t){this.hasMod("type","link")&&!this.hasMod("disabled")&&this.delMod("pressed")}),this.__base()}}),BEM.DOM.decl({block:"w-grid-preview",modName:"great",modVal:"yes"},{onSetMod:{js:function(){BEM.blocks.checkbox.on(this.domElem,"change",this._onCheckboxChange,this),this._subscribeSelects()}},destruct:function(t){BEM.blocks.checkbox.un(this.domElem,"change",this._onCheckboxChange,this),this._unsubscribeSelects(),this.__base(t)},getData:function(){var t={},e=!0;return this.params.data.import_columns.forEach(function(i,n){var s,o=this.elem("col","index",n);this.findBlockInside(o,"checkbox").isChecked()?(e=!1,"new"===(s=this.findBlockInside(o,{block:"select2",modName:"role",modVal:"col-to-import"}).getVal())?t["icolumn_"+n+"_type"]=this.findBlockInside(o,{block:"select2",modName:"role",modVal:"data-type"}).getVal():t["icolumn_"+n+"_to"]=s):t["icolumn_"+n+"_enabled"]=!1},this),{columns:t,allDisabled:e}},updateContent:function(t){var e,i=0;for(e=0;e<t.column_count;e++){var n=t.import_columns[e]["icolumn_"+e+"_enabled"];BEM.DOM.update(this.findElem(this.findElem("col","index",e.toString()),"imported-rows"),n?BEMHTML.apply(t.imported_rows.map(function(t){return this._getPreviewItem(t,"imported-content",i)},this)):""),BEM.DOM.update(this.findElem(this.findElem("col","index",e.toString()),"existing-rows"),n?BEMHTML.apply(t.existing_rows.map(function(t){return this._getPreviewItem(t,"existing-content",i)},this)):""),n&&i++}},enable:function(){var t;for(i=0;i<this.params.data.column_count;i++)t=this.findElem("col","index",i.toString()),this.findBlockInside(t,"checkbox").delMod("disabled").isChecked()&&"new"===this.findBlockInside(t,{block:"select2",modName:"role",modVal:"col-to-import"}).delMod("disabled").getVal()&&this.findBlockInside(t,{block:"select2",modName:"role",modVal:"data-type"}).delMod("disabled")},disable:function(){this.findBlocksInside("select2").concat(this.findBlocksInside("checkbox")).forEach(function(t){t.setMod("disabled","yes")})},_getPreviewItem:function(t,e,i){var n=t[i].value,s=t[i].type,o={block:"w-grid-preview",elem:"preview-item"};return"staff"===s?n.length&&(o.content={block:"m-username",mix:[{block:"mi-staff-card",js:{user:n[0]}}],url:"//staff.yandex-team.ru/"+n[0],content:n[0]}):"checkbox"===s?"boolean"==typeof n&&(o.content={block:"checkbox",mods:{size:"s",checked:n?"yes":"",disabled:"yes",type:e},text:n?BEM.I18N("w-grid-preview","true"):BEM.I18N("w-grid-preview","false")}):"select"===s?n.length&&(o.content=n[0]):"number"===s||"date"===s?o.content=n:n&&n.length&&(o.content=JSON.parse(n)),o},_subscribeSelects:function(){BEM.blocks.select2.on(this.domElem,"change",this._onSelectChange,this)},_unsubscribeSelects:function(){BEM.blocks.select2.un(this.domElem,"change",this._onSelectChange,this)},_onCheckboxChange:function(t,e){var i,n=e.checked,s=t.block.getMod("index");this.setMod(this.findElem("col","index",s),"disabled",n?"":"yes"),this.findBlocksInside(this.findElem("col","index",s),"select2").forEach(function(t){t.setMod("disabled",n?"":"yes")},this),this.setMod(this.findElem(this.findElem("col","index",s),"imported-rows"),"visibility",n?"":"hidden"),this.setMod(this.findElem(this.findElem("col","index",s),"existing-rows"),"visibility",n?"":"hidden"),n||"new"!==(i=this.findBlockInside(this.findElem("col","index",s),{block:"select2",mdoName:"role",modVal:"col-to-import"})).getVal()&&(this._unsubscribeSelects(),i.getVal("new"),this._subscribeSelects(),this._recalculateSelectsOptions(),BEM.DOM.update(this.findElem(this.findElem("col","index",s),"existing-rows"),"")),this._triggerChange()},_onSelectChange:function(t){var e,i=t.block.getVal();"col-to-import"===t.block.getMod("role")&&(e=this.findBlockInside(t.block.domElem.parent(),{block:"select2",modName:"role",modVal:"data-type"}).setMod("disabled","new"===i?"":"yes"),"new"!==i&&this.params.data.existing_columns.forEach(function(t){t[0]===i&&BEM.DOM.replace(e.domElem,BEMHTML.apply({block:"select2",mods:{size:"s",theme:"normal",role:"data-type",type:"radiocheck",disabled:"yes"},val:t[2],items:this.params.data.column_data_types.map(function(t){return{val:t[0],text:t[1]}},this)}))},this),this._recalculateSelectsOptions()),this._triggerChange()},_recalculateSelectsOptions:function(){var t,e,i,n,s=[{val:"new",text:BEM.I18N("w-grid-preview","new")}].concat(this.params.data.existing_columns.map(function(t){return{val:t[0],text:t[1]}},this)),o=[];this._unsubscribeSelects(),this.findBlocksInside({block:"select2",modName:"role",modVal:"col-to-import"}).forEach(function(t){var e=t.getVal();"new"!==e&&o.push(e)},this),this.findBlocksInside({block:"select2",modName:"role",modVal:"col-to-import"}).forEach(function(r){t=[],i=r.getVal(),n=s.slice(),e=o.slice(),"new"!==i&&e.splice(e.indexOf(i),1),s.forEach(function(i,n){-1!==e.indexOf(i.val)&&t.push(n)},this),t.forEach(function(t,e){n.splice(t-e,1)},this);var a=r.domElem.parent(),c=r.getMod("index");r.destruct(),BEM.DOM.prepend(a,BEMHTML.apply({block:"select2",mods:{size:"s",theme:"normal",type:"radiocheck",role:"col-to-import",index:c,text:"vary"},val:i,text:BEM.I18N("w-grid-preview","new"),items:n.map(function(t){return{val:t.val,text:t.text}})}))},this),this._subscribeSelects()},_triggerChange:function(){this.trigger("change",this.getData())}}),BEM.DOM.decl({block:"w-grid-preview",modName:"great",modVal:"yes"},{_getPreviewItem:function(t,e,i){var n=t[i].value,s=t[i].type,o={block:"w-grid-preview",elem:"preview-item"};return"staff"===s?n.length&&(o.content={block:"m-username",login:n[0],content:n[0]}):"checkbox"===s?"boolean"==typeof n&&(o.content={block:"checkbox",mods:{size:"s",checked:n?"yes":"",disabled:"yes",type:e},text:n?BEM.I18N("w-grid-preview","true"):BEM.I18N("w-grid-preview","false")}):"select"===s?n.length&&(o.content=n[0]):"number"===s||"date"===s?o.content=n:n&&n.length&&(o.content=JSON.parse(n)),o}}),BEM.DOM.decl({block:"w-page-info",modName:"type",modVal:"dismissed-authors"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.findBlockInside({block:"button2",modName:"role",modVal:"get-authorship"}).on("click",this._showRequestAuthorshipMessage,this)}},_showRequestAuthorshipMessage:function(){var t=BEM.blocks["i-routes"].actions[".requestauthorship"].page,e=BEM.WISTORE.get("page").get("type");BEM.channel("common").trigger(t[e].block+"."+t[e].event)}}),BEM.DOM.decl({block:"popup",modName:"type",modVal:"modal"},{getDefaultParams:function(){var t=this.__base();return t.top="50%",t.left="50%",t},_isPercentVal:function(t){return"string"==typeof t&&t.indexOf("%")>0},show:function(t){return this._moveToContainer(),this.setMod("visibility","outside").setMod("adaptive","no"),this.repaint(t),this},repaint:function(t){this._moveToContainer(),t||(t={left:this.params.left,top:this.params.top});var e=this.getPopupSize();return this._isPercentVal(t.left)&&!t.marginLeft&&(t.marginLeft=e.width/(-100/parseInt(t.left,10))),this._isPercentVal(t.top)&&!t.marginTop&&(t.marginTop=e.height/(-100/parseInt(t.top,10))),this._show(t),this}}),BEM.DOM.decl("popup",{onSetMod:{autoclosable:{yes:function(){this._enableAutoclosable()},"":function(){this._disableAutoclosable()}}},_enableAutoclosable:function(){if(this.domElem){var t=this._under;this.hasMod(t,"type","paranja")&&(t.is("iframe")&&(t=$([t[0].contentWindow,t[0].contentWindow.document])),this.bindTo(t,"pointerclick",function(t){t.stopPropagation(),this.hide({source:"outside-click"})}),this.bindTo(t,"pointerdown",function(){this._skipReturnFocus=!0})),this.bindTo("pointerdown pointerclick",function(){var t=this;do{t._preventHideByClick=!0,t=t._getParentPopup()}while(t)}),this.bindToDoc("pointerclick",function(t){if(this._preventHideByClick)this._preventHideByClick=null;else if(!this._isRelatedNode($(t.target))){var e=$.Event("outside-click");this.trigger(e,t),e.isDefaultPrevented()||this.hide({source:"outside-click"})}}),this.bindToDoc("pointerdown",function(){this._skipReturnFocus=!0})}},_disableAutoclosable:function(){var t=this._under;this.hasMod(t,"type","paranja")&&(t.is("iframe")&&(t=$([t[0].contentWindow,t[0].contentWindow.document])),this.unbindFrom(t,"pointerclick pointerdown")),this.unbindFromDoc("pointerclick pointerdown")},_isRelatedNode:function(t){var e=this.containsDomElem(t);if(e||(e=Boolean(this._owner)&&this.containsDomElem.call({domElem:this._owner},t)),e)return!0;var i,n=this._childs.length;for(i=0;i<n;i++)if(this.containsDomElem.call({domElem:this._childs[i].domElem},t))return!0;return!1}}),BEM.DOM.decl({block:"popup",modName:"adaptive",modVal:"yes"},{onSetMod:{adaptive:{yes:function(){this._enableAdaptive()},no:function(){this._disableAdaptive()}},"watch-scroll":{yes:function(){this._watchScroll()},no:function(){this._unwatchScroll()}}},_enableAdaptive:function(){this.afterCurrentEvent(function(){this.domElem&&this.bindToWin("resize",this.onResize)}),this._watchScroll()},_disableAdaptive:function(){this.unbindFromWin("resize")._unwatchScroll()},getScrollEvents:function(){return["scroll"]},_watchScroll:function(){this._owner&&!this.hasMod("watch-scroll","no")&&this.bindTo(this._owner.parents().add(this._viewport),this.getScrollEvents().join(" "),this.onScroll,this)},_unwatchScroll:function(){this._owner&&this.unbindFromDomElem(this._owner.parents().add(this._viewport),this.getScrollEvents().join(" "))},onResize:function(t){this._cache={},this._isShown&&!this._isHiding&&this.repaint()},onScroll:function(t){this._cache={},this._isShown&&!this._isHiding&&this.repaint()},destruct:function(){this._disableAdaptive(),this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"popup",modName:"animate",modVal:"yes"},{afterShow:function(){var t=this.getCurrDirection();if(t){var e=t.to,i=this.getCurrPos(),n={opacity:1,top:i.top,left:i.left},s={opacity:0,top:i.top,left:i.left};"bottom"===e?s.top+=10:"top"===e?s.top-=10:"left"===e?s.left-=10:"right"===e&&(s.left+=10),this.domElem.stop(!0).css(s).animate(n,this.params.duration)}},beforeHide:function(t){var e=this.getCurrDirection();if(!e)return t();var i=e.to,n=this.getCurrPos(),s=this.domElem,o={top:n.top,left:n.left,opacity:0};return"bottom"===i?o.top+=10:"top"===i?o.top-=10:"left"===i?o.left-=10:"right"===i&&(o.left+=10),s.stop(!0,!0).animate(o,this.params.duration,function(){t(),s.css("opacity","")})}}),BEM.DOM.decl({block:"popup",modName:"position",modVal:"fixed"},{addChild:function(t){this.__base.apply(this,arguments),t.setMod("watch-scroll","no")},_onFirstFocusableKeyDown:function(t){t.ctrlKey||t.altKey||t.metaKey||t.shiftKey&&t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._lastFocusable.focus())},_onLastFocusableKeyDown:function(t){t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||t.which===BEM.blocks.keycodes.TAB&&(t.preventDefault(),this._firstFocusable.focus())}}),BEM.DOM.decl({block:"popup",modName:"position",modVal:"fixed"},{getOwnerPos:function(){var t=this.__base.apply(this,arguments);if(this._owner){var e=this._viewport;t.top-=e.scrollTop(),t.left-=e.scrollLeft()}return t}}),BEM.DOM.decl({block:"popup",modName:"wrapped",modVal:"yes"},{onSetMod:{visibility:{visible:function(){this.__base(),this._wrap()},"":function(){this.__base(),this._unwrap()}},wrapped:{"":function(){this._unwrap()}}},_wrap:function(){this._wrapper||(this._wrapper=this.elem("wrapper").detach()),this._wrapper&&this.domElem.wrap(this._wrapper)},_unwrap:function(){this._wrapper&&this.domElem.unwrap()},_captureZIndex:function(){var t=this._zIndex,e=this.__base.apply(this,arguments);return this._zIndex!==t&&this.elem("wrapper").css("z-index",this._zIndex),e},destruct:function(){this._unwrap(),this.__base()}}),function(){var t={};BEM.DOM.decl({block:"popup",modName:"body-scroll",modVal:"no"},{onSetMod:{visibility:function(){return this.afterCurrentEvent(function(){this.domElem&&this.hasMod("visibility","visible")?t[this.params.uniqId]=!0:delete t[this.params.uniqId],this._manageScopeOverflow()}),this.__base()}},destruct:function(){var e=this.params.uniqId;t[e]&&(delete t[e],this._manageScopeOverflow()),this.__base.apply(this,arguments)},_enableScroll:function(){return this._scope.css({overflow:""}),this},_disableScroll:function(){return this._scope.css({overflow:"hidden"}),this},_manageScopeOverflow:function(){var e=Object.keys(t).length;0===e?this._enableScroll():1===e&&this._disableScroll()}})}(),BEM.DOM.decl({block:"m-suggest",modName:"assigned",modVal:"form"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.required&&this.findBlockOutside("b-wiki-form")._requiredFields.push(this)}}}),BEM.DOM.decl({block:"select-multiple",modName:"assigned",modVal:"form"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.required&&this.findBlockOutside("b-wiki-form")._requiredFields.push(this)}}}),BEM.DOM.decl("m-head-user",{onSetMod:{js:function(){var t=this.elem("logout");t.attr("href",t.attr("href").replace("{yandexuid}",$.cookie("yandexuid")))}},_onClick:function(){this._popup||(this._popup=this.findBlockOn("popup","popup2"),this._popup.setAnchor(this.domElem)),this._popup.setMod("visible","yes")}},{live:function(){this.liveBindTo("click",function(){this._onClick()})}}),BEM.DOM.decl({block:"messenger",modName:"internal",modVal:"yes"},{getDefaultParams:function(){return $.extend(this.__base(),{scriptUrl:"https://chat.s3.yandex.net/widget_ya_internal.js"})}}),BEM.DOM.decl({block:"user2",modName:"fetch-accounts",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._accountsElem=this.findElem(this._menu.domElem,"accounts"),this._accountsSpin=this.findBlockInside(this._accountsElem,"spin2"),this._accountsDataProvider=BEM.create(this.params.accountsDataProvider,{callbackCtx:this,accountsUrl:this.params.accountsUrl}),this._fetchAccounts()}}},onElemSetMod:{accounts:{loading:function(t,e,i){this._accountsSpin.setMod("progress",i)}}},_fetchAccounts:function(){this.setMod(this._accountsElem,"loading","yes"),this._accountsDataProvider.get({yu:this.params._yu},function(t){this._hasOrganizations=t.accounts&&t.accounts.some(function(t){return t.attributes.has_organization})||!1;var e=!0,i=this._popup.findBlockInside({block:"user-account",modName:"template",modVal:"yes"});if(i){if(t.accounts){var n=this.params.accountsMax;t.accounts.forEach(function(e,s){e.uid!==t.default_uid&&s<=n&&this._accountsContainer[0].appendChild(this._renderAccount(e,s,i))},this),e=Boolean(t["can-add-more"])}var s=i.domElem.parent();i.destruct(),s.remove()}this.updateCounters&&this.updateCounters(),this.toggleMod(this.findElem(this._accountsElem,"add-account"),"hidden","","yes",e),this.delMod(this._accountsElem,"loading")})},_renderAccount:function(t,e,i){var n=t.defaultEmail||t.displayName.social,s=this.params._avatarHost||"https://avatars.mds.yandex.net",o=t.displayName.default_avatar,r=i.domElem.clone().bem("user-account"),a=JSON.parse(r.domElem.attr("data-bem"));n="object"==typeof n?{fb:"Facebook",tw:"Twitter",mr:"Mail.ru",gg:"Google",ok:"Odnoklassniki",vk:"Vkontakte",dz:"Deezer",fs:"Foursquare",ig:"Instagram",lf:"Last.FM",lj:"LiveJournal",in:"LinkedIn",mt:"МТС-Россия",ms:"Microsoft",yh:"Yahoo",ya:"Yandex",vf:"Vodafone-Украина",tg:"Telegram"}[n.provider]:n,a.user2__account={uid:t.uid,pos:e},r.domElem.attr("data-bem",JSON.stringify(a)),r.delMod("template"),r.elem("name-text").text(t.displayName.name),n&&(r.setMod("has-subname","yes"),r.elem("subname").text(n));var c=r.findBlockInside("user-pic"),l=s+"/get-yapic/"+o+"/islands-middle",d=s+"/get-yapic/"+o+"/islands-retina-middle";c.elem("image").attr("src",l),c.elem("image").attr("srcSet",l+" 1x, "+d+" 2x");var h=document.createElement("div");return h.className="menu__item",h.appendChild(r.domElem[0]),h},getDefaultParams:function(){return $.extend(this.__base.apply(this,arguments),{accountsDataProvider:"user2__accounts-provider",accountsMax:this._params.accountsMax||5,maxLength:this._params.maxLength||16})}}),BEM.DOM.decl({block:"user-account",modName:"has-ticker",modVal:"yes"},{getTicker:function(){return this.findBlockOn("ticker","ticker")}}),BEM.DOM.decl({block:"light-popup",modName:"autoclosable",modVal:"yes"},{onSetMod:{visible:{yes:function(){this.afterCurrentEvent(function(){this.domElem&&this.hasMod("visible")&&this.bindToDoc("pointerdown",this._onDocClick)}),this.__base.apply(this,arguments)},"":function(){this.unbindFromDoc("pointerdown").__base.apply(this,arguments)}}},_onDocClick:function(t){this.hasMod("visible")&&!this.containsDomElem($(t.target))&&this.delMod("visible")}}),BEM.decl({block:"user2__accounts-provider",baseBlock:"i-request_type_ajax"},{getDefaultParams:function(){return $.extend(this.__base.apply(this,arguments),{url:this._params.accountsUrl,timeout:5e3,dataType:"json",xhrFields:{withCredentials:!0},cache:!1})}}),BEM.DOM.decl({block:"user2",modName:"fetch-unread",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._unreadDataProvider=BEM.create(this.params.unreadDataProvider,{callbackCtx:this,exportHost:this.params.exportHost}),this._fetchUnread()}}},_fetchUnread:function(){this._unreadDataProvider.get({key:this.params._yu},this._onFetchUnreadSuccess)},_onFetchUnreadSuccess:function(t){this.setUnreadCount(t.unread||0)},getDefaultParams:function(){return $.extend(this.__base.apply(this,arguments),{unreadDataProvider:"user2__unread-provider"})}}),BEM.decl({block:"user2__unread-provider",baseBlock:"i-request_type_ajax"},{getDefaultParams:function(){var t=this._params.exportHost||"https://export.yandex.ru";return $.extend(this.__base.apply(this,arguments),{url:t+"/for/unread.xml",cache:!1})}}),BEM.DOM.decl({block:"user2",modName:"with-organizations",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._organizationsContainer=this.findElem(this._menu.domElem,"organizations").bem("user2__organizations"),this._organizationsCropperContainer=this.findElem(this._menu.domElem,"organizations-cropper"),this._expandIcon=this._organizationsContainer.findBlockInside({block:"icon",modName:"glyph",modVal:"type-arrow"})}}},_onCurrentOrganizationClick:function(t,e){e.domEvent.preventDefault(),this.trigger("current-organization-click"),this._organizationsContainer.toggleMod("collapsed","yes"),this._expandIcon.toggleMod("direction","top")},_onOrganizationClick:function(t,e){t.block.findBlockOn("user2__organizations-trigger")?this._onCurrentOrganizationClick(t,e):this.trigger("organization-click")}},{live:function(){this.__base.apply(this,arguments),this.liveInitOnBlockInsideEvent("init","user-organization").liveInitOnBlockInsideEvent("click","user-organization",this.prototype._onOrganizationClick)}}),BEM.DOM.decl({block:"user2",modName:"fetch-organizations",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments);var t=this.findElem(this._menu.domElem,"organizations");this._organizationsSpin=this.findBlockInside(t,"spin2"),this._organizationsDataProvider=BEM.create(this.params.organizationsDataProvider,{callbackCtx:this,organizationsUrl:this.params.organizationsUrl}),this.getMods()["fetch-accounts"]||this._fetchOrganizations()}}},onElemSetMod:{accounts:{loading:{"":function(){this._hasOrganizations&&this._fetchOrganizations()}}},organizations:{loading:function(t,e,i){this._organizationsSpin.setMod("progress",i)}}},_fetchOrganizations:function(){this.setMod(this._organizationsContainer.domElem,"loading","yes");var t={};this._organizationsDataProvider.get({},function(e){(t=e)[this.params._uid]&&this._renderOrganizations(t[this.params._uid]),this.delMod(this._organizationsContainer.domElem,"loading")},function(){this.delMod(this._organizationsContainer.domElem,"loading")})},_renderOrganizations:function(t){t.length>=15&&this.findElem(this._organizationsContainer.domElem,"add-organization")[0].remove();var e=this.findBlockInside(this._organizationsContainer.domElem,{block:"user-organization",modName:"template",modVal:"yes"});if(t.length>0){var i=this._getDestructuredOrganizations(t);i.current=this._getOrgElem(i.current,e),i.current.classList.add("user2__organizations-trigger"),i.others=i.others.map(function(t){return this._getOrgElem(t,e)}.bind(this));var n=this.findElem(this._organizationsContainer.domElem,"organizations-cropper");this._currentOrganization=i.current,i.others.forEach(function(t){n.append($(t))}),i.others.length>0&&this._organizationsContainer.setMod("expandable","yes"),this._organizationsContainer.domElem.prepend(n),this._organizationsContainer.domElem.prepend(i.current)}e.destruct()},_getOrgElem:function(t,e){var i=e.domElem.clone().bem("user-organization");return i.delMod("template").elem("name").text(t.name),t.logo&&(i.elem("image")[0].src=t.logo),i.domElem[0].href+="&org_id="+t.id,i.domElem[0]},_getDestructuredOrganizations:function(t){var e;if(BEM.blocks["y-cookie"].parse($.cookie("yp"))&&BEM.blocks["y-cookie"].parse($.cookie("yp")).org_id&&(e=BEM.blocks["y-cookie"].parse($.cookie("yp")).org_id.value),e)for(var i=0;i<t.length;i++)if(t[i].id.toString()===e.toString())return{current:t[i],others:t.slice(0,i).concat(t.slice(i+1))};return{current:t[0],others:t.slice(1)}},_setCurrentOrganizationId:function(t){window.location.href=this.params.contextSwitchUrl+"&org_id="+t},getDefaultParams:function(){return $.extend(this.__base.apply(this,arguments),{organizationsDataProvider:"user2__organizations-provider"})}}),BEM.decl({block:"user2__organizations-provider",baseBlock:"i-request_type_ajax"},{getDefaultParams:function(){return $.extend(this.__base.apply(this,arguments),{url:this._params.organizationsUrl,timeout:5e3,dataType:"json",xhrFields:{withCredentials:!0},cache:!1})}}),BEM.DOM.decl("b-page",{onSetMod:{js:function(){this.__base.apply(this,arguments),BEM.channel("common").on("b-page.accessRequest",this._getPageAccess,this),BEM.WISTORE.get("app").on("change:sidebar",this._onSidebarStateChange,this);var t=BEM.WISTORE.get("page");t&&t.on("change:isReadonly",this._updateCanEditState,this),t&&t.on("change:authors",this._updateCanEditState,this),t&&t.on("change:canEdit",this._onCanEditStateChange,this),this.params.hasOldForm&&Ya&&Ya.Rum&&Ya.Rum.logError&&Ya.Rum.logError({message:"old_form_page",level:"info",additional:{supertag:t&&t.get("superTag")}})}},_onSidebarStateChange:function(t,e){this.setMod("sidebar",e)},_updateCanEditState:function(){var t=BEM.WISTORE.get("page"),e=t.get("currentUser");t.set("canEdit",!t.get("isReadonly")||Boolean(t.get("authors").find(function(t){return t.login=e.login})))},_onCanEditStateChange:function(t,e){this.setMod("readonly",!e)},_getPageAccess:function(t,e){this._accessWidgetPopup?this._accessWidgetPopup.show():this._accessWidgetPopup=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply({block:"b-widget",mods:{type:"request-access"},js:{data:e.params}})).bem("b-widget")},_onNotifierClose:function(){this.delMod("notifier")},highLightCode:function(){$("code").each(function(t,e){hljs.highlightBlock(e)})}}),BEM.DOM.decl("b-page",{onSetMod:{js:function(){BEM.channel("common").on("b-page.accessRequest",this._getPageAccess,this),BEM.WISTORE.get("app").on("change:sidebar",this._onSidebarStateChange,this),$(document).on("mouseenter","[data-staff]",function(t){var e=$(t.currentTarget);if(!e.data("staffInited")){var i=e.data("staff");new StaffLiteCard({elem:e,login:i}).show(),e.data("staffInited",!0)}})}}}),BEM.DOM.decl({block:"b-page",modName:"type",modVal:"article"},{onSetMod:{js:function(){if(BEM.blocks["i-routes"].getRoute("article"),this.__base.apply(this,arguments),this.channel("content").on("update",this._updateContent,this),this.channel("comments").on("updated",this.highLightCode),this.channel("common").on("reset-hash",function(){this._resetHashTimeout&&(clearTimeout(this._resetHashTimeout),this._resetHashTimeout=null),this._resetHashTimeout=setTimeout(this._resetHash.bind(this),300)},this),this.highLightCode(),this.afterCurrentEvent(function(){BEM.blocks["i-explainer"].explainAllLinks(this)},this),("ontouchstart"in window||window.navigator.msPointerEnabled)&&this.setMod("browser","touch"),BEM.WISTORE.get("page").on("change:comments",this._onCommentsStatusChange,this),this.bindToDoc("scroll.bar",this._updateGridsPanels.bind(this)),this.bindToWin("resize.bar",this._updateGridsPanels.bind(this)),this.params.notifier&&this.params.notifier.id){var t=this.params.notifier;BEM.DOM.prepend(this.domElem,BEMHTML.apply({block:"w-notifier",mods:{hidden:"yes"},data:{url:t.url,message:t.message,id:t.id}})).bem("w-notifier").on("close",this._onNotifierClose,this)}this._getWfInstance(),Ya&&Ya.Rum&&[[2095,"wiki-js"],[2104,"jquery"],[3071,"formatter"]].forEach(function(t){Ya.Rum.sendResTiming(t[0],$("script[data-src-id='"+t[1]+"']").attr("src"))}),BEM.channel("anchor").on("go",this._onGoAnchorEvent,this)}},destruct:function(){this.__base.apply(this,arguments),BEM.channel("anchor").un("go",this._onGoAnchorEvent,this)},getToc(){return this._getWfInstance().getToc()},getContentHTML(){return $(BEM.WISTORE.get("page").get("withNewWf")?this._getWfInstance().getHTMLFromText(BEM.WISTORE.get("page").get("raw")):this._getContent()[0].outerHTML)},_onGoAnchorEvent:function(t,e){Ya.FormatterViewPort.BEM.channel("anchor").trigger("go",e)},_getContent(){return this._content||(this._content=this.findBlockInside("w-content").domElem),this._content},_getWfInstance:function(){return this._formatterViewPort||(this._formatterViewPort=new Ya.FormatterViewPort({domElem:this._getContent()[0]})),this._formatterViewPort},_getGrids:function(){if(this._grids)return this._grids;var t=this.findBlockInside("w-content"),e=t.findBlocksInside("b-grid-table");return t.findBlocksInside("wiki-widget-action").every(function(t){return t.hasMod("loaded")})&&(this._grids=e),e},_updateGridsPanels:function(){this._getGrids().forEach(function(t){var e=this._inViewport(t.domElem);t.setMod("panels",e?"yes":""),e&&t.updatePanelsPosition()},this)},_onCommentsStatusChange:function(){var t=BEM.WISTORE.get("page").get("comments");this._comments||(this._comments=this.findBlockInside("w-comments")),this._comments.setMod("enabled",t?"yes":"")},_resetHash:function(){var t=location.hash;t&&(location.hash="#fakehash",location.hash=t),this._resetHashTimeout=null},_updateContent:function(t,e){if(BEM.WISTORE.get("page").get("withNewWf"))void 0!==e.data.body?(this._getWfInstance().render(e.data.body),BEM.DOM.init(this._getContent())):e.data.html&&(this._getWfInstance().render(""),BEM.DOM.update(this._getContent(),e.data.html.replace(/\S*_js_inited/g,"")),Ya.FormatterViewPort.BEM.DOM.init(this._getContent())),this._grids=null;else{var i,n=this.findBlockInside("w-content");e.data.bemjson?(e.data.bemjson.mods={status:"main"},i=BEMHTML.apply(e.data.bemjson)):e.data.html&&(i=e.data.html.replace(/\S*_js_inited/g,"")),n&&(BEM.DOM.update(n.domElem,i),this.highLightCode(),this._grids=null)}this._updateTitle(e.data.title)},_updateTitle:function(t){var e=this.findBlockInside("b-page-title");e&&e.domElem.text(t)},_inViewport:function(t){var e=t.offset().top,i=e+t.outerHeight(),n=BEM.DOM.win.scrollTop(),s=n+BEM.DOM.win.height();return i>n&&e<s}}),BEM.DOM.decl({block:"button2",modName:"has-control",modVal:"yes"},{onSetMod:{checked:{yes:function(){this.__base.apply(this,arguments),this.elem("control").prop("checked",!0).attr("aria-checked","true")},"":function(){this.__base.apply(this,arguments),this.elem("control").prop("checked",!1).removeAttr("aria-checked").removeAttr("checked")}}},getVal:function(){return this.elem("control").val()},setVal:function(t){return this.elem("control").val(t),this},_processClick:function(t){this.__base.apply(this,arguments),this.hasMod("type","radio")&&this.setMod("checked","yes"),this.hasMod("type","check")&&this.toggleMod("checked","yes")},getDefaultParams:function(){return $.extend(this.__base(),{prvntKeys:["SPACE"],clickKeys:["SPACE"]})}}),BEM.decl("mi-notifier",{onSetMod:{js:function(){BEM.blocks["m-notification"].on("remove",this._onNotificationRemoved,this),this._initParams()}},destruct:function(t){BEM.blocks["m-notification"].un("remove",this._onNotificationRemoved,this),this.__base(t)},log:function(t,e,i){var n=$.extend({},this._notificationsOptions[t],i);this._push({block:"m-notification",js:{delay:n.delay},mods:{theme:t,icons:n.icons?"yes":"",autoclosable:n.autoclosable?"yes":"",clear:n.clear?"yes":""},content:e})},info:function(t,e){this.log("info",t,e)},error:function(t,e){this.log("error",t,e)},success:function(t,e){this.log("success",t,e)},warn:function(t,e){this.log("warning",t,e)},_initParams:function(){this._notificationsOptions=this._getOptions(),this.setMod("position",this.params.position||"right-top"),this._margin=this.params.margin||10,this._offset=$.extend({left:0,top:0},this.params.offset)},_push:function(t){var e,i,n=5;for(e=BEM.DOM.append(BEM.DOM.scope,BEMHTML.apply(t)),i=$(e).bem("m-notification"),this._notifications||(this._notifications=[]),this._notifications.unshift(i),this._notifications.forEach(function(t,e){this._setNotificationPosition(t,n),n+=t.domElem?t.domElem.outerHeight()+(e===this._notifications.length-1?0:this._margin):0},this),i.setMod("activated","yes");BEM.DOM.doc.outerHeight()<n&&this._notifications.length;)n-=this._removeNotification(this._notifications.length-1)},_removeNotification:function(t){var e=this._notifications[t].domElem,i=e?e.outerHeight()+10:0;return e&&BEM.DOM.destruct(this._notifications[t].domElem),this._notifications.splice(t,1),t!==this._notifications.length&&this._recalculatePositions(),i},_onNotificationRemoved:function(t){this._notifications.forEach(function(e,i){e===t.block&&this._removeNotification(i)},this)},_getOptions:function(){var t=$.extend({info:{},success:{},error:{},warning:{}},this.__self._defaultOptions,this.params.options);return Object.keys(t).forEach(function(e){t[e]=$.extend({icons:this.params.icons,autoclosable:this.params.autoclosable,clear:this.params.clear,delay:this.params.delay},t[e])},this),t}},{_VERT_OFFSET:5,_defaultOptions:{success:{delay:2e3}}}),BEM.decl("mi-notifier",{log:function(t,e){var i=this._notificationsOptions[t];this._push({block:"m-notification",js:{delay:i.delay},mods:{theme:t,icons:i.icons?"yes":"",autoclosable:i.autoclosable?"yes":"",clear:i.clear?"yes":""},content:{html:e}})}}),BEM.decl({block:"mi-notifier",modName:"position",modVal:"left-top"},{_setNotificationPosition:function(t,e){t.domElem.css("left",this.__self._VERT_OFFSET+this._offset.left+"px"),t.domElem.css("top",e+this._offset.top+"px")},_recalculatePositions:function(){var t=this.__self._VERT_OFFSET;this._notifications.forEach(function(e){e.domElem.css("top",t+this._offset.top+"px"),t+=e.domElem.outerHeight()+this._margin},this)}}),BEM.decl({block:"mi-notifier",modName:"position",modVal:"right-bottom"},{_setNotificationPosition:function(t,e){t.domElem.css("right",this.__self._VERT_OFFSET-this._offset.left+"px"),t.domElem.css("bottom",e-this._offset.top+"px")},_recalculatePositions:function(){var t=this.__self._VERT_OFFSET;this._notifications.forEach(function(e){e.domElem.css("bottom",t-this._offset.top+"px"),t+=e.domElem.outerHeight()+this._margin},this)}}),BEM.decl({block:"mi-notifier",modName:"position",modVal:"right-top"},{_setNotificationPosition:function(t,e){t.domElem.css("right",this.__self._VERT_OFFSET-this._offset.left+"px"),t.domElem.css("top",e+this._offset.top+"px")},_recalculatePositions:function(){var t=this.__self._VERT_OFFSET;this._notifications.forEach(function(e){e.domElem.css("top",t+this._offset.top+"px"),t+=e.domElem.outerHeight()+this._margin},this)}}),BEM.DOM.decl("m-editor",{_historyStack:[],init:function(t){var e=this,i=this.params.buttons||[];this._pageEditorButtons=t||this.findBlockOn("m-editor-buttons"),this._textarea=this.elem("textarea","editor","wiki").bem("textarea"),this._hotKeysScope=this._uniqId,this._prevHotKeysScope=null,this._textarea.elem("control").on("focus",function(){e._prevHotKeysScope=window.keymaster.getScope(),window.keymaster.setScope(e._hotKeysScope)}),this._textarea.elem("control").on("blur",function(){window.keymaster.setScope(e._prevHotKeysScope),e._prevHotKeysScope=null}),this.params.drafts?this._initDrafts(i):(this._drawAndRecalculateButtons(i),this._initControl()),this._subscribeChange()},setDataToEditor:function(t){this.setText(t)},setText:function(t){this._unsubscribeChange(),this._textarea.elem("control").val(t),this._textarea.onFirst("change",function(){this.afterCurrentEvent(this._subscribeChange)},this)},getEditorData:function(){return this.val()},val:function(t){var e=this._textarea.elem("control").val();return void 0===t?e:(this._textarea.elem("control").val(t),e!==t&&this.trigger("change",t),t)},restore:function(){this._draftToRestore&&(this.setText(this._draftToRestore),this._draftToRestore=null)},revert:function(){this._updateDraftTimeoutId&&(clearTimeout(this._updateDraftTimeoutId),this._updateDraftTimeoutId=null),this._drafts&&this._draftsStorage.store(this._drafts)},_initDrafts:function(t){this._draftsCountToSave=this.params.drafts.maxCount||10,this._draftsStorage=BEM.create("mi-editor-drafts",this.params.drafts),this._draftsStorage.get().then(function(e){this._drafts=e,e.length&&t.push([{type:"drafts",data:{drafts:e}}]),this._drawAndRecalculateButtons(t),this._initControl(),this._processDrafts(e)}.bind(this))},_processDrafts:function(t){this._drafts=t,t.length&&t[0]&&!1===t[0].isSaved&&(this._draftToRestore=t[0].val,delete t[0].isSaved,this.afterCurrentEvent(function(){this.trigger("draft-restore",t[0])}))},_subscribeChange:function(){this._textarea.on("change",this._onTextChange,this)},_unsubscribeChange:function(){this._textarea.un("change",this._onTextChange,this)},_onTextChange:function(){this._drafts&&this._processChangeForDrafts(),this.afterCurrentEvent(function(){this.trigger("change",this.val())})},_processChangeForDrafts:function(){this._updateDraftTimeoutId?(clearTimeout(this._updateDraftTimeoutId),this._updateDraftTimeoutId=null):this._updateCurrentDraft(),this._updateDraftTimeoutId=setTimeout(this._updateCurrentDraft.bind(this),1e3)},_updateCurrentDraft:function(){var t={val:this.val(),date:Date.now(),isSaved:!1};""===t.val?this._draftsStorage.store(this._drafts):this._draftsStorage.store([t].concat(this._drafts.slice(0,this._draftsCountToSave-1))),this.afterCurrentEvent(function(){this.trigger("draft-store")})},_drawButtons:function(t){this._buttonsContent=[],this.params.virtualButtons&&t.push(this.params.virtualButtons.map(function(t){return{type:t,virtual:!0}})),t.forEach(function(t){this._buttonsContent.push(this._getButtonsBemjson(t))},this),this._buttonsContent.length&&BEM.DOM.update(this._pageEditorButtons.domElem,BEMHTML.apply(this._buttonsContent))},_drawAndRecalculateButtons:function(t){var e,i,n,s,o=[],r=[],a=0,c=this.__self.PRIORITY_ARRAY.slice();if(this._drawButtons(t),e=this.domElem.outerWidth(),BEM.blocks["mi-helpers"].isVisible(this.domElem.get(0))&&(this._pageEditorButtons.domElem.children().each(function(t,e){var i=$(e);a+=i.outerWidth()+10,o.push(i.outerWidth())}),a>e&&c.length)){for(e-=this.__self.EDITOR_PADDING,i=a;i>e&&c.length;)n=c.shift(),(s=this._findButtonInGroups(n,t))&&(r.unshift(n),t[s.groupIndex].splice(s.buttonIndex,1),t[s.groupIndex].length||(t.splice(s.groupIndex,1),e+=10),i-=$($(this._pageEditorButtons.domElem.children()[s.groupIndex]).children()[s.buttonIndex]).outerWidth());t.length?t[t.length-1].push({type:"other",data:r}):t.push([{type:"other",data:r}]),this._drawButtons(t)}},_initControl:function(){this._textarea.elem("control").snickedWackowiki(),this._textarea.elem("control").splendid({buttons:this._pageEditorButtons.findBlocksInside("button2"),editor:this,uploadReqParams:this.params.uploadParams&&this.params.uploadParams.reqParams,uploadURLPath:this.params.uploadParams&&this.params.uploadParams.URLPath,forms:this.params.forms,hotKeysScope:this._hotKeysScope})},_findButtonInGroups:function(t,e){var i=!1;return e.forEach(function(e,n){e.forEach(function(e,s){t!==e||e.virtual||(i={groupIndex:n,buttonIndex:s})})}),i},_getButtonsBemjson:function(t){var e=[];return t.forEach(function(i,n,s){var o,r,a;a="object"==typeof i,r=!1,o="brick-brick",s.length>1?0===n?o="round-brick":n===t.length-1&&(o="brick-round"):o="round-round",a&&i.virtual&&(r=!0),e.push({block:"m-editor-button",mods:{type:a?i.type:i,virtual:r&&"yes"},pin:o,data:i.data,helpURL:this.params.helpURL||this.__self.WIKI_MARKING_TUTORIAL_URL})},this),{block:"m-editor-buttons",elem:"group",content:e}}},{EDITOR_PADDING:60,PRIORITY_ARRAY:["separator","color","underline","indent","outdent","ul","ol","table","quote","h3","h2","italic","strikethrough","bold","spell","picture","user","file","video"],WIKI_MARKING_TUTORIAL_URL:"https://wiki.yandex-team.ru/wiki/vodstvo/syntax/"}),BEM.DOM.decl({block:"m-popup",modName:"form",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._addButton=this.findBlockInside({block:"button2",modName:"action",modVal:"add"}),this._cancelButton=this.findBlockInside({block:"button2",modName:"action",modVal:"cancel"}),this._onAdd(),this._onCancel()}},_onAdd:function(){this._addButton.on("click",function(){var t;"yes"!==this.getMod("drafts")?(t=this.findBlockInside("m-editor-popup").getText(),this._popup.trigger("onadd",t)):this._popup.delMod("visible")},this)},_onCancel:function(){this._cancelButton.on("click",function(){"yes"===this.getMod("drafts")&&this._popup.trigger("update-text",this.findBlockInside("m-editor-popup").params.text),this._popup.delMod("visible")},this)}}),BEM.DOM.decl({block:"m-editor-popup",modName:"type",modVal:"link"},{processParams:function(t){var e,i="";return(i=(e=$.extend({},{pathToLink:"",linkText:""},t)).pathToLink&&e.linkText?e.pathToLink+" "+e.linkText:e.pathToLink+e.linkText)&&(i="(("+i+"))"),i}}),BEM.DOM.decl({block:"button2",modName:"type",modVal:"check"},{_onClick:function(){this.__base.apply(this,arguments),this.toggleMod("checked","yes")}}),BEM.DOM.decl({block:"m-editor-popup",modName:"type",modVal:"user"},{processParams:function(t){var e=t.text||"";return e?t.link?"(("+t.prefix+e+" "+t.link+"))":t.prefix+e:""}}),BEM.DOM.decl("w-page-main-info",{_showAuthorsWidget:function(){this.afterCurrentEvent(function(){BEM.channel("common").trigger("w-action.create-settings",{tab:"authors"})})},_updateModifiedInfo:function(){var t=BEM.WISTORE.get("page");BEM.DOM.replace(this.findElem("modified"),BEMHTML.apply({block:"w-page-main-info",elem:"modified",isOld:t.get("isOld"),modifiedAt:t.get("modifiedAt")}))},_updateAuthorInfo:function(){var t=BEM.WISTORE.get("page");BEM.DOM.replace(this.findElem("left"),BEMHTML.apply({block:"w-page-main-info",elem:"left",authors:t.get("authors"),isOfficial:t.get("isOfficial")})),BEM.DOM.replace(this.findElem("first-author-link"),BEMHTML.apply({block:"w-page-main-info",elem:"first-author-link",authors:t.get("authors"),isOfficial:t.get("isOfficial")}))}},{live:function(){this.liveInitOnStoreEvent("page","change:isOld",function(){this._updateModifiedInfo()}),this.liveInitOnStoreEvent("page","change:authors",function(){this._updateAuthorInfo()}),this.liveBindTo("open-authors","click",function(){this._showAuthorsWidget()})}}),BEM.DOM.decl("w-mixed-tooltip",{destruct:function(){this._tooltip&&this._tooltip.destruct(),this.__base.apply(this,arguments)},getTooltip:function(){return this._tooltip||(this._tooltip=BEM.DOM.append(this.domElem,BEMHTML.apply(this.params.tooltip)).bem("tooltip").setOwner(this.domElem)),this._tooltip},_hide:function(){this.getTooltip().delMod("shown")},_show:function(){($(window).width()<=this.params.screenWidthToShow||"opened"===BEM.WISTORE.get("app").get("sidebar")&&$(window).width()-this.__self._sidebarWidth<=this.params.screenWidthToShow)&&this.getTooltip().setMod("shown","yes")}},{live:function(){this.liveBindTo("click",function(){this._hide()}),this.liveBindTo("mouseover",function(){this._show()}),this.liveBindTo("mouseout",function(){this._hide()})},_sidebarWidth:280}),BEM.DOM.decl("w-fav-button",{onSetMod:{progress:{yes:function(){this._getButton().setMod("disabled","yes")},"":function(){this._getButton().delMod("disabled")}}},_getButton:function(){return this._button||(this._button=this.findBlockOn("button2")),this._button},_addToFavs:function(){var t=window.location.href;this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".favorites/bookmarks",method:"PUT",data:{folder_name:"__INBOX__",title:BEM.WISTORE.get("page").get("title"),url:t},path:"",urlParams:!1}).run().then(this._onSuccess.bind(this,!0),this._onError.bind(this))},_removeFromFavs:function(){this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:".favorites/bookmarks",path:"",method:"POST",data:{supertag:BEM.WISTORE.get("page").get("superTag")},urlParams:!1}).run().then(this._onSuccess.bind(this,!1),this._onError.bind(this))},_onSuccess:function(t){this.delMod("progress"),BEM.WISTORE.get("page").set("isFav",t)},_onError:function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this.domElem,null,t)),this.delMod("progress")}},{live:function(){this.liveBindTo("click",function(){this.hasMod("fav","yes")?this._removeFromFavs():this._addToFavs()})}}),BEM.DOM.decl("w-subscribe-button",{onSetMod:{js:{inited:function(){var t=this.findBlockOn({block:"dropdown2",modName:"role",modVal:"subscribe"});this._tooltip=this.findBlockOn("w-mixed-tooltip").getTooltip(),this._button=t.getSwitcher(),this._popup=t.getPopup(),this._menu=this._popup.findBlockInside("menu"),this._menu.on("click",this._onItemClick,this),this._menu.on("change",this._onChange,this)}},type:function(t,e){var i=BEM.I18N("w-subscribe-button","button_type_"+e);BEM.DOM.update(this._button.elem("text"),i),BEM.DOM.update(this._tooltip.elem("content"),i)},progress:{yes:function(){this._button.setMod("disabled","yes")},"":function(){this._button.delMod("disabled")}}},_onItemClick:function(){this._popup.delMod("visible")},_onChange:function(t,e){this.setMod("progress","yes");var i=!1,n=this.__self._types[e.currVal];"watch"===n&&(i={unwatch_children:!0}),BEM.create("wi-api-request",{apiPath:"."+n,method:"POST",data:i,urlParams:!1,path:BEM.blocks["wi-history"].getCorrectPath()}).run().then(this._onSuccess.bind(this,e.currVal),this._onError.bind(this))},_onSuccess:function(t){this.delMod("progress"),BEM.WISTORE.get("page").set("userSubscription",t)},_onError:function(t){this.delMod("progress"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this.domElem,null,t))}},{live:function(){this.liveBindTo("click",function(){})},_types:{page:"watch",cluster:"masswatch",none:"massunwatch"}}),BEM.decl({name:"input__dataprovider",baseBlock:"i-request_type_ajax"},{get:function(t,e){return this.__base({part:t},function(t){e.call(this,{items:t[1],metainfo:t[2]})})}}),BEM.DOM.decl({block:"b-autocomplete-item",modName:"type",modVal:"nav"},{onSetMod:{js:{inited:function(){this.setMod("nav","yes")}}},enter:function(){return this.__base.apply(this,arguments)},select:function(){return this.__base.apply(this,arguments)}}),BEM.DOM.decl({block:"b-page",modName:"type",modVal:"grid"},{onSetMod:{js:function(){if(BEM.blocks["i-routes"].getRoute("grid"),this.__base.apply(this,arguments),this.highLightCode(),("ontouchstart"in window||window.navigator.msPointerEnabled)&&this.setMod("browser","touch"),this.channel("content").on("update",this._updateContent,this),BEM.WISTORE.get("page").on("change:comments",this._onCommentsStatusChange,this),this.params.notifier&&this.params.notifier.id){var t=this.params.notifier;BEM.DOM.prepend(this.domElem,BEMHTML.apply({block:"w-notifier",mods:{hidden:"yes"},data:{url:t.url,message:t.message,id:t.id}})).bem("w-notifier").on("close",this._onNotifierClose,this)}}},_onCommentsStatusChange:function(){var t=BEM.WISTORE.get("page").get("comments");this._comments||(this._comments=this.findBlockInside("w-comments")),this._comments.setMod("enabled",t?"yes":"")},_updateContent:function(t,e){var i=this.findBlockInside("b-grid-table"),n=this.findBlockInside("b-page-title");i&&i.rebuild(e.data),n&&n.domElem.text(e.data.structure.title)}}),BEM.DOM.decl({name:"b-form-input",modName:"autofocus",modVal:"yes"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this.bindToDoc("keydown",this._autoFocusBind)}},autofocus:{yes:function(){this.bindToDoc("keydown",this._autoFocusBind)},"":function(){this.unbindFromDoc("keydown")}}},_autoFocusBind:function(t){if(!this.hasMod("focused","yes")){var e;try{e=document.activeElement.tagName.toLowerCase()}catch(t){}if(function(t){var e=t.charCode||t.keyCode||t.which||0;if(!t.ctrlKey&&!t.altKey&&!t.metaKey&&(e>=48&&e<=57||e>=96&&e<=105||e>=65&&e<=90||e>=1025&&e<=1071||0===e))return!0}(t)&&"input"!==e&&"textarea"!==e){var i=this.elem("input")[0],n=this.val();if(n.length>0&&" "!==n.substr(n.length-1,1)&&(n+=" ",this.val(n)),i.createTextRange){var s=i.createTextRange();s.collapse(!1),s.select()}else void 0!==i.selectionStart&&i.setSelectionRange(n.length,n.length);this.setMod("focused","yes")}}}}),BEM.DOM.decl({block:"b-page",modName:"type",modVal:"error"},{onSetMod:{js:function(){this.bPage=this.findBlockOutside("b-page"),BEM.blocks["i-routes"].getRoute("error"),this.errorBlock=this.findBlockInside("b-error-page"),this.errorCode=this.errorBlock.params.code,this["_error"+this.errorCode]&&this["_error"+this.errorCode]()}},_error404:function(){var t=this.bPage.findBlockInside({block:"button2",modName:"error",modVal:"new-page"}),e=this.bPage.findBlockInside("b-head");t.on("click",function(){e.openCreatePageWidget()})},_error403:function(){this.button=this.bPage.findBlockInside("b-wiki-form").findBlockInside("button2"),this.link=this.bPage.findBlockInside({block:"link",modName:"open",modVal:"form"}),this.link&&this.link.on("click",this._on403LinkClick,this),this.button.on("click",this._on403FormClick,this)},_on403LinkClick:function(){this.bPage.findBlockInside("b-wiki-form").toggleMod("show","yes","no"),this.link.destruct()},_on403FormClick:function(){var t=this.bPage.findBlockInside("b-wiki-form").findBlockInside("input").val(),e=BEM.blocks["wi-history"].getPath();BEM.create("wi-api-request",{apiPath:".requestaccess",method:"PUT",data:{reason:t},urlParams:!1,path:"/"===e?"/homepage":e}).run().then(this._on403FormSubmit.bind(this),this._on403FormSubmitError.bind(this))},_on403FormSubmit:function(){var t=BEM.I18N("b-page","access_request_sended");this._owner&&this._owner.is_dismissed&&(t=BEM.I18N("b-page","access_request_sended_to_support")),this.bPage.findBlockInside("b-page").elem("text").text(t)},_on403FormSubmitError:function(t){var e=BEM.I18N("b-page","error_occurred"),i=BEM.blocks["wi-notification"].createErrorMessage(t);this.findElem("error").length&&this.findElem("error").remove();var n={block:"b-page",elem:"error",content:e+" "+i};BEM.DOM.before(this.bPage.findBlockInside("b-wiki-form").domElem,BEMHTML.apply(n))}}),BEM.DOM.decl({block:"scroll",modName:"tech",modVal:"js"},{onSetMod:{js:{inited:function(){this._setAllElems(),this._setSizes(),this._bindToContentChange(),this._bindToScroll(),this._correctSelectedScrollPosition(),this.bindToWin("resize",this._setSizes),this.cursorLossTimerPull={horizontal:[],vertical:[]},this.sizes={content:{}}}}},getDefaultParams:function(){return{minThumbSize:30,cursorLossTimer:1e3,stick:{step:400,timer:200,delay:200}}},getContentElem:function(){return this.elems.content},cursorLossTimerPull:null,stickScrollMouseup:!1,_setLossTimer:function(t,e){this.cursorLossTimerPull[t].push(e)},_clearAllLossTimers:function(t){this.cursorLossTimerPull[t]=this.cursorLossTimerPull[t].filter(function(t){return clearTimeout(t),!1})},_setSizes:function(){this.dim=this._getDimensions(),this._setCorrectSize(),this._setTracksSize(),this._setThumbsSize(),this._setThumbsPositions()},_setNewSizes:function(){(this._isContentSizeChanged()||this._isThumbsSizeChanged())&&this._setSizes()},_isContentSizeChanged:function(){var t=this.elems.content,e=this.sizes.content,i=t.width(),n=t.height();return e.width&&e.height?!(e.width===i&&e.height===n)&&(e.width=i,e.height=n,!0):(e.width=i,e.height=n,!1)},_isThumbsSizeChanged:function(){var t=this.dim.content,e=this.elems.nativeElem[0],i=this.dim.scroll.horizontal,n=this.dim.scroll.vertical;return n.thumbHeight!==this._calcThumbSize("vertical",t.visibleHeight,n.height,e.scrollHeight)||i.thumbWidth!==this._calcThumbSize("horizontal",t.visibleWidth,i.width,e.scrollWidth)},_bindToContentChange:function(){var t=this._setNewSizes.bind(this),e=this.channel("sys").on({tick:t,idle:function(){e.un("tick",t)},wakeup:function(){e.on("tick",t)}})},_getDimensions:function(){return{content:{visibleWidth:this.domElem.width(),visibleHeight:this.domElem.height()},scroll:{horizontal:{},vertical:{}}}},_setAllElems:function(){this.elems={nativeElem:this._getElem("native"),content:this._getElem("content"),track:{horizontal:this._getElem("track","orientation","horizontal"),vertical:this._getElem("track","orientation","vertical")},thumb:{horizontal:this._getElem("thumb","orientation","horizontal"),vertical:this._getElem("thumb","orientation","vertical")}}},_getElem:function(t,e,i){var n=this.buildSelector(),s=this.domElem;return this.elem(t,e,i).filter(function(){return s.index($(this).closest(n))>-1})},_setTracksSize:function(){var t=this.dim.scroll,e=this.elems.track;t.horizontal.width=e.horizontal.width(),t.vertical.height=e.vertical.height()},_getCorrect:function(){var t=this.elems.nativeElem;return{right:t.width()-t[0].clientWidth,bottom:t.height()-t[0].clientHeight+parseInt(t.css("padding-bottom"),10)}},_setCorrectSize:function(){var t=this.elems.nativeElem,e=this._getCorrect();t.css({"margin-right":-e.right,"margin-bottom":-e.bottom}),this.getMod("elastic-height","yes")&&"yes"!==this.getMod("page")||t.css("padding-bottom",e.bottom),this.elems.content.css("width","").css("width",t[0].scrollWidth)},_setThumbsSize:function(){var t=this.dim.scroll.horizontal,e=this.dim.scroll.vertical,i=this.dim.content,n=this.elems.nativeElem[0],s={orientation:"horizontal",property:"width",realVisibleSizeName:"realVisibleWidth",thumbSize:t.thumbWidth,visibleSize:i.visibleWidth,scrollSize:t.width,contentSize:n.scrollWidth,realVisibleSize:i.realVisibleWidth},o={orientation:"vertical",property:"height",realVisibleSizeName:"realVisibleHeight",thumbSize:e.thumbHeight,visibleSize:i.visibleHeight,scrollSize:e.height,contentSize:n.scrollHeight,realVisibleSize:i.realVisibleHeight};t.thumbWidth=this._setThumbSize(s,i),e.thumbHeight=this._setThumbSize(o,i),0===e.thumbHeight&&this._setThumbSize(s,i),0!==t.thumbWidth&&0!==e.thumbHeight&&this._delSingleMod()},_setThumbSize:function(t,e){var i=this._calcThumbSize(t.orientation,t.visibleSize,t.scrollSize,t.contentSize);return 0===i&&this._setSingleMod("horizontal"===t.orientation?"vertical":"horizontal"),this.elems.thumb[t.orientation].css(t.property,i),e[t.realVisibleSizeName]=this._calcRealVisibleContentSize(t.contentSize,i,t.scrollSize),i},_calcThumbSize:function(t,e,i,n){var s=e*i/n,o=this.params.minThumbSize;return s>=i?0:(this.dim.scroll[t].realThumbSize=s,s>0&&s<o?o:s)},_calcRealVisibleContentSize:function(t,e,i){return t*e/i},_setSingleMod:function(t){this.setMod("single",t),this._setTracksSize()},_delSingleMod:function(){this.delMod("single"),this._setTracksSize()},_bindToScroll:function(){return this.bindTo("native","scroll",$.throttle(this._setThumbsPositions,30)),this},_correctSelectedScrollPosition:function(){this.bindToDoc("mouseup",function(){var t=this.domElem;(t.scrollTop()>0||t.scrollLeft()>0)&&t.animate({scrollTop:0,scrollLeft:0},50)})},_unbindFromScroll:function(){return this.unbindFrom("native","scroll"),this},_setThumbsPositions:function(){var t=this.elems.nativeElem,e=this.dim.scroll;this.elems.thumb.horizontal.css({left:this._calcThumbPosition(t.scrollLeft(),e.horizontal.width,t[0].scrollWidth,e.horizontal.thumbWidth,e.horizontal.realThumbSize)}),this.elems.thumb.vertical.css({top:this._calcThumbPosition(t.scrollTop(),e.vertical.height,t[0].scrollHeight,e.vertical.thumbHeight,e.vertical.realThumbSize)})},_calcThumbPosition:function(t,e,i,n,s){return this._calcCorrectThumbPosition(t*e/i,e,n,s)},_calcCorrectThumbPosition:function(t,e,i,n){return t*(e-i)/(e-n)},_calcScrollPosition:function(t,e,i,n,s){return this._calcCorrectScrollPosition(t*e/i,t,n,s)},_calcCorrectScrollPosition:function(t,e,i,n){return t*(e-i)/(e-n)},_setThumbPosition:function(t,e){var i=e.scroll,n=e.position,s=e.content,o=this.elems.nativeElem[0],r="horizontal"===t?{scrollSize:i.horizontal.width,thumbSize:i.horizontal.thumbWidth,thumbPos:n.thumb.left,contentSize:o.scrollWidth,visibleSize:s.visibleWidth,realVisibleSize:s.realVisibleWidth,clientPos:e.e.clientX,posStart:n.start.x,thumb:e.thumb,side:"left",scrollMethod:"scrollLeft"}:{scrollSize:i.vertical.height,thumbSize:i.vertical.thumbHeight,thumbPos:n.thumb.top,contentSize:o.scrollHeight,visibleSize:s.visibleHeight,realVisibleSize:s.realVisibleHeight,clientPos:e.e.clientY,posStart:n.start.y,thumb:e.thumb,side:"top",scrollMethod:"scrollTop"},a=Math.min(Math.max(r.thumbPos+r.clientPos-r.posStart,0),r.scrollSize-r.thumbSize);r.thumb.css(r.side,a),this.elems.nativeElem[r.scrollMethod](this._calcScrollPosition(r.contentSize,a,r.scrollSize,r.visibleSize,r.realVisibleSize))},_getTrackOfThumb:function(t,e){return this.elems.track[e||this._getTargetOrientation(t)]},_getTargetOrientation:function(t){return this.getMod($(t.target),"orientation")},_getTargetScrollPosition:function(t,e,i,n){return(t-e)*i/n},_getOneStepScrollPosition:function(t,e){return t+this.params.stick.step*(e>t?1:-1)},_getStickAnimateDuration:function(t,e){return Math.abs(e-t)/this.params.stick.step*this.params.stick.timer},_setStickScrollPosition:function(t,e){"horizontal"===t?this._setScrollPosition({that:e.that,nativeElem:e.nativeElem,property:"scrollLeft",startScrollPosition:e.nativeElem.scrollLeft(),clientPos:e.e.pageX,trackOffset:e.trackOffset.left,contentSize:e.nativeElem[0].scrollWidth,scrollSize:this.dim.scroll.horizontal.width}):this._setScrollPosition({that:e.that,nativeElem:e.nativeElem,property:"scrollTop",startScrollPosition:e.nativeElem.scrollTop(),clientPos:e.e.pageY,trackOffset:e.trackOffset.top,contentSize:e.nativeElem[0].scrollHeight,scrollSize:this.dim.scroll.vertical.height})},_setScrollPosition:function(t){var e=this,i=this._getTargetScrollPosition(t.clientPos,t.trackOffset,t.contentSize,t.scrollSize),n=this.params.stick,s={first:{},full:{}};s.first[t.property]=this._getOneStepScrollPosition(t.startScrollPosition,i),s.full[t.property]=i,t.nativeElem.animate(s.first,n.timer,function(){this.stickScrollMouseup||t.nativeElem.delay(n.delay).animate(s.full,{step:function(){e.stickScrollMouseup&&t.nativeElem.stop()}},t.that._getStickAnimateDuration(t.startScrollPosition,i))})},_onThumbMousedown:function(t){if(1===t.which){var e=$(t.target),i={x:t.clientX,y:t.clientY},n=e.position(),s=this.getMod(e,"orientation"),o=this.dim.scroll,r=this.dim.content,a=!1;this.setMod("dragged","yes")._unbindFromScroll().bindToDoc("mousemove",$.throttle(function(t){a||this._setThumbPosition(s,{e:t,thumb:e,scroll:o,content:r,position:{start:i,thumb:n}})},30)).bindToDoc("mouseup",function(){a=!0,this.delMod("dragged").unbindFromDoc("mousemove")._bindToScroll()}),t.preventDefault(),t.stopPropagation()}},_onTrackMousedown:function(t){if(1===t.which){var e=$(t.target);this.getMod(e,"hovered","yes")&&(this.stickScrollMouseup=!1,this.bindToDoc("mouseup",function(){this.stickScrollMouseup=!0}),this._setStickScrollPosition(this._getTargetOrientation(t),{that:this,nativeElem:this.elems.nativeElem,e:t,trackOffset:e.offset()}),t.preventDefault())}}},{live:function(){return this.liveBindTo("thumb","mouseover",function(t){var e=this._getTargetOrientation(t);this._clearAllLossTimers(e),this.setMod(this._getTrackOfThumb(t,e),"hovered","yes")}).liveBindTo("track thumb","mouseout",function(t){var e=this,i=this._getTargetOrientation(t);this._setLossTimer(i,setTimeout(function(){e.delMod(e._getTrackOfThumb(t,i),"hovered")},this.params.cursorLossTimer))}).liveBindTo("track","mouseover",function(t){this._clearAllLossTimers(this._getTargetOrientation(t))}).liveBindTo("thumb","mousedown",function(t){this._onThumbMousedown(t)}).liveBindTo("track","mousedown",function(t){this._onTrackMousedown(t)}),!1}}),BEM.DOM.decl({block:"scroll",modName:"page",modVal:"yes"},{onSetMod:{js:{inited:function(){this._setSingleMod(),this.__base()}}},_setSingleMod:function(){$("html").css("height","100%"),BEM.DOM.scope.css({height:"100%",padding:0,margin:0,overflow:"hidden"})}}),BEM.DOM.decl({block:"wiki-doc",modName:"magiclinks",modVal:"yes"},{onSetMod:{js:function(){if(this.params["wiki-attrs"].magiclinks_url){var t=this.params["wiki-attrs"].magiclinks_url,e=this._getTld();this._magicLinksApi=e?t.replace(/\{tld\}/g,e):t,BEM.blocks["wiki-cut"].on(this.domElem,"content-loaded",this._renderMagiclinksInCut,this),BEM.blocks["wiki-headcut"].on(this.domElem,"content-loaded",this._renderMagiclinksInCut,this),this._renderMagiclinks(this)}this.__base.apply(this,arguments)}},_getTld:function(t){var e=(t||document.location.hostname).toLowerCase().split("."),i=!1;if(e.length>1){var n=e[e.length-1];isNaN(parseInt(n,10))&&(i=n)}return i},_renderMagiclinks:function(t){BEM.channel("magiclink").trigger("update",{block:t,apiUrl:this._magicLinksApi})},_renderMagiclinksInCut:function(t){this._renderMagiclinks(t.target)}}),BEM.DOM.decl({block:"tabs",modName:"control",modVal:"menu"},{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._tabsMenu=this.findBlockOn("control","tabs-menu")}}},activate:function(t){return this._tabsMenu.setMod(this._tabsMenu.getTab(t),"active","yes"),this},deactivate:function(){return this._tabsMenu.delMod(this._tabsMenu.getActive(),"active","yes"),this},disable:function(t){return this._tabsMenu.setMod(this._tabsMenu.getTab(t),"disabled","yes"),this},enable:function(t){return this._tabsMenu.delMod(this._tabsMenu.getTab(t),"disabled"),this},getActive:function(){return this._tabsMenu.indexOfTab(this._tabsMenu.getActive())},isDisabled:function(t){return this._tabsMenu.hasMod(this._tabsMenu.getTab(t),"disabled","yes")},_onControlChange:function(t,e){e.current.attr("aria-selected",!0),e.prev.attr("aria-selected",!1),this.trigger("change",{currentIndex:e.currentIndex,prevIndex:e.prevIndex})}}),BEM.DOM.decl({name:"m-calendar",modName:"toggler",modVal:"input"},{onSetMod:{js:function(){var t=this;this.input=this.findBlockInside({block:"textinput",modName:"toggler",modVal:"datepicker"}),this.__base.apply(this,arguments),this.input.bindTo("click",t._onTogglerClick.bind(this)),this.input.on("focus",this._onTogglerClick,this),this.input.bindTo(this.input.domElem,"mousedown",function(){t.input.un("focus")})},disabled:function(t,e){this.input.setMod(t,e)}},_onDateChange:function(t,e){var i=BEM.blocks["m-calendar"].dateFormat,n=e.date;e.fromArrow||(n?n.from?this.input.val(i(n.from)+" — "+i(n.to)):this.input.val(i(n)):this.input.val("")),this.__base.apply(this,arguments)},_onTogglerClick:function(){var t=this;this.input._isDatePickerOpened=!0,this.__base.apply(this,arguments),this.bindToDoc("keydown.close",function(e){9===e.which&&(this._datePickerPopup.delMod("visible"),t.unbindFromDoc("keydown.close"))})},_onDatePickerPopupHide:function(){this.__base.apply(this,arguments),this.input.delMod("focused"),this.input.on("focus",this._onTogglerClick,this),this.unbindFromDoc("keydown.close")}}),BEM.DOM.decl({block:"m-calendar",modName:"assigned",modVal:"form"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.required&&this.findBlockOutside("b-wiki-form")._requiredFields.push(this.findBlockInside({block:"input",modName:"toggler",modVal:"datepicker"}))}}}),BEM.DOM.decl({block:"popup",modName:"behaviour",modVal:"scrollable"},{getDefaultParams:function(){var t=this.__base();return t.top=20,t}}),BEM.DOM.decl({name:"b-form-input",modName:"form",modVal:"yes"},{_onSelectItem:function(t,e){var i=t.select(!0),n="object"==typeof i?i.needUpdate:!1!==i,s="object"==typeof i&&i.needEvent;this._preventRequest=!0,n&&this.val(this._userVal=t.val(),{source:"autocomplete",itemIndex:this._curItemIndex}),this.del("_preventRequest"),(n||s)&&this.trigger("select",{item:t,byKeyboard:!0})}}),BEM.DOM.decl("m-head-arrow",{_firstCall:!0,_apiHost:"https://staff.yandex-team.ru/navigation-api/",onSetMod:{js:function(){var t=this;this.popup=this.findBlockInside("popup2").setAnchor(this.domElem),this.bindTo("click",function(e){t._firstCall&&t._collectData(),t.popup.toggleMod("visible","yes","")})}},_collectData:function(){if(this._supportLS()){var t=this._getStorageData();this._compareDate(t.lastCallDate)?(this.popup.setContent(this._buildContent(t)),this._firstCall=!1):this._buildServices()}else this._buildServices()},_buildServices:function(){var t=this;this._getServices().done(function(e){t.popup.setContent(t._buildContent(e)),t._saveLS(e),t._firstCall=!1}).fail(function(e,i){t.popup.setContent(t._buildContent({error:i}))})},_getServices:function(){return $.ajax({url:this.params.host||this._apiHost,timeout:3e3,xhrFields:{withCredentials:!0}})},_buildContent:function(t){var e;return e=t.error?{block:"m-head-services",mods:{type:"list"},content:{elem:"error",content:BEM.I18N("m-head-arrow","error")}}:{block:"m-head-services",mix:[{block:"i-font",mods:{face:"textbook"}}],content:[{elem:"list",elemMods:{type:"main"},content:this._buildList(t.main)},{elem:"list",content:this._buildList(t.secondary)}]},BEMHTML.apply(e)},_buildList:function(t){var e=BEM.I18N.lang(),i=[{elem:"left",content:[]},{elem:"right",content:[]}],n=t.length/2;return t.forEach(function(t,s){var o=n>i[0].content.length?0:1,r={block:"link",mods:{state:t.application_id===this.params.type?"current":void 0,theme:"black"},url:"ru"===e?t.url:t["url_"+e]||t.url,content:[t.icon&&t.icon.length&&{block:"m-head-services",elem:"icon",icon:t.icon},"ru"===e?t.title:t["title_"+e]]};i[o].content.push(r)},this),i},_saveLS:function(t){var e=new Date,i=new Date(e.getFullYear(),e.getMonth(),e.getDate()).valueOf();t.lastCallDate=i,localStorage.setItem("m-head",JSON.stringify(t))},_supportLS:function(){try{return"localStorage"in window&&null!==window.localStorage&&localStorage["m-head"]}catch(t){return!1}},_compareDate:function(t){var e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate()).valueOf()===t},_getStorageData:function(){return JSON.parse(localStorage.getItem("m-head"))}}),BEM.DOM.decl("m-head-arrow",{onSetMod:{js:function(){this.__base.apply(this,arguments),this.unbindFrom("click")}}}),BEM.DOM.decl("m-head-menu",{destruct:function(){return this._morePopup&&this._morePopup.domElem&&BEM.DOM.destruct(this._morePopup.domElem),this.__base.apply(this,arguments)},_onHasSubClick:function(t){var e=this,i=t.data.domElem;this.target=i,this.setMod(i,"is","opened"),this.__self._headMenuPopup||(this.__self._headMenuPopup=this.findBlockOn("popup","popup2").on("beforeClose",function(){e.delMod(e.target,"is")})),this.__self._headMenuPopup.setContent(BEMHTML.apply(i.data("content"))).setAnchor(i).toggleMod("visible","yes")},_onMoreClick:function(t){this._morePopup||(this._morePopup=this.findBlockInside("more","popup2"),this._morePopup.setAnchor(t.data.domElem)),this._morePopup.toggleMod("visible","yes")}},{live:function(){this.liveBindTo({elem:"item",modName:"hassub",modVal:"yes"},"click",function(t){this._onHasSubClick(t)}).liveBindTo("more","click",function(t){this._onMoreClick(t)})}}),BEM.DOM.decl("m-head-search",{onSetMod:{js:function(){var t=this;this.findBlockInside("m-suggest").on("select",function(e){t.domElem.submit()})}}},{}),BEM.DOM.decl("m-head-search",{onSetMod:{js:function(){this.afterCurrentEvent(function(){window.location.hash||this.findBlockInside("textinput").elem("control").focus()},this),this._search=this.elem("search"),this._suggest=this.findBlockInside("m-suggest"),this._actionPathname="wikisearch",this._suggest.on("state-update",function(){Number(_.get(this._suggest,"state.result.meta.features.wiki_to_search"))&&(this._actionPathname="search")},this),this.domElem.on("submit",function(){$(this._search).attr("action","//search.yandex-team.ru/"+this._actionPathname),$(this._search).submit()}.bind(this))}}}),BEM.DOM.decl("notifier",{onSetMod:{js:{inited:function(){this._popup=this.getPopup(),this._popup.attachToScope(),this._spin=this.getSpin(),this.win=window,this._popup.on("beforeOpen beforeClose",function(){var t=this._popup.hasMod("visible","yes");this.toggleMod("opened","yes",!t),t?this._firstOpen=!1:(this.delMod("has-unread"),this._firstOpen=void 0===this._firstOpen||void 0),this._hasLoaded||this._spin.setMod("progress","yes")}.bind(this)),this._fetchCounter()}}},_fetchCounter:function(){$.ajax({url:this._getCounterUrl(),dataType:"json",type:"GET",xhrFields:{withCredentials:!0}}).promise().then(function(t){if(t&&t.records.items.length)return t.records.items.reduce(function(t,e){var i=0;return e.fields.forEach(function(t){"unviewed_count"===t.field_id&&(i=t.value.integer)}),t+i},0)}).then(this.onUpdateCounter.bind(this))},_getCounterUrl:function(){return this.params.counterHandle||this.params.apiHost+"v1/data/app/databases/.ext.notifier@notifications_disk/snapshot?collection_id=meta"},_getIframeUrl:function(t){return this.params.iframeUrl||this.params.baseUrl+"/yandex-notifications/"+this.params.iframeVersion+"/iframe/index."+t+".html"},_getLoaderUrl:function(){return this.params.loaderUrl||this.params.baseUrl+"/iframe-loader/"+this.params.loaderVersion+"/index.min.js"},_insertLoaderScript:function(t){var e=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],i=document.createElement("script");i.setAttribute("src",this._getLoaderUrl()),e.insertBefore(i,e.lastChild),i.onload=t},_loadIframe:function(){var t={iframeUrl:this._getIframeUrl(this.params.lang),container:this.findElem(this._popup.domElem,"content").get(0)};this._atom=new window.LegoIframeLoader(t),this._rpcBridge=this._atom.getRPCBridge(this),this._atom.on("init",function(t,e){this._onIframeLoad(e)}.bind(this)),this._atom.init()},getPopup:function(){return this._popup||this.findBlockOn("popup","popup2")},getSpin:function(){return this._spin||this.getPopup().findBlockInside("spin2")},init:function(){if(this._rpcBridge)return this;window.LegoIframeLoader?this._loadIframe():this._insertLoaderScript(this._loadIframe.bind(this))},onIconClick:function(t){this._rpcBridge||this.init(),!this._popup.hasMod("visible","yes")&&this._rpcBridge&&this._hasLoaded&&this._rpcBridge.invokeMethod("resetUnviewed",{}),this._popup.toggleMod("visible","yes")},onDataLoad:function(t){this.setMod(this._popup.domElem,"loaded","yes"),this._spin.delMod("progress"),this._hasLoaded=!0,this._popup.hasMod("visible","yes")&&this._rpcBridge.invokeMethod("resetUnviewed",{})},onUpdateCounter:function(t){this.toggleMod("has-unread","yes",!this._firstOpen&&Boolean(t)),this._firstOpen&&(this._firstOpen=!1)},updateCounterWithParams:function(t,e){this._rpcBridge.invokeMethod("updateCounterWithParams",{counterParams:t,referrer:e})},_onIframeLoad:function(t){this._rpcBridge.contrAgent.win=t.iframeWin,this._rpcBridge.invokeMethod("onIframeLoad",{source:this.params.source,serviceDatabaseId:this.params.serviceDatabaseId,domain:this.params.domain||this.params.tld,counterParams:this.params.counterParams,referrer:this.params.referrer,apiHost:this.params.apiHost})},onInit:function(t){},getDefaultParams:function(){return{baseUrl:"https://gcn.yandex-team.ru",loaderVersion:"stable",iframeVersion:"stable",lang:"ru",referrer:location.href}}},{live:function(){this.liveBindTo("click",function(t){this.onIconClick(t)})}}),BEM.DOM.decl("notifier",{onSetMod:{js:{inited:function(){this.__base.apply(this,arguments),this._popup.setAnchor(this.elem("box"))}}}}),BEM.DOM.decl("attach",{onSetMod:{js:{inited:function(){this._noFileText=this.elem("text").text(),this._filePath="",this._setFilePath(""),this.bindTo("reset","pointerclick",this.resetFile)}},disabled:function(t,e){this.elem("control").prop("disabled",e),this.getButton().setMod("disabled",e)}},val:function(){return this._filePath},getButton:function(){return this._button||(this._button=this.findBlockOn("button","button2"))},resetFile:function(){var t=this.elem("control");return t.val(""),t.replaceWith(t.clone()),this.dropElemCache("control"),this.getButton().dropElemCache("control"),this._setFilePath(""),this.trigger("reset")},_setFilePath:function(t,e){var i=this._filePath;this._filePath=t;var n=t.split("\\").pop(),s=n.split(".").pop().toLowerCase();this.setMod(this.elem("holder"),"file",this._extensionsToMods[s]||this.params.unknownType),this.toggleMod(this.elem("holder"),"state","hidden",!n);var o=this.params.textWidth,r=this.elem("text");o&&r.css("width",n?o+"px":"auto"),r.text(n||this._noFileText),(e||t!==i)&&this.trigger("change")},_update:function(){this._setFilePath(this.elem("control").val(),!0)},_extensionsToMods:{zip:"archive",rar:"archive",tar:"archive",gz:"archive","7z":"archive",gif:"gif",jpg:"jpg",jpeg:"jpg",png:"png",eml:"eml",exe:"exe",m4a:"audio",ogg:"audio",mp3:"mp3",wav:"wav",wma:"wma",flv:"video",mov:"mov",wmv:"wmv",mp4:"mp4",avi:"avi",xls:"xls",doc:"doc",docx:"doc",txt:"txt",pdf:"pdf",ppt:"ppt"},getDefaultParams:function(){return{unknownType:"unknown"}}},{live:function(){this.liveBindTo("change",function(){this._update()})}}),BEM.decl({block:"mi-notifier",modName:"position",modVal:"left-bottom"},{_setNotificationPosition:function(t,e){t.domElem.css("left",this.__self._VERT_OFFSET+this._offset.left+"px"),t.domElem.css("bottom",e-this._offset.top+"px")},_recalculatePositions:function(){var t=this.__self._VERT_OFFSET;this._notifications.forEach(function(e){e.domElem.css("bottom",t-this._offset.top+"px"),t+=e.domElem.outerHeight()+this._margin},this)}}),BEM.DOM.decl({block:" m-popup",modName:"drafts",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._cancelButton=this.findBlockInside({block:"button2",modName:"action",modVal:"cancel"}),this._onCancel()},visible:function(t,e){"yes"===e&&this.setMod(this.elem("buttons"),"visibility","hidden")}},_onCancel:function(){this._cancelButton.on("click",function(){this._popup.trigger("update-text",this.findBlockInside("m-editor-popup").params.text),this._popup.delMod("visible")},this)},onUpdateText:function(){this.delMod(this.elem("buttons"),"visibility")}}),BEM.DOM.decl({block:"m-popup",modName:"editor",modVal:"yes"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._addButton=this.findBlockInside({block:"button2",modName:"action",modVal:"add"}),this._cancelButton=this.findBlockInside({block:"button2",modName:"action",modVal:"cancel"}),this._onAdd(),this._onCancel()}},_onAdd:function(){this._addButton.on("click",function(){if(this.hasMod("drafts","yes"))this._popup.delMod("visible");else{var t=this.findBlockInside("m-editor-popup").getText();this._popup.trigger("onadd",t)}},this)},_onCancel:function(){this._cancelButton.on("click",function(){this.hasMod("drafts","yes")&&this._popup.trigger("update-text",this.findBlockInside("m-editor-popup").params.text),this._popup.delMod("visible")},this)}}),BEM.DOM.decl({block:"m-editor-popup",modName:"type",modVal:"code"},{onSetMod:{js:function(){this.findBlockInside("select2").popup.bindTo("click",function(t){this.trigger("prevent-close")}.bind(this))}},processParams:function(t){var e,i="";return(e=$.extend({},{codeStyle:"",codeText:""},t)).codeStyle&&(i="("+e.codeStyle+")"),i="%%"+i+"\n"+e.codeText+"\n%%"}}),BEM.DOM.decl({block:"m-speller"},{onSetMod:{js:function(){this._storage=this._getLocalStorage(),this._initUserOptions(),this._bindEvents()}},destruct:function(t){delete this._cashedBlocks,this._getBlockInside("select2").un("change"),this._getBlockInside("button2","type","ignore-once").un("click"),this._getBlockInside("button2","type","replace").un("click"),this._getBlockInside("button2","type","params").un("click"),this._getBlockInside("button2","type","cancel").un("click"),this._getBlockInside("textinput","type","error").un("change"),this._getBlockInside("button2","type","user-dict").un("click"),this._getBlockInside("textarea","role","dict").un("change"),BEM.blocks.checkbox.un(this.domElem,"change",this._onCheckBoxChange,this),this.findBlocksInside("check-button").forEach(function(t){t.un("change")}),this.__base(t)},_initUserOptions:function(){this._storage["yandex.useropt"]||(this._storage["yandex.useropt"]=JSON.stringify({"ignore-uppercase":!1,"ignore-digits":!1,"ignore-urls":!1,"find-repeat":!1,lang:"ru"})),this._storage["yandex.userdic"]||(this._storage["yandex.userdic"]=""),this._optionsCodes={"ignore-uppercase":1,"ignore-digits":2,"ignore-urls":4,"find-repeat":8},this._setOptionsFromStorageToUI()},_bindEvents:function(){this._getBlockInside("select2").on("change",function(){var t=this._getUserOptions(),e=this._getBlockInside("select2").getVal();t.lang=e,this._getBlockInside("select2").findBlockInside("button2").findElem("text").text(BEM.I18N("m-speller",e)),this._setUserOption("lang",t.lang)}.bind(this)),this._getBlockInside("button2","type","ignore-once").on("click",this._goToNextError,this),this._getBlockInside("button2","type","replace").on("click",this._replace,this),this._getBlockInside("button2","type","cancel").on("click",this._cancel,this),this._getBlockInside("button2","type","params").on("click",this._toogleAdditionalOptions,this),this._getBlockInside("textinput","type","error").on("change",this._inputChanged,this),this._getBlockInside("button2","type","user-dict").on("click",this._showUserDict,this),this._getBlockInside("textarea","role","dict").on("change",this._setUserDict,this),BEM.blocks.checkbox.on(this.domElem,"change",this._onCheckBoxChange,this)},_onCheckBoxChange:function(t,e){var i=t.block.getMod("type");["ignore-uppercase","ignore-digits","ignore-urls","find-repeat"].indexOf(i)>=0&&this._setUserOption(i,e.checked)},check:function(t){t?(this._inputText=t,this._sendRequest(this._getUserOptions())):this._finish()},_sendRequest:function(t){$.post("//speller.yandex.net/services/spellservice.json/checkText",{text:this._inputText,lang:t.lang,options:this._getOptionsHash()},this._processErrors.bind(this),"json")},_processErrors:function(t){t.length?(this.delMod("finished"),this.delMod(this.elem("flex-container","hide-in-finish","yes"),"hidden"),this._offset=0,this._errorsArray=t,this._goToNextError(0)):this._finish()},_goToNextError:function(t){var e,i,n,s,o=this._storage["yandex.userdic"].split(" ");if(this._inputText)if(this._currentErrorIndex="number"==typeof t?t:void 0!==this._currentErrorIndex?this._currentErrorIndex+1:0,this._currentErrorIndex>this._errorsArray.length-1)this._finish();else if((s=this._errorsArray[this._currentErrorIndex]).needToReplace)this._replace();else if(n=this._getRemainingErrorsCount(o),this.elem("status").html($(BEMHTML.apply([{block:"m-speller",elem:"main-text",content:BEM.I18N("m-speller","complete")+", "+BEM.I18N("m-speller","recommended")+" "},{block:"m-speller",elem:"main-text",mix:{block:"m-speller",elem:"attention"},content:n+" "+this._getCorrectonForm(n)}]))),o.indexOf(s.word)>=0)this._goToNextError();else{this._getBlockInside("textinput","type","error").val(s.word);var r=s.pos;e=$(BEMHTML.apply({block:"m-speller",elem:"text",before:this._inputText.slice(r>90?r-40:0,r+this._offset),word:s.word,after:this._inputText.substr(r+this._offset+s.len,this._inputText.length)})),this._getBlockInside("island","role","input-text").domElem.html(e),i=this._getBlockInside("island","role","correction-options"),BEM.DOM.update(i.domElem,""),s.s.length?(this._getBlockInside("button2","type","replace").delMod("disabled"),s.s.forEach(function(t,e){e<=4&&BEM.DOM.append(i.domElem,BEMHTML.apply({block:"button2",mods:{size:"xs",theme:"clear",type:"check",checked:0===e?"yes":""},mix:[{block:"m-speller",elem:"check-button"}],value:t,text:t}))})):(this._getBlockInside("button2","type","replace").setMod("disabled","yes"),BEM.DOM.append(i.domElem,BEMHTML.apply({block:"button2",mods:{size:"xs",theme:"clear",role:"not-options",type:"check"},mix:[{block:"m-speller",elem:"check-button"}],text:"( "+BEM.I18N("m-speller","options-not-found")+" )"}))),BEM.DOM.append(i.domElem,BEMHTML.apply({block:"button2",mods:{size:"xs",theme:"clear",role:"add-to-dict",type:"check"},mix:[{block:"m-speller",elem:"check-button"}],content:{elem:"text",content:{block:"m-speller",elem:"add-to-dict"}}})),this._bindEventsOnCorrectionOptions()}},_getRemainingErrorsCount:function(t){for(var e=this._errorsArray.length-this._currentErrorIndex,i=this._currentErrorIndex;i<this._errorsArray.length;i++)t.indexOf(this._errorsArray[i].word)>=0&&e--;return e},_getCorrectonForm:function(t){var e="correction",i=t%10;return 1===i?e+="1":i>1&&i<5&&(e+="2"),BEM.I18N("m-speller",e)},_bindEventsOnCorrectionOptions:function(){var t=this;this.bindTo(this.findElem("check-button"),"click",function(e){"add-to-dict"===this.findBlockOn(e.data.domElem,{block:"button2",modName:"type",modVal:"check"}).getMod("role")?t.afterCurrentEvent(t._addToLocalDictionaty,t):this.findBlockInside({block:"island",modName:"role",modVal:"correction-options"}).findBlocksInside({block:"button2",modName:"type",modVal:"check"}).forEach(function(t){t.delMod("checked")})})},_getBlockInside:function(t,e,i){var n,s=t+"_"+e+"_"+i;return this._cashedBlocks||(this._cashedBlocks={}),this._cashedBlocks[s]?this._cashedBlocks[s]:(n=this.findBlockInside({block:t,modName:e,modVal:i}),this._cashedBlocks[s]=n,n)},_showUserDict:function(){this._getBlockInside("userdict").delMod("hidden"),this._getBlockInside("button2","type","user-dict").setMod("hidden","yes"),this._setDictionaryFromStorageToUI()},_hideUserDict:function(){this._getBlockInside("userdict").setMod("hidden","yes"),this._getBlockInside("button2","type","user-dict").delMod("hidden")},_setUserDict:function(){var t=this._getBlockInside("textarea","role","dict").val();this._storage["yandex.userdic"]=t.replace(new RegExp(/[\n,\r]+/g)," ").replace(new RegExp(/\s+/g)," ").trim()},_inputChanged:function(){if(this._inputText&&"yes"!==this.getMod("finished")){var t=this._errorsArray[this._currentErrorIndex];this._getBlockInside("textinput","type","error").val()!==t.word?this._getBlockInside("button2","type","replace").delMod("disabled"):this._getBlockInside("button2","type","replace").setMod("disabled",t.s.length?"":"yes")}},_setUserOption:function(t,e){var i=this._getUserOptions();i[t]!==e&&(i[t]=e,this._setUserOptions(i),this._inputText&&this._sendRequest(this._getUserOptions()))},_toogleAdditionalOptions:function(){var t=this.findElem("options"),e="yes"!==this.getMod(t,"hidden");this.setMod(t,"hidden",e?"yes":""),this._getBlockInside("button2","type","params").findElem("text").text(BEM.I18N("m-speller",e?"params":"hideparams")),e&&this._hideUserDict()},_setOptionsFromStorageToUI:function(){var t=this._getUserOptions();Object.keys(t).forEach(function(e){"lang"!==e&&this._getBlockInside("checkbox","type",e).setMod("checked",t[e]?"yes":"")}.bind(this)),this._getBlockInside("select2").setVal(t.lang),this._getBlockInside("select2").findBlockInside("button2").findElem("text").text(BEM.I18N("m-speller",t.lang))},_setDictionaryFromStorageToUI:function(){this._getBlockInside("textarea","role","dict").val(this._getLocalDictionary())},_getLocalDictionary:function(){return this._storage["yandex.userdic"]},_getUserOptions:function(){return JSON.parse(this._storage["yandex.useropt"])},_getOptionsHash:function(){var t=0,e=this._getUserOptions();return Object.keys(e).forEach(function(i){!0===e[i]&&(t+=this._optionsCodes[i])}.bind(this)),t},_setUserOptions:function(t){this._storage["yandex.useropt"]=t?JSON.stringify(t):JSON.stringify({"ignore-uppercase":!1,"ignore-digits":!1,"ignore-urls":!1,"find-repeat":!1,lang:"ru"})},_addToLocalDictionaty:function(){if(this._inputText){var t=this._errorsArray[this._currentErrorIndex].word;this._storage["yandex.userdic"]+=(this._storage["yandex.userdic"]?" ":"")+t,this._setDictionaryFromStorageToUI(),this._goToNextError()}},_getValueToReplace:function(t){var e=this._getBlockInside("textinput","type","error");return e.val()===t?this._getBlockInside("island","role","correction-options").findBlockInside({block:"button2",modName:"checked",modVal:"yes"}).getText():e.val()},_replace:function(){var t=this._errorsArray[this._currentErrorIndex],e=t.word,i=t.needToReplace||this._getValueToReplace(e);this._inputText&&(this._inputText=this._inputText.substr(0,t.pos+this._offset)+this._inputText.substr(t.pos+this._offset+t.len),this._inputText=this._inputText.slice(0,t.pos+this._offset)+i+this._inputText.slice(t.pos+this._offset),this._offset+=i.length-e.length,this.trigger("change",this._inputText),this._goToNextError())},_replaceAll:function(){var t=this._errorsArray[this._currentErrorIndex],e=this._getValueToReplace(t.word);this._inputText&&(this._errorsArray.forEach(function(i){i.word===t.word&&(i.needToReplace=e)}),this._replace())},_finish:function(){this.setMod("finished","yes"),this._clearUI(),this.elem("status").html($(BEMHTML.apply([{block:"m-speller",elem:"main-text",content:BEM.I18N("m-speller","complete")+",  "},{block:"m-speller",elem:"corrections-not-found"}]))),this.setMod(this.elem("flex-container","hide-in-finish","yes"),"hidden","yes"),"yes"===this.getMod(this.elem("options"),"hidden")&&this._toogleAdditionalOptions()},_cancel:function(){this.trigger("cancel")},_clearUI:function(){this._getBlockInside("textinput","type","error").val(""),BEM.DOM.update(this._getBlockInside("island","role","input-text").domElem,""),BEM.DOM.update(this._getBlockInside("island","role","correction-options").domElem,"")},_getLocalStorage:function(){return window.localStorage?window.localStorage:window.globalStorage[document.domain]}}),BEM.DOM.decl({block:"m-editor",modName:"type",modVal:"edit-page"},{hasNewDraft:!1,onSetMod:{js:function(){this.__base.apply(this,arguments),this._bPage=this.findBlockOutside("b-page"),this.afterCurrentEvent(this._backward),this.on("draft-store",this._onDraftStore,this),this.on("draft-restore",this._onDraftRestore,this)}},_onDraftStore:function(){this.hasNewDraft=!0},_onDraftRestore:function(){confirm(BEM.I18N("m-editor","unsaved_changes"))&&(this.restore(),this.trigger("change",this.val()))},_backward:function(){var t=this.__self._storageKey;window.localStorage.getItem(t)||(localStorage.removeItem("_ajaxTickets"),setTimeout(function(){Object.keys(window.localStorage).forEach(function(t){0===t.search("#/")&&window.localStorage.removeItem(t)}),window.localStorage.setItem(t,!0)},1e4))},close:function(){var t=$.url.getAllParams(location.href);if(this._bPage.hasMod("editor")?this._bPage.delMod("editor"):this._bPage.hasMod("new-page")&&this._bPage.delMod("new-page"),this._bPage.setMod("revision",""),t.goanchor){var e=$(".wiki-head__anchor[name="+t.goanchor+"]");e.length&&$(window).scrollTop(e.offset().top-this.__self._topVisibleOffset)}BEM.blocks["wi-history"].removeState(),BEM.blocks["wi-history"]._clearUrl(),this.hasNewDraft=!1}},{_storageKey:"_draftsProcessed",_topVisibleOffset:40}),BEM.DOM.decl({name:"m-calendar",modName:"toggler",modVal:"button"},{onSetMod:{js:function(){this.input=this.findBlockInside({block:"button2",modName:"toggler",modVal:"datepicker"}),this.__base.apply(this,arguments),this.input.on("click",this._onTogglerClick,this),this.bindTo(this.input.domElem,"mouseout",this._onInputMouseOut)},disabled:function(t,e){this.input.setMod(t,e)}},_onInputMouseOut:function(){this._popUpOpened||(this.input._isDatePickerOpened=!1,this.input.delMod("pressed").delMod("focused"))},_onTogglerClick:function(){var t=this;if(this._preventClick)return this._preventClick=!1,!1;this.__base.apply(this,arguments),this._datePickerPopup.on("outside-click",function(e,i){i.target===t.input.elem("input")[0]&&(t._preventClick=!0,t._hideWithFocus())}),this.bindToDoc("keydown.close",function(e){13!==e.which&&32!==e.which||(t._preventClick=!0,t._hideWithFocus()),9!==e.which&&27!==e.which||(t._preventClick=!1,t._hideWithFocus())})},_hideWithFocus:function(){this._datePickerPopup.delMod("visible"),this.input.setMod("focused","yes")},_onDateChange:function(t,e){var i=BEM.DOM.blocks["m-calendar"].dateFormat,n=e.date,s=e.fromArrow,o=this.input.elem("input"),r=this.input.elem("text");s||(n?n.from?(o.val(BEM.blocks["mi-helpers"].getHumanStringFromDate({date:n.from})+" — "+BEM.blocks["mi-helpers"].getHumanStringFromDate({date:n.to})),r.text(i(n.from)+" — "+i(n.to))):(o.val(n.toISOString()),r.text(i(n))):(o.val(""),r.text(this.params.defaultText))),this.__base.apply(this,arguments)},_onDatePickerPopupHide:function(){this.__base.apply(this,arguments),this.input.delMod("focused"),this.input.delMod("pressed"),this._datePickerPopup.un("outside-click"),this.unbindFromDoc("keydown.close")}}),BEM.DOM.decl({name:"m-datepicker",modName:"type",modVal:"month"},{onSetMod:{js:function(){this.hasMod("disable","change")&&(this.changeDisabled=!0),this._todayDate=this._getCurrentDate(),this.params.specialDays&&(this._specialDays=this.params.specialDays,this.setMod("special-days","yes")),this.params.limits&&this.setLimits(this.params.limits.min,this.params.limits.max),this.params.value?this.setDate(this.params.value):this._buildDatepicker(),this.changeDisabled||this.bindTo("wheel",this._onMouseWheel),this._checkLimits()}},setSpecialDays:function(t){this._specialDays=t,this._buildDatepicker()},setMinDate:function(t){if(t=BEM.blocks["mi-helpers"].getDateFromHumanString(t),this._maxDate&&t>this._maxDate)throw new Error("meccano:m-datepicker:  min date should be less then Max date");this._minDate=t,this.yearChooserControl&&this.yearChooserControl.attr("min",t.getFullYear())},setMaxDate:function(t){if(t=BEM.blocks["mi-helpers"].getDateFromHumanString(t),this._minDate&&t<this._minDate)throw new Error("meccano:m-datepicker: max date should be greater then Min date");this._maxDate=t,this.yearChooserControl&&this.yearChooserControl.attr("max",t.getFullYear())},setLimits:function(t,e){t&&this.setMinDate(t),e&&this.setMaxDate(e)},_checkLimits:function(){this._minDate&&this._toggleDirectionButton("previous"),this._maxDate&&this._toggleDirectionButton("next")},_toggleDirectionButton:function(t){var e=this[t+"Button"],i="next"==t?this._maxDate:this._minDate,n=BEM.blocks["mi-helpers"].getUTC_YMD(this._dates[t].year,this._dates[t].month,"next"==t?1:this._dates[t].monthDays),s="next"==t?n>i:n<i;s&&e.delMod("hovered"),e.toggleMod("disabled","yes","",s)},_toggleMonthChooserButtons:function(){var t,e,i=0,n=11,s=this.monthChooserButtons[0];this._minDate&&this.gereatChooserData.year==this._minDate.getFullYear()&&(i=this._minDate.getMonth()),this._maxDate&&this.gereatChooserData.year==this._maxDate.getFullYear()&&(n=this._maxDate.getMonth()),this.monthChooserRadio.each(function(o){e=$(this),(t=o<i||o>n)&&(this.control.checked=!1,s.setMod(e,"checked","")),s.toggleMod(e,"disabled","yes","",t)})},_onMouseWheel:function(t,e,i,n){var s;if(t.preventDefault(),this._isChangeCalendarRunning)return!1;this._isChangeCalendarRunning=!0,(i<0||n>0)&&(s=this._changeMonth("next")),(i>0||n<0)&&(s=this._changeMonth("previous")),s||(this._isChangeCalendarRunning=!1)},setSizes:function(){var t,e=this.findElem("bodies");if(!this._sizes){if(!(t=this.findElem("grid-table")).width()||!t.height())return;this._sizes={gridWidth:t.width(),gridHeight:t.height(),titleHeight:this.findElem("title","position","current").height()}}e.css({width:this._sizes.gridWidth,height:this._sizes.gridHeight}),this.findElem("head").height(this._sizes.titleHeight),this._blockSizeSet||(this.domElem.width(this.domElem.outerWidth()),this.domElem.height(this.domElem.outerHeight()),this._blockSizeSet=!0)},_onTitleClick:function(){var t=this;this.toggleMod("show","great-chooser"),this.hasMod("show","great-chooser")?(this._subscribeChooserControlls(),this.gereatChooserData={year:this._dates.current.year,month:this._dates.current.month},this.yearChooser.val(this._dates.current.year),this.monthChooserButtons.forEach(function(e){e.val(t._dates.current.month.toString())}),this._toggleMonthChooserButtons()):this._unsubscribeChooserControlls()},_subscribeChooserControlls:function(){var t=this;this.monthChooserButtons.forEach(function(e){e.on("change",t._onChooserMonthChange,t)}),this.bindToDomElem(this.yearChooserControl,"input",this._onChooserYearInput),this.bindTo(this.chooser,"submit",this._onChooserSubmit)},_unsubscribeChooserControlls:function(){this.monthChooserButtons.forEach(function(t){t.un("change")}),this.unbindFromDomElem(this.yearChooserControl,"input"),this.unbindFrom(this.chooser,"submit")},_onChooserSubmit:function(t){t.preventDefault(),this.delMod("show"),this._buildDatepicker(BEM.blocks["mi-helpers"].getUTC_YMD(this.gereatChooserData.year,this.gereatChooserData.month,1)),this._checkLimits()},_onChooserMonthChange:function(t){this.gereatChooserData.month=t.target.val()},_onChooserYearInput:function(t){var e=this.yearChooser.val();e&&(this._maxDate&&e>this._maxDate.getFullYear()||this._minDate&&e<this._minDate.getFullYear()||(this.yearChooser.val(e),this.gereatChooserData.year=e,this._toggleMonthChooserButtons()))},_bindToDates:function(){this.bindTo(this.findElem("dates"),"click",this._onDateChoose)},_onChangeMonthButtonClick:function(t){var e=t.target.getMod("target");this._isChangeCalendarRunning||this._changeMonth(e)},_changeMonth:function(t){var e=this,i=BEM.I18N("i-tanker__months","n"+(this._dates[t].month+1))+" "+this._dates[t].year,n=this.findElem("body","position","back"),s=this.findElem("body","position","current"),o=this.findElem("title","position","back"),r=this.findElem("title","position","current"),a=n.add(o),c=s.add(r),l=n.add(s).add(o).add(r);return!("previous"==t&&this.previousButton.hasMod("disabled")||"next"==t&&this.nextButton.hasMod("disabled"))&&(this.setMod(l,"transition","no").setMod(a,"direction",t),this._isChangeCalendarRunning=!0,BEM.DOM.update(n,BEMHTML.apply(this._buildDatepickerGridBEMJSON(this._dates[t]))),BEM.DOM.update(o,BEMHTML.apply(this._getTitleClickBEMJSON(i))),this._createDateContext({year:this._dates[t].year,month:this._dates[t].month}),setTimeout(function(){e.delMod(l,"transition").delMod(a,"direction").setMod(c,"direction",t)},50),n.on("TransitionEnd webkitTransitionEnd transitionend oTransitionEnd MSTransitionEnd",function(){e.setMod(l,"transition","no").setMod(a,"position","current").setMod(c,"position","back").delMod(c,"direction"),BEM.DOM.update(c,""),n.off(),e._bindToDates(),e._bindTitleClick(),e._isChangeCalendarRunning=!1,e.setSizes()}),this._checkLimits(),!0)},_getTitleClickBEMJSON:function(t){return{block:"m-datepicker",elem:"title-click",tag:"span",content:[t,{block:"awesome-icon",mods:{icon:"angle-down"}}]}},_bindTitleClick:function(){this.bindTo(this.findElem("title-click"),"click",this._onTitleClick)},_createDateContext:function(t){var e,i,n,s,o,r,a=t instanceof Date;e=a?t.getMonth():t.month,s=a?t.getFullYear():t.year,i=e-1<0?11:e-1,n=e+1>11?0:e+1,o=11===i?s-1:s,r=0===n?s+1:s,this._dates={current:this._fillDateContext(e,s),previous:this._fillDateContext(i,o),next:this._fillDateContext(n,r)}},_fillDateContext:function(t,e){return{month:t,year:e,startDay:this._getStartDay(t,e),monthDays:this._getMonthDays(t,e)}},_buildDatepicker:function(t){t?this._createDateContext(t):this.params.date?this._createDateContext(BEM.blocks["mi-helpers"].getDateFromHumanString(this.params.date+"-01")):this._isDateSelected?this._createDateContext(this._selectedDate):this._createDateContext(this._todayDate),BEM.DOM.update(this.domElem,BEMHTML.apply(this._getDatePickerBEMJSON())),this.changeDisabled||(this._findMainControlls(),this._subscribeMainControlls(),this._bindToDates()),this.setSizes()},_findMainControlls:function(){this.previousButton=this.findBlockInside({block:"button2",modName:"target",modVal:"previous"}),this.nextButton=this.findBlockInside({block:"button2",modName:"target",modVal:"next"}),this.monthChooserButtons=this.findBlocksInside("choose-month","radio-button"),this.monthChooserRadio=this.monthChooserButtons[0].findElem("radio"),this.yearChooser=this.findBlockInside("choose-year","textinput"),this.yearChooserControl=this.yearChooser.findElem("control"),this.chooser=this.findElem("great-chooser"),this.hasMod("has","clear")&&(this.clearButton=this.findBlockInside({block:"button2",modName:"action",modVal:"clear"}))},_subscribeMainControlls:function(){this.previousButton.on("click",this._onChangeMonthButtonClick,this),this.nextButton.on("click",this._onChangeMonthButtonClick,this),this.clearButton&&this.clearButton.on("click",this.clearDate,this),this._bindTitleClick()},_onDateChoose:function(t){var e=$(t.target),i=e.hasClass(BEM.INTERNAL.buildClass(this.__self.getName(),"day")),n=e.hasClass(BEM.INTERNAL.buildClass(this.__self.getName(),"day","disabled","yes"));i&&!n&&(this._selectedDate=BEM.blocks["mi-helpers"].getUTC_YMD(this._dates.current.year,this._dates.current.month,$(t.target).attr("data-content")),this._isDateSelected||(this._isDateSelected=!0),this.delMod(this.findElem("day","selected","yes"),"selected").setMod($(t.target),"selected","yes").trigger("change",{date:this.getDate()}),this.clearButton&&this.clearButton.delMod("disabled"))},_getDatePickerBEMJSON:function(){var t,e=[{block:"m-datepicker",elem:"head",content:this._getDatePickerHeadBEMJSON()},{block:"m-datepicker",elem:"bodies",content:[{elem:"body",elemMods:{position:"back"}},{elem:"body",elemMods:{position:"current"},content:this._buildDatepickerGridBEMJSON(this._dates.current)}]}];return this.changeDisabled||e.push({block:"m-datepicker",elem:"great-chooser",content:this._buildGreatChooserBEMJSON()}),this.hasMod("has","clear")&&(t=this._getFootElemBEMJSON({block:"button2",mods:{theme:"normal",type:"simple",size:"s",action:"clear"},text:BEM.I18N("m-datepicker","clear")}),this._isDateSelected||(t.content.mods.disabled="yes"),e.push(t)),e},_buildGreatChooserBEMJSON:function(){return[{elem:"choose-year",content:{block:"textinput",mods:{theme:"normal",size:"s",type:"number"},controlAttrs:{min:this._minDate?this._minDate.getFullYear():"",max:this._maxDate?this._maxDate.getFullYear():""}}},{elem:"choose-month",content:function(){for(var t=1,e=[],i=0;i<4;i++)e.push({block:"radio-button",mods:{theme:"normal",size:"s",quorter:"q"+(i+1)},js:{id:"1234"},name:this._uniqId+"-radio",inputAttrs:{name:"q"+(i+1)},content:function(){for(var e=[],i=1;i<4;i++)e.push({elem:"radio",controlAttrs:{value:t-1,required:"required"},content:BEM.I18N("i-tanker__months","short"+t)}),t++;return e}()});return e}.bind(this)()},{elem:"chooser-submit",content:{block:"button2",mods:{size:"s",theme:"normal",type:"submit"},text:"OK"}}]},_getDatePickerHeadBEMJSON:function(){var t=BEM.I18N("i-tanker__months","n"+(this._dates.current.month+1))+" "+this._dates.current.year;return this.changeDisabled?{elem:"titles",content:{elem:"title",elemMods:{position:"current"},content:t}}:[{elem:"left",content:{block:"button2",mods:{theme:"normal",type:"simple",size:"s",target:"previous"},text:"←"}},{elem:"titles",content:[{elem:"title",elemMods:{position:"current"},content:this._getTitleClickBEMJSON(t)},{elem:"title",elemMods:{position:"back"}}]},{elem:"right",content:{block:"button2",mods:{theme:"normal",type:"simple",size:"s",target:"next"},text:"→"}}]},_buildDatepickerGridBEMJSON:function(t){var e=this,i=[],n=this._buildGridMap(t);return i.push({elem:"thead",tag:"thead",content:{elem:"thead-line",tag:"tr",content:function(){var t,e=[];for(t=0;t<7;t++)e.push({elem:"day-name",tag:"th",content:{elem:"day-name-i",content:BEM.I18N("m-datepicker__short-days",t+1)}});return e}()}}),i.push({elem:"dates",tag:"tbody",content:function(){for(var i=[],s=0;s<n.length;s++)i.push({elem:"week",tag:"tr",content:function(){var i,o,r,a,c=[],l=e._maxDate||e._minDate,d=t.month==e._todayDate.getMonth()&&t.year==e._todayDate.getFullYear(),h=e._selectedDate&&t.month==e._selectedDate.getMonth()&&t.year==e._selectedDate.getFullYear(),u=BEM.blocks["mi-helpers"].getUTC_YMD(t.year,t.month,1);a=1===(t.month+1).toString().length?"0"+(t.month+1):t.month+1;for(var m=0;m<7;m++)n[s][m]?(i={elem:"day",tag:"td",elemMods:{},attrs:{"data-content":n[s][m]}},e._specialDays&&(o=1===n[s][m].toString().length?"0"+n[s][m].toString():n[s][m],r=t.year+"-"+a+"-"+o,e._specialDays[r]&&(i.attrs.style="background: "+e._specialDays[r].background+"; ",e._specialDays[r].color&&(i.attrs.style=i.attrs.style+"color: "+e._specialDays[r].color),i.attrs.title=e._specialDays[r].title)),5!==m&&6!==m||(i.elemMods.weekend="yes"),h&&n[s][m]===e.getSelectedDay()&&(i.elemMods.selected="yes"),d&&n[s][m]===e._todayDate.getDate()&&(i.elemMods.today="yes"),l&&(u.setDate(n[s][m]),(e._minDate&&u<e._minDate||e._maxDate&&u>e._maxDate)&&(i.elemMods.disabled="yes")),c.push(i)):(i={elem:"day-empty",tag:"td"},c.push(i));return c}()});return i}()}),{block:"m-datepicker",elem:"grid",content:[{elem:"grid-table",tag:"table",content:i}]}},_buildGridMap:function(t){var e,i=0,n=new Array(7),s=[];for(e=1;e<=t.monthDays;e++)1==e&&(i=t.startDay-1),n[i]=e,6==i?(s.push(n),n=new Array(7),i=0):i++,e+1>t.monthDays&&s.push(n);return s.length<6&&s.push(new Array(7)),s},_isChangeCalendarRunning:!1}),BEM.DOM.decl({block:"m-head-action",modName:"with",modVal:"popup"},{onSetMod:{js:function(){this._listTogglerButton=this.findBlockInside({block:"button2",modName:"role",modVal:"list-toggler"}).on("click",this._onListTogglerButtonClick,this),this._popup=this._getPopup()}},_onListTogglerButtonClick:function(t){this._popup.toggleMod("visible","yes")},_onItemClick:function(){this._popup.delMod("visible")},_onPopupHide:function(){this._listTogglerButton.delMod("direction")},_onPopupShow:function(){this._listTogglerButton.setMod("direction","up")},_getPopup:function(){return this._popup||(this._popup=$(BEMHTML.apply(this._getPopupBEMJSON())).bem("popup2").on({beforeOpen:this._onPopupShow,beforeClose:this._onPopupHide},this),this.bindTo(this.findElem(this._popup.domElem,"popup-item"),"click",this._onItemClick.bind(this))),this._popup.setAnchor(this._listTogglerButton.domElem)},_getPopupBEMJSON:function(){return{block:"popup2",mods:{theme:"normal",target:"anchor",hiding:"yes",autoclosable:"yes"},mix:[{block:this.__self.getName(),elem:"action-popup"}],directions:["bottom-right"],content:{elem:"content",content:this.params.items.map(function(t){return{block:"m-head-action",mods:{with:"popup"},elem:"popup-item",elemMods:{},item:t}},this)}}}}),BEM.DOM.decl("w-page-panel",{},{live:function(){this.liveInitOnStoreEvent("page","change:access",function(t,e){BEM.DOM.replace(this.findElem("access"),BEMHTML.apply({block:"w-page-panel",elem:"access",data:e}))}),this.liveInitOnStoreEvent("page","change:isFav",function(t,e){BEM.DOM.replace(this.findElem("fav"),BEMHTML.apply({block:"w-page-panel",elem:"fav",isFav:e}))}),this.liveInitOnStoreEvent("page","change:userSubscription",function(t,e){this.findBlockInside("w-subscribe-button").setMod("type",e)}),this.liveInitOnStoreEvent("page","change:canEdit",function(t,e){BEM.DOM.replace(this.findElem("edit"),BEMHTML.apply({block:"w-page-panel",elem:"edit",canEdit:e}))})}}),BEM.DOM.decl({name:"m-calendar",modName:"type",modVal:"month"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this.params.keyboard&&window.keymaster("enter, left, right, up, down",this._onKeyDown.bind(this))}},destruct:function(t){this.params.keyboard&&window.keymaster.unbind("enter, left, right, up, down",this),this.__base(t)},_onKeyDown:function(t){var e,i,n=this.params;this.__self.activeCalendar===this&&(this._datePicker._selectedDate?e=Number(this._datePicker._selectedDate):i=n.date?new Date(n.date):new Date,i||"Left"!==t.keyIdentifier?i||"Right"!==t.keyIdentifier?i||"Up"!==t.keyIdentifier?i||"Down"!==t.keyIdentifier||(t.preventDefault(),i=new Date(e+this.__self.MILLISECONDS_IN_WEEK)):(t.preventDefault(),i=new Date(e-this.__self.MILLISECONDS_IN_WEEK)):i=new Date(e+this.__self.MILLISECONDS_IN_DAY):i=new Date(e-this.__self.MILLISECONDS_IN_DAY),!(!n.limits||n.limits&&(!n.limits.max||BEM.blocks["mi-helpers"].getDateFromHumanString(n.limits.max)>=i)&&(!n.limits.min||BEM.blocks["mi-helpers"].getDateFromHumanString(n.limits.min)<=i))||"Left"!==t.keyIdentifier&&"Right"!==t.keyIdentifier&&"Up"!==t.keyIdentifier&&"Down"!==t.keyIdentifier?"Enter"===t.keyIdentifier&&this._datePicker._selectedDate&&this.setDate(BEM.blocks["mi-helpers"].dateFormat(this._datePicker._selectedDate,"yyyy-mm-dd")):this.setDate(BEM.blocks["mi-helpers"].dateFormat(i,"yyyy-mm-dd"),!0))},_getDatePickerBEMJSON:function(){var t={block:"m-datepicker",mods:{type:"month"},js:["value","date","specialDays","limits"].reduce(function(t,e){return this.params[e]&&(t[e]=this.params[e]),t}.bind(this),{})};return this.hasMod("has","clear")&&(t.mods.has="clear"),t},setSpecialDays:function(t){return this._datePicker.setSpecialDays(t)},setMinDate:function(t){return this._datePicker.setMinDate(t)},setMaxDate:function(t){return this._datePicker.setMaxDate(t)},setLimits:function(t,e){return this._datePicker.setLimits(t,e)},_onDatePickerPopupHide:function(){this.__base.apply(this,arguments),this.__self.activeCalendar=null},_onDatePickerPopupShow:function(){this.__base.apply(this,arguments),setTimeout(function(){this.__self.activeCalendar=this}.bind(this),200)}},{MILLISECONDS_IN_DAY:864e5,MILLISECONDS_IN_WEEK:6048e5}),BEM.DOM.decl({block:"attach",modName:"role",modVal:"import-page"},{_update:function(){var t=this.elem("control").val(),e=t.split("\\").pop().split(".").pop().toLowerCase();!t||this.__self.EXTENSIONS[e]?(this.__base.apply(this,arguments),this.setMod("hidden-button",t?"yes":"")):this.afterCurrentEvent(function(){this.resetFile(),this.delMod("hidden-button"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("attach","page_import_invalid_format")))},this)},_setFilePath:function(t,e){var i=this._filePath;this._filePath=t;var n=t.split("\\").pop(),s=n.split(".").pop().toLowerCase(),o=new RegExp("\\."+s+"$");this.setMod(this.elem("holder"),"file",this._extensionsToMods[s]||this.params.unknownType),this.toggleMod(this.elem("holder"),"state","hidden",!n),BEM.DOM.update(this.elem("text"),BEMHTML.apply(n?[{block:"attach",elem:"file-name",content:n.replace(o,"")},{block:"attach",elem:"file-extension",content:"."+s}]:this._noFileText)),(e||t!==i)&&this.trigger("change")},resetFile:function(){this.__base.apply(this,arguments),this.delMod("hidden-button")}},{EXTENSIONS:function(){const t=Object.create(null);return t.docx=!0,t.txt=!0,t}()}),BEM.DOM.decl("m-uploader",{onSetMod:{js:function(){this.files=this.__self.getFiles(),this.summary=this.__self.getSummary(),this.popup=this.__self.getPopup(this.params),this.box=this.popup.findBlockInside("uploader-box"),this.info=this.__self.getInfo(),this.dragFlag=!0,this._initParams(),this._bind(),this.__self.checkBind()&&(this._bindPopup(),this._infoDrag(),this._initParamsPopup())}},_initParamsPopup:function(){this.params.autoupload&&"yes"===this.params.autoupload?this.params.autoupload=!0:(this.params.autoupload=!1,this.readyForUpload=this.__self.getFilesList())},_initParams:function(){"no"===this.params.choosefile?this.params.choosefile=!1:this.params.choosefile=!0,this.params.dropzone&&"no"===this.params.dropzone?this.params.dropzone=!1:this.params.dropzone=!0},getSummary:function(){return this.summary},getFiles:function(){return Object.keys(this.files).map(function(t){return this.files[t]},this)},sendFiles:function(){this.readyForUpload.forEach(function(t){this._send(t)}.bind(this)),this.readyForUpload=this.__self.getFilesList()},uploadsAbort:function(){Object.keys(this.files).forEach(function(t){"uploading"===this.files[t].status&&(this.files[t].req.abort(),this.files[t].status="aborted",BEM.DOM.destruct(this.files[t].node.domElem),delete this.files[t],this.trigger("uploadabort"))},this),this.trigger("uploadsabort")},_bindRow:function(t){this.files[t].node.findElem("abort").on("click",function(e){e.stopPropagation(),this.files[t].req&&this.files[t].req.abort(),BEM.DOM.destruct(this.files[t].node.domElem),delete this.files[t],this.trigger("uploadabort",t)}.bind(this))},_infoDrag:function(){function t(t){var e=t.get(0).getBoundingClientRect(),i=document.body,n=document.documentElement,s=window.pageYOffset||n.scrollTop||i.scrollTop,o=window.pageXOffset||n.scrollLeft||i.scrollLeft,r=n.clientTop||i.clientTop||0,a=n.clientLeft||i.clientLeft||0,c=e.top+s-r,l=e.left+o-a;return{top:Math.round(c),left:Math.round(l)}}var e=this.info.domElem,i=this.info.findElem("box");i.on("dragstart",function(){return!1}),i.on("mousedown",function(n){var s=t(i),o=t(e),r=n.pageX-s.left;return document.onmousemove=function(t){var n=t.pageX-r-o.left,s=e.width()-i.width();n<0&&(n=0),n>s&&(n=s),i.css("left",n+"px")},document.onmouseup=function(){document.onmousemove=document.onmouseup=null},!1})},_bindPopup:function(){var t=this,e=this.info,i=this.box.findElem("drop-popup"),n=this.box.findBlockInside("attach"),s=this.box.findBlockInside({block:"button",modName:"type",modVal:"start-upload"}),o=this.box.findBlockInside({block:"button",modName:"type",modVal:"abort-uploads"}),r=this.box.findBlockInside({block:"button",modName:"type",modVal:"clear-list"}),a=this.box.findBlockInside({block:"button",modName:"type",modVal:"close"});n&&n.on("change",function(){t._prepareData(n.findElem("control")[0])}),!this.params.autoupload&&s&&s.bindTo("click",this.sendFiles.bind(t)),a&&a.bindTo("click",function(){t._clearList.apply(t),t.popup.hide()}),o&&o.bindTo("click",this.uploadsAbort.bind(this)),r&&r.bindTo("click",this._clearList.bind(this)),i.on("drop",function(e){e.preventDefault();var n=e.originalEvent.dataTransfer;t.delMod(i,"is"),t.box.delMod(i,"is"),t._prepareData(n)}).on("dragover",function(t){t.preventDefault()}),this.box.domElem.on("dragenter",function(){t.dragFlag&&(t.dragFlag=!1,t.box.setMod(i,"is","show"),t._unlockDrag())}),this.box.domElem.on("dragleave",function(){t.dragFlag&&(t.dragFlag=!1,t.box.delMod(i,"is"),t._unlockDrag())}),this.popup.on("hide",function(){t.summary.filesTotal&&e.setMod("is","show")}),e.findElem("box").on("dblclick",function(){t.popup.show(),e.delMod("is")})},_bind:function(){var t=this,e=this.findElem("drop-zone"),i=this.findBlockInside("attach");this.params.choosefile&&i.on("change",function(){t._prepareData(i.findElem("control")[0])}),this.params.dropzone&&e.on("dragenter dragleave",function(){t.dragFlag&&(t.dragFlag=!1,t.toggleMod(e,"is","hovered",""),t._unlockDrag())}).on("drop",function(i){i.preventDefault();var n=i.originalEvent.dataTransfer;t.delMod(e,"is"),t.box.delMod(e,"is"),t._prepareData(n)}).on("dragover",function(t){t.preventDefault()}),this.on("uploadabort uploadsabort filesready fileready uploadsuccess uploaderror clearlist",function(){t._updateSummary(),t._updateSummaryRow()}),this.on("progress drag",function(e,i){t._updateSummary(),t._updateSummaryRow(),t._progressUpdate(i)}),this.on("thumbready",function(e,i){var n=i.key;t.files[n].dataurl=i.dataurl,t.files[n].previewHeight=i.height,t.files[n].previewWidth=i.width,BEM.DOM.update(t.files[n].node.findElem("icon"),i.img)})},_unlockDrag:function(){setTimeout(function(){this.dragFlag=!0}.bind(this),0)},_clearList:function(){Object.keys(this.files).forEach(function(t){"uploading"!==this.files[t].status&&(this.files[t].hasOwnProperty("req")&&this.files[t].req.abort(),BEM.DOM.destruct(this.files[t].node.domElem),delete this.files[t])},this),this.trigger("clearlist")},_prepareData:function(t){if(t.files.length)this._handleFiles(t.files);else if(t.getData("text/html")&&t.getData("text/html").substr("img")){var e,i,n,s,o,r,a,c=this,l=t.getData("text/html"),d=new DOMParser,h=d.parseFromString(l,"text/html")||d.parseFromString(l,"text/xml"),u=$("img",h).attr("src");if(-1!==u.indexOf(";base64,")){i=(e=u.split(";base64,"))[0].split(":")[1],s=(n=atob(e[1])).length,o=new Uint8Array(s);for(var m=0;m<s;++m)o[m]=n.charCodeAt(m);r=[new Blob([o],{type:i})],this._handleFiles(r)}else a=c.box.findElem("drop-popup"),$.ajax({type:c.params.ajaxType||"POST",url:this.params.url,data:u,beforeSend:function(){c.popup.show(),c.box.setMod(a,"is","waiting"),BEM.DOM.update(a,BEMHTML.apply(c._getSpin())),c.box.findBlockInside(a,"spin").setMod("progress","yes")},success:function(t){BEM.DOM.destruct(c.box.findBlockInside(a,"spin").domElem),c.box.delMod(a,"is"),c._handleFiles([JSON.parse(t)])}})}},_toBytes:function(t){return t.value*Math.pow(1024,["kb","mb","gb"].indexOf(t.prefix)+1)},_calculateStatus:function(t){var e="ready",i=this.params.fileLimit;return i&&t.size>this._toBytes(i)?e="fileIsToLarge":t.hasOwnProperty("data")&&(e="done"),e},_handleFiles:function(t){var e=this,i=Array.prototype.slice.apply(t);this.popup.show(),this.info.hasMod("is","show")&&this.info.delMod("is"),i.forEach(function(t,i){var n="file_"+Object.keys(e.files).length,s=e._calculateStatus(t),o=BEMHTML.apply(e._getFileRow(n,e._getFriendlyData(t)));(BEM.DOM.prepend(e.box.findElem("list"),o),e.files[n]=t,t.total=t.size+(t.name&&t.name.length||0)+t.type.length+164,t.node=e.box.findBlockInside({block:"uploader-row",modName:"file",modVal:n}),t.status=s,t.data&&(t.progress=100,t.loaded=t.total,t.node.setMod("status","done"),e.trigger("drag",n)),e._bindRow(n),t.type.match(/image.*/))&&(BEM.DOM.update(e.files[n].node.findElem("icon"),BEMHTML.apply(e._getSpin())),e.files[n].node.findBlockInside("spin").setMod("progress","yes"),e._getThumbnail(t,n));e.trigger("fileready",n)}),this.trigger("filesready"),this.readyForUpload=this.__self.getFilesList(),Object.keys(this.files).forEach(function(t){var i="ready"===e.files[t].status;i&&e.params.autoupload?e._send(t):i&&e.readyForUpload.push(t)})},_getOverallPercent:function(){var t=this,e=0,i=0,n=0,s=0;return Object.keys(this.files).length&&(Object.keys(this.files).forEach(function(n){e+=t.files[n].total||0,i+=t.files[n].loaded||0}),s=e/100,n=Math.round(i/s)),n},_send:function(t){var e=this,i=new FormData;i.append("data",this.files[t]),this.files[t].req=$.ajax({xhr:function(){var i=new window.XMLHttpRequest;return i.upload.addEventListener("progress",function(i){if(i.lengthComputable){var n=i.loaded/i.total*100<<0;e.files[t].progress=n,e.files[t].loaded=i.loaded,e.files[t].total=i.total,e.trigger("progress",t)}},!1),i},type:e.params.ajaxType||"POST",url:this.params.url,data:i,processData:!1,contentType:!1,beforeSend:function(){e._beforeUpload(t)},success:function(i){e._uploadSuccess(i,t),e.files[t].loaded=e.files[t].total,e.files[t].progress=100,e._progressUpdate(t)},error:function(i){e._uploadError(t)}}),this.params.hasOwnProperty("ajaxExtend")&&this._ajaxExtend(t)},_ajaxExtend:function(t){var e=this.params.ajaxExtend;Object.keys(e).forEach(function(i){this.files[t].req[i]=e[i]}.bind(this))},_beforeUpload:function(t){this.files[t].status="uploading"},_uploadError:function(t){this.files[t].node.setMod("status","error"),this.trigger("uploaderror")},_uploadSuccess:function(t,e){this.files[e].response=t,this.files[e].status="done",this.files[e].node.setMod("status","done"),this.trigger("uploadsuccess",this.files[e])},_progressUpdate:function(t){var e=this.files[t],i=this._getOptimalSize(e.loaded)+" / "+this._getOptimalSize(e.total);e.node.findElem("bar").css("width",e.progress+"%"),BEM.DOM.update(e.node.findElem("calc"),i)},_updateSummary:function(){var t=this,e=Object.keys(this.files),i=0,n=0;this.summary.filesTotal=e.length,this.summary.filesUploaded=0,this.summary.percent=this._getOverallPercent(),e.forEach(function(e){"done"===t.files[e].status&&t.summary.filesUploaded++,i+=t.files[e].total,n+=t.files[e].loaded}),this.summary.bytesTotal=i,this.summary.total=this._getOptimalSize(i),this.summary.uploaded=this._getOptimalSize(n)},_updateSummaryRow:function(){var t=this.box.findElem("panel"),e="Загружено файлов: ".concat(this.summary.filesUploaded," из ",this.summary.filesTotal," (",this.summary.percent,"%)");BEM.DOM.update(t,e),BEM.DOM.update(this.info.findElem("box"),e)},_getFriendlyData:function(t){return{type:this._getFileType(t.name||t.type),name:t.name,size:this._getOptimalSize(t.size)}},_getThumbnail:function(t,e){var i=this,n=new FileReader;t.data?this._getThumbImage(t.data,t.type,e):(n.onloadend=function(){i._getThumbImage(n.result,t.type,e)},n.readAsDataURL(t))},_getSpin:function(){return{block:"spin",mods:{theme:"gray-32"}}},_getThumbImage:function(t,e,i){var n=this,s=new Image,o=this.params.thumbnail;s.onload=function(){var t=o&&o.width||240,r=o&&o.height||140,a=s.width,c=s.height,l=document.createElement("canvas"),d=null,h=!1,u={},m=a>c&&a>t,p=c>a&&c>r,f=c===a&&c>r;!function o(){var _=new Image;_.onload=function(){s=_,o()};if(m&&s.width>>1>t||p&&s.height>>1>r||f&&s.height>>1>r)h=!0,a>>=1,c>>=1,l.width=a,l.height=c,l.getContext("2d").drawImage(s,0,0,a,c),d=l.toDataURL(e),_.src=d;else{m?(c*=t/a,a=t,c>r&&(a*=r/c,c=r)):(p||f)&&(a*=r/c,c=r,a>t&&(c*=t/a,a=t)),a=Math.round(a),c=Math.round(c),l.width=a,l.height=c,l.getContext("2d").drawImage(s,0,0,a,c),d=l.toDataURL(e);var g=new Image;g.src=d,(h||s.width>t>>2||s.height>r>>2)&&(a>c&&a/c>2?(g.width=a>>2,$(g).addClass("by-width can-increased")):(g.height=c>>2,$(g).addClass("by-height can-increased"))),u.key=i,u.img=g,u.dataurl=d,u.width=a,u.height=c,n.trigger("thumbready",u)}}()},s.src=t},_getFileType:function(t){var e=t.split(".")?t.split("."):t.split("/");return e[e.length-1]},_getOptimalSize:function(t){for(var e=["B","Kb","Mb","Gb"],i=0;i<e.length;i++){var n=t/1024;if(!(n>1))return t.toFixed(2)+e[i];t=n}},_getFileRow:function(t,e){return{block:"uploader-row",mods:{file:t},content:[{elem:"icon",elemMods:{type:e.type},content:"."+e.type},{elem:"progress",content:[{elem:"bar"},{elem:"name",content:e.name},{elem:"calc"}]},{elem:"abort"}]}}},{getFiles:function(){return this.files||(this.files={})},getSummary:function(){return this.summary||(this.summary={})},getFilesList:function(){return this.readyForUpload||(this.readyForUpload=[])},getInfo:function(){return this.info||(this.info=((t=$(BEMHTML.apply({block:"uploader-info",content:{elem:"box"}}))).appendTo("body"),t=t.bem("uploader-info")));var t},checkBind:function(){return!this.binded&&(this.binded=!0,!0)},getPopup:function(t){var e,i=this;return this.popup||(this.popup=((e=$(BEMHTML.apply({block:"popup",mods:{"m-uploader":"yes",type:"modal",position:"fixed","has-close":"yes",behaviour:"scrollable"},underMods:{type:"paranja"},content:[{elem:"content",content:i.getContent(t)}]}))).appendTo("body"),e=e.bem("popup")))},getContent:function(t){return{block:"uploader-box",content:[{elem:"drop-popup"},{elem:"panel"},{elem:"list"},{elem:"controls",content:this.getControls(t)}]}},getControls:function(t){var e={upload:this.buttonUpload.bind(this,t),attach:this.buttonAttach,abort:this.buttonAbort,clear:this.buttonClear,close:this.buttonClose},i={upload:this.buttonUpload.bind(this,t),attach:this.buttonAttach,abort:this.buttonAbort,clear:this.buttonClear};return t.controls?t.controls.map(function(t){return e[t]()}):Object.keys(i).map(function(t){return i[t]()})},buttonUpload:function(t){return(!t.autoupload||"no"===t.autoupload)&&{block:"button",mods:{theme:"action",type:"start-upload",size:"s"},content:"Загрузить"}},buttonAttach:function(){return{block:"attach",mods:{theme:"normal",size:"s"},content:[{block:"button",mods:{theme:"normal",size:"s"},mix:[{block:"attach",elem:"button"}],controlAttrs:{multiple:"yes"},content:"Выбрать файл"}]}},buttonAbort:function(){return{block:"button",mods:{theme:"normal",size:"s",type:"abort-uploads"},content:"Отменить все загрузки"}},buttonClear:function(){return{block:"button",mods:{theme:"normal",size:"s",type:"clear-list"},content:"Очистить"}},buttonClose:function(){return{block:"button",mods:{theme:"normal",size:"s",type:"close"},content:"Закрыть"}}}),BEM.DOM.decl({block:"m-editor-popup",modName:"type",modVal:"picture"},{onSetMod:{js:function(){var t=this;this._widthInput=this.findBlockInside({block:"textinput",modName:"picture",modVal:"width"}),this._heightInput=this.findBlockInside({block:"textinput",modName:"picture",modVal:"height"}),this._linkInput=this.findBlockInside({block:"textinput",modName:"picture",modVal:"link"}),this._progress=this.findBlockInside("progress"),this._attach=this.findBlockInside("attach"),this._attach&&this._attach.on("change",this._onFileSelected,this).on("reset",function(){t._linkInput.delMod("disabled").val("")}),this._uploader=this.findBlockInside("mi-uploader"),this._uploader&&this._uploader.on("success",this._onUploadSuccess,this).on("error",this._onUploadError,this).on("progress",function(e,i){t._progress.update(i.progress/100,"linear")})}},processParams:function(t){var e,i="";return(e=$.extend({},{pictureWidth:0,pictureHeight:0,pictureLink:""},t)).pictureLink&&(i=e.pictureLink,(e.pictureWidth||e.pictureHeight||!/\.jpg$|png$|gif$/.test(e.pictureLink))&&(i=e.pictureWidth+"x"+e.pictureHeight+":"+i)),i},_onFileSelected:function(t,e){var i=this._attach.elem("control")[0].files;i.length&&(this._attach.delMod(this._attach.elem("text"),"error"),this._attach.setMod("disabled","yes").delMod(this._attach.elem("reset"),"visibility"),this._uploader.clear().setData(i[0]).getFiles()[0].send())},_onUploadSuccess:function(t,e){var i;e.data.errors?this._onUploadError():(i=this._getUploadedFileURL(e),this._linkInput.setMod("disabled","yes").val(i),this._progress.update(0),this._attach.delMod("disabled").setMod(this._attach.elem("reset"),"visibility","visible"),this.trigger("event",{name:"uploaded",data:e}))},_onUploadError:function(t){this._progress.update(0),this._attach.delMod("disabled").setMod(this._attach.elem("holder"),"state","hidden").setMod(this._attach.elem("holder"),"file","unknown").resetFile(),this._attach.setMod(this._attach.elem("text"),"error","yes").elem("text").text(BEM.I18N("m-editor-popup","uploadError")+"...")},_getUploadedFileURL:function(t){return(this.params.uploadURLPath&&this.params.uploadURLPath.split(".")||[]).forEach(function(e){t=t[e]},this),t}}),BEM.DOM.decl({block:"m-editor-popup",modName:"type",modVal:"file"},{onSetMod:{js:function(){var t=this;this._progress=this.findBlockInside("progress"),this._attach=this.findBlockInside("attach"),this._attach&&this._attach.on("change",this._onFileSelected,this),this._uploader=this.findBlockInside("mi-uploader"),this._uploader&&this._uploader.on("success",this._onUploadSuccess,this).on("error",this._onUploadError,this).on("progress",function(e,i){t._progress.update(i.progress/100,"linear")})}},_onFileSelected:function(t,e){var i=this._attach.elem("control")[0].files;i.length&&(this._attach.delMod(this._attach.elem("text"),"error"),this._attach.setMod("disabled","yes").delMod(this._attach.elem("reset"),"visibility"),this._uploader.clear().setData(i[0]).getFiles()[0].send())},_onUploadSuccess:function(t,e){e.data.errors?this._onUploadError():(this._progress.update(0),this._attach.delMod("disabled").setMod(this._attach.elem("reset"),"visibility","visible"),this.trigger("event",{name:"uploaded",data:e}),this.trigger("add-text",this._getUploadedFileURL(e)))},_onUploadError:function(t){this._progress.update(0),this._attach.delMod("disabled").setMod(this._attach.elem("holder"),"state","hidden").setMod(this._attach.elem("holder"),"file","unknown").resetFile(),this._attach.setMod(this._attach.elem("text"),"error","yes").elem("text").text(BEM.I18N("m-editor-popup","uploadError")+"...")},_getUploadedFileURL:function(t){return(this.params.uploadURLPath&&this.params.uploadURLPath.split(".")||[]).forEach(function(e){t=t[e]},this),t}}),BEM.DOM.decl({block:"b-widget",modName:"type",modVal:"new-page"},{onSetMod:{js:function(){this.__base.apply(this,arguments),this._localStorage=BEM.blocks["mi-storage"],this._bPage=this.findBlockOutside("b-page"),this._bHead=this._bPage.findBlockInside("b-head"),this._cancel=this.findBlockInside({block:"button2",modName:"role",modVal:"new-page-cancel"}),this._save=this.findBlockInside({block:"button2",modName:"role",modVal:"new-page-save"}),this._type=this.findBlockInside({block:"radio-button",modName:"type",modVal:"new-page"}),this._clusterType=this.findBlockInside({block:"select2",modName:"role",modVal:"cluster-type"}),this._area=this.findBlockInside({block:"input",modName:"role",modVal:"note"}),this._url=this.findBlockInside({block:"input",modName:"type",modVal:"new-page-url"}),this._title=this.findBlockInside({block:"input",modName:"type",modVal:"new-page-title"}),this._spinner=this.findBlockInside({block:"spin2",modName:"type",modVal:"create-load"}),this._attach=this.findBlockInside({block:"attach",modName:"role",modVal:"import-page"}),this.setMod("page-type","page"),this._type.on("change",this._onTypeChange,this),this._clusterType.on("change",this._onClusterTypeChange,this),this._cancel.on("click",this._onCancel,this),this._save.on("click",this._onSave,this),this._title.on("change",this._onTitleChange,this),this._url.on("change",this._onUrlChange,this)},"cluster-type":function(t,e){if(e){if(this._clusterType.getVal()!==e&&(this._preventClusterTypeChange=!0,this._clusterType.setVal(e)),this._prefix=this.__self.prefixes[e]?this.__self.prefixes[e][0]:"/",this._unsetIgnoreTitleChange(),!this._clusterChangedFromUrl){const t=this.getMod("is404")?BEM.blocks["wi-history"].getCorrectPath():this._prefix+"newpage";this._url.val()!==t&&(this._setIgnoreUrlChange(),this._url.val(t)),this._title.val()&&this._onTitleChange()}this._clusterChangedFromUrl=!1,BEM.DOM.update(this.elem("description"),BEM.I18N("b-widget","cluster_description_"+e,{cluster:"cluster"===e?"/users/"+this._bPage.params.login+"/":BEM.blocks["wi-history"].getCorrectPath()}))}},is404:function(t,e){this._clusterType.setMod("disabled",e)},progress:function(t,e){this._spinner.setMod("progress",e),this._cancel.setMod("disabled",e),this._save.setMod("disabled",e),this._attach.setMod("disabled",e),this._url.setMod("disabled",e),this._title.setMod("disabled",e),this._clusterType.setMod("disabled",e||this.getMod("is404"))}},_onTypeChange:function(t,e){this.setMod("page-type",e.currentVal)},_onClusterTypeChange:function(t,e){this._preventClusterTypeChange||this.setMod("cluster-type",e.currVal),this._preventClusterTypeChange=!1},show:function(){this.__base.apply(this,arguments),keymaster("ctrl+enter, command+enter",this._onSave.bind(this))},hide:function(){this.__base.apply(this,arguments),keymaster.unbind("ctrl+enter, command+enter"),this._setIgnoreTitleChange(),this._title.val(""),this._unsetIgnoreTitleChange(),this.delMod("cluster-type")},_createUrl:function(){var t="";switch(this._type.val()){default:case"page":t=this._url.val();break;case"grid":t=this._url.val()+"/.grid/create";break;case"note":t=".notes"}return t},_checkIsTitleFilled:function(){return!!this._title.val().trim()||(BEM.channel("notification").trigger("error",{elem:this._title.domElem,message:BEM.I18N("b-widget","input_page_name")}),!1)},_checkIsUrlFilled:function(){return!!this._url.val().trim()||(BEM.channel("notification").trigger("error",{elem:this._url.domElem,message:BEM.I18N("b-widget","input_page_url")}),!1)},_normalizeUrl:function(t){var e,i="",n=this;if(this._prefix=null,t=t.trim(),Object.keys(this.__self.prefixes).forEach(function(e){n.__self.prefixes[e].forEach(function(s){i||-1===t.indexOf(s)||(i=e,n._prefix=s)})}),t=t.replace(/\/{2,}/,"/"),this._prefix)if("cluster"===i)e="users/"+this._bPage.params.login+"/"+t.split(this._prefix).pop();else{var s=BEM.WISTORE.get("page").get("tag");s.endsWith("/")||(s+="/"),e=s+t.split(this._prefix).pop()}else e=(t=/^\/?(\S+)/.exec(t))&&t[1];return encodeURIComponent(e)},_pageExist:function(t){var e=this,i=this._url.val(),n=this._normalizeUrl(i);this._checkIsUrlFilled()&&this._checkIsTitleFilled()&&(this.setMod("progress","yes"),BEM.create("wi-api-request",{apiPath:n,method:"HEAD",data:!1,urlParams:["format=json"],path:""}).run().then(function(){var t=e._type.val(),i=BEM.I18N("b-widget","page_already_exist");switch(t){case"page":i=BEM.I18N("b-widget","page_already_exist");break;case"grid":i=BEM.I18N("b-widget","grid_already_exist")}e.delMod("progress"),BEM.channel("notification").trigger("error",{elem:e._save.domElem,message:i})},t.bind(this)))},_validateUrl:function(t){var e=this._normalizeUrl(this._url.val());BEM.create("wi-api-request",{apiPath:".validate_tag",method:"GET",urlParams:["tag="+(e||"")],path:""}).run().then(t.bind(this),function(t){BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(this._save.domElem,BEM.I18N("b-widget","validation_error"),t)),this.delMod("progress")}.bind(this))},_onCancel:function(){this.hide(),this._attach.resetFile(),BEM.blocks["wi-history"].removeState()},_onSave:function(){switch(this._type.val()){case"page":this._onSavePage();break;case"grid":this._onSaveGrid();break;case"note":this._onSaveNote()}},_onSaveNote:function(){this.setMod("progress","yes"),yaCounter&&yaCounter.reachGoal("create_note",{clusterType:this._clusterType.getVal(),fileAttached:this._isFilesAttached()}),BEM.create("wi-api-request",{apiPath:this._createUrl(),method:"POST",data:{body:this._area.val()},path:""}).run().then(this._onSaveData.bind(this),this._onPageSaveError.bind(this))},_checkTitleLength:function(){var t=this._title.val();return!(t.length>this.__self.TITLE_MAX_LENGTH)||(BEM.blocks["wi-notification"].errorHandler(this._save.domElem,BEM.I18N("b-widget","title_length_error")+" "+(t.length-this.__self.TITLE_MAX_LENGTH))(),!1)},_onSavePage:function(){yaCounter&&yaCounter.reachGoal("create_page",{clusterType:this._clusterType.getVal(),fileAttached:this._isFilesAttached()}),this._checkTitleLength()&&this._pageExist(function(){this._validateUrl(function(t){if(t.data.success){if("page"===this._type.val()){var e=new FormData,i=this._attach.elem("control")[0].files;i.length&&e.append("file",i[0]),e.append("title",this._title.val()),e.append("body",""),BEM.create("wi-api-request",{apiPath:"",method:"POST",data:e,path:"/"+this._normalizeUrl(this._createUrl())}).run().then(this._onSaveData.bind(this),this._onPageSaveError.bind(this))}}else BEM.blocks["wi-notification"].errorHandler(this._save.domElem,BEM.I18N("b-widget","validation_error"))()})})},_isFilesAttached:function(){return Boolean(this._attach.elem("control")[0].files.length)},_onSaveGrid:function(){yaCounter&&yaCounter.reachGoal("create_grid",{clusterType:this._clusterType.getVal(),fileAttached:this._isFilesAttached()}),this._checkTitleLength()&&this._pageExist(function(){this._validateUrl(function(t){t.data.success?BEM.create("wi-api-request",{apiPath:this._normalizeUrl(this._createUrl()),method:"POST",data:{title:this._title.val(),body:""},path:""}).run().then(this._onSaveData.bind(this),this._onGridSaveError.bind(this)):BEM.blocks["wi-notification"].errorHandler(this._save.domElem,BEM.I18N("b-widget","validation_error"))()})})},_onSaveData:function(t){switch(this._type.val()){case"page":window.location=t.data.url+"/.edit";break;case"grid":t.data.url&&(this._localStorage.setItem("wiki-sidebar","true"),this._localStorage.setItem("wiki-new-grid","true"),window.location=t.data.url);break;case"note":t.data.url&&(window.location=t.data.url)}},_onPageSaveError:function(t){this.delMod("progress"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-widget","cant_create_page"),t))},_onGridSaveError:function(t){this.delMod("progress"),BEM.channel("notification").trigger("error",BEM.blocks["wi-notification"].getError(null,BEM.I18N("b-widget","cant_create_grid"),t))},_getErrorData:function(t,e){return{node:this._save.domElem,error:e,content:{body:t}}},open:function(t,e,i){t||(t="root"),this.setMod("is404",i),this.setMod("page-type","page"),this.setMod("cluster-type",t),this._title.val(e||""),this.show(),setTimeout(function(){this._title.elem("control").focus(),this._title.val(""),this._title.val(e||"")}.bind(this),0)},_setIgnoreUrlChange:function(){this._ignoreUrlChange=!0},_setIgnoreTitleChange:function(){this._ignoreUrlChange||(this._ignoreTitleChange=!0)},_unsetIgnoreUrlChange:function(){this._ignoreUrlChange=!1},_unsetIgnoreTitleChange:function(){this._ignoreTitleChange=!1},_onTitleChange:function(){if(!this.getMod("is404")&&!this._ignoreTitleChange){var t=this.__self.replaceWhitespaces(this._title.val()),e=this._url.val(),i=this._prefix+t;e!==i&&(this._setIgnoreUrlChange(),this._url.val(i))}},_onUrlChange:function(){if(this._ignoreUrlChange)this._unsetIgnoreUrlChange();else{this._setIgnoreTitleChange();var t=this._url.val(),e=this.__self.replaceWhitespaces(t);t!==e&&(this._setIgnoreUrlChange(),this._url.val(e)),this.getMod("is404")||(e.startsWith("~/")&&"cluster"!==this._clusterType.getVal()?(this._clusterChangedFromUrl=!0,this._clusterType.setVal("cluster")):e.startsWith("!/")&&"sub"!==this._clusterType.getVal()?(this._clusterChangedFromUrl=!0,this._clusterType.setVal("sub")):e.startsWith("~/")||e.startsWith("!/")||"root"===this._clusterType.getVal()||(this._clusterChangedFromUrl=!0,this._clusterType.setVal("root")))}}},{TITLE_MAX_LENGTH:200,prefixes:{cluster:["~/","~"],sub:["!/","!"]},replaceWhitespaces:function(t){return t.replace(/\s+/g,"-")}});